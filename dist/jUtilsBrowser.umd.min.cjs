/**  
 * 浏览器工具库 => jUtilsBrowser
 * @update 2024-05-31 09:08:29
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@bestime/utils_base")):"function"==typeof define&&define.amd?define(["exports","@bestime/utils_base"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).jUtilsBrowser={},e.jUtilsBase)}(this,function(e,u){"use strict";let n=0,o,i=!1;const r={};let c;var d={add:function(e,t){return o="HI-"+ ++n,r[o]={start:+new Date,current:0,handler:e,interval:t},i||(clearInterval(c),i=!0,c=setInterval(function(){for(var e in r){const t=r[e];t.current=+new Date,t.current-t.start>=t.interval&&(t.start=t.current,r[e].handler())}},17)),o},remove:function(e){delete r[e],0===Object.keys(r).length&&(i=!1,clearInterval(c),c=undefined)}};function l(e,t){const n=document.createElement("a");n.style.display="none",n.download=t,n.setAttribute("href",e),n.setAttribute("target","_blank"),n.setAttribute("download",t),document.body.appendChild(n),n.click(),n.remove()}const s=void 0,a=decodeURIComponent,f=window,h=document.getElementsByTagName("head")[0];const m={};function g(n,o){const i=[];let r=0;for(let t=0;t<n.length;t++)p(n[t],function(e){i[t]=e,++r===n.length&&o.apply(s,i)})}function p(e,t){var n=e.dependencies&&e.dependencies.length,o=e["with"]&&e["with"].length;m[e.url]||(m[e.url]={count:0,dependencies:!n,"with":!o,complete:!1,create:!1,url:e.url});const i=m[e.url];function r(){i.complete&&i.dependencies&&i["with"]&&(e.module?t(f[e.module]):t())}if(i.count++,!i.dependencies&&n)i.dependencies=!0,g(e.dependencies,function(){p(e,t)});else if(!i["with"]&&o)i["with"]=!0,g(e["with"].concat(e),r);else if(i.create)u.variableHasValue(function(){return i.complete},r,300);else{i.create=!0;var n=e.type,o=e.url,c=function(){i.complete=!0,r()},l=e.attribute;if(h){let e;if("js"===n?(e=document.createElement("script")).src=o:((e=document.createElement("link")).setAttribute("rel","stylesheet"),e.href=o),l)for(var s in l)e.setAttribute(s,l[s]);e.onload=e.onerror=c,h.appendChild(e)}}}function t(e,t,n){var o;o=t,t=o=u.isString(o)?o:JSON.stringify(o);let i=e+"="+encodeURI(t)+";path=/;";"number"==typeof n&&((o=new Date).setTime(o.getTime()+n),i+="expires="+o.toUTCString()),document.cookie=i}function v(t,e){u.isArray(e)?u.forEach(e,function(e){t.classList.remove(e)}):t.classList.remove(e)}function b(t,e){u.isArray(e)?u.forEach(e,function(e){t.classList.add(e)}):t.classList.add(e)}var w=f.navigator.userAgent,w={isChrome:/Chrome/.test(w),isIPhone:/iPhone/.test(w)};e.addClass=b,e.browser=w,e.downloadFileByArrayBuffer=function(e,t){const n=f.URL;l(e=n.createObjectURL(new Blob([e])),t),n.revokeObjectURL(e),undefined},e.downloadFileByUrl=l,e.getCookie=function(e,t){t=t||document.cookie;let o="";return t.replace(new RegExp("(^|;\\s)"+e+"=(.*?)($|(;\\s))"),function(e,t,n){o=a(n)}),o},e.getJsFileBaseUrl=function(e){e=e||0;for(var t="/[^/]*",n=document.scripts,o=0;o<e;o++)t+=t;return n[n.length-1].src.replace(new RegExp(t+"$"),"")},e.getRatio=function(){return window.devicePixelRatio||1},e.getRelativePos=function(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top,height:e.offsetHeight,width:e.offsetWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight}},e.getStorage=function(e){return e=localStorage.getItem(e),u.defaultValue(e,"")},e.getWindowSize=function(){return{width:document.documentElement.clientWidth||document.body.clientWidth||window.innerWidth||0,height:document.documentElement.clientHeight||document.body.clientHeight||window.innerHeight||0}},e.libraryFile=function(e,t){(e instanceof Array?g:p)(e,t)},e.observeDomResize=function(n,o,i,e){let r=[0,0,!1],c=[0,0,!1],l=[0,0,!1],s=[0,0,!1];const t=d.add(u,e=e||500);function u(){if(document.body.contains(n)){let e=!1;var t;i?.includes("position")&&(t=n.getBoundingClientRect(),l[0]=t.left,l[2]=l[0]!==l[1],s[0]=t.top,s[2]=s[0]!==s[1]),r[0]=n.offsetWidth,r[2]=r[0]!==r[1],c[0]=n.offsetHeight,c[2]=c[0]!==c[1],r[2]&&(r[1]=r[0],i?.includes("width")&&(e=!0)),c[2]&&(c[1]=c[0],i?.includes("height")&&(e=!0)),(s[2]||l[2])&&(s[1]=s[0],l[1]=l[0],i?.includes("position")&&(e=!0)),i&&0!==i.length||(r[2]||c[2]||s[2]||l[2])&&(e=!0),e&&o(n)}else a()}function a(){d.remove(t),r=undefined,c=undefined}return u(),a},e.observeDomScroll=function(e,t){const n=u._KvPair(t),o=u._Number(n.offetY);var i=!1;function r(){i||(n.onTop&&e.scrollTop<=0?(i=!0,n.onTop(function(){i=!1})):n.onBottom&&e.scrollTop>=e.scrollHeight-e.offsetHeight-o?(i=!0,n.onBottom(function(){i=!1})):i=!1)}return e.addEventListener("scroll",r),{dispose:function(){e.removeEventListener("scroll",r)}}},e.prevent=function(e,t,n){e=e||f.event,n=!1!==n,(t=!1!==t)&&f.event?f.event.cancelBubble=!0:e.stopPropagation(),n&&f.event?f.event.returnValue=!1:e.preventDefault()},e.removeClass=v,e.removeCookie=function(e){t(e,"",-1)},e.removeElement=function(e){e.parentNode&&e.parentNode.removeChild(e)},e.removeStorage=function(e){localStorage.removeItem(e)},e.replaceClass=function(e,t,n){v(e,t),b(e,n)},e.setCookie=t,e.setStorage=function(e,t){localStorage.setItem(e,(e=t,e=u.isString(e)?e:JSON.stringify(e)))},e.toggleClass=function(t,e){u.isArray(e)?u.forEach(e,function(e){t.classList.toggle(e)}):t.classList.toggle(e)}});
