/**
 * 纯JS工具库 => jUtilsBase
 * @update 2024-06-12 17:25:36
 */
var $letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],$ArrayTypeNameBig="Array",$FunctionTypeNameBig="Function",$ObjectTypeNameBig="Object",$stringTypeNameBig="String",$numberTypeNameBig="Number",$undefinedValue=void 0,$zeroString="0",$falseString="false",$trueString="true",$ObjectTypeNameBigPrototypeToString=Object.prototype.toString,$encodeURI=encodeURI,$decodeURIComponent=decodeURIComponent,$regSpaceStr="\\s\\uFEFF\\xA0",$zeroWidthCode="‎";function isNull(e){return null===e||e===$undefinedValue}function _String(e){return isNull(e)?"":String(e)}function getType(e){return $ObjectTypeNameBigPrototypeToString.call(e).slice(8,-1)}function isArray(e){return getType(e)===$ArrayTypeNameBig}function isKvPair(e){return getType(e)===$ObjectTypeNameBig}function isString(e){return getType(e)===$stringTypeNameBig}function hpJsonParse(e,n){var r;try{r=JSON.parse(e)}catch(t){r=n}return r}function _KvPair(e){return e=isKvPair(e)||isKvPair(e=hpJsonParse(e))?e:{}}function isEmpty(e){return isNull(e)||""===e}function isFunction(e){return"function"==typeof e}function param(e){var r=[];function a(e,n){null!=e&&""!==e&&(n=null==(n=isFunction(n)?n():n)?"":n,r[r.length]=$encodeURI(e)+"="+$encodeURI(n))}return function i(e,n){var r,t;if(e)switch(getType(n)){case $ArrayTypeNameBig:for(r=0;r<n.length;r++)i(e+"["+("object"==typeof n[r]&&n[r]?r:"")+"]",n[r]);break;case $ObjectTypeNameBig:for(t in n)i(e+"["+t+"]",n[t]);break;default:a(e,n)}else switch(getType(n)){case $stringTypeNameBig:case $ObjectTypeNameBig:for(t in n)i(t,n[t]);break;case $ArrayTypeNameBig:for(r=0;r<n.length;r++)a(n[r].name,n[r].value)}}("",e),r.join("&")}function _Array(e){return e=isArray(e)||isArray(e=hpJsonParse(e))?e:[]}function _Number(e){return e=Number(e),Math.abs(e)===Math.abs(Infinity)||isNaN(e)?0:e}function hpTryToParseStringToBasicType(e){return null==e?$undefinedValue:$falseString!==e&&($trueString===e||hpJsonParse(e,e))}var defaultSplitArr=[$undefinedValue,$undefinedValue];function handleDeepKey(e,n,r){var n=splitSymbol(n),t=n[0];isPreLikeArray(t)?(t=_Number(t),n[1]==$undefinedValue?e.push(r):(/^\[[\D]+\]/.test(n[1])?e[t]=_KvPair(e[t]):e[t]=_Array(e[t]),handleDeepKey(e[t],n[1],r))):n[1]==$undefinedValue?e[t]=r:(/^\[[\D]+\]/.test(n[1])?e[t]=_KvPair(e[t]):e[t]=_Array(e[t]),handleDeepKey(e[t],n[1],r))}function splitSymbol(e){if(e==$undefinedValue)return defaultSplitArr;var t,a=e;return e.replace(/^\[(.*?)\](.*)?/,function(e,n,r){return a=n,t=r,""}),[a,t]}function isPreLikeArray(e){return""===e||/^\d+$/.test(e)}function parseQuery(e){var i={},o=!1,r="";return(e=isNull(e)?"":e).replace(/([^=&?/#]*?)=([^=&?/#]*)/g,function(e,n,a){a=hpTryToParseStringToBasicType($decodeURIComponent(a)),r=$decodeURIComponent(n),o=!1,""!==r&&(r.replace(/(.*?)(\[.*)/,function(e,n,r){var t=splitSymbol(r);o=!0,isPreLikeArray(t[0])?i[n]=_Array(i[n]):i[n]=_KvPair(i[n]),handleDeepKey(i[n],r,a)}),o||(i[r]=a))}),i}var baseReg="["+$regSpaceStr+"]+";function trim(e,n){var r=getType(e),t=(r===$numberTypeNameBig&&(e=String(e),r=$stringTypeNameBig),"");if(r!==$stringTypeNameBig)return"";switch(n){case 1:t="^"+baseReg;break;case-1:t=baseReg+"$";break;case"*":t=baseReg;break;default:t="^"+baseReg+"|"+baseReg+"$"}return e.replace(new RegExp(t,"g"),"")}function urlToGet(e,n){e=_String(e);var i=isKvPair(n)?n:parseQuery(n),n=parseQuery(e=e.replace(/({{)(.*?)(}})/g,function(e,n,r,t){r=trim(r);var a=i[r];return delete i[r],a})),n=param(i=Object.assign(n,i));return e=n?(e=e.replace(/\?.*/,""))+"?"+n:e}function hpIsEmptyMap(e){var n,r=!0;for(n in e)if(n!==$undefinedValue){r=!1;break}return r}function cloneEasy(e){switch(getType(e)){case $ArrayTypeNameBig:for(var n=[],r=0;r<e.length;r++)n.push(cloneEasy(e[r]));break;case $ObjectTypeNameBig:for(var t in n={},e)n[t]=cloneEasy(e[t]);break;case $FunctionTypeNameBig:function a(){e.apply(this,arguments)}for(var i in e.prototype)a.prototype[i]=e.prototype[i];n=a;break;default:n=e}return n}function isNoData(e,n){var r=!1;return r=isArray(e)&&n.array&&0===e.length||isKvPair(e)&&n.kvPair&&hpIsEmptyMap(e)||isString(e)&&n.string&&""===e||isNull(e)?!0:r}function hander(e,n){if(isKvPair(e))for(var r in e){var t=e[r];(isArray(t)||isKvPair(t))&&hander(t,n),isNoData(t,n)&&delete e[r]}}function shake(e,n){n=Object.assign({string:!0,array:!0,kvPair:!0},n);return hander(e=cloneEasy(e),n),e}function variableHasValue(e,n,r){var t;r=null==r?60:r,e()?n():(clearTimeout(t),setTimeout(function(){variableHasValue(e,n,r)},r))}variableHasValue["async"]=function(n,r){return new Promise(function(e){variableHasValue(n,e,r)})};var DEFAULT_CONFIG={id:"id",children:"children"};function deepFindTreePath(e,n,r){r=Object.assign(DEFAULT_CONFIG,r);for(var t=[],a=cloneEasy(e),i=new Set,o=r["children"];a.length;){var u=a[0];if(i.has(u))t.pop(),a.shift();else if(i.add(u),u[o]&&a.unshift.apply(a,u[o]),t.push(u),n(u))return t}return undefined}function isLikeNumber(e){var n=!1;return"boolean"==typeof e||isArray(e)||null==e||""===e||(e=Number(e),n=!isNaN(e)&&Infinity!=Math.abs(e)),n}function defaultValue(e,n){return isNull(e)?n:e}function repeatString(e,n){var r="";if((e=_String(e)).length*n<1<<28)for(;1==(1&n)&&(r+=e),0!=(n>>>=1);)e+=e;return r}function hpPadString(e,n,r,t){return(e=_String(e)).length>(n>>=0)?e:(n-=e.length,r.length<n&&(r+=repeatString(r,n/r.length)),-1===t?r.slice(0,n)+e:e+r.slice(0,n))}function padStart(e,n,r){return hpPadString(e,n,r,-1)}function padEnd(e,n,r){return hpPadString(e,n,r,1)}function split(e,n){return""!==e?e.split(n):[]}function floorFixed(e,n,r){var e=split(e=trim(_Number(e)),"."),t=e[1]||"";return t.length<n&&(t=padEnd(t,n,$zeroString),r&&(t=t.replace(/0+$/,""))),n<1||!t?e[0]:e[0]+"."+t.substring(0,n)}function roundFixed(e,n,r){e=_Number(e);var t,a=Math.pow(10,n),e=_String(Math.round(e*a)/a);return 0<n&&(t=(a=split(e,"."))[0],(a=a[1]||"").length<n&&(a=padEnd(a,n,$zeroString),e=(a=r?a.replace(/0+$/,""):a)?t+"."+a:t)),e}function deepFindItem(e,r,n){var t,a,i=isNull(n)?"children":n;return function o(e){if(e)for(var n=0;n<e.length;n++){if(a=r(e[n])){t=e[n];break}if(o(e[n][i]),a)break}}(e),t}function flatArrayToTree(e,n){for(var r=(n=_KvPair(n)).id||"id",t=n.pid||"pid",a=n.children||"children",i=0;i<e.length;i++){var o,u=e[i];(o=deepFindItem(e,function(e){return null!=e[r]&&e[r]!=u[r]&&e[r]===u[t]},a))&&(o[a]=_Array(o[a]),o[a].push(u),e.splice(i--,1))}return e}function changeIndex(e,n,r){if(e<0)return n;e+=1;return(n=(n+r)%e)<0&&(n+=e),-0===n?0:n}function getRandom(e,n,r){r=!1===r?0:1;return e=Math.random()*(n-e+r)+e,r?Math.floor(e):e}function getRandomWord(){return $letters[getRandom(0,$letters.length-1)][0]}function uuid(e){e=_Number(e);for(var n="",r=0;r<13;r++)n+=getRandom(1,9);e=(new Date).getTime()*getRandom(1,100);return padEnd(getRandomWord()+Number(n).toString(32)+e.toString(32),20,getRandomWord()+getRandomWord()+getRandomWord())}function _Boolean(e){return!0===e||"true"===e||"1"===e||1===e}function flatTree(e,t){var a=[];return t=defaultValue(t,"children"),function i(e){if(isArray(e))for(var n,r=0;r<e.length;r++)n=e[r],a.push(n),i(n[t])}(e),a}function main(e,a,i,o){o=o||"children";var n=[];return function u(e,n){for(var r=0;r<e.length;r++){var t=i(e[r]);isNull(t)||(n[r]=cloneEasy(t),e[r][o]&&(n[r][a]=[],u(e[r][o],n[r][a])))}}(e,n),n}var events={};function defineEventBus(a){if(events[a])throw'"'+a+'" Has already been registered!';return events[a]=events[a]||[],{on:function(e){events[a].push(e)},emit:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var t=0;t<events[a].length;t++)events[a][t].apply($undefinedValue,n)},off:function(e){if(!e)throw"the hander of off is required!";for(var n=0;n<events[a].length;n++)events[a][n]===e&&events[a].splice(n--,1)},dispose:function(){for(var e=0;e<events[a].length;e++)events[a].splice(e--,1);delete events[a]}}}function forEachTree(e,a,i){i=i||"children",function o(e,n){for(var r=0;r<e.length;r++){var t=cloneEasy(n);a(e[r],t),isArray(e[r][i])&&(t.push(e[r]),o(e[r][i],t))}}(e,[])}function forEach(e,n){for(var r=0;r<e.length;r++)n(e[r],r,e)}function randomColor(){return"rgba("+getRandom(0,255,!0)+","+getRandom(0,255,!0)+","+getRandom(0,255,!0)+",1)"}function emptyFunc(e,n){}var Polling=function(){function e(e){this._timer=void 0,this._timer_info=void 0,this._stamp=0,this._passStamp=0,this._option=void 0,this._option=Object.assign({timeout:6e3,interval:1e3,handler:emptyFunc},e),this._next=this._next.bind(this),this._doOnce=this._doOnce.bind(this),this.done=this.done.bind(this)}var n=e.prototype;return n._next=function(){return clearInterval(this._timer),this._passStamp=+new Date-this._stamp,this._timer=setTimeout(this._doOnce,this._option.interval),this},n._doOnce=function(){if(this._passStamp>=this._option.timeout)return this._option.onMessage&&this._option.onMessage(0),this.done(),this;this._option.handler(this._next,this.done)},n.start=function(){var e,n=this;this._stamp=+new Date,this.done(),this._doOnce();return this._option.onMessage&&(clearInterval(this._timer_info),this._timer_info=setInterval(function(){e=+new Date-n._stamp,0===(e=Math.max(n._option.timeout-e,0))&&n.done(),n._option.onMessage(e)},100)),this},n.done=function(){return clearTimeout(this._timer),clearTimeout(this._timer_info),this},n.dispose=function(){return this.done(),this},e}();function dataPage(e,n,r){if(r<1)throw"页码必须大于0";var t=(r-1)*n,a=t+n;return{current:r,total:e.length,size:n,pages:Math.ceil(e.length/n),data:cloneEasy(e.slice(t,a))}}function basicCheck(e,n,r,t){if(e="【"+e+"】",r&&isEmpty(n))throw"字段"+e+"不能为空";if(getType(n)!==t)switch(t){case"String":n=String(n);break;case"Number":if(!isLikeNumber(n))throw"字段"+e+"必须为数字";n=Number(n)}return n}var fieldCheck={number:function(e,n){return basicCheck(e,n,!(2<arguments.length&&arguments[2]!==undefined)||arguments[2],"Number")},string:function(e,n){return basicCheck(e,n,2<arguments.length&&arguments[2]!==undefined&&arguments[2],"String")}};function uniq(e){return Array.from(new Set(e))}var defaultSortFun=function(e,n){return Number(e)-Number(n)},_names_count=0,_namesMap={};function getIdMap(e){return _namesMap[e]||(_namesMap[e]={id:++_names_count,label:e}),_namesMap[e]}function createUniqIds(e,n){var r=[],t=[];return e.forEach(function(e){e=getIdMap(n[e]);r.push(e.id),t.push(e.label)}),{id:r.join("_"),label:t.join("→")}}function arrayRowToColumn(e,a){var n,r=[],i=(e.forEach(function(e){e=String(e[a.colField]);r.includes(e)||r.push(e)}),r.sort(null!=(t=a.colSort)?t:defaultSortFun),{}),f=(e.forEach(function(n){var e=createUniqIds(a.uniqueRowId,n),r={},t=(a.uniqueRowId.forEach(function(e){r[e]=n[e]}),i[e.id]=i[e.id]||{value:r,name:e.label,data:{}},a.colCreate(n[a.colField]).field);i[e.id].data[t]=i[e.id].data[t]||[],i[e.id].data[t].push(n)}),[]);for(n in i)f.push({name:i[n].name,value:i[n].value,data:i[n].data,summary:{}});var t=r.map(function(e){var n=a.colCreate(e);return{value:e,label:n.label,field:n.field}}),d={};return a.summaryConfig&&(a.summaryConfig.row&&(f=mergeRowSummary(f,a.summaryConfig.row,a.summaryConfig.averageField)),a.summaryConfig.column&&(d=mergeColSummary(f,a.summaryConfig.column,a.summaryConfig.averageField))),{columns:t,data:f,colSummary:d,getExtRow:function(n,e,r){var t,a=f.find(function(e){return e.name===n}),i={};if(!a){var o=e,u=r,c=d[n],l={};if(c)for(var s in c)l[s]=u(c[s][o]);return l}for(t in a.summary)i[t]=r(a.summary[t][e]);return i}}}function getRatio$1(e,n){return e===$undefinedValue||n===$undefinedValue?$undefinedValue:(n-e)/e}function mergeRowSummary(a,i,n){return a.forEach(function(c){var l=i[c.name];if(l){var s,e,f=0,d=0;for(e in c.data)!function(e){d++;var n,r=[],t=0,a=[],i=[],o=(c.data[e].forEach(function(e){r.push(e[l.count.field]);var n=_Number(e[l.value.field]);switch(l.value.mode){case"uniqLength":a.push(e[l.value.field]),a=uniq(a),t=a.length;break;case"sum":case"avg":t+=n}0!==n&&i.push(n)}),0);switch(l.count.mode){case"length":o=r.length;break;case"uniqLength":o=uniq(r).length;break;case"notZeroValue":o=i.length}var u=t;"avg"===l.value.mode&&(u=t/o),f+=u,c.summary[e]={value:u,proportion:0,riseRatio:s?getRatio$1(null==(n=c.summary[s])?void 0:n.value,u):void 0},s=e}(e);c.summary[n]={value:f/d,riseRatio:$undefinedValue,proportion:0}}}),a.forEach(function(e){var n=i[e.name];if(n){var r=a.find(function(e){return e.name===n.proportionBaseField});if(n.proportionBaseField&&r)for(var t in e.summary)e.summary[t].proportion=e.summary[t].value/r.summary[t].value}}),a}function mergeColSummary(l,s,f){var e,d={},m={},n=function(a){m[a]={},d[a]={};var e,i=s[a],n=(l.forEach(function(t){for(var e in t.data)!function(e){d[a][e]=d[a][e]||{data:[],sum:0};var n=[],r=0;switch(t.data[e].forEach(function(e){switch(n.push(e[i.field]),i.mode){case"uniqLength":n=uniq(n);break;case"avg":case"sum":r+=e[i.field];break;case"notZeroLength":0!==_Number(e[i.field])&&r++}}),i.mode){case"uniqLength":n=uniq(n);break;case"avg":r/=t.data[e].length}d[a][e].data=d[a][e].data.concat(n),d[a][e].sum+=r}(e)}),void 0);for(e in d[a]){var r,t=0;switch(i.mode){case"avg":t=d[a][e].sum/l.length;break;case"uniqLength":t=uniq(d[a][e].data).length;break;case"notZeroLength":case"sum":t=d[a][e].sum}m[a][e]={value:t,proportion:0,riseRatio:n?getRatio$1(null==(r=m[a][n])?void 0:r.value,t):void 0},n=e}var o,u=0,c=0;for(o in m[a])u+=m[a][o].value,c++;m[a][f]={value:u/c,riseRatio:$undefinedValue,proportion:0}};for(e in s)n(e);return m}function sameRowCellCount(e,n,r,t){var a=1;for(e++;e<t.length;e++){var i=t[e][n];if(i!==r&&!isEmpty(i))break;a++}return a}function findPrevRowSpanNum(e,n,r){for(var t=0;0<=n&&!(0<(t=e[n].$rowSpan[r]));n--);return t}function sameColSellCount(e,n,r,t){var a=1;for(e++;e<t.length;e++){var i=trim(r[t[e]]);if(i!==n&&!isEmpty(i))break;a++}return a}function spanTable(e,u){var c=cloneEasy(e),l={};return u.forEach(function(e,n){var a,i,o;a=e,i=u[n-1],o=0,c.forEach(function(e,n){e.$rowSpan=null!=(t=e.$rowSpan)?t:{};var r,t=e[a];l[a]=null!=(r=l[a])?r:0,1<l[a]?(e.$rowSpan[a]=0,l[a]--):(r=sameRowCellCount(n,a,t,c),void 0!==i&&(t=findPrevRowSpanNum(c,n,i),0<o?t<=o+r?(r=t-o,o=0):o+=r:r<t?o=r:r=t),l[a]=r,e.$rowSpan[a]=l[a])})}),c.forEach(function(t){t.$colSpan={},t.$colField={};var a=0;u.forEach(function(e,n){var r=t[e];1<a?(t.$colSpan[n]=0,t.$colField[e]=0,a--):(a=sameColSellCount(n,r,t,u),t.$colSpan[n]=a,t.$colField[e]=a)})}),c}function thousands(e,a,i){return a=a||3,i=i||",",(isString(e)?e:_String(e)).replace(/([^.]*)?(\.)?(.*)?/,function(e,n,r,t){return _String(n).replace(new RegExp("(.(?=(.{"+a+"})+$))","g"),"$1"+i)+_String(r)+_String(t)})}function mapKvPair(e,n){var r,t={};for(r in e)t[r]=n(cloneEasy(e[r]),r);return t}function isFuzzyMatch(e,n,r){var t=!0;return(e=trim(e,"*"))&&(e=split(e,"").join(".*"),t=new RegExp(e,_String(r)).test(n)),t}function mixInZeroWidthUnicode(e){return split(e,"").join($zeroWidthCode)}function forEachKvPair(e,n){var r,t={},a=-1;for(r in e)a++,t[r]=n(e[r],r,a);return t}function getSortList(e){return e.map(function(e,n){return{value:e,index:n}})}function getSortIndex(e,r){var n=getSortList(e),t=getSortList(e);return t.sort(function(e,n){return r(e.value,n.value)}),n.map(function(n){return t.findIndex(function(e){return n.index===e.index})})}function sortWithIndex(e,n){for(var r=[],t=0;t<e.length;t++)r[t]=e[n[t]];return r}function getRatio(e,n){return 0===e||isNull(e)?0:0===n||isNull(n)?1:e/n}function difference(e,r,t){var a=[];return e.forEach(function(n){r.some(function(e){return t(e,n)})||a.push(n)}),r.forEach(function(n){e.some(function(e){return t(e,n)})||a.some(function(e){return t(e,n)})||a.push(n)}),a}function hpObjectKeys(e){return Object.keys(e)}var AVG_FIELD="sys-row-avg";function getUniqId(e,n){var r=[];return isArray(e)?e.forEach(function(e){r.push(n[e])}):r.push(n[e]),r.join("→")}function _rowToColumn(e,n){var u={},r=n.colField;if(!isNull(r)&&e.length){var a=n.cellSummary;if(e.forEach(function(e){var n=e[r];u[n]=u[n]||{data:[],summary:0,_collect:[]},u[n].data.push(e),a&&(e=e[a.numerator[0]],u[n].summary+=e,u[n]._collect.push(e))}),!isNull(a)){var t,i,o;for(t in u)!function(e){var n=u[e],r=1,t=a.denominator;if(t)switch(t[1]){case"length":r=n.data.map(function(e){return e[t[0]]}).length;break;case"uniqLength":r=uniq(n.data.map(function(e){return e[t[0]]})).length}switch(a.numerator[1]){case"sum":isNull(n.summary)||(n.summary=n.summary/r);break;case"length":n.summary=n._collect.length/r;break;case"uniqLength":n.summary=uniq(n._collect).length/r}}(t);o=i=0,forEachKvPair(u,function(e){i++;e=isNull(e.summary)?0:e.summary;o+=e}),u[AVG_FIELD]={data:[],summary:o/i,_collect:[]},n.colCustom&&forEachKvPair(n.colCustom,function(e,n){var r=c(e.numerator),e=e.denominator?c(e.denominator):1;u[n]={data:[],summary:getRatio(r,e),_collect:[]}})}}return u;function c(i){var o=0,e=hpObjectKeys(u).filter(function(e){var n=[AVG_FIELD].includes(e),e="*"===i[1]||i[1].includes(e);return!n&&e});return isArray(i[1])&&e.sort(function(e,n){return i[1].indexOf(e)-i[1].indexOf(n)}),e.forEach(function(e,n){var r,t,e=u[e],a=0;isNull(i[2])||"value"===i[2]?a=isNull(e.summary)?0:e.summary:"length"===i[2]?(r=i[3])&&(a=e.data.map(function(e){return e[r]}).length):"uniqLength"===i[2]&&(t=i[3])&&(a=uniq(e.data.map(function(e){return e[t]})).length),"sum"===i[0]?o+=a:"max"===i[0]?o=Math.max(o,a):"diff"===i[0]&&(0===n?o=a:o-=a)}),o}}function _groupToList(e,n,r,t){var a,i=[];for(a in e){var o=n===r,u=_groupToList(e[a].child,n,r+1,t);i.push({uidPath:e[a].uidPath,uid:e[a].uid,data:e[a].data,_columnRiseRatio:{},_columnTotal:{},_columnProportion:{},_columns:_rowToColumn(e[a].data,t),isLeaf:o,children:u})}return i}function deepGroup(e,u){var n={},c=0;!function s(e,n,r){for(var t=0;t<n.length;t++){var a=n[t],i=getUniqId(u.path[c].field,a);e[i]=e[i]||{uidPath:r.concat(i),uid:i,data:[],child:{}},e[i].data.push(a)}if(c<u.path.length-1)for(var o in c++,e)s(e[o].child,e[o].data,e[o].uidPath)}(n,e,[]);var e=_groupToList(n,c,0,u),t=(!function a(e,n){var r;e.sort(null==(r=u.path[n])?void 0:r.sort),e.forEach(function(e){a(e.children,n+1)})}(e,0),!function i(e){e.forEach(function(e){var r={};forEachKvPair(e._columns,function(e,n){e=isNull(e.summary)?0:e.summary;r[n]=r[n]||0,r[n]+=e}),e._columnTotal=r,i(e.children)})}(e),{}),l=(e.forEach(function(r){forEachKvPair(r._columns,function(e,n){t[n]=t[n]||0,t[n]+=r._columnTotal[n]})}),[]);return u.colCustom&&forEachKvPair(u.colCustom,function(e,n){e.riseRatio||l.push(n)}),function r(e){var i={},o={};e.forEach(function(e,a){forEachKvPair(e._columns,function(e,n){var r,t;l.includes(n)||(0<a?isNull(r=e.summary)?o[n]=$undefinedValue:(t=null!=(t=i[n])?t:0,o[n]=getRatio(r-t,t)):o[n]=void 0,i[n]=e.summary)}),e._columnRiseRatio=o,r(e.children)})}(e),function o(e,t){e.forEach(function(e,n){var r={};forEachKvPair(e._columns,function(e,n){r[n]=getRatio(e.summary,t[n])}),e._columnProportion=r,o(e.children,e._columnTotal)})}(e,t),{data:e,total:t}}function listGroup(e,n){var s=deepGroup(e,n);function i(e,n,r,t,a){var i=deepFindItem(s.data,function(e){return 0===difference(e.uidPath,n,function(e,n){return e===n}).length}),o=defaultValue(a,"");if(i)try{switch(e){case"_columnRiseRatio":case"_columnTotal":case"_columnProportion":var u=i[e][r];return isNull(u)?o:t(u);default:var c=i[e][r].summary;return isNull(c)?o:t(c,i[e][r].data)}}catch(l){return o}return o}function o(e,n,r,t){return i("_columns",e,n,r,t)}function u(e,n,r,t){return i("_columnProportion",e,n,r,t)}return{data:s.data,getCellValue:o,getCellVerticalRiseRatio:function(e,n,r,t){return i("_columnRiseRatio",e,n,r,t)},getCellVerticalTotal:function(e,n,r,t){var a;return"*"===e?isNull(a=s.total[n])?defaultValue(t,""):r(a):i("_columnTotal",e,n,r,t)},getCellVerticalProportion:u,getRowCellValue:function(n,e,r,t){var a={};return e.forEach(function(e){a[e.id]=o(n,e.field,r,t)}),a},getRowVerticalProportion:function(n,e,r,t){var a={};return e.forEach(function(e){a[e.id]=u(n,e.field,r,t)}),a},getOriginGroupData:function(n,e){var r=deepFindItem(s.data,function(e){return 0===difference(e.uidPath,n,function(e,n){return e===n}).length});return r&&null!=(r=null==(e=r._columns[e])?void 0:e.data)?r:[]},getOriginAllData:function(){return e}}}function union(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var t=new Set(n);return Array.from(t)}function filterWithMove(e,n){for(var r=[],t=0;t<e.length;t++){var a=e[t];n(a,t,e)&&(r.push(a),e.splice(t--,1))}return r}var defaUnits=[[1e4,"万"],[1e8,"亿"]];function shortNumber(e,n,r){for(var t=isNull(r)?defaUnits:r,a=(t.sort(function(e,n){return n[0]-e[0]}),e),i="",o=0;o<t.length;o++){var u=t[o],c=e/u[0];if(1<=c){a=c,i=u[1];break}}return{value:a,fmtValue:n(a),unit:i}}export{Polling,_Array,_Boolean,_KvPair,_Number,_String,arrayRowToColumn,changeIndex,cloneEasy,dataPage,deepFindItem,deepFindTreePath,defaultValue,defineEventBus,fieldCheck,filterWithMove,flatTree,floorFixed,forEach,forEachKvPair,forEachTree,getRandom,getRatio,getSortIndex,getType,isArray,isEmpty,isFunction,isFuzzyMatch,isKvPair,isLikeNumber,isNull,isString,listGroup,mapKvPair,main as mapTree,mixInZeroWidthUnicode,padEnd,padStart,param,parseQuery,randomColor,repeatString,roundFixed,shake,shortNumber,sortWithIndex,spanTable,split,thousands,flatArrayToTree as tree,trim,union,urlToGet,uuid,variableHasValue};
