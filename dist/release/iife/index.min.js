/**  
 * 个人工具库 (TS版) bestime.iife.min.js
 * @QQ 1174295440
 * @author Bestime
 * @see https://github.com/bestime/tool
 * @update 2023-03-28 14:45:43
 */
var bestime=function(e){"use strict";function a(e){return null===e||e===undefined}function o(e){return a(e)?"":String(e)}var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],u="Array",c="Object",l="String",H="Number",s=undefined,j="0",P="false",U="true",f=window,$=Object.prototype.toString,W=encodeURIComponent,i=decodeURIComponent,J=document.getElementsByTagName("head")[0];function d(e){return $.call(e).slice(8,-1)}function h(e){return d(e)===u}function p(e){return d(e)===c}function n(e,t){var n;try{n=JSON.parse(e)}catch(r){n=t}return n}function g(e){return e=p(e)||p(e=n(e))?e:{}}function K(e){return"function"==typeof e}function L(e){var n=[];function i(e,t){null!=e&&""!==e&&(t=null==(t=K(t)?t():t)?"":t,n[n.length]=W(e)+"="+W(t))}return function o(e,t){var n,r;if(e)switch(d(t)){case u:for(n=0;n<t.length;n++)o(e+"["+("object"==typeof t[n]&&t[n]?n:"")+"]",t[n]);break;case c:for(r in t)o(e+"["+r+"]",t[r]);break;default:i(e,t)}else switch(d(t)){case l:case c:for(r in t)o(r,t[r]);break;case u:for(n=0;n<t.length;n++)i(t[n].name,t[n].value)}}("",e),n.join("&")}var v="[\\s\\uFEFF\\xA0]+";function m(e,t){var n=d(e),r=(n===H&&(e=String(e),n=l),"");if(n!==l)return"";switch(t){case 1:r="^"+v;break;case-1:r=v+"$";break;case"*":r=v;break;default:r="^"+v+"|"+v+"$"}return e.replace(new RegExp(r,"g"),"")}function b(e){return d(e)===l}function y(e){var t,n=!0;for(t in e)if(t!==undefined){n=!1;break}return n}function z(e,t,n,r){b(e)?t&&""==m(e,"*")||r(e):null!=e&&(n&&p(e)&&y(e),r(e))}function w(e){switch(d(e)){case u:for(var t=[],n=0;n<e.length;n++)t.push(w(e[n]));break;case c:for(var r in t={},e)t[r]=w(e[r]);break;case"Function":function i(){e.apply(this,arguments)}for(var o in e.prototype)i.prototype[o]=e.prototype[o];t=i;break;default:t=e}return t}function G(e,t){if(p(e))for(var n in e){var r=e[n];(h(r)||p(r))&&G(r,t),i=t,o=!1,(o=!!(h(r=r)&&i.array&&0===r.length||p(r)&&i.kvPair&&y(r)||b(r)&&i.string&&""===r||a(r))||o)&&delete e[n]}var i,o}function _(e){return e=h(e)||h(e=n(e))?e:[]}function k(e,t,n){var r;n=null==n?60:n,e()?t():(clearTimeout(r),setTimeout(function(){k(e,t,n)},n))}var r={};var V={id:"id",children:"children"};function Q(e,t,n){t=r=b(r=t)?r:JSON.stringify(r);var r=e+"="+encodeURI(t)+";path=/;";"number"==typeof n&&((e=new Date).setTime(e.getTime()+n),r+="expires="+e.toUTCString()),document.cookie=r}function S(e){return null==e?undefined:P!==e&&(U===e||n(e,e))}function B(e){return(e=Number(e))===Math.abs(Infinity)||isNaN(e)?0:e}var Y=[s,s];function q(e){if(e==s)return Y;var r,i=e;return e.replace(/^\[(.*?)\](.*)?/,function(e,t,n){return i=t,r=n,""}),[i,r]}function X(e){return""===e||/^\d+$/.test(e)}function Z(e,t){return a(e)?t:e}function ee(e,t){var n=document.createElement("a");n.style.display="none",n.download=t,n.setAttribute("href",e),n.setAttribute("target","_blank"),n.setAttribute("download",t),document.body.appendChild(n),n.click(),n.remove()}var te=f.URL;function ne(e,t){var n="";if((e=o(e)).length*t<1<<28)for(;1==(1&t)&&(n+=e),0!=(t>>>=1);)e+=e;return n}function re(e,t,n,r){return(e=o(e)).length>(t>>=0)?e:(t-=e.length,n.length<t&&(n+=ne(n,t/n.length)),-1===r?n.slice(0,t)+e:e+n.slice(0,t))}function ie(e,t,n){return re(e,t,n,-1)}function x(e,t,n){return re(e,t,n,1)}function F(e,t){return""!==e?e.split(t):[]}function T(e,t,n){var e=F(e=m(B(e)),"."),r=e[1]||"";return r.length<t&&(r=x(r,t,j),n&&(r=r.replace(/0+$/,""))),t<1||!r?e[0]:e[0]+"."+r.substring(0,t)}function oe(e,n,r){var i,o;return r=a(r)?"children":r,function u(e){if(e)for(var t=0;t<e.length;t++){if(o=n(e[t])){i=e[t];break}if(u(e[t][r]),o)break}}(e),i}function E(e,t,n){var r=e[t];return e[t]===undefined||null===e[t]?"":ie(n,2,"0")+r}var M=8388608,ue=1024*M;function I(e,t,n){n=!1===n?0:1;return e=Math.random()*(t-e+n)+e,n?Math.floor(e):e}function O(){return t[I(0,t.length-1)][0]}var R={};function ae(n,r){for(var i=[],o=0,e=0;e<n.length;e++)!function(t){ce(n[t],function(e){i[t]=e,++o===n.length&&r.apply(s,i)})}(e)}function ce(e,t){var n=e.dependencies&&e.dependencies.length,r=e["with"]&&e["with"].length,i=(R[e.url]||(R[e.url]={count:0,dependencies:!n,"with":!r,complete:!1,create:!1,url:e.url}),R[e.url]);function o(){i.complete&&i.dependencies&&i["with"]&&(e.module?t(f[e.module]):t())}if(i.count++,!i.dependencies&&n)i.dependencies=!0,ae(e.dependencies,function(){ce(e,t)});else if(!i["with"]&&r)i["with"]=!0,ae(e["with"].concat(e),o);else if(i.create)k(function(){return i.complete},o,300);else{i.create=!0;var u,n=e.type,r=e.url,a=function(){i.complete=!0,o()},c=e.attribute;if("js"===n?(u=document.createElement("script")).src=r:((u=document.createElement("link")).setAttribute("rel","stylesheet"),u.href=r),c)for(var l in c)u.setAttribute(l,c[l]);u.onload=u.onerror=a,J.appendChild(u)}}var le,C,se=0,fe=!(k["async"]=function(t,n){return new Promise(function(e){k(t,e,n)})}),N={};var de={add:function(e,t){return le="HI-"+ ++se,N[le]={start:+new Date,current:0,handler:e,interval:t},fe||(clearInterval(C),fe=!0,C=setInterval(function(){for(var e in N){var t=N[e];t.current=+new Date,t.current-t.start>=t.interval&&(t.start=t.current,N[e].handler())}},17)),le},remove:function(e){delete N[e],y(N)&&(fe=!1,clearInterval(C),C=undefined)}},D={};function he(e,t){}return e.Polling=function(){function e(e){this._timer=void 0,this._timer_info=void 0,this._stamp=0,this._passStamp=0,this._option=void 0,this._option=Object.assign({timeout:6e3,interval:1e3,handler:he},e),this._next=this._next.bind(this),this._doOnce=this._doOnce.bind(this),this.done=this.done.bind(this)}var t=e.prototype;return t._next=function(){return clearInterval(this._timer),this._passStamp=+new Date-this._stamp,this._timer=setTimeout(this._doOnce,this._option.interval),this},t._doOnce=function(){if(this._passStamp>=this._option.timeout)return this._option.onMessage&&this._option.onMessage(0),this.done(),this;this._option.handler(this._next,this.done)},t.start=function(){var e,t=this;this._stamp=+new Date,this.done(),this._doOnce();return this._option.onMessage&&(clearInterval(this._timer_info),this._timer_info=setInterval(function(){e=+new Date-t._stamp,0===(e=Math.max(t._option.timeout-e,0))&&t.done(),t._option.onMessage(e)},100)),this},t.done=function(){return clearTimeout(this._timer),clearTimeout(this._timer_info),this},t.dispose=function(){return this.done(),this},e}(),e._Array=_,e._Boolean=function(e){return!0===e||"true"===e||"1"===e||1===e},e._KvPair=g,e._Number=B,e._String=o,e.changeIndex=function(e,t,n){return e<0?t:((t=(t+n)%(e+=1))<0&&(t+=e),-0===t?0:t)},e.clean=function A(e,t,n){if(n=!1!==n,p(e)){var r,i,o={};for(i in e)z(h(r=e[i])||p(r)?A(r,t):r,t,n,function(e){o[i]=e})}else if(h(e)){o=[];for(var u=0,a=e.length;u<a;u++)z(A(e[u],t),t,n,function(e){o.push(e)})}else o=e;return o},e.cloneEasy=w,e.dataCacheUtil=function(e){r[e]=r[e]||{count:0,complete:!1,data:null};var t=r[e];return t.count++,{isExist:function(){return 1<t.count},set:function(e){t.complete=!0,t.data=JSON.stringify(e)},get:function(e){k(function(){return t.complete},function(){e(n(t.data))},100)},logs:r}},e.dataPage=function(e,t,n){if(n<1)throw"页码必须大于0";var r=(n-1)*t,i=r+t;return{current:n,total:e.length,size:t,pages:Math.ceil(e.length/t),data:w(e.slice(r,i))}},e.deepFindItem=oe,e.deepFindTreePath=function(e,t,n){n=Object.assign(V,n);for(var r=[],i=w(e),o=new Set,u=n["children"];i.length;){var a=i[0];if(o.has(a))r.pop(),i.shift();else if(o.add(a),a[u]&&i.unshift.apply(i,a[u]),r.push(a),t(a))return r}return null},e.defaultValue=Z,e.defineEventBus=function(i){if(D[i])throw'"'+i+'" Has already been registered!';return D[i]=D[i]||[],{on:function(e){D[i].push(e)},emit:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<D[i].length;r++)D[i][r].apply(s,t)},off:function(e){if(!e)throw"the hander of off is required!";for(var t=0;t<D[i].length;t++)D[i][t]===e&&D[i].splice(t--,1)},dispose:function(){for(var e=0;e<D[i].length;e++)D[i].splice(e--,1);delete D[i]}}},e.downloadFileByArrayBuffer=function(e,t){ee(e=te.createObjectURL(new Blob([e])),t),te.revokeObjectURL(e),undefined},e.downloadFileByUrl=ee,e.fileSize=function(e,t){var n=e;switch(t=t||"Bytes"){case"MB":n=e*M;break;case"KB":n=8192*e;break;case"Bytes":n=8*e}var t=n/8796093022208,r=n/ue,i=n/M,o=n/8192,u=(console.log("_kb",o),n/8),t=T(t.toFixed(8),2),r=T(r.toFixed(8),2),i=T(i.toFixed(8),2),o=T(o.toFixed(8),2);return{Bit:n,Bytes:u=T(u.toFixed(8),2),KB:o,MB:i,GB:r,TB:t,format:.1<+t?t+" TB":.1<+r?r+" GB":.1<+i?i+" MB":o+" KB"}},e.flatTree=function(e,r){var i=[];return r=Z(r,"children"),function o(e){if(h(e))for(var t,n=0;n<e.length;n++)t=e[n],i.push(t),o(t[r])}(e),i},e.floorFixed=T,e.forEachTree=function(e,n,r){r=r||"children",function i(e){for(var t=0;t<e.length;t++)n(e[t]),h(e[t][r])&&i(e[t][r])}(e)},e.getCookie=function(e,t){t=t||document.cookie;var r="";return t.replace(new RegExp("(^|;\\s)"+e+"=(.*?)($|(;\\s))"),function(e,t,n){r=S(i(n))}),r},e.getJsFileBaseUrl=function(e){e=e||0;for(var t="/[^/]*",n=document.scripts,r=0;r<e;r++)t+=t;return n[n.length-1].src.replace(new RegExp(t+"$"),"")},e.getRandom=I,e.getRelativePos=function(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top,height:e.offsetHeight,width:e.offsetWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight}},e.getStorage=function(e){return(e=localStorage.getItem(e))?S(e):""},e.getType=d,e.getWindowSize=function(){return{width:document.documentElement.clientWidth||document.body.clientWidth||window.innerWidth||0,height:document.documentElement.clientHeight||document.body.clientHeight||window.innerHeight||0}},e.isArray=h,e.isFunction=K,e.isKvPair=p,e.isNull=a,e.libraryFile=function(e,t){console.log("加载器",e,R),(e instanceof Array?ae:ce)(e,t)},e.mapTree=function(e,r,i,o){o=o||"children";var t=[];return function u(e,t){for(var n=0;n<e.length;n++)t[n]=w(i(e[n])),e[n][o]&&(t[n][r]=[],u(e[n][o],t[n][r]))}(e,t),t},e.observeDomResize=function(n,r,i,e){var o=[0,0,!1],u=[0,0,!1],a=[0,0,!1],c=[0,0,!1],t=de.add(l,e=e||500);function l(){var e,t;document.body.contains(n)?(e=!1,null!=i&&i.includes("position")&&(t=n.getBoundingClientRect(),a[0]=t.left,a[2]=a[0]!==a[1],c[0]=t.top,c[2]=c[0]!==c[1]),o[0]=n.offsetWidth,o[2]=o[0]!==o[1],u[0]=n.offsetHeight,u[2]=u[0]!==u[1],o[2]&&(o[1]=o[0],null!=i&&i.includes("width")&&(e=!0)),u[2]&&(u[1]=u[0],null!=i&&i.includes("height")&&(e=!0)),(c[2]||a[2])&&(c[1]=c[0],a[1]=a[0],null!=i&&i.includes("position")&&(e=!0)),i&&0!==i.length||(o[2]||u[2]||c[2]||a[2])&&(e=!0),e&&r(n)):s()}function s(){de.remove(t),o=undefined,u=undefined}return l(),s},e.padEnd=x,e.padStart=ie,e.param=L,e.parseQuery=function(e){var u,n,a={};return(e=e||f.location.href).replace(/([^=&?/#]*?)=([^=&?/#]*)/g,function(e,t,o){o=S(i(o)),n=i(t),u=!1,""!==n&&(n.replace(/(.*?)(\[.*)/,function(e,t,n){var r=q(n);u=!0,X(r[0])?a[t]=_(a[t]):a[t]=g(a[t]),function i(e,t,n){var t=q(t),r=t[0];X(r)?(r=B(r),t[1]==s?e.push(n):(/^\[[\D]+\]/.test(t[1])?e[r]=g(e[r]):e[r]=_(e[r]),i(e[r],t[1],n))):t[1]==s?e[r]=n:(/^\[[\D]+\]/.test(t[1])?e[r]=g(e[r]):e[r]=_(e[r]),i(e[r],t[1],n))}(a[t],n,o)}),u||(a[n]=o))}),a},e.prevent=function(e,t,n){e=e||f.event,n=!1!==n,(t=!1!==t)&&f.event?f.event.cancelBubble=!0:e.stopPropagation(),n&&f.event?f.event.returnValue=!1:e.preventDefault()},e.randomColor=function(){return"rgba("+I(0,255,!0)+","+I(0,255,!0)+","+I(0,255,!0)+",1)"},e.removeCookie=function(e){Q(e,"",-1)},e.removeElement=function(e){e.parentNode&&e.parentNode.removeChild(e)},e.removeStorage=function(e){localStorage.removeItem(e)},e.repeatString=ne,e.roundFixed=function(e,t,n){e=B(e);var r,i=Math.pow(10,t),e=o(Math.round(e*i)/i);return 0<t&&(r=(i=F(e,"."))[0],(i=i[1]||"").length<t&&(i=x(i,t,j),e=(i=n?i.replace(/0+$/,""):i)?r+"."+i:r)),e},e.serverConfig=function(e){var t,n,o={};for(n in e)t=e[n],o[n]={to:t,reg:new RegExp("^("+n+")(/|$)")};return function(e){var t,n=!1,r=e;for(t in o){var i=o[t];if(i.reg.test(e)){n=!0,"string"==typeof i.to&&(r=e.replace(i.reg,i.to+"$2"));break}}return n||(console.error('警告：请求地址 "'+e+'" 不在白名单中！'),console.table(o)),r}},e.setCookie=Q,e.setStorage=function(e,t){localStorage.setItem(e,e=b(e=t)?e:JSON.stringify(e))},e.shake=function(e,t){return t=Object.assign({string:!0,array:!0,kvPair:!0},t),G(e=w(e),t),e},e.split=F,e.timeLine=function(e,t){t=t||["年","月","日 ","时","分","秒","毫秒"];for(var n,r=[],i=0;i<e.length;i++){var o,u=[E(t,0,(o=new Date(e[i])).getFullYear()),E(t,1,o.getMonth()+1),E(t,2,o.getDate()),E(t,3,o.getHours()),E(t,4,o.getMinutes()),E(t,5,o.getSeconds()),E(t,6,o.getMilliseconds())];r.push({value:e[i],timestamp:+o,split:[u,w(u)]})}for(r.sort(function(e,t){return e.millisecond-t.millisecond}),i=1;i<r.length;i++){f=s=l=c=a=void 0;for(var a=r[i-1],c=r[i],l=a.split[0],s=c.split[1],f=0;f<l.length&&l[f]===s[f];f++)s[f]=""}for(i=0;i<r.length;i++)(n=r[i]).split=n.split[1],n.label=m(n.split.join(""));return r},e.tree=function(e,t){for(var n=(t=g(t)).id||"id",r=t.pid||"pid",i=t.children||"children",o=0;o<e.length;o++){var u,a=e[o];(u=oe(e,function(e){return null!=e[n]&&e[n]!=a[n]&&e[n]===a[r]},i))&&(u[i]=_(u[i]),u[i].push(a),e.splice(o--,1))}return e},e.trim=m,e.urlToGet=function(e,t){e=o(e).replace(/&*$/g,"").replace(/\?*$/,"");var n="";return(n=p(t)||h(t)?L(t):o(t).replace(/^&*/,""))&&(e+=(/\?/.test(e)?"&":"?")+n),e},e.uuid=function(e){e=B(e);for(var t="",n=0;n<13;n++)t+=I(1,9);return e=(new Date).getTime()*I(1,100),x(O()+Number(t).toString(32)+e.toString(32),20,O()+O()+O())},e.variableHasValue=k,e}({});
