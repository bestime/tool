/**
 * 纯JS工具库 => jUtilsBase
 * @update 2024-08-07 17:46:54
 */
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).jUtilsBase={})}(this,function(n){"use strict";var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a="Array",j="Function",u="Object",c="String",N="Number",v=void 0,q="false",D="true",V=Object.prototype.toString,B=encodeURI,G=decodeURIComponent;function E(n){return null===n||n===v}function f(n){return E(n)?"":String(n)}function l(n){return V.call(n).slice(8,-1)}function S(n){return l(n)===a}function s(n){return l(n)===u}function e(n){return l(n)===c}function i(n,t){var r;try{r=JSON.parse(n)}catch(e){r=t}return r}function h(n){return n=s(n)||s(n=i(n))?n:{}}function d(n){return E(n)||""===n}function X(n){return"function"==typeof n}function H(n){var r=[];function i(n,t){null!=n&&""!==n&&(t=null==(t=X(t)?t():t)?"":t,r[r.length]=B(n)+"="+B(t))}return function o(n,t){var r,e;if(n)switch(l(t)){case a:for(r=0;r<t.length;r++)o(n+"["+("object"==typeof t[r]&&t[r]?r:"")+"]",t[r]);break;case u:for(e in t)o(n+"["+e+"]",t[e]);break;default:i(n,t)}else switch(l(t)){case c:case u:for(e in t)o(e,t[e]);break;case a:for(r=0;r<t.length;r++)i(t[r].name,t[r].value)}}("",n),r.join("&")}function m(n){return n=S(n)||S(n=i(n))?n:[]}function g(n){return l(n)===N}var o="[\\s\\uFEFF\\xA0]+";function p(n,t){var r=l(n),e=(r===N&&(n=String(n),r=c),"");if(r!==c)return"";switch(t){case 1:e="^"+o;break;case-1:e=o+"$";break;case"*":e=o;break;default:e="^"+o+"|"+o+"$"}return n.replace(new RegExp(e,"g"),"")}function y(n){var t=!1,r=0,r=g(n)?n:(e(n)&&(n=p(n,"*").replace(/,/g,"").replace(/%$/,function(n){return t=!0,""})),Number(n));return r=Math.abs(r)===Math.abs(Infinity)||isNaN(r)?0:r,t&&(r/=100),r}var K=[v,v];function U(n){if(n==v)return K;var e,i=n;return n.replace(/^\[(.*?)\](.*)?/,function(n,t,r){return i=t,e=r,""}),[i,e]}function W(n){return""===n||/^\d+$/.test(n)}function r(n){var a={},u=!1,e="";return(n=E(n)?"":n).replace(/([^=&?/#]*?)=([^=&?/#]*)/g,function(n,t,o){var r;r=G(o),o=null==r?v:q!==r&&(D===r||i(r,r)),e=G(t),u=!1,""!==e&&(e.replace(/(.*?)(\[.*)/,function(n,t,r){var e=U(r);u=!0,W(e[0])?a[t]=m(a[t]):a[t]=h(a[t]),function i(n,t,r){var t=U(t),e=t[0];W(e)?(e=y(e),t[1]==v?n.push(r):(/^\[[\D]+\]/.test(t[1])?n[e]=h(n[e]):n[e]=m(n[e]),i(n[e],t[1],r))):t[1]==v?n[e]=r:(/^\[[\D]+\]/.test(t[1])?n[e]=h(n[e]):n[e]=m(n[e]),i(n[e],t[1],r))}(a[t],r,o)}),u||(a[e]=o))}),a}function _(n){switch(l(n)){case a:for(var t=[],r=0;r<n.length;r++)t.push(_(n[r]));break;case u:for(var e in t={},n)t[e]=_(n[e]);break;case j:function i(){n.apply(this,arguments)}for(var o in n.prototype)i.prototype[o]=n.prototype[o];t=i;break;default:t=n}return t}function Z(n,t){var r=!1;return r=S(n)&&t.array&&0===n.length||s(n)&&t.kvPair&&function(n){var t,r=!0;for(t in n)if(t!==v){r=!1;break}return r}(n)||e(n)&&t.string&&""===n||E(n)?!0:r}function x(n,t,r){var e;r=null==r?60:r,n()?t():(clearTimeout(e),setTimeout(function(){x(n,t,r)},r))}x["async"]=function(t,r){return new Promise(function(n){x(t,n,r)})};var z={id:"id",children:"children"};function J(n){n=p(n);return/^(-|\+)?((\d+)|((\d,?)+\d+))(\.?\d+)?%?$/.test(n)}function b(n,t){return E(n)?t:n}function Q(n,t){var r="";if((n=f(n)).length*t<1<<28)for(;1==(1&t)&&(r+=n),0!=(t>>>=1);)n+=n;return r}function Y(n,t,r,e){return(n=f(n)).length>(t>>=0)?n:(t-=n.length,r.length<t&&(r+=Q(r,t/r.length)),-1===e?r.slice(0,t)+n:n+r.slice(0,t))}function nn(n,t,r){return Y(n,t,r,-1)}function k(n,t,r){return Y(n,t,r,1)}function C(n,t){return""!==n?n.split(t):[]}function w(n,r,t){var e,i,o=E(t)?"children":t;return function a(n){if(n)for(var t=0;t<n.length;t++){if(i=r(n[t])){e=n[t];break}if(a(n[t][o]),i)break}}(n),e}function T(n,t,r){r=!1===r?0:1;return n=Math.random()*(t-n+r)+n,r?Math.floor(n):n}function A(){return t[T(0,t.length-1)][0]}var R={};function P(n,t){for(var r=0;r<n.length;r++)t(n[r],r,n)}function tn(n,t){}var rn=function(){function n(n){this._timer=void 0,this._timer_info=void 0,this._stamp=0,this._passStamp=0,this._option=void 0,this._option=Object.assign({timeout:6e3,interval:1e3,handler:tn},n),this._next=this._next.bind(this),this._doOnce=this._doOnce.bind(this),this.done=this.done.bind(this)}var t=n.prototype;return t._next=function(){return clearInterval(this._timer),this._passStamp=+new Date-this._stamp,this._timer=setTimeout(this._doOnce,this._option.interval),this},t._doOnce=function(){if(this._passStamp>=this._option.timeout)return this._option.onMessage&&this._option.onMessage(0),this.done(),this;this._option.handler(this._next,this.done)},t.start=function(){var n,t=this;this._stamp=+new Date,this.done(),this._doOnce();return this._option.onMessage&&(clearInterval(this._timer_info),this._timer_info=setInterval(function(){n=+new Date-t._stamp,0===(n=Math.max(t._option.timeout-n,0))&&t.done(),t._option.onMessage(n)},100)),this},t.done=function(){return clearTimeout(this._timer),clearTimeout(this._timer_info),this},t.dispose=function(){return this.done(),this},n}();function en(n,t,r,e){if(n="【"+n+"】",r&&d(t))throw"字段"+n+"不能为空";if(l(t)!==e)switch(e){case"String":t=String(t);break;case"Number":if(!J(t))throw"字段"+n+"必须为数字";t=Number(t)}return t}var on={number:function(n,t){return en(n,t,!(2<arguments.length&&arguments[2]!==undefined)||arguments[2],"Number")},string:function(n,t){return en(n,t,2<arguments.length&&arguments[2]!==undefined&&arguments[2],"String")}};function F(n){return Array.from(new Set(n))}var an=function(n,t){return Number(n)-Number(t)},un=0,M={};function cn(n,t){var r=[],e=[];return n.forEach(function(n){n=t[n],M[n]||(M[n]={id:++un,label:n});n=M[n];r.push(n.id),e.push(n.label)}),{id:r.join("_"),label:e.join("→")}}function fn(n,t){return n===v||t===v?v:(t-n)/Math.abs(n)}function I(n,t){var r,e={},i=-1;for(r in n)i++,e[r]=t(n[r],r,i);return e}function ln(n){return n.map(function(n,t){return{value:n,index:t}})}function O(n,t){return 0===n||E(n)?0:0===t||E(t)?1:n/t}function sn(n,r,e){var i=[];return n.forEach(function(t){r.some(function(n){return e(n,t)})||i.push(t)}),r.forEach(function(t){n.some(function(n){return e(n,t)})||i.some(function(n){return e(n,t)})||i.push(t)}),i}var hn="sys-row-avg";function dn(n,t){var u={},r=t.colField;if(!E(r)&&n.length){var i=t.cellSummary;if(n.forEach(function(n){var t=n[r];u[t]=u[t]||{data:[],summary:0,_collect:[]},u[t].data.push(n),i&&(n=n[i.numerator[0]],u[t].summary+=n,u[t]._collect.push(n))}),!E(i)){var e,o,a;for(e in u)!function(n){var t=u[n],r=1,e=i.denominator;if(e)if(g(e))r=e;else switch(e[1]){case"length":r=t.data.map(function(n){return n[e[0]]}).length;break;case"uniqLength":r=F(t.data.map(function(n){return n[e[0]]})).length}switch(i.numerator[1]){case"sum":E(t.summary)||(t.summary=t.summary/r);break;case"length":t.summary=t._collect.length/r;break;case"uniqLength":t.summary=F(t._collect).length/r}}(e);a=o=0,I(u,function(n){o++;n=E(n.summary)?0:n.summary;a+=n}),u[hn]={data:[],summary:a/o,_collect:[]},t.colCustom&&I(t.colCustom,function(n,t){var r=c(n.numerator),n=n.denominator?c(n.denominator):1;u[t]={data:[],summary:O(r,n),_collect:[]}})}}return u;function c(o){var a=0,n=Object.keys(u).filter(function(n){var t=[hn].includes(n),n="*"===o[1]||o[1].includes(n);return!t&&n});return S(o[1])&&n.sort(function(n,t){return o[1].indexOf(n)-o[1].indexOf(t)}),n.forEach(function(n,t){var r,e,n=u[n],i=0;E(o[2])||"value"===o[2]?i=E(n.summary)?0:n.summary:"length"===o[2]?(r=o[3])&&(i=n.data.map(function(n){return n[r]}).length):"uniqLength"===o[2]&&(e=o[3])&&(i=F(n.data.map(function(n){return n[e]})).length),"sum"===o[0]?a+=i:"max"===o[0]?a=Math.max(a,i):"diff"===o[0]&&(0===t?a=i:a-=i)}),a}}function vn(n,u){var t={},c=0;!function l(n,t,r){for(var e=0;e<t.length;e++){var i=t[e],o=function(n,t){var r=[];return S(n)?n.forEach(function(n){r.push(t[n])}):r.push(t[n]),r.join("→")}(u.path[c].field,i);n[o]=n[o]||{uidPath:r.concat(o),uid:o,data:[],child:{}},n[o].data.push(i)}if(c<u.path.length-1)for(var a in c++,n)l(n[a].child,n[a].data,n[a].uidPath)}(t,n,[]);var n=function s(n,t,r,e){var i,o=[];for(i in n){var a=t===r,u=s(n[i].child,t,r+1,e);o.push({uidPath:n[i].uidPath,uid:n[i].uid,data:n[i].data,_columnRiseRatio:{},_columnTotal:{},_columnProportion:{},_columns:dn(n[i].data,e),isLeaf:a,children:u})}return o}(t,c,0,u),e=(!function i(n,t){var r;n.sort(null==(r=u.path[t])?void 0:r.sort),n.forEach(function(n){i(n.children,t+1)})}(n,0),!function o(n){n.forEach(function(n){var r={};I(n._columns,function(n,t){n=E(n.summary)?0:n.summary;r[t]=r[t]||0,r[t]+=n}),n._columnTotal=r,o(n.children)})}(n),{}),f=(n.forEach(function(r){I(r._columns,function(n,t){e[t]=e[t]||0,e[t]+=r._columnTotal[t]})}),[]);return u.colCustom&&I(u.colCustom,function(n,t){n.riseRatio||f.push(t)}),function r(n){var o={},a={};n.forEach(function(n,i){I(n._columns,function(n,t){var r,e;f.includes(t)||(0<i?E(r=n.summary)?a[t]=v:(e=null!=(e=o[t])?e:0,a[t]=O(r-e,e)):a[t]=void 0,o[t]=n.summary)}),n._columnRiseRatio=a,r(n.children)})}(n),function a(n,e){n.forEach(function(n,t){var r={};I(n._columns,function(n,t){r[t]=O(n.summary,e[t])}),n._columnProportion=r,a(n.children,n._columnTotal)})}(n,e),{data:n,total:e}}function L(n){return E(n)||0===n}var mn=[[1e4,"万"],[1e8,"亿"]];function $(n,t){return nn(n,t,"0")}function gn(n){var t=[];return function r(n,t){P(n,function(n){S(n.children)?r(n.children,t):t.push(n)})}(n,t),t}var pn={title:"title",field:"field"};var yn=new(function(){function n(){this._list={}}var t=n.prototype;return t._resetGroupClickXAxisCategory=function(i){i.forEach(function(t){clearTimeout(t.timer_01),t.instence.off("click",t.onAxxisSeriesClick),t.instence.off("click",t.onAxxisCategoryClick),t.onAxxisCategoryClick=function(n){var r=n.tickIndex,e=!1!==n.needEmit;clearTimeout(t.timer_01),t.timer_01=setTimeout(function(){i.forEach(function(n){var t=function(n,e){var i,t=_(n.getOption());if(t&&S(t.xAxis))return i=[],t.xAxis.forEach(function(n){n.data.forEach(function(n,t){var r;n.defaultTextStyle=null!=(r=n.defaultTextStyle)?r:n.textStyle,t===e?(i.push("rgba(255,255,255,0.2)"),n.textStyle=n.activeTextStyle):(i.push("transparent"),n.textStyle=n.defaultTextStyle)}),n.splitArea={show:!0,areaStyle:{color:i}}}),n.setOption({xAxis:t.xAxis}),t.xAxis}(n.instence,r);e&&t&&n.config&&n.config.onXAxisCtegoryClick&&n.config.onXAxisCtegoryClick(t.map(function(n){return n.data}),r,n.instence)})},30)},t.onAxxisSeriesClick=function(n){"markLine"!==n.componentType&&null!=t&&t.onAxxisCategoryClick&&t.onAxxisCategoryClick({tickIndex:n.dataIndex})},t.instence.on("click","series",t.onAxxisSeriesClick),t.instence.on("click","xAxis.category",t.onAxxisCategoryClick)})},t.clickXAsisCategory=function(n,t,r){var e,i=!0!==r;for(e in this._list)for(var o=0;o<this._list[e].length;o++){var a=this._list[e][o];a.instence===n&&a.onAxxisCategoryClick&&a.onAxxisCategoryClick({tickIndex:t,needEmit:i})}},t.add=function(n,t){var r=n.group;return r&&(this._list[r]=this._list[r]||[],this._list[r].push({config:t,instence:n,timer_01:-1}),this._resetGroupClickXAxisCategory(this._list[r])),this},t.remove=function(n){if(n)for(var t in this._list)for(var r=0;r<this._list[t].length;r++){var e=this._list[t][r];clearTimeout(e.timer_01),e.instence===n&&(e.instence.off("click",e.onAxxisCategoryClick),this._list[t].splice(r--,1))}},n}());n.Polling=rn,n._Array=m,n._Boolean=function(n){return!0===n||"true"===n||"1"===n||1===n},n._KvPair=h,n._Number=y,n._String=f,n.arrayRowToColumn=function(n,i){var t,r=[],o=(n.forEach(function(n){n=String(n[i.colField]);r.includes(n)||r.push(n)}),r.sort(null!=(c=i.colSort)?c:an),{}),s=(n.forEach(function(t){var n=cn(i.uniqueRowId,t),r={},e=(i.uniqueRowId.forEach(function(n){r[n]=t[n]}),o[n.id]=o[n.id]||{value:r,name:n.label,data:{}},i.colCreate(t[i.colField]).field);o[n.id].data[e]=o[n.id].data[e]||[],o[n.id].data[e].push(t)}),[]);for(t in o)s.push({name:o[t].name,value:o[t].value,data:o[t].data,summary:{}});var a,u,e,c=r.map(function(n){var t=i.colCreate(n);return{value:n,label:t.label,field:t.field}}),h={};return i.summaryConfig&&(i.summaryConfig.row&&(a=s,u=i.summaryConfig.row,e=i.summaryConfig.averageField,a.forEach(function(c){var f=u[c.name];if(f){var l,n,s=0,h=0;for(n in c.data)!function(n){h++;var t,r=[],e=0,i=[],o=[],a=(c.data[n].forEach(function(n){g(f.count)||r.push(n[f.count.field]);var t=y(n[f.value.field]);switch(f.value.mode){case"uniqLength":i.push(n[f.value.field]),i=F(i),e=i.length;break;case"sum":case"avg":e+=t}0!==t&&o.push(t)}),0);if(g(f.count))a=f.count;else switch(f.count.mode){case"length":a=r.length;break;case"uniqLength":a=F(r).length;break;case"notZeroValue":a=o.length}var u=e;"avg"===f.value.mode&&(u=e/a),s+=u,c.summary[n]={value:u,proportion:0,riseRatio:l?fn(null==(t=c.summary[l])?void 0:t.value,u):void 0},l=n}(n);c.summary[e]={value:s/h,riseRatio:v,proportion:0}}}),a.forEach(function(n){var t=u[n.name];if(t){var r=a.find(function(n){return n.name===t.proportionBaseField});if(t.proportionBaseField&&r)for(var e in n.summary)n.summary[e].proportion=n.summary[e].value/r.summary[e].value}}),s=a),i.summaryConfig.column&&(h=function(f,l,s){var n,h={},d={},t=function(i){d[i]={},h[i]={};var n,o=l[i],t=(f.forEach(function(e){for(var n in e.data)!function(n){h[i][n]=h[i][n]||{data:[],sum:0};var t=[],r=0;switch(e.data[n].forEach(function(n){switch(t.push(n[o.field]),o.mode){case"uniqLength":t=F(t);break;case"avg":case"sum":r+=n[o.field];break;case"notZeroLength":0!==y(n[o.field])&&r++}}),o.mode){case"uniqLength":t=F(t);break;case"avg":r/=e.data[n].length}h[i][n].data=h[i][n].data.concat(t),h[i][n].sum+=r}(n)}),void 0);for(n in h[i]){var r,e=0;switch(o.mode){case"avg":e=h[i][n].sum/f.length;break;case"uniqLength":e=F(h[i][n].data).length;break;case"notZeroLength":case"sum":e=h[i][n].sum}d[i][n]={value:e,proportion:0,riseRatio:t?fn(null==(r=d[i][t])?void 0:r.value,e):void 0},t=n}var a,u=0,c=0;for(a in d[i])u+=d[i][a].value,c++;d[i][s]={value:u/c,riseRatio:v,proportion:0}};for(n in l)t(n);return d}(s,i.summaryConfig.column,i.summaryConfig.averageField))),{columns:c,data:s,colSummary:h,getExtRow:function(t,n,r){var e,i=s.find(function(n){return n.name===t}),o={};if(!i){var a=n,u=r,c=h[t],f={};if(c)for(var l in c)f[l]=u(c[l][a]);return f}for(e in i.summary)o[e]=r(i.summary[e][n]);return o}}},n.changeIndex=function(n,t,r){return n<0?t:((t=(t+r)%(n+=1))<0&&(t+=n),-0===t?0:t)},n.cloneEasy=_,n.connectEcharts=yn,n.dataPage=function(n,t,r){if(r<1)throw"页码必须大于0";var e=(r-1)*t,i=e+t;return{current:r,total:n.length,size:t,pages:Math.ceil(n.length/t),data:_(n.slice(e,i))}},n.deepFindItem=w,n.deepFindTreePath=function(n,t,r){r=Object.assign(z,r);for(var e=[],i=_(n),o=new Set,a=r["children"];i.length;){var u=i[0];if(o.has(u))e.pop(),i.shift();else if(o.add(u),u[a]&&i.unshift.apply(i,u[a]),e.push(u),t(u))return e}return undefined},n.defaultValue=b,n.defineEventBus=function(i){if(R[i])throw'"'+i+'" Has already been registered!';return R[i]=R[i]||[],{on:function(n){R[i].push(n)},emit:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];for(var e=0;e<R[i].length;e++)R[i][e].apply(v,t)},off:function(n){if(!n)throw"the hander of off is required!";for(var t=0;t<R[i].length;t++)R[i][t]===n&&R[i].splice(t--,1)},dispose:function(){for(var n=0;n<R[i].length;n++)R[i].splice(n--,1);delete R[i]},eventList:function(){return R[i]}}},n.difference=sn,n.fieldCheck=on,n.filterWithMove=function(n,t){for(var r=[],e=0;e<n.length;e++){var i=n[e];t(i,e,n)&&(r.push(i),n.splice(e--,1))}return r},n.floorFixed=function(n,t,r){var e=(n=C(n=p(y(n)),"."))[1]||"";return e.length<t&&(e=k(e,t,"0"),r&&(e=e.replace(/0+$/,""))),t<1||!e?n[0]:n[0]+"."+e.substring(0,t)},n.forEach=P,n.forEachKvPair=I,n.forEachTree=function(n,i,o){o=o||"children",function a(n,t){for(var r=0;r<n.length;r++){var e=_(t);i(n[r],e),S(n[r][o])&&(e.push(n[r]),a(n[r][o],e))}}(n,[])},n.formatTime=function(n){var t=(n=new Date(n)).getFullYear(),r=n.getMonth()+1,e=n.getDate(),i=n.getHours(),o=n.getMinutes(),a=n.getSeconds(),n=n.getMilliseconds();return $(t,4)+"/"+$(r,2)+"/"+$(e,2)+" "+$(i,2)+":"+$(o,2)+":"+$(a,2)+":"+$(n,3)},n.getPiecesWithIndex=function(n,e){var i=[];return P(n,function(t,n){var r=e.find(function(n){return t>=n.min&&t<n.max});r&&i.push({gte:n,lt:n+1,color:r.color})}),i},n.getRandom=T,n.getRatio=O,n.getRiseRatio=function(n,t){return L(n)&&L(t)?0:L(n)?1:L(t)?-1:(t-n)/n},n.getSortIndex=function(n,r){var t=ln(n),e=ln(n);return e.sort(function(n,t){return r(n.value,t.value)}),t.map(function(t){return e.findIndex(function(n){return t.index===n.index})})},n.getType=l,n.isArray=S,n.isEmpty=d,n.isFunction=X,n.isFuzzyMatch=function(n,t,r){var e=!0;return(n=p(n,"*"))&&(n=C(n,"").join(".*"),e=new RegExp(n,f(r)).test(t)),e},n.isKvPair=s,n.isLikeNumber=J,n.isNull=E,n.isString=e,n.listGroup=function(n,t){var l=vn(n,t);function o(n,t,r,e,i){var o=w(l.data,function(n){return 0===sn(n.uidPath,t,function(n,t){return n===t}).length}),a=b(i,"");if(o)try{switch(n){case"_columnRiseRatio":case"_columnTotal":case"_columnProportion":var u=o[n][r];return E(u)?a:e(u);default:var c=o[n][r].summary;return E(c)?a:e(c,o[n][r].data)}}catch(f){return a}return a}function a(n,t,r,e){return o("_columns",n,t,r,e)}function u(n,t,r,e){return o("_columnProportion",n,t,r,e)}return{data:l.data,getCellValue:a,getCellVerticalRiseRatio:function(n,t,r,e){return o("_columnRiseRatio",n,t,r,e)},getCellVerticalTotal:function(n,t,r,e){var i;return"*"===n?E(i=l.total[t])?b(e,""):r(i):o("_columnTotal",n,t,r,e)},getCellVerticalProportion:u,getRowCellValue:function(t,n,r,e){var i={};return n.forEach(function(n){i[n.id]=a(t,n.field,r,e)}),i},getRowVerticalProportion:function(t,n,r,e){var i={};return n.forEach(function(n){i[n.id]=u(t,n.field,r,e)}),i},getOriginGroupData:function(t,n){var r=w(l.data,function(n){return 0===sn(n.uidPath,t,function(n,t){return n===t}).length});return r&&null!=(r=null==(n=r._columns[n])?void 0:n.data)?r:[]},getOriginAllData:function(){return n}}},n.mapKvPair=function(n,t){var r,e={};for(r in n)e[r]=t(_(n[r]),r);return e},n.mapTree=function(n,i,o,a){a=a||"children";var t=[];return function u(n,t){for(var r=0;r<n.length;r++){var e=o(n[r]);E(e)||(t[r]=_(e),n[r][a]&&(t[r][i]=[],u(n[r][a],t[r][i])))}}(n,t),t},n.mixInZeroWidthUnicode=function(n){return C(n,"").join("‎")},n.padEnd=k,n.padStart=nn,n.param=H,n.parseQuery=r,n.parseTreeToTableHeader=function(n,t){var w=E(t)?pn:t,r=_(n),e=function a(n,t){for(var r=(t=E(t)?1:t)+1,e=0;e<n.length;e++){var i=n[e];E(i.children)||(i=a(i.children,r),t=Math.max(t,i))}return t}(n),t=gn(n);function i(x,b){var k=[];return function C(n,t,r){for(var e,i=r,o=-1,a=0;a<t.length;a++){var u=t[a],c=t[a].children;if(n===x){var f=i,l=i=function _(t,n){return n&&(t+=n.length-1,n.forEach(function(n){t=_(t,n.children)})),t}(i,u.children);i++;for(var s=0;s<=l-f;s++){var h=s+f,d=0===s?l:h;k[h]={title:u[w.title],field:u[w.field],colStart:h,colEnd:d,isLeaf:!u.children,colSpan:(h=h,d=d,E((e=u).colSpan)?!e.children||e.children.length<=1?1:0==(e=d-h)?e:1+e:e.colSpan)}}}else if(c&&n<x){var v,m=o=-1===o?a+r:o,g=null==b||null==(v=b[m])?void 0:v.field;if(g&&b)for(var p=b.length-1;0<=p;p--)if((null==(y=b[p])?void 0:y.field)===g){var y=function(n){if(S(b))for(;n<b.length;n++){var t;if(!1===(null==(t=b[n])?void 0:t.isLeaf))return null==(t=b[n])?void 0:t.colStart}}(p+1);E(y)||(o=y);break}C(n+1,c,m)}}}(1,r,0),k}console.log("叶子",t);var o=[];return function u(n,t){n<=e&&(t=i(n,t),console.log("深度",n,_(t)),o.push(t),u(n+1,t))}(1),o.forEach(function(n,r){n.forEach(function(n,t){n&&(n.rowSpan=function(n,t){for(var r,e=0;n<o.length&&(null==o||null==(r=o[n])||!r[t]);n++)e++;return e}(r+1,t)+1)})}),{columns:function(){for(var r=[],n=o.length-1;0<=n;n--)o[n].forEach(function(n,t){n&&n.field&&E(r[t])&&(r[t]=n.field)});return r}(),data:o}},n.randomColor=function(){return"rgba("+T(0,255,!0)+","+T(0,255,!0)+","+T(0,255,!0)+",1)"},n.repeatString=Q,n.roundFixed=function(n,t,r){n=y(n);var e,i=Math.pow(10,t),n=f(Math.round(n*i)/i);return 0<t&&(e=(i=C(n,"."))[0],(i=i[1]||"").length<t&&(i=k(i,t,"0"),n=(i=r?i.replace(/0+$/,""):i)?e+"."+i:e)),n},n.shake=function(n,t){return t=Object.assign({string:!0,array:!0,kvPair:!0},t),function i(n,t){if(s(n))for(var r in n){var e=n[r];(S(e)||s(e))&&i(e,t),Z(e,t)&&delete n[r]}}(n=_(n),t),n},n.shortNumber=function(n,t,r){for(var e=E(r)?mn:r,i=(e.sort(function(n,t){return t[0]-n[0]}),n),o="",a=0;a<e.length;a++){var u=e[a],c=n/u[0];if(1<=c){i=c,o=u[1];break}}return{value:i,fmtValue:t(i),unit:o}},n.sortWithIndex=function(n,t){for(var r=[],e=0;e<n.length;e++)r[e]=n[t[e]];return r},n.spanTable=function(n,o){var u=_(n),c={};function r(i,o){var a=0;u.forEach(function(n,t){n.$rowSpan=null!=(e=n.$rowSpan)?e:{};var r,e=n[i];c[i]=null!=(r=c[i])?r:0,1<c[i]?(n.$rowSpan[i]=0,c[i]--):(r=function(n,t,r,e){var i=1;for(n++;n<e.length;n++){var o=e[n][t];if(o!==r&&!d(o))break;i++}return i}(t,i,e,u),void 0!==o&&(e=function(n,t,r){for(var e=0;0<=t&&!(0<(e=n[t].$rowSpan[r]));t--);return e}(u,t,o),0<a?e<=a+r?(r=e-a,a=0):a+=r:r<e?a=r:r=e),c[i]=r,n.$rowSpan[i]=c[i])})}return o.forEach(function(n,t){r(n,o[t-1])}),u.forEach(function(e){e.$colField={};var i=0;o.forEach(function(n,t){var r=e[n];1<i?(e.$colField[n]=0,i--):(i=function(n,t,r,e){var i=1;for(n++;n<e.length;n++){var o=p(r[e[n]]);if(o!==t&&!d(o))break;i++}return i}(t,r,e,o),e.$colField[n]=i)})}),u},n.split=C,n.thousands=function(n,i,o){return i=i||3,o=o||",",(e(n)?n:f(n)).replace(/([^.]*)?(\.)?(.*)?/,function(n,t,r,e){return f(t).replace(new RegExp("(.(?=(.{"+i+"})+$))","g"),"$1"+o)+f(r)+f(e)})},n.tree=function(n,t){for(var r=(t=h(t)).id||"id",e=t.pid||"pid",i=t.children||"children",o=0;o<n.length;o++){var a,u=n[o];(a=w(n,function(n){return null!=n[r]&&n[r]!=u[r]&&n[r]===u[e]},i))&&(a[i]=m(a[i]),a[i].push(u),n.splice(o--,1))}return n},n.treeLeafs=gn,n.trim=p,n.union=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=new Set(t);return Array.from(e)},n.urlToGet=function(n,t){n=f(n);var o=s(t)?t:r(t),t=r(n=n.replace(/({{)(.*?)(}})/g,function(n,t,r,e){r=p(r);var i=o[r];return delete o[r],i})),t=H(o=Object.assign(t,o));return n=t?(n=n.replace(/\?.*/,""))+"?"+t:n},n.uuid=function(n){n=y(n);for(var t="",r=0;r<13;r++)t+=T(1,9);return n=(new Date).getTime()*T(1,100),k(A()+Number(t).toString(32)+n.toString(32),20,A()+A()+A())},n.variableHasValue=x});
