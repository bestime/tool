/**  
 * 个人工具库. bestime.esm.min.js
 * @QQ 1174295440
 * @author Bestime
 * @see https://github.com/bestime/tool
 * @update 2022-08-25 16:23:38
 */
function serverConfig(e){let o={};var t,n;for(n in e)t=e[n],o[n]={to:t,reg:new RegExp("^("+n+")(/|$)")};return function(e){let t=!1;var n,r=e;for(n in o){const i=o[n];if(i.reg.test(e)){t=!0,"string"==typeof i.to&&(r=e.replace(i.reg,i.to+"$2"));break}}return t||(console.error('警告：请求地址 "'+e+'" 不在白名单中！'),console.table(o)),r}}function isNull(e){return null===e||e===undefined}function _String(e){return isNull(e)?"":String(e)}const Bytes=8,KB=1024*Bytes,MB=1024*KB,GB=1024*MB,TB=1024*GB,LETTER_LIST=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],TYPE_ARRAY="Array",_NULL=null,ZERO_STRING="0",STRING_FALSE="false",STRING_TRUE="true",WINDOW=window,_TOSTRING=Object.prototype.toString,TYPE_OBJECT="Object",ENCODE_URI_COMPONENT=encodeURIComponent,_FUNCTION_NAME="function",TYPE_STRING="String",TYPE_NUMBER="Number",DECODE_URI_COMPONENT=decodeURIComponent;function getType(e){return _TOSTRING.call(e).slice(8,-1)}function isArray(e){return getType(e)===TYPE_ARRAY}function isMap(e){return getType(e)===TYPE_OBJECT}function jsonParse(e){try{e=JSON.parse(e)}catch(t){e=undefined}return e}function _Map(e){return e=isMap(e)||isMap(e=jsonParse(e))?e:{}}function isFunction(e){return typeof e===_FUNCTION_NAME}function param(e){var n=[];function i(e,t){null!=e&&""!==e&&(t=null==(t=isFunction(t)?t():t)?"":t,n[n.length]=ENCODE_URI_COMPONENT(e)+"="+ENCODE_URI_COMPONENT(t))}return function o(e,t){var n,r;if(e)switch(getType(t)){case TYPE_ARRAY:for(n=0;n<t.length;n++)o(e+"["+("object"==typeof t[n]&&t[n]?n:"")+"]",t[n]);break;case TYPE_OBJECT:for(r in t)o(e+"["+r+"]",t[r]);break;default:i(e,t)}else switch(getType(t)){case TYPE_STRING:case TYPE_OBJECT:for(r in t)o(r,t[r]);break;case TYPE_ARRAY:for(n=0;n<t.length;n++)i(t[n].name,t[n].value)}}("",e),n.join("&")}function urlToGet(e,t){e=_String(e).replace(/&*$/g,"").replace(/\?*$/,"");var n="";return(n=isMap(t)||isArray(t)?param(t):_String(t).replace(/^&*/,""))&&(e+=(/\?/.test(e)?"&":"?")+n),e}function trim(e,t){var n=getType(e);if(n===TYPE_NUMBER&&(e=String(e),n=TYPE_STRING),n!==TYPE_STRING)return"";switch(t){case 1:return e.replace(/^[\s\uFEFF\xA0]+/,"");case-1:return e.replace(/[\s\uFEFF\xA0]+$/,"");case 0:case"*":return e.replace(/[\s\uFEFF\xA0]+/g,"");default:return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function isString(e){return getType(e)===TYPE_STRING}function isEmptyMap(e){var t,n=!0;for(t in e)t!==undefined&&(n=!1);return n}function clean(e,t,n){if(n=!1!==n,isMap(e)){var r,i,o={};for(i in e)_filterData(isArray(r=e[i])||isMap(r)?clean(r,t):r,t,n,function(e){o[i]=e})}else if(isArray(e)){o=[];for(var a=0,u=e.length;a<u;a++)_filterData(clean(e[a],t),t,n,function(e){o.push(e)})}else o=e;return o}function _filterData(e,t,n,r){isString(e)?t&&""==trim(e,"*")||r(e):null!=e&&(n&&isMap(e)&&isEmptyMap(e),r(e))}function _Array(e){return e=isArray(e)||isArray(e=jsonParse(e))?e:[]}function variableHasValue(e,t,n){var r;n=null==n?60:n,e()?t():(clearTimeout(r),setTimeout(function(){variableHasValue(e,t,n)},n))}const _tmp={};function dataCacheUtil(e){_tmp[e]=_tmp[e]||{count:0,complete:!1,data:null};const t=_tmp[e];return t.count++,{isExist:function(){return 1<t.count},set:function(e){t.complete=!0,t.data=JSON.stringify(e)},get:function(e){variableHasValue(function(){return t.complete},function(){e(JSON.parse(t.data))},100)},logs:_tmp}}const DEFAULT_CONFIG={id:"id",children:"children"};function deepFindTreePath(e,t,n){n=Object.assign(DEFAULT_CONFIG,n);const r=[],i=[...e],o=new Set;for(var a=n["children"];i.length;){var u=i[0];if(o.has(u))r.pop(),i.shift();else if(o.add(u),u[a]&&i.unshift(...u[a]),r.push(u),t(u))return r}return null}function setObjectToString(e){return e=isString(e)?e:JSON.stringify(e)}function setCookie(e,t,n){t=setObjectToString(t);var r=new Date;r.setTime(r.getTime()+n),document.cookie=e+"="+encodeURI(t)+";path=/;expires="+r.toUTCString()}function FN_FORMAT_STRING_VALUE(e){let t=e;if(null==e)t=undefined;else if(STRING_FALSE===e)t=!1;else if(STRING_TRUE===e)t=!0;else if(isString(e)&&/^\d+$/.test(e))t=String(e);else try{t=JSON.parse(e)}catch(n){}return t}function getCookie(e,t){t=t||document.cookie;let r="";return t.replace(new RegExp("(^|;\\s)"+e+"=(.*?)($|(;\\s))"),function(e,t,n){r=FN_FORMAT_STRING_VALUE(DECODE_URI_COMPONENT(n))}),r}function removeCookie(e){var t=new Date,e=(t.setTime(t.getTime()-1e7),e+"="+encodeURI("")+";expires="+t.toUTCString());document.cookie=e}function _Number(e){return(e=Number(e))===Math.abs(Infinity)||isNaN(e)?0:e}const defaultSplitArr=[_NULL,_NULL];function handleDeepKey(e,t,n){var t=splitSymbol(t),r=t[0];isPreLikeArray(r)?(r=_Number(r),t[1]==_NULL?e.push(n):(/^\[[\D]+\]/.test(t[1])?e[r]=_Map(e[r]):e[r]=_Array(e[r]),handleDeepKey(e[r],t[1],n))):t[1]==_NULL?e[r]=n:(/^\[[\D]+\]/.test(t[1])?e[r]=_Map(e[r]):e[r]=_Array(e[r]),handleDeepKey(e[r],t[1],n))}function splitSymbol(e){if(e==_NULL)return defaultSplitArr;var r,i=e;return e.replace(/^\[(.*?)\](.*)?/,function(e,t,n){return i=t,r=n,""}),[i,r]}function isPreLikeArray(e){return""===e||/^\d+$/.test(e)}function parseQuery(e){var t,o,n,a={};try{t=WINDOW.location.href}catch(r){t=""}return(e=isString(e)?e:t).replace(/([^=&?/#]*?)=([^=&?/#]*)/g,function(e,t,i){i=FN_FORMAT_STRING_VALUE(DECODE_URI_COMPONENT(i)),n=DECODE_URI_COMPONENT(t),o=!1,""!==n&&(n.replace(/(.*?)(\[.*)/,function(e,t,n){var r=splitSymbol(n);o=!0,isPreLikeArray(r[0])?a[t]=_Array(a[t]):a[t]=_Map(a[t]),handleDeepKey(a[t],n,i)}),o||(a[n]=i))}),a}function defaultValue(e,t){return isNull(e)?t:e}function downloadFileByUrl(e,t){var n=document.createElement("a");n.style.display="none",n.download=t,n.setAttribute("href",e),document.body.appendChild(n),n.click(),n.remove()}function downloadFileByArrayBuffer(e,t){downloadFileByUrl(window.URL.createObjectURL(new Blob([e])),t)}function repeatString(e,t){var n="";if((e=_String(e)).length*t<1<<28)for(;1==(1&t)&&(n+=e),0!=(t>>>=1);)e+=e;return n}function PAD_STRING(e,t,n,r){return(e=_String(e)).length>(t>>=0)?e:(t-=e.length,n.length<t&&(n+=repeatString(n,t/n.length)),-1===r?n.slice(0,t)+e:e+n.slice(0,t))}function padStart(e,t,n){return PAD_STRING(e,t,n,-1)}function padEnd(e,t,n){return PAD_STRING(e,t,n,1)}function split(e,t){return""!==e?e.split(t):[]}function floorFixed(e,t,n){var e=split(e=trim(_Number(e)),"."),r=e[1]||"";return r.length<t&&(r=padEnd(r,t,ZERO_STRING),n&&(r=r.replace(/0+$/,""))),t<1||!r?e[0]:e[0]+"."+r.substring(0,t)}function roundFixed(e,t,n){e=_Number(e);var r,i=Math.pow(10,t),e=_String(Math.round(e*i)/i);return 0<t&&(r=(i=split(e,"."))[0],(i=i[1]||"").length<t&&(i=padEnd(i,t,ZERO_STRING),e=(i=n?i.replace(/0+$/,""):i)?r+"."+i:r)),e}function deepFindItem(e,n,r){var i,o;return r=isNull(r)?"children":r,function a(e){if(e)for(var t=0;t<e.length;t++){if(o=n(e[t])){i=e[t];break}if(a(e[t][r]),o)break}}(e),i}function flatArrayToTree(e,t){for(var n,r,i=(t=_Map(t)).id||"id",o=t.pid||"pid",a=t.children||"children",u=0;u<e.length;u++)(r=e[u])[a]=_Array(r[a]),(n=deepFindItem(e,function(e){return null!=e[i]&&e[i]!=r[i]&&e[i]===r[o]},a))&&(n[a]=_Array(n[a]),n[a].push(r),e.splice(u--,1));return e}function changeIndex(e,t,n){e+=1;return(t=(t+n)%e)<0&&(t+=e),-0===t?0:t}function simpleClone(e){return e=jsonParse(e=JSON.stringify(e))}function zeroTo2(e){return padStart(e,2,"0")}function formatFunc(e,t,n){t=e[t];return""===t?"":zeroTo2(n)+t}function handleOne(e,t){for(var n=e.split[0],r=t.split[1],i=0;i<n.length&&n[i]===r[i];i++)r[i]=""}function timeLine(e,t){t=t||["年","月","日 ","时","分","秒","毫秒"];for(var n,r=[],i=0;i<e.length;i++){var o,a=[formatFunc(t,0,(o=new Date(e[i])).getFullYear()),formatFunc(t,1,o.getMonth()+1),formatFunc(t,2,o.getDate()),formatFunc(t,3,o.getHours()),formatFunc(t,4,o.getMinutes()),formatFunc(t,5,o.getSeconds()),formatFunc(t,6,o.getMilliseconds())];r.push({value:e[i],timestamp:+o,split:[a,simpleClone(a)]})}r.sort(function(e,t){return e.millisecond-t.millisecond});for(i=1;i<r.length;i++)handleOne(r[i-1],r[i]);for(i=0;i<r.length;i++)(n=r[i]).split=n.split[1],n.label=trim(n.split.join(""));return r}function fileSize(e,t){var n=e;switch(t){case"MB":n=e*MB;break;case"KB":n=e*KB;break;case"Bytes":n=e*Bytes}var t=floorFixed(n/TB,2),r=floorFixed(n/GB,2),i=floorFixed(n/MB,2),o=floorFixed(n/KB,2);return{Bit:n,Bytes:floorFixed(n/Bytes,2),KB:o,MB:i,GB:r,TB:t,format:1<=+t?t+" TB":1<=+r?r+" GB":1<=+i?i+" MB":o+" KB"}}function removeElement(e){try{e.parentNode.removeChild(e)}catch(t){}}function prevent(e,t,n){e=e||WINDOW.event,n=!1!==n,(t=!1!==t)&&WINDOW.event?WINDOW.event.cancelBubble=!0:e.stopPropagation(),n&&WINDOW.event?WINDOW.event.returnValue=!1:e.preventDefault()}function getRandom(e,t,n){n=!1===n?0:1;return e=Math.random()*(t-e+n)+e,n?Math.floor(e):e}function uuid(e){e=_Number(e);let t="";for(let e=0;e<13;e++)t+=getRandom(1,9);t=_Number(t);var n=+new Date,n=n*getRandom(1,String(n).length)+t;let r=LETTER_LIST[getRandom(0,LETTER_LIST.length)]+t.toString(32)+n;return r=e?r.substring(0,e):r}function _Boolean(e){return!0===e||"true"===e||"1"===e||1===e}function getStorage(e){return FN_FORMAT_STRING_VALUE(localStorage.getItem(e))}function removeStorage(e){localStorage.removeItem(e)}function SET_STRING_VALUE(e){return e=isString(e)?e:JSON.stringify(e)}function setStorage(e,t){localStorage.setItem(e,SET_STRING_VALUE(t))}function getRelativePos(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top,height:e.offsetHeight,width:e.offsetWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight}}function flatTree(e,r){const i=[];return r=defaultValue(r,"children"),function o(t){var n;if(isArray(t))for(let e=0;e<t.length;e++)n=t[e],i.push(n),o(n[r])}(e),i}function getJsFileBaseUrl(e){e=e||0;for(var t="/[^/]*",n=document.scripts,r=0;r<e;r++)t+=t;return n[n.length-1].src.replace(new RegExp(t+"$"),"")}function getfile(e,t,n,r,i){let o;"script"===n?(o=document.createElement("script")).src=r:((o=document.createElement("link")).href=r,o.setAttribute("rel","stylesheet")),o.setAttribute("level-id",e),o.onload=o.onerror=i,t.appendChild(o)}let _setting={},times=0,oHead=document.getElementsByTagName("head")[0];function getMuti(e,n,r,i){const o=[];let a=0;for(let t=0;t<r.length;t++)getOne(e,n,r[t],function(e){o[t]=e,++a===r.length&&i(...o)})}function getOne(e,t,n,r){const i=_setting[n];if(!i)throw"未配置该资源："+n;const o=/^js/.test(n);function a(){i._complete=!0,isFunction(r)&&(o?r(window[i.global]):r())}var u;0<i._count?variableHasValue(function(){return i._complete},a):!i._depenIsLoad&&i.dependencies&&0<i.dependencies.length?(i._depenIsLoad=!0,getMuti(e,t+1,i.dependencies,function(){getOne(e,t,n,a)})):!i._syncsIsLoad&&i.syncs&&0<i.syncs.length?(i._syncsIsLoad=!0,getMuti(e,t,i.syncs.concat(n),a)):(i._count=i._count?i._count+1:1,i._deeps=e+"."+t,u=o?"script":"link",getfile(i._deeps,oHead,u,i.url,a))}function loadJsAndCss(e,t){("object"==typeof e?getMuti:getOne)(++times,1,e,t)}loadJsAndCss.config=function(e){if(!isEmptyMap(_setting))throw"config is already configured";_setting=e},loadJsAndCss.getConfig=function(){return _setting};export{_Array,_Boolean,_Map,_Number,_String,changeIndex,clean,dataCacheUtil,deepFindItem,deepFindTreePath,defaultValue,downloadFileByArrayBuffer,downloadFileByUrl,fileSize,flatTree,floorFixed,getCookie,getJsFileBaseUrl,getRandom,getRelativePos,getStorage,getType,isArray,isFunction,isMap,isNull,loadJsAndCss as need,padEnd,padStart,param,parseQuery,prevent,removeCookie,removeElement,removeStorage,repeatString,roundFixed,serverConfig,setCookie,setStorage,split,timeLine,flatArrayToTree as tree,trim,urlToGet,uuid,variableHasValue};
