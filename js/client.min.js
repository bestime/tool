(function (a, b) { function cy(a) { return f.isWindow(a) ? a : a.nodeType === 9 ? a.defaultView || a.parentWindow : !1 } function cu(a) { if (!cj[a]) { var b = c.body, d = f("<" + a + ">").appendTo(b), e = d.css("display"); d.remove(); if (e === "none" || e === "") { ck || (ck = c.createElement("iframe"), ck.frameBorder = ck.width = ck.height = 0), b.appendChild(ck); if (!cl || !ck.createElement) cl = (ck.contentWindow || ck.contentDocument).document, cl.write((f.support.boxModel ? "<!doctype html>" : "") + "<html><body>"), cl.close(); d = cl.createElement(a), cl.body.appendChild(d), e = f.css(d, "display"), b.removeChild(ck) } cj[a] = e } return cj[a] } function ct(a, b) { var c = {}; f.each(cp.concat.apply([], cp.slice(0, b)), function () { c[this] = a }); return c } function cs() { cq = b } function cr() { setTimeout(cs, 0); return cq = f.now() } function ci() { try { return new a.ActiveXObject("Microsoft.XMLHTTP") } catch (b) { } } function ch() { try { return new a.XMLHttpRequest } catch (b) { } } function cb(a, c) { a.dataFilter && (c = a.dataFilter(c, a.dataType)); var d = a.dataTypes, e = {}, g, h, i = d.length, j, k = d[0], l, m, n, o, p; for (g = 1; g < i; g++) { if (g === 1) for (h in a.converters) typeof h == "string" && (e[h.toLowerCase()] = a.converters[h]); l = k, k = d[g]; if (k === "*") k = l; else if (l !== "*" && l !== k) { m = l + " " + k, n = e[m] || e["* " + k]; if (!n) { p = b; for (o in e) { j = o.split(" "); if (j[0] === l || j[0] === "*") { p = e[j[1] + " " + k]; if (p) { o = e[o], o === !0 ? n = p : p === !0 && (n = o); break } } } } !n && !p && f.error("No conversion from " + m.replace(" ", " to ")), n !== !0 && (c = n ? n(c) : p(o(c))) } } return c } function ca(a, c, d) { var e = a.contents, f = a.dataTypes, g = a.responseFields, h, i, j, k; for (i in g) i in d && (c[g[i]] = d[i]); while (f[0] === "*") f.shift(), h === b && (h = a.mimeType || c.getResponseHeader("content-type")); if (h) for (i in e) if (e[i] && e[i].test(h)) { f.unshift(i); break } if (f[0] in d) j = f[0]; else { for (i in d) { if (!f[0] || a.converters[i + " " + f[0]]) { j = i; break } k || (k = i) } j = j || k } if (j) { j !== f[0] && f.unshift(j); return d[j] } } function b_(a, b, c, d) { if (f.isArray(b)) f.each(b, function (b, e) { c || bD.test(a) ? d(a, e) : b_(a + "[" + (typeof e == "object" ? b : "") + "]", e, c, d) }); else if (!c && f.type(b) === "object") for (var e in b) b_(a + "[" + e + "]", b[e], c, d); else d(a, b) } function b$(a, c) { var d, e, g = f.ajaxSettings.flatOptions || {}; for (d in c) c[d] !== b && ((g[d] ? a : e || (e = {}))[d] = c[d]); e && f.extend(!0, a, e) } function bZ(a, c, d, e, f, g) { f = f || c.dataTypes[0], g = g || {}, g[f] = !0; var h = a[f], i = 0, j = h ? h.length : 0, k = a === bS, l; for (; i < j && (k || !l); i++)l = h[i](c, d, e), typeof l == "string" && (!k || g[l] ? l = b : (c.dataTypes.unshift(l), l = bZ(a, c, d, e, l, g))); (k || !l) && !g["*"] && (l = bZ(a, c, d, e, "*", g)); return l } function bY(a) { return function (b, c) { typeof b != "string" && (c = b, b = "*"); if (f.isFunction(c)) { var d = b.toLowerCase().split(bO), e = 0, g = d.length, h, i, j; for (; e < g; e++)h = d[e], j = /^\+/.test(h), j && (h = h.substr(1) || "*"), i = a[h] = a[h] || [], i[j ? "unshift" : "push"](c) } } } function bB(a, b, c) { var d = b === "width" ? a.offsetWidth : a.offsetHeight, e = b === "width" ? 1 : 0, g = 4; if (d > 0) { if (c !== "border") for (; e < g; e += 2)c || (d -= parseFloat(f.css(a, "padding" + bx[e])) || 0), c === "margin" ? d += parseFloat(f.css(a, c + bx[e])) || 0 : d -= parseFloat(f.css(a, "border" + bx[e] + "Width")) || 0; return d + "px" } d = by(a, b); if (d < 0 || d == null) d = a.style[b]; if (bt.test(d)) return d; d = parseFloat(d) || 0; if (c) for (; e < g; e += 2)d += parseFloat(f.css(a, "padding" + bx[e])) || 0, c !== "padding" && (d += parseFloat(f.css(a, "border" + bx[e] + "Width")) || 0), c === "margin" && (d += parseFloat(f.css(a, c + bx[e])) || 0); return d + "px" } function bo(a) { var b = c.createElement("div"); bh.appendChild(b), b.innerHTML = a.outerHTML; return b.firstChild } function bn(a) { var b = (a.nodeName || "").toLowerCase(); b === "input" ? bm(a) : b !== "script" && typeof a.getElementsByTagName != "undefined" && f.grep(a.getElementsByTagName("input"), bm) } function bm(a) { if (a.type === "checkbox" || a.type === "radio") a.defaultChecked = a.checked } function bl(a) { return typeof a.getElementsByTagName != "undefined" ? a.getElementsByTagName("*") : typeof a.querySelectorAll != "undefined" ? a.querySelectorAll("*") : [] } function bk(a, b) { var c; b.nodeType === 1 && (b.clearAttributes && b.clearAttributes(), b.mergeAttributes && b.mergeAttributes(a), c = b.nodeName.toLowerCase(), c === "object" ? b.outerHTML = a.outerHTML : c !== "input" || a.type !== "checkbox" && a.type !== "radio" ? c === "option" ? b.selected = a.defaultSelected : c === "input" || c === "textarea" ? b.defaultValue = a.defaultValue : c === "script" && b.text !== a.text && (b.text = a.text) : (a.checked && (b.defaultChecked = b.checked = a.checked), b.value !== a.value && (b.value = a.value)), b.removeAttribute(f.expando), b.removeAttribute("_submit_attached"), b.removeAttribute("_change_attached")) } function bj(a, b) { if (b.nodeType === 1 && !!f.hasData(a)) { var c, d, e, g = f._data(a), h = f._data(b, g), i = g.events; if (i) { delete h.handle, h.events = {}; for (c in i) for (d = 0, e = i[c].length; d < e; d++)f.event.add(b, c, i[c][d]) } h.data && (h.data = f.extend({}, h.data)) } } function bi(a, b) { return f.nodeName(a, "table") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a } function U(a) { var b = V.split("|"), c = a.createDocumentFragment(); if (c.createElement) while (b.length) c.createElement(b.pop()); return c } function T(a, b, c) { b = b || 0; if (f.isFunction(b)) return f.grep(a, function (a, d) { var e = !!b.call(a, d, a); return e === c }); if (b.nodeType) return f.grep(a, function (a, d) { return a === b === c }); if (typeof b == "string") { var d = f.grep(a, function (a) { return a.nodeType === 1 }); if (O.test(b)) return f.filter(b, d, !c); b = f.filter(b, d) } return f.grep(a, function (a, d) { return f.inArray(a, b) >= 0 === c }) } function S(a) { return !a || !a.parentNode || a.parentNode.nodeType === 11 } function K() { return !0 } function J() { return !1 } function n(a, b, c) { var d = b + "defer", e = b + "queue", g = b + "mark", h = f._data(a, d); h && (c === "queue" || !f._data(a, e)) && (c === "mark" || !f._data(a, g)) && setTimeout(function () { !f._data(a, e) && !f._data(a, g) && (f.removeData(a, d, !0), h.fire()) }, 0) } function m(a) { for (var b in a) { if (b === "data" && f.isEmptyObject(a[b])) continue; if (b !== "toJSON") return !1 } return !0 } function l(a, c, d) { if (d === b && a.nodeType === 1) { var e = "data-" + c.replace(k, "-$1").toLowerCase(); d = a.getAttribute(e); if (typeof d == "string") { try { d = d === "true" ? !0 : d === "false" ? !1 : d === "null" ? null : f.isNumeric(d) ? +d : j.test(d) ? f.parseJSON(d) : d } catch (g) { } f.data(a, c, d) } else d = b } return d } function h(a) { var b = g[a] = {}, c, d; a = a.split(/\s+/); for (c = 0, d = a.length; c < d; c++)b[a[c]] = !0; return b } var c = a.document, d = a.navigator, e = a.location, f = function () { function J() { if (!e.isReady) { try { c.documentElement.doScroll("left") } catch (a) { setTimeout(J, 1); return } e.ready() } } var e = function (a, b) { return new e.fn.init(a, b, h) }, f = a.jQuery, g = a.$, h, i = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, j = /\S/, k = /^\s+/, l = /\s+$/, m = /^<(\w+)\s*\/?>(?:<\/\1>)?$/, n = /^[\],:{}\s]*$/, o = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, p = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, q = /(?:^|:|,)(?:\s*\[)+/g, r = /(webkit)[ \/]([\w.]+)/, s = /(opera)(?:.*version)?[ \/]([\w.]+)/, t = /(msie) ([\w.]+)/, u = /(mozilla)(?:.*? rv:([\w.]+))?/, v = /-([a-z]|[0-9])/gi, w = /^-ms-/, x = function (a, b) { return (b + "").toUpperCase() }, y = d.userAgent, z, A, B, C = Object.prototype.toString, D = Object.prototype.hasOwnProperty, E = Array.prototype.push, F = Array.prototype.slice, G = String.prototype.trim, H = Array.prototype.indexOf, I = {}; e.fn = e.prototype = { constructor: e, init: function (a, d, f) { var g, h, j, k; if (!a) return this; if (a.nodeType) { this.context = this[0] = a, this.length = 1; return this } if (a === "body" && !d && c.body) { this.context = c, this[0] = c.body, this.selector = a, this.length = 1; return this } if (typeof a == "string") { a.charAt(0) !== "<" || a.charAt(a.length - 1) !== ">" || a.length < 3 ? g = i.exec(a) : g = [null, a, null]; if (g && (g[1] || !d)) { if (g[1]) { d = d instanceof e ? d[0] : d, k = d ? d.ownerDocument || d : c, j = m.exec(a), j ? e.isPlainObject(d) ? (a = [c.createElement(j[1])], e.fn.attr.call(a, d, !0)) : a = [k.createElement(j[1])] : (j = e.buildFragment([g[1]], [k]), a = (j.cacheable ? e.clone(j.fragment) : j.fragment).childNodes); return e.merge(this, a) } h = c.getElementById(g[2]); if (h && h.parentNode) { if (h.id !== g[2]) return f.find(a); this.length = 1, this[0] = h } this.context = c, this.selector = a; return this } return !d || d.jquery ? (d || f).find(a) : this.constructor(d).find(a) } if (e.isFunction(a)) return f.ready(a); a.selector !== b && (this.selector = a.selector, this.context = a.context); return e.makeArray(a, this) }, selector: "", jquery: "1.7.2", length: 0, size: function () { return this.length }, toArray: function () { return F.call(this, 0) }, get: function (a) { return a == null ? this.toArray() : a < 0 ? this[this.length + a] : this[a] }, pushStack: function (a, b, c) { var d = this.constructor(); e.isArray(a) ? E.apply(d, a) : e.merge(d, a), d.prevObject = this, d.context = this.context, b === "find" ? d.selector = this.selector + (this.selector ? " " : "") + c : b && (d.selector = this.selector + "." + b + "(" + c + ")"); return d }, each: function (a, b) { return e.each(this, a, b) }, ready: function (a) { e.bindReady(), A.add(a); return this }, eq: function (a) { a = +a; return a === -1 ? this.slice(a) : this.slice(a, a + 1) }, first: function () { return this.eq(0) }, last: function () { return this.eq(-1) }, slice: function () { return this.pushStack(F.apply(this, arguments), "slice", F.call(arguments).join(",")) }, map: function (a) { return this.pushStack(e.map(this, function (b, c) { return a.call(b, c, b) })) }, end: function () { return this.prevObject || this.constructor(null) }, push: E, sort: [].sort, splice: [].splice }, e.fn.init.prototype = e.fn, e.extend = e.fn.extend = function () { var a, c, d, f, g, h, i = arguments[0] || {}, j = 1, k = arguments.length, l = !1; typeof i == "boolean" && (l = i, i = arguments[1] || {}, j = 2), typeof i != "object" && !e.isFunction(i) && (i = {}), k === j && (i = this, --j); for (; j < k; j++)if ((a = arguments[j]) != null) for (c in a) { d = i[c], f = a[c]; if (i === f) continue; l && f && (e.isPlainObject(f) || (g = e.isArray(f))) ? (g ? (g = !1, h = d && e.isArray(d) ? d : []) : h = d && e.isPlainObject(d) ? d : {}, i[c] = e.extend(l, h, f)) : f !== b && (i[c] = f) } return i }, e.extend({ noConflict: function (b) { a.$ === e && (a.$ = g), b && a.jQuery === e && (a.jQuery = f); return e }, isReady: !1, readyWait: 1, holdReady: function (a) { a ? e.readyWait++ : e.ready(!0) }, ready: function (a) { if (a === !0 && !--e.readyWait || a !== !0 && !e.isReady) { if (!c.body) return setTimeout(e.ready, 1); e.isReady = !0; if (a !== !0 && --e.readyWait > 0) return; A.fireWith(c, [e]), e.fn.trigger && e(c).trigger("ready").off("ready") } }, bindReady: function () { if (!A) { A = e.Callbacks("once memory"); if (c.readyState === "complete") return setTimeout(e.ready, 1); if (c.addEventListener) c.addEventListener("DOMContentLoaded", B, !1), a.addEventListener("load", e.ready, !1); else if (c.attachEvent) { c.attachEvent("onreadystatechange", B), a.attachEvent("onload", e.ready); var b = !1; try { b = a.frameElement == null } catch (d) { } c.documentElement.doScroll && b && J() } } }, isFunction: function (a) { return e.type(a) === "function" }, isArray: Array.isArray || function (a) { return e.type(a) === "array" }, isWindow: function (a) { return a != null && a == a.window }, isNumeric: function (a) { return !isNaN(parseFloat(a)) && isFinite(a) }, type: function (a) { return a == null ? String(a) : I[C.call(a)] || "object" }, isPlainObject: function (a) { if (!a || e.type(a) !== "object" || a.nodeType || e.isWindow(a)) return !1; try { if (a.constructor && !D.call(a, "constructor") && !D.call(a.constructor.prototype, "isPrototypeOf")) return !1 } catch (c) { return !1 } var d; for (d in a); return d === b || D.call(a, d) }, isEmptyObject: function (a) { for (var b in a) return !1; return !0 }, error: function (a) { throw new Error(a) }, parseJSON: function (b) { if (typeof b != "string" || !b) return null; b = e.trim(b); if (a.JSON && a.JSON.parse) return a.JSON.parse(b); if (n.test(b.replace(o, "@").replace(p, "]").replace(q, ""))) return new Function("return " + b)(); e.error("Invalid JSON: " + b) }, parseXML: function (c) { if (typeof c != "string" || !c) return null; var d, f; try { a.DOMParser ? (f = new DOMParser, d = f.parseFromString(c, "text/xml")) : (d = new ActiveXObject("Microsoft.XMLDOM"), d.async = "false", d.loadXML(c)) } catch (g) { d = b } (!d || !d.documentElement || d.getElementsByTagName("parsererror").length) && e.error("Invalid XML: " + c); return d }, noop: function () { }, globalEval: function (b) { b && j.test(b) && (a.execScript || function (b) { a.eval.call(a, b) })(b) }, camelCase: function (a) { return a.replace(w, "ms-").replace(v, x) }, nodeName: function (a, b) { return a.nodeName && a.nodeName.toUpperCase() === b.toUpperCase() }, each: function (a, c, d) { var f, g = 0, h = a.length, i = h === b || e.isFunction(a); if (d) { if (i) { for (f in a) if (c.apply(a[f], d) === !1) break } else for (; g < h;)if (c.apply(a[g++], d) === !1) break } else if (i) { for (f in a) if (c.call(a[f], f, a[f]) === !1) break } else for (; g < h;)if (c.call(a[g], g, a[g++]) === !1) break; return a }, trim: G ? function (a) { return a == null ? "" : G.call(a) } : function (a) { return a == null ? "" : (a + "").replace(k, "").replace(l, "") }, makeArray: function (a, b) { var c = b || []; if (a != null) { var d = e.type(a); a.length == null || d === "string" || d === "function" || d === "regexp" || e.isWindow(a) ? E.call(c, a) : e.merge(c, a) } return c }, inArray: function (a, b, c) { var d; if (b) { if (H) return H.call(b, a, c); d = b.length, c = c ? c < 0 ? Math.max(0, d + c) : c : 0; for (; c < d; c++)if (c in b && b[c] === a) return c } return -1 }, merge: function (a, c) { var d = a.length, e = 0; if (typeof c.length == "number") for (var f = c.length; e < f; e++)a[d++] = c[e]; else while (c[e] !== b) a[d++] = c[e++]; a.length = d; return a }, grep: function (a, b, c) { var d = [], e; c = !!c; for (var f = 0, g = a.length; f < g; f++)e = !!b(a[f], f), c !== e && d.push(a[f]); return d }, map: function (a, c, d) { var f, g, h = [], i = 0, j = a.length, k = a instanceof e || j !== b && typeof j == "number" && (j > 0 && a[0] && a[j - 1] || j === 0 || e.isArray(a)); if (k) for (; i < j; i++)f = c(a[i], i, d), f != null && (h[h.length] = f); else for (g in a) f = c(a[g], g, d), f != null && (h[h.length] = f); return h.concat.apply([], h) }, guid: 1, proxy: function (a, c) { if (typeof c == "string") { var d = a[c]; c = a, a = d } if (!e.isFunction(a)) return b; var f = F.call(arguments, 2), g = function () { return a.apply(c, f.concat(F.call(arguments))) }; g.guid = a.guid = a.guid || g.guid || e.guid++; return g }, access: function (a, c, d, f, g, h, i) { var j, k = d == null, l = 0, m = a.length; if (d && typeof d == "object") { for (l in d) e.access(a, c, l, d[l], 1, h, f); g = 1 } else if (f !== b) { j = i === b && e.isFunction(f), k && (j ? (j = c, c = function (a, b, c) { return j.call(e(a), c) }) : (c.call(a, f), c = null)); if (c) for (; l < m; l++)c(a[l], d, j ? f.call(a[l], l, c(a[l], d)) : f, i); g = 1 } return g ? a : k ? c.call(a) : m ? c(a[0], d) : h }, now: function () { return (new Date).getTime() }, uaMatch: function (a) { a = a.toLowerCase(); var b = r.exec(a) || s.exec(a) || t.exec(a) || a.indexOf("compatible") < 0 && u.exec(a) || []; return { browser: b[1] || "", version: b[2] || "0" } }, sub: function () { function a(b, c) { return new a.fn.init(b, c) } e.extend(!0, a, this), a.superclass = this, a.fn = a.prototype = this(), a.fn.constructor = a, a.sub = this.sub, a.fn.init = function (d, f) { f && f instanceof e && !(f instanceof a) && (f = a(f)); return e.fn.init.call(this, d, f, b) }, a.fn.init.prototype = a.fn; var b = a(c); return a }, browser: {} }), e.each("Boolean Number String Function Array Date RegExp Object".split(" "), function (a, b) { I["[object " + b + "]"] = b.toLowerCase() }), z = e.uaMatch(y), z.browser && (e.browser[z.browser] = !0, e.browser.version = z.version), e.browser.webkit && (e.browser.safari = !0), j.test("Â ") && (k = /^[\s\xA0]+/, l = /[\s\xA0]+$/), h = e(c), c.addEventListener ? B = function () { c.removeEventListener("DOMContentLoaded", B, !1), e.ready() } : c.attachEvent && (B = function () { c.readyState === "complete" && (c.detachEvent("onreadystatechange", B), e.ready()) }); return e }(), g = {}; f.Callbacks = function (a) { a = a ? g[a] || h(a) : {}; var c = [], d = [], e, i, j, k, l, m, n = function (b) { var d, e, g, h, i; for (d = 0, e = b.length; d < e; d++)g = b[d], h = f.type(g), h === "array" ? n(g) : h === "function" && (!a.unique || !p.has(g)) && c.push(g) }, o = function (b, f) { f = f || [], e = !a.memory || [b, f], i = !0, j = !0, m = k || 0, k = 0, l = c.length; for (; c && m < l; m++)if (c[m].apply(b, f) === !1 && a.stopOnFalse) { e = !0; break } j = !1, c && (a.once ? e === !0 ? p.disable() : c = [] : d && d.length && (e = d.shift(), p.fireWith(e[0], e[1]))) }, p = { add: function () { if (c) { var a = c.length; n(arguments), j ? l = c.length : e && e !== !0 && (k = a, o(e[0], e[1])) } return this }, remove: function () { if (c) { var b = arguments, d = 0, e = b.length; for (; d < e; d++)for (var f = 0; f < c.length; f++)if (b[d] === c[f]) { j && f <= l && (l--, f <= m && m--), c.splice(f--, 1); if (a.unique) break } } return this }, has: function (a) { if (c) { var b = 0, d = c.length; for (; b < d; b++)if (a === c[b]) return !0 } return !1 }, empty: function () { c = []; return this }, disable: function () { c = d = e = b; return this }, disabled: function () { return !c }, lock: function () { d = b, (!e || e === !0) && p.disable(); return this }, locked: function () { return !d }, fireWith: function (b, c) { d && (j ? a.once || d.push([b, c]) : (!a.once || !e) && o(b, c)); return this }, fire: function () { p.fireWith(this, arguments); return this }, fired: function () { return !!i } }; return p }; var i = [].slice; f.extend({ Deferred: function (a) { var b = f.Callbacks("once memory"), c = f.Callbacks("once memory"), d = f.Callbacks("memory"), e = "pending", g = { resolve: b, reject: c, notify: d }, h = { done: b.add, fail: c.add, progress: d.add, state: function () { return e }, isResolved: b.fired, isRejected: c.fired, then: function (a, b, c) { i.done(a).fail(b).progress(c); return this }, always: function () { i.done.apply(i, arguments).fail.apply(i, arguments); return this }, pipe: function (a, b, c) { return f.Deferred(function (d) { f.each({ done: [a, "resolve"], fail: [b, "reject"], progress: [c, "notify"] }, function (a, b) { var c = b[0], e = b[1], g; f.isFunction(c) ? i[a](function () { g = c.apply(this, arguments), g && f.isFunction(g.promise) ? g.promise().then(d.resolve, d.reject, d.notify) : d[e + "With"](this === i ? d : this, [g]) }) : i[a](d[e]) }) }).promise() }, promise: function (a) { if (a == null) a = h; else for (var b in h) a[b] = h[b]; return a } }, i = h.promise({}), j; for (j in g) i[j] = g[j].fire, i[j + "With"] = g[j].fireWith; i.done(function () { e = "resolved" }, c.disable, d.lock).fail(function () { e = "rejected" }, b.disable, d.lock), a && a.call(i, i); return i }, when: function (a) { function m(a) { return function (b) { e[a] = arguments.length > 1 ? i.call(arguments, 0) : b, j.notifyWith(k, e) } } function l(a) { return function (c) { b[a] = arguments.length > 1 ? i.call(arguments, 0) : c, --g || j.resolveWith(j, b) } } var b = i.call(arguments, 0), c = 0, d = b.length, e = Array(d), g = d, h = d, j = d <= 1 && a && f.isFunction(a.promise) ? a : f.Deferred(), k = j.promise(); if (d > 1) { for (; c < d; c++)b[c] && b[c].promise && f.isFunction(b[c].promise) ? b[c].promise().then(l(c), j.reject, m(c)) : --g; g || j.resolveWith(j, b) } else j !== a && j.resolveWith(j, d ? [a] : []); return k } }), f.support = function () { var b, d, e, g, h, i, j, k, l, m, n, o, p = c.createElement("div"), q = c.documentElement; p.setAttribute("className", "t"), p.innerHTML = "   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>", d = p.getElementsByTagName("*"), e = p.getElementsByTagName("a")[0]; if (!d || !d.length || !e) return {}; g = c.createElement("select"), h = g.appendChild(c.createElement("option")), i = p.getElementsByTagName("input")[0], b = { leadingWhitespace: p.firstChild.nodeType === 3, tbody: !p.getElementsByTagName("tbody").length, htmlSerialize: !!p.getElementsByTagName("link").length, style: /top/.test(e.getAttribute("style")), hrefNormalized: e.getAttribute("href") === "/a", opacity: /^0.55/.test(e.style.opacity), cssFloat: !!e.style.cssFloat, checkOn: i.value === "on", optSelected: h.selected, getSetAttribute: p.className !== "t", enctype: !!c.createElement("form").enctype, html5Clone: c.createElement("nav").cloneNode(!0).outerHTML !== "<:nav></:nav>", submitBubbles: !0, changeBubbles: !0, focusinBubbles: !1, deleteExpando: !0, noCloneEvent: !0, inlineBlockNeedsLayout: !1, shrinkWrapBlocks: !1, reliableMarginRight: !0, pixelMargin: !0 }, f.boxModel = b.boxModel = c.compatMode === "CSS1Compat", i.checked = !0, b.noCloneChecked = i.cloneNode(!0).checked, g.disabled = !0, b.optDisabled = !h.disabled; try { delete p.test } catch (r) { b.deleteExpando = !1 } !p.addEventListener && p.attachEvent && p.fireEvent && (p.attachEvent("onclick", function () { b.noCloneEvent = !1 }), p.cloneNode(!0).fireEvent("onclick")), i = c.createElement("input"), i.value = "t", i.setAttribute("type", "radio"), b.radioValue = i.value === "t", i.setAttribute("checked", "checked"), i.setAttribute("name", "t"), p.appendChild(i), j = c.createDocumentFragment(), j.appendChild(p.lastChild), b.checkClone = j.cloneNode(!0).cloneNode(!0).lastChild.checked, b.appendChecked = i.checked, j.removeChild(i), j.appendChild(p); if (p.attachEvent) for (n in { submit: 1, change: 1, focusin: 1 }) m = "on" + n, o = m in p, o || (p.setAttribute(m, "return;"), o = typeof p[m] == "function"), b[n + "Bubbles"] = o; j.removeChild(p), j = g = h = p = i = null, f(function () { var d, e, g, h, i, j, l, m, n, q, r, s, t, u = c.getElementsByTagName("body")[0]; !u || (m = 1, t = "padding:0;margin:0;border:", r = "position:absolute;top:0;left:0;width:1px;height:1px;", s = t + "0;visibility:hidden;", n = "style='" + r + t + "5px solid #000;", q = "<div " + n + "display:block;'><div style='" + t + "0;display:block;overflow:hidden;'></div></div>" + "<table " + n + "' cellpadding='0' cellspacing='0'>" + "<tr><td></td></tr></table>", d = c.createElement("div"), d.style.cssText = s + "width:0;height:0;position:static;top:0;margin-top:" + m + "px", u.insertBefore(d, u.firstChild), p = c.createElement("div"), d.appendChild(p), p.innerHTML = "<table><tr><td style='" + t + "0;display:none'></td><td>t</td></tr></table>", k = p.getElementsByTagName("td"), o = k[0].offsetHeight === 0, k[0].style.display = "", k[1].style.display = "none", b.reliableHiddenOffsets = o && k[0].offsetHeight === 0, a.getComputedStyle && (p.innerHTML = "", l = c.createElement("div"), l.style.width = "0", l.style.marginRight = "0", p.style.width = "2px", p.appendChild(l), b.reliableMarginRight = (parseInt((a.getComputedStyle(l, null) || { marginRight: 0 }).marginRight, 10) || 0) === 0), typeof p.style.zoom != "undefined" && (p.innerHTML = "", p.style.width = p.style.padding = "1px", p.style.border = 0, p.style.overflow = "hidden", p.style.display = "inline", p.style.zoom = 1, b.inlineBlockNeedsLayout = p.offsetWidth === 3, p.style.display = "block", p.style.overflow = "visible", p.innerHTML = "<div style='width:5px;'></div>", b.shrinkWrapBlocks = p.offsetWidth !== 3), p.style.cssText = r + s, p.innerHTML = q, e = p.firstChild, g = e.firstChild, i = e.nextSibling.firstChild.firstChild, j = { doesNotAddBorder: g.offsetTop !== 5, doesAddBorderForTableAndCells: i.offsetTop === 5 }, g.style.position = "fixed", g.style.top = "20px", j.fixedPosition = g.offsetTop === 20 || g.offsetTop === 15, g.style.position = g.style.top = "", e.style.overflow = "hidden", e.style.position = "relative", j.subtractsBorderForOverflowNotVisible = g.offsetTop === -5, j.doesNotIncludeMarginInBodyOffset = u.offsetTop !== m, a.getComputedStyle && (p.style.marginTop = "1%", b.pixelMargin = (a.getComputedStyle(p, null) || { marginTop: 0 }).marginTop !== "1%"), typeof d.style.zoom != "undefined" && (d.style.zoom = 1), u.removeChild(d), l = p = d = null, f.extend(b, j)) }); return b }(); var j = /^(?:\{.*\}|\[.*\])$/, k = /([A-Z])/g; f.extend({ cache: {}, uuid: 0, expando: "jQuery" + (f.fn.jquery + Math.random()).replace(/\D/g, ""), noData: { embed: !0, object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000", applet: !0 }, hasData: function (a) { a = a.nodeType ? f.cache[a[f.expando]] : a[f.expando]; return !!a && !m(a) }, data: function (a, c, d, e) { if (!!f.acceptData(a)) { var g, h, i, j = f.expando, k = typeof c == "string", l = a.nodeType, m = l ? f.cache : a, n = l ? a[j] : a[j] && j, o = c === "events"; if ((!n || !m[n] || !o && !e && !m[n].data) && k && d === b) return; n || (l ? a[j] = n = ++f.uuid : n = j), m[n] || (m[n] = {}, l || (m[n].toJSON = f.noop)); if (typeof c == "object" || typeof c == "function") e ? m[n] = f.extend(m[n], c) : m[n].data = f.extend(m[n].data, c); g = h = m[n], e || (h.data || (h.data = {}), h = h.data), d !== b && (h[f.camelCase(c)] = d); if (o && !h[c]) return g.events; k ? (i = h[c], i == null && (i = h[f.camelCase(c)])) : i = h; return i } }, removeData: function (a, b, c) { if (!!f.acceptData(a)) { var d, e, g, h = f.expando, i = a.nodeType, j = i ? f.cache : a, k = i ? a[h] : h; if (!j[k]) return; if (b) { d = c ? j[k] : j[k].data; if (d) { f.isArray(b) || (b in d ? b = [b] : (b = f.camelCase(b), b in d ? b = [b] : b = b.split(" "))); for (e = 0, g = b.length; e < g; e++)delete d[b[e]]; if (!(c ? m : f.isEmptyObject)(d)) return } } if (!c) { delete j[k].data; if (!m(j[k])) return } f.support.deleteExpando || !j.setInterval ? delete j[k] : j[k] = null, i && (f.support.deleteExpando ? delete a[h] : a.removeAttribute ? a.removeAttribute(h) : a[h] = null) } }, _data: function (a, b, c) { return f.data(a, b, c, !0) }, acceptData: function (a) { if (a.nodeName) { var b = f.noData[a.nodeName.toLowerCase()]; if (b) return b !== !0 && a.getAttribute("classid") === b } return !0 } }), f.fn.extend({ data: function (a, c) { var d, e, g, h, i, j = this[0], k = 0, m = null; if (a === b) { if (this.length) { m = f.data(j); if (j.nodeType === 1 && !f._data(j, "parsedAttrs")) { g = j.attributes; for (i = g.length; k < i; k++)h = g[k].name, h.indexOf("data-") === 0 && (h = f.camelCase(h.substring(5)), l(j, h, m[h])); f._data(j, "parsedAttrs", !0) } } return m } if (typeof a == "object") return this.each(function () { f.data(this, a) }); d = a.split(".", 2), d[1] = d[1] ? "." + d[1] : "", e = d[1] + "!"; return f.access(this, function (c) { if (c === b) { m = this.triggerHandler("getData" + e, [d[0]]), m === b && j && (m = f.data(j, a), m = l(j, a, m)); return m === b && d[1] ? this.data(d[0]) : m } d[1] = c, this.each(function () { var b = f(this); b.triggerHandler("setData" + e, d), f.data(this, a, c), b.triggerHandler("changeData" + e, d) }) }, null, c, arguments.length > 1, null, !1) }, removeData: function (a) { return this.each(function () { f.removeData(this, a) }) } }), f.extend({ _mark: function (a, b) { a && (b = (b || "fx") + "mark", f._data(a, b, (f._data(a, b) || 0) + 1)) }, _unmark: function (a, b, c) { a !== !0 && (c = b, b = a, a = !1); if (b) { c = c || "fx"; var d = c + "mark", e = a ? 0 : (f._data(b, d) || 1) - 1; e ? f._data(b, d, e) : (f.removeData(b, d, !0), n(b, c, "mark")) } }, queue: function (a, b, c) { var d; if (a) { b = (b || "fx") + "queue", d = f._data(a, b), c && (!d || f.isArray(c) ? d = f._data(a, b, f.makeArray(c)) : d.push(c)); return d || [] } }, dequeue: function (a, b) { b = b || "fx"; var c = f.queue(a, b), d = c.shift(), e = {}; d === "inprogress" && (d = c.shift()), d && (b === "fx" && c.unshift("inprogress"), f._data(a, b + ".run", e), d.call(a, function () { f.dequeue(a, b) }, e)), c.length || (f.removeData(a, b + "queue " + b + ".run", !0), n(a, b, "queue")) } }), f.fn.extend({ queue: function (a, c) { var d = 2; typeof a != "string" && (c = a, a = "fx", d--); if (arguments.length < d) return f.queue(this[0], a); return c === b ? this : this.each(function () { var b = f.queue(this, a, c); a === "fx" && b[0] !== "inprogress" && f.dequeue(this, a) }) }, dequeue: function (a) { return this.each(function () { f.dequeue(this, a) }) }, delay: function (a, b) { a = f.fx ? f.fx.speeds[a] || a : a, b = b || "fx"; return this.queue(b, function (b, c) { var d = setTimeout(b, a); c.stop = function () { clearTimeout(d) } }) }, clearQueue: function (a) { return this.queue(a || "fx", []) }, promise: function (a, c) { function m() { --h || d.resolveWith(e, [e]) } typeof a != "string" && (c = a, a = b), a = a || "fx"; var d = f.Deferred(), e = this, g = e.length, h = 1, i = a + "defer", j = a + "queue", k = a + "mark", l; while (g--) if (l = f.data(e[g], i, b, !0) || (f.data(e[g], j, b, !0) || f.data(e[g], k, b, !0)) && f.data(e[g], i, f.Callbacks("once memory"), !0)) h++, l.add(m); m(); return d.promise(c) } }); var o = /[\n\t\r]/g, p = /\s+/, q = /\r/g, r = /^(?:button|input)$/i, s = /^(?:button|input|object|select|textarea)$/i, t = /^a(?:rea)?$/i, u = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i, v = f.support.getSetAttribute, w, x, y; f.fn.extend({ attr: function (a, b) { return f.access(this, f.attr, a, b, arguments.length > 1) }, removeAttr: function (a) { return this.each(function () { f.removeAttr(this, a) }) }, prop: function (a, b) { return f.access(this, f.prop, a, b, arguments.length > 1) }, removeProp: function (a) { a = f.propFix[a] || a; return this.each(function () { try { this[a] = b, delete this[a] } catch (c) { } }) }, addClass: function (a) { var b, c, d, e, g, h, i; if (f.isFunction(a)) return this.each(function (b) { f(this).addClass(a.call(this, b, this.className)) }); if (a && typeof a == "string") { b = a.split(p); for (c = 0, d = this.length; c < d; c++) { e = this[c]; if (e.nodeType === 1) if (!e.className && b.length === 1) e.className = a; else { g = " " + e.className + " "; for (h = 0, i = b.length; h < i; h++)~g.indexOf(" " + b[h] + " ") || (g += b[h] + " "); e.className = f.trim(g) } } } return this }, removeClass: function (a) { var c, d, e, g, h, i, j; if (f.isFunction(a)) return this.each(function (b) { f(this).removeClass(a.call(this, b, this.className)) }); if (a && typeof a == "string" || a === b) { c = (a || "").split(p); for (d = 0, e = this.length; d < e; d++) { g = this[d]; if (g.nodeType === 1 && g.className) if (a) { h = (" " + g.className + " ").replace(o, " "); for (i = 0, j = c.length; i < j; i++)h = h.replace(" " + c[i] + " ", " "); g.className = f.trim(h) } else g.className = "" } } return this }, toggleClass: function (a, b) { var c = typeof a, d = typeof b == "boolean"; if (f.isFunction(a)) return this.each(function (c) { f(this).toggleClass(a.call(this, c, this.className, b), b) }); return this.each(function () { if (c === "string") { var e, g = 0, h = f(this), i = b, j = a.split(p); while (e = j[g++]) i = d ? i : !h.hasClass(e), h[i ? "addClass" : "removeClass"](e) } else if (c === "undefined" || c === "boolean") this.className && f._data(this, "__className__", this.className), this.className = this.className || a === !1 ? "" : f._data(this, "__className__") || "" }) }, hasClass: function (a) { var b = " " + a + " ", c = 0, d = this.length; for (; c < d; c++)if (this[c].nodeType === 1 && (" " + this[c].className + " ").replace(o, " ").indexOf(b) > -1) return !0; return !1 }, val: function (a) { var c, d, e, g = this[0]; { if (!!arguments.length) { e = f.isFunction(a); return this.each(function (d) { var g = f(this), h; if (this.nodeType === 1) { e ? h = a.call(this, d, g.val()) : h = a, h == null ? h = "" : typeof h == "number" ? h += "" : f.isArray(h) && (h = f.map(h, function (a) { return a == null ? "" : a + "" })), c = f.valHooks[this.type] || f.valHooks[this.nodeName.toLowerCase()]; if (!c || !("set" in c) || c.set(this, h, "value") === b) this.value = h } }) } if (g) { c = f.valHooks[g.type] || f.valHooks[g.nodeName.toLowerCase()]; if (c && "get" in c && (d = c.get(g, "value")) !== b) return d; d = g.value; return typeof d == "string" ? d.replace(q, "") : d == null ? "" : d } } } }), f.extend({ valHooks: { option: { get: function (a) { var b = a.attributes.value; return !b || b.specified ? a.value : a.text } }, select: { get: function (a) { var b, c, d, e, g = a.selectedIndex, h = [], i = a.options, j = a.type === "select-one"; if (g < 0) return null; c = j ? g : 0, d = j ? g + 1 : i.length; for (; c < d; c++) { e = i[c]; if (e.selected && (f.support.optDisabled ? !e.disabled : e.getAttribute("disabled") === null) && (!e.parentNode.disabled || !f.nodeName(e.parentNode, "optgroup"))) { b = f(e).val(); if (j) return b; h.push(b) } } if (j && !h.length && i.length) return f(i[g]).val(); return h }, set: function (a, b) { var c = f.makeArray(b); f(a).find("option").each(function () { this.selected = f.inArray(f(this).val(), c) >= 0 }), c.length || (a.selectedIndex = -1); return c } } }, attrFn: { val: !0, css: !0, html: !0, text: !0, data: !0, width: !0, height: !0, offset: !0 }, attr: function (a, c, d, e) { var g, h, i, j = a.nodeType; if (!!a && j !== 3 && j !== 8 && j !== 2) { if (e && c in f.attrFn) return f(a)[c](d); if (typeof a.getAttribute == "undefined") return f.prop(a, c, d); i = j !== 1 || !f.isXMLDoc(a), i && (c = c.toLowerCase(), h = f.attrHooks[c] || (u.test(c) ? x : w)); if (d !== b) { if (d === null) { f.removeAttr(a, c); return } if (h && "set" in h && i && (g = h.set(a, d, c)) !== b) return g; a.setAttribute(c, "" + d); return d } if (h && "get" in h && i && (g = h.get(a, c)) !== null) return g; g = a.getAttribute(c); return g === null ? b : g } }, removeAttr: function (a, b) { var c, d, e, g, h, i = 0; if (b && a.nodeType === 1) { d = b.toLowerCase().split(p), g = d.length; for (; i < g; i++)e = d[i], e && (c = f.propFix[e] || e, h = u.test(e), h || f.attr(a, e, ""), a.removeAttribute(v ? e : c), h && c in a && (a[c] = !1)) } }, attrHooks: { type: { set: function (a, b) { if (r.test(a.nodeName) && a.parentNode) f.error("type property can't be changed"); else if (!f.support.radioValue && b === "radio" && f.nodeName(a, "input")) { var c = a.value; a.setAttribute("type", b), c && (a.value = c); return b } } }, value: { get: function (a, b) { if (w && f.nodeName(a, "button")) return w.get(a, b); return b in a ? a.value : null }, set: function (a, b, c) { if (w && f.nodeName(a, "button")) return w.set(a, b, c); a.value = b } } }, propFix: { tabindex: "tabIndex", readonly: "readOnly", for: "htmlFor", class: "className", maxlength: "maxLength", cellspacing: "cellSpacing", cellpadding: "cellPadding", rowspan: "rowSpan", colspan: "colSpan", usemap: "useMap", frameborder: "frameBorder", contenteditable: "contentEditable" }, prop: function (a, c, d) { var e, g, h, i = a.nodeType; if (!!a && i !== 3 && i !== 8 && i !== 2) { h = i !== 1 || !f.isXMLDoc(a), h && (c = f.propFix[c] || c, g = f.propHooks[c]); return d !== b ? g && "set" in g && (e = g.set(a, d, c)) !== b ? e : a[c] = d : g && "get" in g && (e = g.get(a, c)) !== null ? e : a[c] } }, propHooks: { tabIndex: { get: function (a) { var c = a.getAttributeNode("tabindex"); return c && c.specified ? parseInt(c.value, 10) : s.test(a.nodeName) || t.test(a.nodeName) && a.href ? 0 : b } } } }), f.attrHooks.tabindex = f.propHooks.tabIndex, x = { get: function (a, c) { var d, e = f.prop(a, c); return e === !0 || typeof e != "boolean" && (d = a.getAttributeNode(c)) && d.nodeValue !== !1 ? c.toLowerCase() : b }, set: function (a, b, c) { var d; b === !1 ? f.removeAttr(a, c) : (d = f.propFix[c] || c, d in a && (a[d] = !0), a.setAttribute(c, c.toLowerCase())); return c } }, v || (y = { name: !0, id: !0, coords: !0 }, w = f.valHooks.button = { get: function (a, c) { var d; d = a.getAttributeNode(c); return d && (y[c] ? d.nodeValue !== "" : d.specified) ? d.nodeValue : b }, set: function (a, b, d) { var e = a.getAttributeNode(d); e || (e = c.createAttribute(d), a.setAttributeNode(e)); return e.nodeValue = b + "" } }, f.attrHooks.tabindex.set = w.set, f.each(["width", "height"], function (a, b) { f.attrHooks[b] = f.extend(f.attrHooks[b], { set: function (a, c) { if (c === "") { a.setAttribute(b, "auto"); return c } } }) }), f.attrHooks.contenteditable = { get: w.get, set: function (a, b, c) { b === "" && (b = "false"), w.set(a, b, c) } }), f.support.hrefNormalized || f.each(["href", "src", "width", "height"], function (a, c) { f.attrHooks[c] = f.extend(f.attrHooks[c], { get: function (a) { var d = a.getAttribute(c, 2); return d === null ? b : d } }) }), f.support.style || (f.attrHooks.style = { get: function (a) { return a.style.cssText.toLowerCase() || b }, set: function (a, b) { return a.style.cssText = "" + b } }), f.support.optSelected || (f.propHooks.selected = f.extend(f.propHooks.selected, { get: function (a) { var b = a.parentNode; b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex); return null } })), f.support.enctype || (f.propFix.enctype = "encoding"), f.support.checkOn || f.each(["radio", "checkbox"], function () { f.valHooks[this] = { get: function (a) { return a.getAttribute("value") === null ? "on" : a.value } } }), f.each(["radio", "checkbox"], function () { f.valHooks[this] = f.extend(f.valHooks[this], { set: function (a, b) { if (f.isArray(b)) return a.checked = f.inArray(f(a).val(), b) >= 0 } }) }); var z = /^(?:textarea|input|select)$/i, A = /^([^\.]*)?(?:\.(.+))?$/, B = /(?:^|\s)hover(\.\S+)?\b/, C = /^key/, D = /^(?:mouse|contextmenu)|click/, E = /^(?:focusinfocus|focusoutblur)$/, F = /^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/, G = function (a) { var b = F.exec(a); b && (b[1] = (b[1] || "").toLowerCase(), b[3] = b[3] && new RegExp("(?:^|\\s)" + b[3] + "(?:\\s|$)")); return b }, H = function (a, b) { var c = a.attributes || {}; return (!b[1] || a.nodeName.toLowerCase() === b[1]) && (!b[2] || (c.id || {}).value === b[2]) && (!b[3] || b[3].test((c["class"] || {}).value)) }, I = function (a) { return f.event.special.hover ? a : a.replace(B, "mouseenter$1 mouseleave$1") }; f.event = { add: function (a, c, d, e, g) { var h, i, j, k, l, m, n, o, p, q, r, s; if (!(a.nodeType === 3 || a.nodeType === 8 || !c || !d || !(h = f._data(a)))) { d.handler && (p = d, d = p.handler, g = p.selector), d.guid || (d.guid = f.guid++), j = h.events, j || (h.events = j = {}), i = h.handle, i || (h.handle = i = function (a) { return typeof f != "undefined" && (!a || f.event.triggered !== a.type) ? f.event.dispatch.apply(i.elem, arguments) : b }, i.elem = a), c = f.trim(I(c)).split(" "); for (k = 0; k < c.length; k++) { l = A.exec(c[k]) || [], m = l[1], n = (l[2] || "").split(".").sort(), s = f.event.special[m] || {}, m = (g ? s.delegateType : s.bindType) || m, s = f.event.special[m] || {}, o = f.extend({ type: m, origType: l[1], data: e, handler: d, guid: d.guid, selector: g, quick: g && G(g), namespace: n.join(".") }, p), r = j[m]; if (!r) { r = j[m] = [], r.delegateCount = 0; if (!s.setup || s.setup.call(a, e, n, i) === !1) a.addEventListener ? a.addEventListener(m, i, !1) : a.attachEvent && a.attachEvent("on" + m, i) } s.add && (s.add.call(a, o), o.handler.guid || (o.handler.guid = d.guid)), g ? r.splice(r.delegateCount++, 0, o) : r.push(o), f.event.global[m] = !0 } a = null } }, global: {}, remove: function (a, b, c, d, e) { var g = f.hasData(a) && f._data(a), h, i, j, k, l, m, n, o, p, q, r, s; if (!!g && !!(o = g.events)) { b = f.trim(I(b || "")).split(" "); for (h = 0; h < b.length; h++) { i = A.exec(b[h]) || [], j = k = i[1], l = i[2]; if (!j) { for (j in o) f.event.remove(a, j + b[h], c, d, !0); continue } p = f.event.special[j] || {}, j = (d ? p.delegateType : p.bindType) || j, r = o[j] || [], m = r.length, l = l ? new RegExp("(^|\\.)" + l.split(".").sort().join("\\.(?:.*\\.)?") + "(\\.|$)") : null; for (n = 0; n < r.length; n++)s = r[n], (e || k === s.origType) && (!c || c.guid === s.guid) && (!l || l.test(s.namespace)) && (!d || d === s.selector || d === "**" && s.selector) && (r.splice(n--, 1), s.selector && r.delegateCount--, p.remove && p.remove.call(a, s)); r.length === 0 && m !== r.length && ((!p.teardown || p.teardown.call(a, l) === !1) && f.removeEvent(a, j, g.handle), delete o[j]) } f.isEmptyObject(o) && (q = g.handle, q && (q.elem = null), f.removeData(a, ["events", "handle"], !0)) } }, customEvent: { getData: !0, setData: !0, changeData: !0 }, trigger: function (c, d, e, g) { if (!e || e.nodeType !== 3 && e.nodeType !== 8) { var h = c.type || c, i = [], j, k, l, m, n, o, p, q, r, s; if (E.test(h + f.event.triggered)) return; h.indexOf("!") >= 0 && (h = h.slice(0, -1), k = !0), h.indexOf(".") >= 0 && (i = h.split("."), h = i.shift(), i.sort()); if ((!e || f.event.customEvent[h]) && !f.event.global[h]) return; c = typeof c == "object" ? c[f.expando] ? c : new f.Event(h, c) : new f.Event(h), c.type = h, c.isTrigger = !0, c.exclusive = k, c.namespace = i.join("."), c.namespace_re = c.namespace ? new RegExp("(^|\\.)" + i.join("\\.(?:.*\\.)?") + "(\\.|$)") : null, o = h.indexOf(":") < 0 ? "on" + h : ""; if (!e) { j = f.cache; for (l in j) j[l].events && j[l].events[h] && f.event.trigger(c, d, j[l].handle.elem, !0); return } c.result = b, c.target || (c.target = e), d = d != null ? f.makeArray(d) : [], d.unshift(c), p = f.event.special[h] || {}; if (p.trigger && p.trigger.apply(e, d) === !1) return; r = [[e, p.bindType || h]]; if (!g && !p.noBubble && !f.isWindow(e)) { s = p.delegateType || h, m = E.test(s + h) ? e : e.parentNode, n = null; for (; m; m = m.parentNode)r.push([m, s]), n = m; n && n === e.ownerDocument && r.push([n.defaultView || n.parentWindow || a, s]) } for (l = 0; l < r.length && !c.isPropagationStopped(); l++)m = r[l][0], c.type = r[l][1], q = (f._data(m, "events") || {})[c.type] && f._data(m, "handle"), q && q.apply(m, d), q = o && m[o], q && f.acceptData(m) && q.apply(m, d) === !1 && c.preventDefault(); c.type = h, !g && !c.isDefaultPrevented() && (!p._default || p._default.apply(e.ownerDocument, d) === !1) && (h !== "click" || !f.nodeName(e, "a")) && f.acceptData(e) && o && e[h] && (h !== "focus" && h !== "blur" || c.target.offsetWidth !== 0) && !f.isWindow(e) && (n = e[o], n && (e[o] = null), f.event.triggered = h, e[h](), f.event.triggered = b, n && (e[o] = n)); return c.result } }, dispatch: function (c) { c = f.event.fix(c || a.event); var d = (f._data(this, "events") || {})[c.type] || [], e = d.delegateCount, g = [].slice.call(arguments, 0), h = !c.exclusive && !c.namespace, i = f.event.special[c.type] || {}, j = [], k, l, m, n, o, p, q, r, s, t, u; g[0] = c, c.delegateTarget = this; if (!i.preDispatch || i.preDispatch.call(this, c) !== !1) { if (e && (!c.button || c.type !== "click")) { n = f(this), n.context = this.ownerDocument || this; for (m = c.target; m != this; m = m.parentNode || this)if (m.disabled !== !0) { p = {}, r = [], n[0] = m; for (k = 0; k < e; k++)s = d[k], t = s.selector, p[t] === b && (p[t] = s.quick ? H(m, s.quick) : n.is(t)), p[t] && r.push(s); r.length && j.push({ elem: m, matches: r }) } } d.length > e && j.push({ elem: this, matches: d.slice(e) }); for (k = 0; k < j.length && !c.isPropagationStopped(); k++) { q = j[k], c.currentTarget = q.elem; for (l = 0; l < q.matches.length && !c.isImmediatePropagationStopped(); l++) { s = q.matches[l]; if (h || !c.namespace && !s.namespace || c.namespace_re && c.namespace_re.test(s.namespace)) c.data = s.data, c.handleObj = s, o = ((f.event.special[s.origType] || {}).handle || s.handler).apply(q.elem, g), o !== b && (c.result = o, o === !1 && (c.preventDefault(), c.stopPropagation())) } } i.postDispatch && i.postDispatch.call(this, c); return c.result } }, props: "attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks: {}, keyHooks: { props: "char charCode key keyCode".split(" "), filter: function (a, b) { a.which == null && (a.which = b.charCode != null ? b.charCode : b.keyCode); return a } }, mouseHooks: { props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter: function (a, d) { var e, f, g, h = d.button, i = d.fromElement; a.pageX == null && d.clientX != null && (e = a.target.ownerDocument || c, f = e.documentElement, g = e.body, a.pageX = d.clientX + (f && f.scrollLeft || g && g.scrollLeft || 0) - (f && f.clientLeft || g && g.clientLeft || 0), a.pageY = d.clientY + (f && f.scrollTop || g && g.scrollTop || 0) - (f && f.clientTop || g && g.clientTop || 0)), !a.relatedTarget && i && (a.relatedTarget = i === a.target ? d.toElement : i), !a.which && h !== b && (a.which = h & 1 ? 1 : h & 2 ? 3 : h & 4 ? 2 : 0); return a } }, fix: function (a) { if (a[f.expando]) return a; var d, e, g = a, h = f.event.fixHooks[a.type] || {}, i = h.props ? this.props.concat(h.props) : this.props; a = f.Event(g); for (d = i.length; d;)e = i[--d], a[e] = g[e]; a.target || (a.target = g.srcElement || c), a.target.nodeType === 3 && (a.target = a.target.parentNode), a.metaKey === b && (a.metaKey = a.ctrlKey); return h.filter ? h.filter(a, g) : a }, special: { ready: { setup: f.bindReady }, load: { noBubble: !0 }, focus: { delegateType: "focusin" }, blur: { delegateType: "focusout" }, beforeunload: { setup: function (a, b, c) { f.isWindow(this) && (this.onbeforeunload = c) }, teardown: function (a, b) { this.onbeforeunload === b && (this.onbeforeunload = null) } } }, simulate: function (a, b, c, d) { var e = f.extend(new f.Event, c, { type: a, isSimulated: !0, originalEvent: {} }); d ? f.event.trigger(e, null, b) : f.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault() } }, f.event.handle = f.event.dispatch, f.removeEvent = c.removeEventListener ? function (a, b, c) { a.removeEventListener && a.removeEventListener(b, c, !1) } : function (a, b, c) { a.detachEvent && a.detachEvent("on" + b, c) }, f.Event = function (a, b) { if (!(this instanceof f.Event)) return new f.Event(a, b); a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || a.returnValue === !1 || a.getPreventDefault && a.getPreventDefault() ? K : J) : this.type = a, b && f.extend(this, b), this.timeStamp = a && a.timeStamp || f.now(), this[f.expando] = !0 }, f.Event.prototype = { preventDefault: function () { this.isDefaultPrevented = K; var a = this.originalEvent; !a || (a.preventDefault ? a.preventDefault() : a.returnValue = !1) }, stopPropagation: function () { this.isPropagationStopped = K; var a = this.originalEvent; !a || (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0) }, stopImmediatePropagation: function () { this.isImmediatePropagationStopped = K, this.stopPropagation() }, isDefaultPrevented: J, isPropagationStopped: J, isImmediatePropagationStopped: J }, f.each({ mouseenter: "mouseover", mouseleave: "mouseout" }, function (a, b) { f.event.special[a] = { delegateType: b, bindType: b, handle: function (a) { var c = this, d = a.relatedTarget, e = a.handleObj, g = e.selector, h; if (!d || d !== c && !f.contains(c, d)) a.type = e.origType, h = e.handler.apply(this, arguments), a.type = b; return h } } }), f.support.submitBubbles || (f.event.special.submit = { setup: function () { if (f.nodeName(this, "form")) return !1; f.event.add(this, "click._submit keypress._submit", function (a) { var c = a.target, d = f.nodeName(c, "input") || f.nodeName(c, "button") ? c.form : b; d && !d._submit_attached && (f.event.add(d, "submit._submit", function (a) { a._submit_bubble = !0 }), d._submit_attached = !0) }) }, postDispatch: function (a) { a._submit_bubble && (delete a._submit_bubble, this.parentNode && !a.isTrigger && f.event.simulate("submit", this.parentNode, a, !0)) }, teardown: function () { if (f.nodeName(this, "form")) return !1; f.event.remove(this, "._submit") } }), f.support.changeBubbles || (f.event.special.change = { setup: function () { if (z.test(this.nodeName)) { if (this.type === "checkbox" || this.type === "radio") f.event.add(this, "propertychange._change", function (a) { a.originalEvent.propertyName === "checked" && (this._just_changed = !0) }), f.event.add(this, "click._change", function (a) { this._just_changed && !a.isTrigger && (this._just_changed = !1, f.event.simulate("change", this, a, !0)) }); return !1 } f.event.add(this, "beforeactivate._change", function (a) { var b = a.target; z.test(b.nodeName) && !b._change_attached && (f.event.add(b, "change._change", function (a) { this.parentNode && !a.isSimulated && !a.isTrigger && f.event.simulate("change", this.parentNode, a, !0) }), b._change_attached = !0) }) }, handle: function (a) { var b = a.target; if (this !== b || a.isSimulated || a.isTrigger || b.type !== "radio" && b.type !== "checkbox") return a.handleObj.handler.apply(this, arguments) }, teardown: function () { f.event.remove(this, "._change"); return z.test(this.nodeName) } }), f.support.focusinBubbles || f.each({ focus: "focusin", blur: "focusout" }, function (a, b) { var d = 0, e = function (a) { f.event.simulate(b, a.target, f.event.fix(a), !0) }; f.event.special[b] = { setup: function () { d++ === 0 && c.addEventListener(a, e, !0) }, teardown: function () { --d === 0 && c.removeEventListener(a, e, !0) } } }), f.fn.extend({ on: function (a, c, d, e, g) { var h, i; if (typeof a == "object") { typeof c != "string" && (d = d || c, c = b); for (i in a) this.on(i, c, d, a[i], g); return this } d == null && e == null ? (e = c, d = c = b) : e == null && (typeof c == "string" ? (e = d, d = b) : (e = d, d = c, c = b)); if (e === !1) e = J; else if (!e) return this; g === 1 && (h = e, e = function (a) { f().off(a); return h.apply(this, arguments) }, e.guid = h.guid || (h.guid = f.guid++)); return this.each(function () { f.event.add(this, a, e, d, c) }) }, one: function (a, b, c, d) { return this.on(a, b, c, d, 1) }, off: function (a, c, d) { if (a && a.preventDefault && a.handleObj) { var e = a.handleObj; f(a.delegateTarget).off(e.namespace ? e.origType + "." + e.namespace : e.origType, e.selector, e.handler); return this } if (typeof a == "object") { for (var g in a) this.off(g, c, a[g]); return this } if (c === !1 || typeof c == "function") d = c, c = b; d === !1 && (d = J); return this.each(function () { f.event.remove(this, a, d, c) }) }, bind: function (a, b, c) { return this.on(a, null, b, c) }, unbind: function (a, b) { return this.off(a, null, b) }, live: function (a, b, c) { f(this.context).on(a, this.selector, b, c); return this }, die: function (a, b) { f(this.context).off(a, this.selector || "**", b); return this }, delegate: function (a, b, c, d) { return this.on(b, a, c, d) }, undelegate: function (a, b, c) { return arguments.length == 1 ? this.off(a, "**") : this.off(b, a, c) }, trigger: function (a, b) { return this.each(function () { f.event.trigger(a, b, this) }) }, triggerHandler: function (a, b) { if (this[0]) return f.event.trigger(a, b, this[0], !0) }, toggle: function (a) { var b = arguments, c = a.guid || f.guid++, d = 0, e = function (c) { var e = (f._data(this, "lastToggle" + a.guid) || 0) % d; f._data(this, "lastToggle" + a.guid, e + 1), c.preventDefault(); return b[e].apply(this, arguments) || !1 }; e.guid = c; while (d < b.length) b[d++].guid = c; return this.click(e) }, hover: function (a, b) { return this.mouseenter(a).mouseleave(b || a) } }), f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function (a, b) { f.fn[b] = function (a, c) { c == null && (c = a, a = null); return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b) }, f.attrFn && (f.attrFn[b] = !0), C.test(b) && (f.event.fixHooks[b] = f.event.keyHooks), D.test(b) && (f.event.fixHooks[b] = f.event.mouseHooks) }), function () { function x(a, b, c, e, f, g) { for (var h = 0, i = e.length; h < i; h++) { var j = e[h]; if (j) { var k = !1; j = j[a]; while (j) { if (j[d] === c) { k = e[j.sizset]; break } if (j.nodeType === 1) { g || (j[d] = c, j.sizset = h); if (typeof b != "string") { if (j === b) { k = !0; break } } else if (m.filter(b, [j]).length > 0) { k = j; break } } j = j[a] } e[h] = k } } } function w(a, b, c, e, f, g) { for (var h = 0, i = e.length; h < i; h++) { var j = e[h]; if (j) { var k = !1; j = j[a]; while (j) { if (j[d] === c) { k = e[j.sizset]; break } j.nodeType === 1 && !g && (j[d] = c, j.sizset = h); if (j.nodeName.toLowerCase() === b) { k = j; break } j = j[a] } e[h] = k } } } var a = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, d = "sizcache" + (Math.random() + "").replace(".", ""), e = 0, g = Object.prototype.toString, h = !1, i = !0, j = /\\/g, k = /\r\n/g, l = /\W/;[0, 0].sort(function () { i = !1; return 0 }); var m = function (b, d, e, f) { e = e || [], d = d || c; var h = d; if (d.nodeType !== 1 && d.nodeType !== 9) return []; if (!b || typeof b != "string") return e; var i, j, k, l, n, q, r, t, u = !0, v = m.isXML(d), w = [], x = b; do { a.exec(""), i = a.exec(x); if (i) { x = i[3], w.push(i[1]); if (i[2]) { l = i[3]; break } } } while (i); if (w.length > 1 && p.exec(b)) if (w.length === 2 && o.relative[w[0]]) j = y(w[0] + w[1], d, f); else { j = o.relative[w[0]] ? [d] : m(w.shift(), d); while (w.length) b = w.shift(), o.relative[b] && (b += w.shift()), j = y(b, j, f) } else { !f && w.length > 1 && d.nodeType === 9 && !v && o.match.ID.test(w[0]) && !o.match.ID.test(w[w.length - 1]) && (n = m.find(w.shift(), d, v), d = n.expr ? m.filter(n.expr, n.set)[0] : n.set[0]); if (d) { n = f ? { expr: w.pop(), set: s(f) } : m.find(w.pop(), w.length === 1 && (w[0] === "~" || w[0] === "+") && d.parentNode ? d.parentNode : d, v), j = n.expr ? m.filter(n.expr, n.set) : n.set, w.length > 0 ? k = s(j) : u = !1; while (w.length) q = w.pop(), r = q, o.relative[q] ? r = w.pop() : q = "", r == null && (r = d), o.relative[q](k, r, v) } else k = w = [] } k || (k = j), k || m.error(q || b); if (g.call(k) === "[object Array]") if (!u) e.push.apply(e, k); else if (d && d.nodeType === 1) for (t = 0; k[t] != null; t++)k[t] && (k[t] === !0 || k[t].nodeType === 1 && m.contains(d, k[t])) && e.push(j[t]); else for (t = 0; k[t] != null; t++)k[t] && k[t].nodeType === 1 && e.push(j[t]); else s(k, e); l && (m(l, h, e, f), m.uniqueSort(e)); return e }; m.uniqueSort = function (a) { if (u) { h = i, a.sort(u); if (h) for (var b = 1; b < a.length; b++)a[b] === a[b - 1] && a.splice(b--, 1) } return a }, m.matches = function (a, b) { return m(a, null, null, b) }, m.matchesSelector = function (a, b) { return m(b, null, null, [a]).length > 0 }, m.find = function (a, b, c) { var d, e, f, g, h, i; if (!a) return []; for (e = 0, f = o.order.length; e < f; e++) { h = o.order[e]; if (g = o.leftMatch[h].exec(a)) { i = g[1], g.splice(1, 1); if (i.substr(i.length - 1) !== "\\") { g[1] = (g[1] || "").replace(j, ""), d = o.find[h](g, b, c); if (d != null) { a = a.replace(o.match[h], ""); break } } } } d || (d = typeof b.getElementsByTagName != "undefined" ? b.getElementsByTagName("*") : []); return { set: d, expr: a } }, m.filter = function (a, c, d, e) { var f, g, h, i, j, k, l, n, p, q = a, r = [], s = c, t = c && c[0] && m.isXML(c[0]); while (a && c.length) { for (h in o.filter) if ((f = o.leftMatch[h].exec(a)) != null && f[2]) { k = o.filter[h], l = f[1], g = !1, f.splice(1, 1); if (l.substr(l.length - 1) === "\\") continue; s === r && (r = []); if (o.preFilter[h]) { f = o.preFilter[h](f, s, d, r, e, t); if (!f) g = i = !0; else if (f === !0) continue } if (f) for (n = 0; (j = s[n]) != null; n++)j && (i = k(j, f, n, s), p = e ^ i, d && i != null ? p ? g = !0 : s[n] = !1 : p && (r.push(j), g = !0)); if (i !== b) { d || (s = r), a = a.replace(o.match[h], ""); if (!g) return []; break } } if (a === q) if (g == null) m.error(a); else break; q = a } return s }, m.error = function (a) { throw new Error("Syntax error, unrecognized expression: " + a) }; var n = m.getText = function (a) { var b, c, d = a.nodeType, e = ""; if (d) { if (d === 1 || d === 9 || d === 11) { if (typeof a.textContent == "string") return a.textContent; if (typeof a.innerText == "string") return a.innerText.replace(k, ""); for (a = a.firstChild; a; a = a.nextSibling)e += n(a) } else if (d === 3 || d === 4) return a.nodeValue } else for (b = 0; c = a[b]; b++)c.nodeType !== 8 && (e += n(c)); return e }, o = m.selectors = { order: ["ID", "NAME", "TAG"], match: { ID: /#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, CLASS: /\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, NAME: /\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/, ATTR: /\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/, TAG: /^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/, CHILD: /:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/, POS: /:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/, PSEUDO: /:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/ }, leftMatch: {}, attrMap: { class: "className", for: "htmlFor" }, attrHandle: { href: function (a) { return a.getAttribute("href") }, type: function (a) { return a.getAttribute("type") } }, relative: { "+": function (a, b) { var c = typeof b == "string", d = c && !l.test(b), e = c && !d; d && (b = b.toLowerCase()); for (var f = 0, g = a.length, h; f < g; f++)if (h = a[f]) { while ((h = h.previousSibling) && h.nodeType !== 1); a[f] = e || h && h.nodeName.toLowerCase() === b ? h || !1 : h === b } e && m.filter(b, a, !0) }, ">": function (a, b) { var c, d = typeof b == "string", e = 0, f = a.length; if (d && !l.test(b)) { b = b.toLowerCase(); for (; e < f; e++) { c = a[e]; if (c) { var g = c.parentNode; a[e] = g.nodeName.toLowerCase() === b ? g : !1 } } } else { for (; e < f; e++)c = a[e], c && (a[e] = d ? c.parentNode : c.parentNode === b); d && m.filter(b, a, !0) } }, "": function (a, b, c) { var d, f = e++, g = x; typeof b == "string" && !l.test(b) && (b = b.toLowerCase(), d = b, g = w), g("parentNode", b, f, a, d, c) }, "~": function (a, b, c) { var d, f = e++, g = x; typeof b == "string" && !l.test(b) && (b = b.toLowerCase(), d = b, g = w), g("previousSibling", b, f, a, d, c) } }, find: { ID: function (a, b, c) { if (typeof b.getElementById != "undefined" && !c) { var d = b.getElementById(a[1]); return d && d.parentNode ? [d] : [] } }, NAME: function (a, b) { if (typeof b.getElementsByName != "undefined") { var c = [], d = b.getElementsByName(a[1]); for (var e = 0, f = d.length; e < f; e++)d[e].getAttribute("name") === a[1] && c.push(d[e]); return c.length === 0 ? null : c } }, TAG: function (a, b) { if (typeof b.getElementsByTagName != "undefined") return b.getElementsByTagName(a[1]) } }, preFilter: { CLASS: function (a, b, c, d, e, f) { a = " " + a[1].replace(j, "") + " "; if (f) return a; for (var g = 0, h; (h = b[g]) != null; g++)h && (e ^ (h.className && (" " + h.className + " ").replace(/[\t\n\r]/g, " ").indexOf(a) >= 0) ? c || d.push(h) : c && (b[g] = !1)); return !1 }, ID: function (a) { return a[1].replace(j, "") }, TAG: function (a, b) { return a[1].replace(j, "").toLowerCase() }, CHILD: function (a) { if (a[1] === "nth") { a[2] || m.error(a[0]), a[2] = a[2].replace(/^\+|\s*/g, ""); var b = /(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2] === "even" && "2n" || a[2] === "odd" && "2n+1" || !/\D/.test(a[2]) && "0n+" + a[2] || a[2]); a[2] = b[1] + (b[2] || 1) - 0, a[3] = b[3] - 0 } else a[2] && m.error(a[0]); a[0] = e++; return a }, ATTR: function (a, b, c, d, e, f) { var g = a[1] = a[1].replace(j, ""); !f && o.attrMap[g] && (a[1] = o.attrMap[g]), a[4] = (a[4] || a[5] || "").replace(j, ""), a[2] === "~=" && (a[4] = " " + a[4] + " "); return a }, PSEUDO: function (b, c, d, e, f) { if (b[1] === "not") if ((a.exec(b[3]) || "").length > 1 || /^\w/.test(b[3])) b[3] = m(b[3], null, null, c); else { var g = m.filter(b[3], c, d, !0 ^ f); d || e.push.apply(e, g); return !1 } else if (o.match.POS.test(b[0]) || o.match.CHILD.test(b[0])) return !0; return b }, POS: function (a) { a.unshift(!0); return a } }, filters: { enabled: function (a) { return a.disabled === !1 && a.type !== "hidden" }, disabled: function (a) { return a.disabled === !0 }, checked: function (a) { return a.checked === !0 }, selected: function (a) { a.parentNode && a.parentNode.selectedIndex; return a.selected === !0 }, parent: function (a) { return !!a.firstChild }, empty: function (a) { return !a.firstChild }, has: function (a, b, c) { return !!m(c[3], a).length }, header: function (a) { return /h\d/i.test(a.nodeName) }, text: function (a) { var b = a.getAttribute("type"), c = a.type; return a.nodeName.toLowerCase() === "input" && "text" === c && (b === c || b === null) }, radio: function (a) { return a.nodeName.toLowerCase() === "input" && "radio" === a.type }, checkbox: function (a) { return a.nodeName.toLowerCase() === "input" && "checkbox" === a.type }, file: function (a) { return a.nodeName.toLowerCase() === "input" && "file" === a.type }, password: function (a) { return a.nodeName.toLowerCase() === "input" && "password" === a.type }, submit: function (a) { var b = a.nodeName.toLowerCase(); return (b === "input" || b === "button") && "submit" === a.type }, image: function (a) { return a.nodeName.toLowerCase() === "input" && "image" === a.type }, reset: function (a) { var b = a.nodeName.toLowerCase(); return (b === "input" || b === "button") && "reset" === a.type }, button: function (a) { var b = a.nodeName.toLowerCase(); return b === "input" && "button" === a.type || b === "button" }, input: function (a) { return /input|select|textarea|button/i.test(a.nodeName) }, focus: function (a) { return a === a.ownerDocument.activeElement } }, setFilters: { first: function (a, b) { return b === 0 }, last: function (a, b, c, d) { return b === d.length - 1 }, even: function (a, b) { return b % 2 === 0 }, odd: function (a, b) { return b % 2 === 1 }, lt: function (a, b, c) { return b < c[3] - 0 }, gt: function (a, b, c) { return b > c[3] - 0 }, nth: function (a, b, c) { return c[3] - 0 === b }, eq: function (a, b, c) { return c[3] - 0 === b } }, filter: { PSEUDO: function (a, b, c, d) { var e = b[1], f = o.filters[e]; if (f) return f(a, c, b, d); if (e === "contains") return (a.textContent || a.innerText || n([a]) || "").indexOf(b[3]) >= 0; if (e === "not") { var g = b[3]; for (var h = 0, i = g.length; h < i; h++)if (g[h] === a) return !1; return !0 } m.error(e) }, CHILD: function (a, b) { var c, e, f, g, h, i, j, k = b[1], l = a; switch (k) { case "only": case "first": while (l = l.previousSibling) if (l.nodeType === 1) return !1; if (k === "first") return !0; l = a; case "last": while (l = l.nextSibling) if (l.nodeType === 1) return !1; return !0; case "nth": c = b[2], e = b[3]; if (c === 1 && e === 0) return !0; f = b[0], g = a.parentNode; if (g && (g[d] !== f || !a.nodeIndex)) { i = 0; for (l = g.firstChild; l; l = l.nextSibling)l.nodeType === 1 && (l.nodeIndex = ++i); g[d] = f } j = a.nodeIndex - e; return c === 0 ? j === 0 : j % c === 0 && j / c >= 0 } }, ID: function (a, b) { return a.nodeType === 1 && a.getAttribute("id") === b }, TAG: function (a, b) { return b === "*" && a.nodeType === 1 || !!a.nodeName && a.nodeName.toLowerCase() === b }, CLASS: function (a, b) { return (" " + (a.className || a.getAttribute("class")) + " ").indexOf(b) > -1 }, ATTR: function (a, b) { var c = b[1], d = m.attr ? m.attr(a, c) : o.attrHandle[c] ? o.attrHandle[c](a) : a[c] != null ? a[c] : a.getAttribute(c), e = d + "", f = b[2], g = b[4]; return d == null ? f === "!=" : !f && m.attr ? d != null : f === "=" ? e === g : f === "*=" ? e.indexOf(g) >= 0 : f === "~=" ? (" " + e + " ").indexOf(g) >= 0 : g ? f === "!=" ? e !== g : f === "^=" ? e.indexOf(g) === 0 : f === "$=" ? e.substr(e.length - g.length) === g : f === "|=" ? e === g || e.substr(0, g.length + 1) === g + "-" : !1 : e && d !== !1 }, POS: function (a, b, c, d) { var e = b[2], f = o.setFilters[e]; if (f) return f(a, c, b, d) } } }, p = o.match.POS, q = function (a, b) { return "\\" + (b - 0 + 1) }; for (var r in o.match) o.match[r] = new RegExp(o.match[r].source + /(?![^\[]*\])(?![^\(]*\))/.source), o.leftMatch[r] = new RegExp(/(^(?:.|\r|\n)*?)/.source + o.match[r].source.replace(/\\(\d+)/g, q)); o.match.globalPOS = p; var s = function (a, b) { a = Array.prototype.slice.call(a, 0); if (b) { b.push.apply(b, a); return b } return a }; try { Array.prototype.slice.call(c.documentElement.childNodes, 0)[0].nodeType } catch (t) { s = function (a, b) { var c = 0, d = b || []; if (g.call(a) === "[object Array]") Array.prototype.push.apply(d, a); else if (typeof a.length == "number") for (var e = a.length; c < e; c++)d.push(a[c]); else for (; a[c]; c++)d.push(a[c]); return d } } var u, v; c.documentElement.compareDocumentPosition ? u = function (a, b) { if (a === b) { h = !0; return 0 } if (!a.compareDocumentPosition || !b.compareDocumentPosition) return a.compareDocumentPosition ? -1 : 1; return a.compareDocumentPosition(b) & 4 ? -1 : 1 } : (u = function (a, b) { if (a === b) { h = !0; return 0 } if (a.sourceIndex && b.sourceIndex) return a.sourceIndex - b.sourceIndex; var c, d, e = [], f = [], g = a.parentNode, i = b.parentNode, j = g; if (g === i) return v(a, b); if (!g) return -1; if (!i) return 1; while (j) e.unshift(j), j = j.parentNode; j = i; while (j) f.unshift(j), j = j.parentNode; c = e.length, d = f.length; for (var k = 0; k < c && k < d; k++)if (e[k] !== f[k]) return v(e[k], f[k]); return k === c ? v(a, f[k], -1) : v(e[k], b, 1) }, v = function (a, b, c) { if (a === b) return c; var d = a.nextSibling; while (d) { if (d === b) return -1; d = d.nextSibling } return 1 }), function () { var a = c.createElement("div"), d = "script" + (new Date).getTime(), e = c.documentElement; a.innerHTML = "<a name='" + d + "'/>", e.insertBefore(a, e.firstChild), c.getElementById(d) && (o.find.ID = function (a, c, d) { if (typeof c.getElementById != "undefined" && !d) { var e = c.getElementById(a[1]); return e ? e.id === a[1] || typeof e.getAttributeNode != "undefined" && e.getAttributeNode("id").nodeValue === a[1] ? [e] : b : [] } }, o.filter.ID = function (a, b) { var c = typeof a.getAttributeNode != "undefined" && a.getAttributeNode("id"); return a.nodeType === 1 && c && c.nodeValue === b }), e.removeChild(a), e = a = null }(), function () { var a = c.createElement("div"); a.appendChild(c.createComment("")), a.getElementsByTagName("*").length > 0 && (o.find.TAG = function (a, b) { var c = b.getElementsByTagName(a[1]); if (a[1] === "*") { var d = []; for (var e = 0; c[e]; e++)c[e].nodeType === 1 && d.push(c[e]); c = d } return c }), a.innerHTML = "<a href='#'></a>", a.firstChild && typeof a.firstChild.getAttribute != "undefined" && a.firstChild.getAttribute("href") !== "#" && (o.attrHandle.href = function (a) { return a.getAttribute("href", 2) }), a = null }(), c.querySelectorAll && function () { var a = m, b = c.createElement("div"), d = "__sizzle__"; b.innerHTML = "<p class='TEST'></p>"; if (!b.querySelectorAll || b.querySelectorAll(".TEST").length !== 0) { m = function (b, e, f, g) { e = e || c; if (!g && !m.isXML(e)) { var h = /^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b); if (h && (e.nodeType === 1 || e.nodeType === 9)) { if (h[1]) return s(e.getElementsByTagName(b), f); if (h[2] && o.find.CLASS && e.getElementsByClassName) return s(e.getElementsByClassName(h[2]), f) } if (e.nodeType === 9) { if (b === "body" && e.body) return s([e.body], f); if (h && h[3]) { var i = e.getElementById(h[3]); if (!i || !i.parentNode) return s([], f); if (i.id === h[3]) return s([i], f) } try { return s(e.querySelectorAll(b), f) } catch (j) { } } else if (e.nodeType === 1 && e.nodeName.toLowerCase() !== "object") { var k = e, l = e.getAttribute("id"), n = l || d, p = e.parentNode, q = /^\s*[+~]/.test(b); l ? n = n.replace(/'/g, "\\$&") : e.setAttribute("id", n), q && p && (e = e.parentNode); try { if (!q || p) return s(e.querySelectorAll("[id='" + n + "'] " + b), f) } catch (r) { } finally { l || k.removeAttribute("id") } } } return a(b, e, f, g) }; for (var e in a) m[e] = a[e]; b = null } }(), function () { var a = c.documentElement, b = a.matchesSelector || a.mozMatchesSelector || a.webkitMatchesSelector || a.msMatchesSelector; if (b) { var d = !b.call(c.createElement("div"), "div"), e = !1; try { b.call(c.documentElement, "[test!='']:sizzle") } catch (f) { e = !0 } m.matchesSelector = function (a, c) { c = c.replace(/\=\s*([^'"\]]*)\s*\]/g, "='$1']"); if (!m.isXML(a)) try { if (e || !o.match.PSEUDO.test(c) && !/!=/.test(c)) { var f = b.call(a, c); if (f || !d || a.document && a.document.nodeType !== 11) return f } } catch (g) { } return m(c, null, null, [a]).length > 0 } } }(), function () { var a = c.createElement("div"); a.innerHTML = "<div class='test e'></div><div class='test'></div>"; if (!!a.getElementsByClassName && a.getElementsByClassName("e").length !== 0) { a.lastChild.className = "e"; if (a.getElementsByClassName("e").length === 1) return; o.order.splice(1, 0, "CLASS"), o.find.CLASS = function (a, b, c) { if (typeof b.getElementsByClassName != "undefined" && !c) return b.getElementsByClassName(a[1]) }, a = null } }(), c.documentElement.contains ? m.contains = function (a, b) { return a !== b && (a.contains ? a.contains(b) : !0) } : c.documentElement.compareDocumentPosition ? m.contains = function (a, b) { return !!(a.compareDocumentPosition(b) & 16) } : m.contains = function () { return !1 }, m.isXML = function (a) { var b = (a ? a.ownerDocument || a : 0).documentElement; return b ? b.nodeName !== "HTML" : !1 }; var y = function (a, b, c) { var d, e = [], f = "", g = b.nodeType ? [b] : b; while (d = o.match.PSEUDO.exec(a)) f += d[0], a = a.replace(o.match.PSEUDO, ""); a = o.relative[a] ? a + "*" : a; for (var h = 0, i = g.length; h < i; h++)m(a, g[h], e, c); return m.filter(f, e) }; m.attr = f.attr, m.selectors.attrMap = {}, f.find = m, f.expr = m.selectors, f.expr[":"] = f.expr.filters, f.unique = m.uniqueSort, f.text = m.getText, f.isXMLDoc = m.isXML, f.contains = m.contains }(); var L = /Until$/, M = /^(?:parents|prevUntil|prevAll)/, N = /,/, O = /^.[^:#\[\.,]*$/, P = Array.prototype.slice, Q = f.expr.match.globalPOS, R = { children: !0, contents: !0, next: !0, prev: !0 }; f.fn.extend({ find: function (a) { var b = this, c, d; if (typeof a != "string") return f(a).filter(function () { for (c = 0, d = b.length; c < d; c++)if (f.contains(b[c], this)) return !0 }); var e = this.pushStack("", "find", a), g, h, i; for (c = 0, d = this.length; c < d; c++) { g = e.length, f.find(a, this[c], e); if (c > 0) for (h = g; h < e.length; h++)for (i = 0; i < g; i++)if (e[i] === e[h]) { e.splice(h--, 1); break } } return e }, has: function (a) { var b = f(a); return this.filter(function () { for (var a = 0, c = b.length; a < c; a++)if (f.contains(this, b[a])) return !0 }) }, not: function (a) { return this.pushStack(T(this, a, !1), "not", a) }, filter: function (a) { return this.pushStack(T(this, a, !0), "filter", a) }, is: function (a) { return !!a && (typeof a == "string" ? Q.test(a) ? f(a, this.context).index(this[0]) >= 0 : f.filter(a, this).length > 0 : this.filter(a).length > 0) }, closest: function (a, b) { var c = [], d, e, g = this[0]; if (f.isArray(a)) { var h = 1; while (g && g.ownerDocument && g !== b) { for (d = 0; d < a.length; d++)f(g).is(a[d]) && c.push({ selector: a[d], elem: g, level: h }); g = g.parentNode, h++ } return c } var i = Q.test(a) || typeof a != "string" ? f(a, b || this.context) : 0; for (d = 0, e = this.length; d < e; d++) { g = this[d]; while (g) { if (i ? i.index(g) > -1 : f.find.matchesSelector(g, a)) { c.push(g); break } g = g.parentNode; if (!g || !g.ownerDocument || g === b || g.nodeType === 11) break } } c = c.length > 1 ? f.unique(c) : c; return this.pushStack(c, "closest", a) }, index: function (a) { if (!a) return this[0] && this[0].parentNode ? this.prevAll().length : -1; if (typeof a == "string") return f.inArray(this[0], f(a)); return f.inArray(a.jquery ? a[0] : a, this) }, add: function (a, b) { var c = typeof a == "string" ? f(a, b) : f.makeArray(a && a.nodeType ? [a] : a), d = f.merge(this.get(), c); return this.pushStack(S(c[0]) || S(d[0]) ? d : f.unique(d)) }, andSelf: function () { return this.add(this.prevObject) } }), f.each({ parent: function (a) { var b = a.parentNode; return b && b.nodeType !== 11 ? b : null }, parents: function (a) { return f.dir(a, "parentNode") }, parentsUntil: function (a, b, c) { return f.dir(a, "parentNode", c) }, next: function (a) { return f.nth(a, 2, "nextSibling") }, prev: function (a) { return f.nth(a, 2, "previousSibling") }, nextAll: function (a) { return f.dir(a, "nextSibling") }, prevAll: function (a) { return f.dir(a, "previousSibling") }, nextUntil: function (a, b, c) { return f.dir(a, "nextSibling", c) }, prevUntil: function (a, b, c) { return f.dir(a, "previousSibling", c) }, siblings: function (a) { return f.sibling((a.parentNode || {}).firstChild, a) }, children: function (a) { return f.sibling(a.firstChild) }, contents: function (a) { return f.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : f.makeArray(a.childNodes) } }, function (a, b) { f.fn[a] = function (c, d) { var e = f.map(this, b, c); L.test(a) || (d = c), d && typeof d == "string" && (e = f.filter(d, e)), e = this.length > 1 && !R[a] ? f.unique(e) : e, (this.length > 1 || N.test(d)) && M.test(a) && (e = e.reverse()); return this.pushStack(e, a, P.call(arguments).join(",")) } }), f.extend({ filter: function (a, b, c) { c && (a = ":not(" + a + ")"); return b.length === 1 ? f.find.matchesSelector(b[0], a) ? [b[0]] : [] : f.find.matches(a, b) }, dir: function (a, c, d) { var e = [], g = a[c]; while (g && g.nodeType !== 9 && (d === b || g.nodeType !== 1 || !f(g).is(d))) g.nodeType === 1 && e.push(g), g = g[c]; return e }, nth: function (a, b, c, d) { b = b || 1; var e = 0; for (; a; a = a[c])if (a.nodeType === 1 && ++e === b) break; return a }, sibling: function (a, b) { var c = []; for (; a; a = a.nextSibling)a.nodeType === 1 && a !== b && c.push(a); return c } }); var V = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", W = / jQuery\d+="(?:\d+|null)"/g, X = /^\s+/, Y = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi, Z = /<([\w:]+)/, $ = /<tbody/i, _ = /<|&#?\w+;/, ba = /<(?:script|style)/i, bb = /<(?:script|object|embed|option|style)/i, bc = new RegExp("<(?:" + V + ")[\\s/>]", "i"), bd = /checked\s*(?:[^=]|=\s*.checked.)/i, be = /\/(java|ecma)script/i, bf = /^\s*<!(?:\[CDATA\[|\-\-)/, bg = { option: [1, "<select multiple='multiple'>", "</select>"], legend: [1, "<fieldset>", "</fieldset>"], thead: [1, "<table>", "</table>"], tr: [2, "<table><tbody>", "</tbody></table>"], td: [3, "<table><tbody><tr>", "</tr></tbody></table>"], col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"], area: [1, "<map>", "</map>"], _default: [0, "", ""] }, bh = U(c); bg.optgroup = bg.option, bg.tbody = bg.tfoot = bg.colgroup = bg.caption = bg.thead, bg.th = bg.td, f.support.htmlSerialize || (bg._default = [1, "div<div>", "</div>"]), f.fn.extend({ text: function (a) { return f.access(this, function (a) { return a === b ? f.text(this) : this.empty().append((this[0] && this[0].ownerDocument || c).createTextNode(a)) }, null, a, arguments.length) }, wrapAll: function (a) { if (f.isFunction(a)) return this.each(function (b) { f(this).wrapAll(a.call(this, b)) }); if (this[0]) { var b = f(a, this[0].ownerDocument).eq(0).clone(!0); this[0].parentNode && b.insertBefore(this[0]), b.map(function () { var a = this; while (a.firstChild && a.firstChild.nodeType === 1) a = a.firstChild; return a }).append(this) } return this }, wrapInner: function (a) { if (f.isFunction(a)) return this.each(function (b) { f(this).wrapInner(a.call(this, b)) }); return this.each(function () { var b = f(this), c = b.contents(); c.length ? c.wrapAll(a) : b.append(a) }) }, wrap: function (a) { var b = f.isFunction(a); return this.each(function (c) { f(this).wrapAll(b ? a.call(this, c) : a) }) }, unwrap: function () { return this.parent().each(function () { f.nodeName(this, "body") || f(this).replaceWith(this.childNodes) }).end() }, append: function () { return this.domManip(arguments, !0, function (a) { this.nodeType === 1 && this.appendChild(a) }) }, prepend: function () { return this.domManip(arguments, !0, function (a) { this.nodeType === 1 && this.insertBefore(a, this.firstChild) }) }, before: function () { if (this[0] && this[0].parentNode) return this.domManip(arguments, !1, function (a) { this.parentNode.insertBefore(a, this) }); if (arguments.length) { var a = f.clean(arguments); a.push.apply(a, this.toArray()); return this.pushStack(a, "before", arguments) } }, after: function () { if (this[0] && this[0].parentNode) return this.domManip(arguments, !1, function (a) { this.parentNode.insertBefore(a, this.nextSibling) }); if (arguments.length) { var a = this.pushStack(this, "after", arguments); a.push.apply(a, f.clean(arguments)); return a } }, remove: function (a, b) { for (var c = 0, d; (d = this[c]) != null; c++)if (!a || f.filter(a, [d]).length) !b && d.nodeType === 1 && (f.cleanData(d.getElementsByTagName("*")), f.cleanData([d])), d.parentNode && d.parentNode.removeChild(d); return this }, empty: function () { for (var a = 0, b; (b = this[a]) != null; a++) { b.nodeType === 1 && f.cleanData(b.getElementsByTagName("*")); while (b.firstChild) b.removeChild(b.firstChild) } return this }, clone: function (a, b) { a = a == null ? !1 : a, b = b == null ? a : b; return this.map(function () { return f.clone(this, a, b) }) }, html: function (a) { return f.access(this, function (a) { var c = this[0] || {}, d = 0, e = this.length; if (a === b) return c.nodeType === 1 ? c.innerHTML.replace(W, "") : null; if (typeof a == "string" && !ba.test(a) && (f.support.leadingWhitespace || !X.test(a)) && !bg[(Z.exec(a) || ["", ""])[1].toLowerCase()]) { a = a.replace(Y, "<$1></$2>"); try { for (; d < e; d++)c = this[d] || {}, c.nodeType === 1 && (f.cleanData(c.getElementsByTagName("*")), c.innerHTML = a); c = 0 } catch (g) { } } c && this.empty().append(a) }, null, a, arguments.length) }, replaceWith: function (a) { if (this[0] && this[0].parentNode) { if (f.isFunction(a)) return this.each(function (b) { var c = f(this), d = c.html(); c.replaceWith(a.call(this, b, d)) }); typeof a != "string" && (a = f(a).detach()); return this.each(function () { var b = this.nextSibling, c = this.parentNode; f(this).remove(), b ? f(b).before(a) : f(c).append(a) }) } return this.length ? this.pushStack(f(f.isFunction(a) ? a() : a), "replaceWith", a) : this }, detach: function (a) { return this.remove(a, !0) }, domManip: function (a, c, d) { var e, g, h, i, j = a[0], k = []; if (!f.support.checkClone && arguments.length === 3 && typeof j == "string" && bd.test(j)) return this.each(function () { f(this).domManip(a, c, d, !0) }); if (f.isFunction(j)) return this.each(function (e) { var g = f(this); a[0] = j.call(this, e, c ? g.html() : b), g.domManip(a, c, d) }); if (this[0]) { i = j && j.parentNode, f.support.parentNode && i && i.nodeType === 11 && i.childNodes.length === this.length ? e = { fragment: i } : e = f.buildFragment(a, this, k), h = e.fragment, h.childNodes.length === 1 ? g = h = h.firstChild : g = h.firstChild; if (g) { c = c && f.nodeName(g, "tr"); for (var l = 0, m = this.length, n = m - 1; l < m; l++)d.call(c ? bi(this[l], g) : this[l], e.cacheable || m > 1 && l < n ? f.clone(h, !0, !0) : h) } k.length && f.each(k, function (a, b) { b.src ? f.ajax({ type: "GET", global: !1, url: b.src, async: !1, dataType: "script" }) : f.globalEval((b.text || b.textContent || b.innerHTML || "").replace(bf, "/*$0*/")), b.parentNode && b.parentNode.removeChild(b) }) } return this } }), f.buildFragment = function (a, b, d) { var e, g, h, i, j = a[0]; b && b[0] && (i = b[0].ownerDocument || b[0]), i.createDocumentFragment || (i = c), a.length === 1 && typeof j == "string" && j.length < 512 && i === c && j.charAt(0) === "<" && !bb.test(j) && (f.support.checkClone || !bd.test(j)) && (f.support.html5Clone || !bc.test(j)) && (g = !0, h = f.fragments[j], h && h !== 1 && (e = h)), e || (e = i.createDocumentFragment(), f.clean(a, i, e, d)), g && (f.fragments[j] = h ? e : 1); return { fragment: e, cacheable: g } }, f.fragments = {}, f.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function (a, b) { f.fn[a] = function (c) { var d = [], e = f(c), g = this.length === 1 && this[0].parentNode; if (g && g.nodeType === 11 && g.childNodes.length === 1 && e.length === 1) { e[b](this[0]); return this } for (var h = 0, i = e.length; h < i; h++) { var j = (h > 0 ? this.clone(!0) : this).get(); f(e[h])[b](j), d = d.concat(j) } return this.pushStack(d, a, e.selector) } }), f.extend({ clone: function (a, b, c) { var d, e, g, h = f.support.html5Clone || f.isXMLDoc(a) || !bc.test("<" + a.nodeName + ">") ? a.cloneNode(!0) : bo(a); if ((!f.support.noCloneEvent || !f.support.noCloneChecked) && (a.nodeType === 1 || a.nodeType === 11) && !f.isXMLDoc(a)) { bk(a, h), d = bl(a), e = bl(h); for (g = 0; d[g]; ++g)e[g] && bk(d[g], e[g]) } if (b) { bj(a, h); if (c) { d = bl(a), e = bl(h); for (g = 0; d[g]; ++g)bj(d[g], e[g]) } } d = e = null; return h }, clean: function (a, b, d, e) { var g, h, i, j = []; b = b || c, typeof b.createElement == "undefined" && (b = b.ownerDocument || b[0] && b[0].ownerDocument || c); for (var k = 0, l; (l = a[k]) != null; k++) { typeof l == "number" && (l += ""); if (!l) continue; if (typeof l == "string") if (!_.test(l)) l = b.createTextNode(l); else { l = l.replace(Y, "<$1></$2>"); var m = (Z.exec(l) || ["", ""])[1].toLowerCase(), n = bg[m] || bg._default, o = n[0], p = b.createElement("div"), q = bh.childNodes, r; b === c ? bh.appendChild(p) : U(b).appendChild(p), p.innerHTML = n[1] + l + n[2]; while (o--) p = p.lastChild; if (!f.support.tbody) { var s = $.test(l), t = m === "table" && !s ? p.firstChild && p.firstChild.childNodes : n[1] === "<table>" && !s ? p.childNodes : []; for (i = t.length - 1; i >= 0; --i)f.nodeName(t[i], "tbody") && !t[i].childNodes.length && t[i].parentNode.removeChild(t[i]) } !f.support.leadingWhitespace && X.test(l) && p.insertBefore(b.createTextNode(X.exec(l)[0]), p.firstChild), l = p.childNodes, p && (p.parentNode.removeChild(p), q.length > 0 && (r = q[q.length - 1], r && r.parentNode && r.parentNode.removeChild(r))) } var u; if (!f.support.appendChecked) if (l[0] && typeof (u = l.length) == "number") for (i = 0; i < u; i++)bn(l[i]); else bn(l); l.nodeType ? j.push(l) : j = f.merge(j, l) } if (d) { g = function (a) { return !a.type || be.test(a.type) }; for (k = 0; j[k]; k++) { h = j[k]; if (e && f.nodeName(h, "script") && (!h.type || be.test(h.type))) e.push(h.parentNode ? h.parentNode.removeChild(h) : h); else { if (h.nodeType === 1) { var v = f.grep(h.getElementsByTagName("script"), g); j.splice.apply(j, [k + 1, 0].concat(v)) } d.appendChild(h) } } } return j }, cleanData: function (a) { var b, c, d = f.cache, e = f.event.special, g = f.support.deleteExpando; for (var h = 0, i; (i = a[h]) != null; h++) { if (i.nodeName && f.noData[i.nodeName.toLowerCase()]) continue; c = i[f.expando]; if (c) { b = d[c]; if (b && b.events) { for (var j in b.events) e[j] ? f.event.remove(i, j) : f.removeEvent(i, j, b.handle); b.handle && (b.handle.elem = null) } g ? delete i[f.expando] : i.removeAttribute && i.removeAttribute(f.expando), delete d[c] } } } }); var bp = /alpha\([^)]*\)/i, bq = /opacity=([^)]*)/, br = /([A-Z]|^ms)/g, bs = /^[\-+]?(?:\d*\.)?\d+$/i, bt = /^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i, bu = /^([\-+])=([\-+.\de]+)/, bv = /^margin/, bw = { position: "absolute", visibility: "hidden", display: "block" }, bx = ["Top", "Right", "Bottom", "Left"], by, bz, bA; f.fn.css = function (a, c) { return f.access(this, function (a, c, d) { return d !== b ? f.style(a, c, d) : f.css(a, c) }, a, c, arguments.length > 1) }, f.extend({ cssHooks: { opacity: { get: function (a, b) { if (b) { var c = by(a, "opacity"); return c === "" ? "1" : c } return a.style.opacity } } }, cssNumber: { fillOpacity: !0, fontWeight: !0, lineHeight: !0, opacity: !0, orphans: !0, widows: !0, zIndex: !0, zoom: !0 }, cssProps: { float: f.support.cssFloat ? "cssFloat" : "styleFloat" }, style: function (a, c, d, e) { if (!!a && a.nodeType !== 3 && a.nodeType !== 8 && !!a.style) { var g, h, i = f.camelCase(c), j = a.style, k = f.cssHooks[i]; c = f.cssProps[i] || i; if (d === b) { if (k && "get" in k && (g = k.get(a, !1, e)) !== b) return g; return j[c] } h = typeof d, h === "string" && (g = bu.exec(d)) && (d = +(g[1] + 1) * +g[2] + parseFloat(f.css(a, c)), h = "number"); if (d == null || h === "number" && isNaN(d)) return; h === "number" && !f.cssNumber[i] && (d += "px"); if (!k || !("set" in k) || (d = k.set(a, d)) !== b) try { j[c] = d } catch (l) { } } }, css: function (a, c, d) { var e, g; c = f.camelCase(c), g = f.cssHooks[c], c = f.cssProps[c] || c, c === "cssFloat" && (c = "float"); if (g && "get" in g && (e = g.get(a, !0, d)) !== b) return e; if (by) return by(a, c) }, swap: function (a, b, c) { var d = {}, e, f; for (f in b) d[f] = a.style[f], a.style[f] = b[f]; e = c.call(a); for (f in b) a.style[f] = d[f]; return e } }), f.curCSS = f.css, c.defaultView && c.defaultView.getComputedStyle && (bz = function (a, b) { var c, d, e, g, h = a.style; b = b.replace(br, "-$1").toLowerCase(), (d = a.ownerDocument.defaultView) && (e = d.getComputedStyle(a, null)) && (c = e.getPropertyValue(b), c === "" && !f.contains(a.ownerDocument.documentElement, a) && (c = f.style(a, b))), !f.support.pixelMargin && e && bv.test(b) && bt.test(c) && (g = h.width, h.width = c, c = e.width, h.width = g); return c }), c.documentElement.currentStyle && (bA = function (a, b) { var c, d, e, f = a.currentStyle && a.currentStyle[b], g = a.style; f == null && g && (e = g[b]) && (f = e), bt.test(f) && (c = g.left, d = a.runtimeStyle && a.runtimeStyle.left, d && (a.runtimeStyle.left = a.currentStyle.left), g.left = b === "fontSize" ? "1em" : f, f = g.pixelLeft + "px", g.left = c, d && (a.runtimeStyle.left = d)); return f === "" ? "auto" : f }), by = bz || bA, f.each(["height", "width"], function (a, b) { f.cssHooks[b] = { get: function (a, c, d) { if (c) return a.offsetWidth !== 0 ? bB(a, b, d) : f.swap(a, bw, function () { return bB(a, b, d) }) }, set: function (a, b) { return bs.test(b) ? b + "px" : b } } }), f.support.opacity || (f.cssHooks.opacity = { get: function (a, b) { return bq.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? parseFloat(RegExp.$1) / 100 + "" : b ? "1" : "" }, set: function (a, b) { var c = a.style, d = a.currentStyle, e = f.isNumeric(b) ? "alpha(opacity=" + b * 100 + ")" : "", g = d && d.filter || c.filter || ""; c.zoom = 1; if (b >= 1 && f.trim(g.replace(bp, "")) === "") { c.removeAttribute("filter"); if (d && !d.filter) return } c.filter = bp.test(g) ? g.replace(bp, e) : g + " " + e } }), f(function () { f.support.reliableMarginRight || (f.cssHooks.marginRight = { get: function (a, b) { return f.swap(a, { display: "inline-block" }, function () { return b ? by(a, "margin-right") : a.style.marginRight }) } }) }), f.expr && f.expr.filters && (f.expr.filters.hidden = function (a) { var b = a.offsetWidth, c = a.offsetHeight; return b === 0 && c === 0 || !f.support.reliableHiddenOffsets && (a.style && a.style.display || f.css(a, "display")) === "none" }, f.expr.filters.visible = function (a) { return !f.expr.filters.hidden(a) }), f.each({ margin: "", padding: "", border: "Width" }, function (a, b) { f.cssHooks[a + b] = { expand: function (c) { var d, e = typeof c == "string" ? c.split(" ") : [c], f = {}; for (d = 0; d < 4; d++)f[a + bx[d] + b] = e[d] || e[d - 2] || e[0]; return f } } }); var bC = /%20/g, bD = /\[\]$/, bE = /\r?\n/g, bF = /#.*$/, bG = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm, bH = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i, bI = /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/, bJ = /^(?:GET|HEAD)$/, bK = /^\/\//, bL = /\?/, bM = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, bN = /^(?:select|textarea)/i, bO = /\s+/, bP = /([?&])_=[^&]*/, bQ = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/, bR = f.fn.load, bS = {}, bT = {}, bU, bV, bW = ["*/"] + ["*"]; try { bU = e.href } catch (bX) { bU = c.createElement("a"), bU.href = "", bU = bU.href } bV = bQ.exec(bU.toLowerCase()) || [], f.fn.extend({ load: function (a, c, d) { if (typeof a != "string" && bR) return bR.apply(this, arguments); if (!this.length) return this; var e = a.indexOf(" "); if (e >= 0) { var g = a.slice(e, a.length); a = a.slice(0, e) } var h = "GET"; c && (f.isFunction(c) ? (d = c, c = b) : typeof c == "object" && (c = f.param(c, f.ajaxSettings.traditional), h = "POST")); var i = this; f.ajax({ url: a, type: h, dataType: "html", data: c, complete: function (a, b, c) { c = a.responseText, a.isResolved() && (a.done(function (a) { c = a }), i.html(g ? f("<div>").append(c.replace(bM, "")).find(g) : c)), d && i.each(d, [c, b, a]) } }); return this }, serialize: function () { return f.param(this.serializeArray()) }, serializeArray: function () { return this.map(function () { return this.elements ? f.makeArray(this.elements) : this }).filter(function () { return this.name && !this.disabled && (this.checked || bN.test(this.nodeName) || bH.test(this.type)) }).map(function (a, b) { var c = f(this).val(); return c == null ? null : f.isArray(c) ? f.map(c, function (a, c) { return { name: b.name, value: a.replace(bE, "\r\n") } }) : { name: b.name, value: c.replace(bE, "\r\n") } }).get() } }), f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function (a, b) { f.fn[b] = function (a) { return this.on(b, a) } }), f.each(["get", "post"], function (a, c) { f[c] = function (a, d, e, g) { f.isFunction(d) && (g = g || e, e = d, d = b); return f.ajax({ type: c, url: a, data: d, success: e, dataType: g }) } }), f.extend({ getScript: function (a, c) { return f.get(a, b, c, "script") }, getJSON: function (a, b, c) { return f.get(a, b, c, "json") }, ajaxSetup: function (a, b) { b ? b$(a, f.ajaxSettings) : (b = a, a = f.ajaxSettings), b$(a, b); return a }, ajaxSettings: { url: bU, isLocal: bI.test(bV[1]), global: !0, type: "GET", contentType: "application/x-www-form-urlencoded; charset=UTF-8", processData: !0, async: !0, accepts: { xml: "application/xml, text/xml", html: "text/html", text: "text/plain", json: "application/json, text/javascript", "*": bW }, contents: { xml: /xml/, html: /html/, json: /json/ }, responseFields: { xml: "responseXML", text: "responseText" }, converters: { "* text": a.String, "text html": !0, "text json": f.parseJSON, "text xml": f.parseXML }, flatOptions: { context: !0, url: !0 } }, ajaxPrefilter: bY(bS), ajaxTransport: bY(bT), ajax: function (a, c) { function w(a, c, l, m) { if (s !== 2) { s = 2, q && clearTimeout(q), p = b, n = m || "", v.readyState = a > 0 ? 4 : 0; var o, r, u, w = c, x = l ? ca(d, v, l) : b, y, z; if (a >= 200 && a < 300 || a === 304) { if (d.ifModified) { if (y = v.getResponseHeader("Last-Modified")) f.lastModified[k] = y; if (z = v.getResponseHeader("Etag")) f.etag[k] = z } if (a === 304) w = "notmodified", o = !0; else try { r = cb(d, x), w = "success", o = !0 } catch (A) { w = "parsererror", u = A } } else { u = w; if (!w || a) w = "error", a < 0 && (a = 0) } v.status = a, v.statusText = "" + (c || w), o ? h.resolveWith(e, [r, w, v]) : h.rejectWith(e, [v, w, u]), v.statusCode(j), j = b, t && g.trigger("ajax" + (o ? "Success" : "Error"), [v, d, o ? r : u]), i.fireWith(e, [v, w]), t && (g.trigger("ajaxComplete", [v, d]), --f.active || f.event.trigger("ajaxStop")) } } typeof a == "object" && (c = a, a = b), c = c || {}; var d = f.ajaxSetup({}, c), e = d.context || d, g = e !== d && (e.nodeType || e instanceof f) ? f(e) : f.event, h = f.Deferred(), i = f.Callbacks("once memory"), j = d.statusCode || {}, k, l = {}, m = {}, n, o, p, q, r, s = 0, t, u, v = { readyState: 0, setRequestHeader: function (a, b) { if (!s) { var c = a.toLowerCase(); a = m[c] = m[c] || a, l[a] = b } return this }, getAllResponseHeaders: function () { return s === 2 ? n : null }, getResponseHeader: function (a) { var c; if (s === 2) { if (!o) { o = {}; while (c = bG.exec(n)) o[c[1].toLowerCase()] = c[2] } c = o[a.toLowerCase()] } return c === b ? null : c }, overrideMimeType: function (a) { s || (d.mimeType = a); return this }, abort: function (a) { a = a || "abort", p && p.abort(a), w(0, a); return this } }; h.promise(v), v.success = v.done, v.error = v.fail, v.complete = i.add, v.statusCode = function (a) { if (a) { var b; if (s < 2) for (b in a) j[b] = [j[b], a[b]]; else b = a[v.status], v.then(b, b) } return this }, d.url = ((a || d.url) + "").replace(bF, "").replace(bK, bV[1] + "//"), d.dataTypes = f.trim(d.dataType || "*").toLowerCase().split(bO), d.crossDomain == null && (r = bQ.exec(d.url.toLowerCase()), d.crossDomain = !(!r || r[1] == bV[1] && r[2] == bV[2] && (r[3] || (r[1] === "http:" ? 80 : 443)) == (bV[3] || (bV[1] === "http:" ? 80 : 443)))), d.data && d.processData && typeof d.data != "string" && (d.data = f.param(d.data, d.traditional)), bZ(bS, d, c, v); if (s === 2) return !1; t = d.global, d.type = d.type.toUpperCase(), d.hasContent = !bJ.test(d.type), t && f.active++ === 0 && f.event.trigger("ajaxStart"); if (!d.hasContent) { d.data && (d.url += (bL.test(d.url) ? "&" : "?") + d.data, delete d.data), k = d.url; if (d.cache === !1) { var x = f.now(), y = d.url.replace(bP, "$1_=" + x); d.url = y + (y === d.url ? (bL.test(d.url) ? "&" : "?") + "_=" + x : "") } } (d.data && d.hasContent && d.contentType !== !1 || c.contentType) && v.setRequestHeader("Content-Type", d.contentType), d.ifModified && (k = k || d.url, f.lastModified[k] && v.setRequestHeader("If-Modified-Since", f.lastModified[k]), f.etag[k] && v.setRequestHeader("If-None-Match", f.etag[k])), v.setRequestHeader("Accept", d.dataTypes[0] && d.accepts[d.dataTypes[0]] ? d.accepts[d.dataTypes[0]] + (d.dataTypes[0] !== "*" ? ", " + bW + "; q=0.01" : "") : d.accepts["*"]); for (u in d.headers) v.setRequestHeader(u, d.headers[u]); if (d.beforeSend && (d.beforeSend.call(e, v, d) === !1 || s === 2)) { v.abort(); return !1 } for (u in { success: 1, error: 1, complete: 1 }) v[u](d[u]); p = bZ(bT, d, c, v); if (!p) w(-1, "No Transport"); else { v.readyState = 1, t && g.trigger("ajaxSend", [v, d]), d.async && d.timeout > 0 && (q = setTimeout(function () { v.abort("timeout") }, d.timeout)); try { s = 1, p.send(l, w) } catch (z) { if (s < 2) w(-1, z); else throw z } } return v }, param: function (a, c) { var d = [], e = function (a, b) { b = f.isFunction(b) ? b() : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b) }; c === b && (c = f.ajaxSettings.traditional); if (f.isArray(a) || a.jquery && !f.isPlainObject(a)) f.each(a, function () { e(this.name, this.value) }); else for (var g in a) b_(g, a[g], c, e); return d.join("&").replace(bC, "+") } }), f.extend({ active: 0, lastModified: {}, etag: {} }); var cc = f.now(), cd = /(\=)\?(&|$)|\?\?/i; f.ajaxSetup({ jsonp: "callback", jsonpCallback: function () { return f.expando + "_" + cc++ } }), f.ajaxPrefilter("json jsonp", function (b, c, d) { var e = typeof b.data == "string" && /^application\/x\-www\-form\-urlencoded/.test(b.contentType); if (b.dataTypes[0] === "jsonp" || b.jsonp !== !1 && (cd.test(b.url) || e && cd.test(b.data))) { var g, h = b.jsonpCallback = f.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, i = a[h], j = b.url, k = b.data, l = "$1" + h + "$2"; b.jsonp !== !1 && (j = j.replace(cd, l), b.url === j && (e && (k = k.replace(cd, l)), b.data === k && (j += (/\?/.test(j) ? "&" : "?") + b.jsonp + "=" + h))), b.url = j, b.data = k, a[h] = function (a) { g = [a] }, d.always(function () { a[h] = i, g && f.isFunction(i) && a[h](g[0]) }), b.converters["script json"] = function () { g || f.error(h + " was not called"); return g[0] }, b.dataTypes[0] = "json"; return "script" } }), f.ajaxSetup({ accepts: { script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript" }, contents: { script: /javascript|ecmascript/ }, converters: { "text script": function (a) { f.globalEval(a); return a } } }), f.ajaxPrefilter("script", function (a) { a.cache === b && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1) }), f.ajaxTransport("script", function (a) { if (a.crossDomain) { var d, e = c.head || c.getElementsByTagName("head")[0] || c.documentElement; return { send: function (f, g) { d = c.createElement("script"), d.async = "async", a.scriptCharset && (d.charset = a.scriptCharset), d.src = a.url, d.onload = d.onreadystatechange = function (a, c) { if (c || !d.readyState || /loaded|complete/.test(d.readyState)) d.onload = d.onreadystatechange = null, e && d.parentNode && e.removeChild(d), d = b, c || g(200, "success") }, e.insertBefore(d, e.firstChild) }, abort: function () { d && d.onload(0, 1) } } } }); var ce = a.ActiveXObject ? function () { for (var a in cg) cg[a](0, 1) } : !1, cf = 0, cg; f.ajaxSettings.xhr = a.ActiveXObject ? function () { return !this.isLocal && ch() || ci() } : ch, function (a) { f.extend(f.support, { ajax: !!a, cors: !!a && "withCredentials" in a }) }(f.ajaxSettings.xhr()), f.support.ajax && f.ajaxTransport(function (c) { if (!c.crossDomain || f.support.cors) { var d; return { send: function (e, g) { var h = c.xhr(), i, j; c.username ? h.open(c.type, c.url, c.async, c.username, c.password) : h.open(c.type, c.url, c.async); if (c.xhrFields) for (j in c.xhrFields) h[j] = c.xhrFields[j]; c.mimeType && h.overrideMimeType && h.overrideMimeType(c.mimeType), !c.crossDomain && !e["X-Requested-With"] && (e["X-Requested-With"] = "XMLHttpRequest"); try { for (j in e) h.setRequestHeader(j, e[j]) } catch (k) { } h.send(c.hasContent && c.data || null), d = function (a, e) { var j, k, l, m, n; try { if (d && (e || h.readyState === 4)) { d = b, i && (h.onreadystatechange = f.noop, ce && delete cg[i]); if (e) h.readyState !== 4 && h.abort(); else { j = h.status, l = h.getAllResponseHeaders(), m = {}, n = h.responseXML, n && n.documentElement && (m.xml = n); try { m.text = h.responseText } catch (a) { } try { k = h.statusText } catch (o) { k = "" } !j && c.isLocal && !c.crossDomain ? j = m.text ? 200 : 404 : j === 1223 && (j = 204) } } } catch (p) { e || g(-1, p) } m && g(j, k, m, l) }, !c.async || h.readyState === 4 ? d() : (i = ++cf, ce && (cg || (cg = {}, f(a).unload(ce)), cg[i] = d), h.onreadystatechange = d) }, abort: function () { d && d(0, 1) } } } }); var cj = {}, ck, cl, cm = /^(?:toggle|show|hide)$/, cn = /^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i, co, cp = [["height", "marginTop", "marginBottom", "paddingTop", "paddingBottom"], ["width", "marginLeft", "marginRight", "paddingLeft", "paddingRight"], ["opacity"]], cq; f.fn.extend({ show: function (a, b, c) { var d, e; if (a || a === 0) return this.animate(ct("show", 3), a, b, c); for (var g = 0, h = this.length; g < h; g++)d = this[g], d.style && (e = d.style.display, !f._data(d, "olddisplay") && e === "none" && (e = d.style.display = ""), (e === "" && f.css(d, "display") === "none" || !f.contains(d.ownerDocument.documentElement, d)) && f._data(d, "olddisplay", cu(d.nodeName))); for (g = 0; g < h; g++) { d = this[g]; if (d.style) { e = d.style.display; if (e === "" || e === "none") d.style.display = f._data(d, "olddisplay") || "" } } return this }, hide: function (a, b, c) { if (a || a === 0) return this.animate(ct("hide", 3), a, b, c); var d, e, g = 0, h = this.length; for (; g < h; g++)d = this[g], d.style && (e = f.css(d, "display"), e !== "none" && !f._data(d, "olddisplay") && f._data(d, "olddisplay", e)); for (g = 0; g < h; g++)this[g].style && (this[g].style.display = "none"); return this }, _toggle: f.fn.toggle, toggle: function (a, b, c) { var d = typeof a == "boolean"; f.isFunction(a) && f.isFunction(b) ? this._toggle.apply(this, arguments) : a == null || d ? this.each(function () { var b = d ? a : f(this).is(":hidden"); f(this)[b ? "show" : "hide"]() }) : this.animate(ct("toggle", 3), a, b, c); return this }, fadeTo: function (a, b, c, d) { return this.filter(":hidden").css("opacity", 0).show().end().animate({ opacity: b }, a, c, d) }, animate: function (a, b, c, d) { function g() { e.queue === !1 && f._mark(this); var b = f.extend({}, e), c = this.nodeType === 1, d = c && f(this).is(":hidden"), g, h, i, j, k, l, m, n, o, p, q; b.animatedProperties = {}; for (i in a) { g = f.camelCase(i), i !== g && (a[g] = a[i], delete a[i]); if ((k = f.cssHooks[g]) && "expand" in k) { l = k.expand(a[g]), delete a[g]; for (i in l) i in a || (a[i] = l[i]) } } for (g in a) { h = a[g], f.isArray(h) ? (b.animatedProperties[g] = h[1], h = a[g] = h[0]) : b.animatedProperties[g] = b.specialEasing && b.specialEasing[g] || b.easing || "swing"; if (h === "hide" && d || h === "show" && !d) return b.complete.call(this); c && (g === "height" || g === "width") && (b.overflow = [this.style.overflow, this.style.overflowX, this.style.overflowY], f.css(this, "display") === "inline" && f.css(this, "float") === "none" && (!f.support.inlineBlockNeedsLayout || cu(this.nodeName) === "inline" ? this.style.display = "inline-block" : this.style.zoom = 1)) } b.overflow != null && (this.style.overflow = "hidden"); for (i in a) j = new f.fx(this, b, i), h = a[i], cm.test(h) ? (q = f._data(this, "toggle" + i) || (h === "toggle" ? d ? "show" : "hide" : 0), q ? (f._data(this, "toggle" + i, q === "show" ? "hide" : "show"), j[q]()) : j[h]()) : (m = cn.exec(h), n = j.cur(), m ? (o = parseFloat(m[2]), p = m[3] || (f.cssNumber[i] ? "" : "px"), p !== "px" && (f.style(this, i, (o || 1) + p), n = (o || 1) / j.cur() * n, f.style(this, i, n + p)), m[1] && (o = (m[1] === "-=" ? -1 : 1) * o + n), j.custom(n, o, p)) : j.custom(n, h, "")); return !0 } var e = f.speed(b, c, d); if (f.isEmptyObject(a)) return this.each(e.complete, [!1]); a = f.extend({}, a); return e.queue === !1 ? this.each(g) : this.queue(e.queue, g) }, stop: function (a, c, d) { typeof a != "string" && (d = c, c = a, a = b), c && a !== !1 && this.queue(a || "fx", []); return this.each(function () { function h(a, b, c) { var e = b[c]; f.removeData(a, c, !0), e.stop(d) } var b, c = !1, e = f.timers, g = f._data(this); d || f._unmark(!0, this); if (a == null) for (b in g) g[b] && g[b].stop && b.indexOf(".run") === b.length - 4 && h(this, g, b); else g[b = a + ".run"] && g[b].stop && h(this, g, b); for (b = e.length; b--;)e[b].elem === this && (a == null || e[b].queue === a) && (d ? e[b](!0) : e[b].saveState(), c = !0, e.splice(b, 1)); (!d || !c) && f.dequeue(this, a) }) } }), f.each({ slideDown: ct("show", 1), slideUp: ct("hide", 1), slideToggle: ct("toggle", 1), fadeIn: { opacity: "show" }, fadeOut: { opacity: "hide" }, fadeToggle: { opacity: "toggle" } }, function (a, b) { f.fn[a] = function (a, c, d) { return this.animate(b, a, c, d) } }), f.extend({ speed: function (a, b, c) { var d = a && typeof a == "object" ? f.extend({}, a) : { complete: c || !c && b || f.isFunction(a) && a, duration: a, easing: c && b || b && !f.isFunction(b) && b }; d.duration = f.fx.off ? 0 : typeof d.duration == "number" ? d.duration : d.duration in f.fx.speeds ? f.fx.speeds[d.duration] : f.fx.speeds._default; if (d.queue == null || d.queue === !0) d.queue = "fx"; d.old = d.complete, d.complete = function (a) { f.isFunction(d.old) && d.old.call(this), d.queue ? f.dequeue(this, d.queue) : a !== !1 && f._unmark(this) }; return d }, easing: { linear: function (a) { return a }, swing: function (a) { return -Math.cos(a * Math.PI) / 2 + .5 } }, timers: [], fx: function (a, b, c) { this.options = b, this.elem = a, this.prop = c, b.orig = b.orig || {} } }), f.fx.prototype = { update: function () { this.options.step && this.options.step.call(this.elem, this.now, this), (f.fx.step[this.prop] || f.fx.step._default)(this) }, cur: function () { if (this.elem[this.prop] != null && (!this.elem.style || this.elem.style[this.prop] == null)) return this.elem[this.prop]; var a, b = f.css(this.elem, this.prop); return isNaN(a = parseFloat(b)) ? !b || b === "auto" ? 0 : b : a }, custom: function (a, c, d) { function h(a) { return e.step(a) } var e = this, g = f.fx; this.startTime = cq || cr(), this.end = c, this.now = this.start = a, this.pos = this.state = 0, this.unit = d || this.unit || (f.cssNumber[this.prop] ? "" : "px"), h.queue = this.options.queue, h.elem = this.elem, h.saveState = function () { f._data(e.elem, "fxshow" + e.prop) === b && (e.options.hide ? f._data(e.elem, "fxshow" + e.prop, e.start) : e.options.show && f._data(e.elem, "fxshow" + e.prop, e.end)) }, h() && f.timers.push(h) && !co && (co = setInterval(g.tick, g.interval)) }, show: function () { var a = f._data(this.elem, "fxshow" + this.prop); this.options.orig[this.prop] = a || f.style(this.elem, this.prop), this.options.show = !0, a !== b ? this.custom(this.cur(), a) : this.custom(this.prop === "width" || this.prop === "height" ? 1 : 0, this.cur()), f(this.elem).show() }, hide: function () { this.options.orig[this.prop] = f._data(this.elem, "fxshow" + this.prop) || f.style(this.elem, this.prop), this.options.hide = !0, this.custom(this.cur(), 0) }, step: function (a) { var b, c, d, e = cq || cr(), g = !0, h = this.elem, i = this.options; if (a || e >= i.duration + this.startTime) { this.now = this.end, this.pos = this.state = 1, this.update(), i.animatedProperties[this.prop] = !0; for (b in i.animatedProperties) i.animatedProperties[b] !== !0 && (g = !1); if (g) { i.overflow != null && !f.support.shrinkWrapBlocks && f.each(["", "X", "Y"], function (a, b) { h.style["overflow" + b] = i.overflow[a] }), i.hide && f(h).hide(); if (i.hide || i.show) for (b in i.animatedProperties) f.style(h, b, i.orig[b]), f.removeData(h, "fxshow" + b, !0), f.removeData(h, "toggle" + b, !0); d = i.complete, d && (i.complete = !1, d.call(h)) } return !1 } i.duration == Infinity ? this.now = e : (c = e - this.startTime, this.state = c / i.duration, this.pos = f.easing[i.animatedProperties[this.prop]](this.state, c, 0, 1, i.duration), this.now = this.start + (this.end - this.start) * this.pos), this.update(); return !0 } }, f.extend(f.fx, { tick: function () { var a, b = f.timers, c = 0; for (; c < b.length; c++)a = b[c], !a() && b[c] === a && b.splice(c--, 1); b.length || f.fx.stop() }, interval: 13, stop: function () { clearInterval(co), co = null }, speeds: { slow: 600, fast: 200, _default: 400 }, step: { opacity: function (a) { f.style(a.elem, "opacity", a.now) }, _default: function (a) { a.elem.style && a.elem.style[a.prop] != null ? a.elem.style[a.prop] = a.now + a.unit : a.elem[a.prop] = a.now } } }), f.each(cp.concat.apply([], cp), function (a, b) { b.indexOf("margin") && (f.fx.step[b] = function (a) { f.style(a.elem, b, Math.max(0, a.now) + a.unit) }) }), f.expr && f.expr.filters && (f.expr.filters.animated = function (a) { return f.grep(f.timers, function (b) { return a === b.elem }).length }); var cv, cw = /^t(?:able|d|h)$/i, cx = /^(?:body|html)$/i; "getBoundingClientRect" in c.documentElement ? cv = function (a, b, c, d) { try { d = a.getBoundingClientRect() } catch (e) { } if (!d || !f.contains(c, a)) return d ? { top: d.top, left: d.left } : { top: 0, left: 0 }; var g = b.body, h = cy(b), i = c.clientTop || g.clientTop || 0, j = c.clientLeft || g.clientLeft || 0, k = h.pageYOffset || f.support.boxModel && c.scrollTop || g.scrollTop, l = h.pageXOffset || f.support.boxModel && c.scrollLeft || g.scrollLeft, m = d.top + k - i, n = d.left + l - j; return { top: m, left: n } } : cv = function (a, b, c) { var d, e = a.offsetParent, g = a, h = b.body, i = b.defaultView, j = i ? i.getComputedStyle(a, null) : a.currentStyle, k = a.offsetTop, l = a.offsetLeft; while ((a = a.parentNode) && a !== h && a !== c) { if (f.support.fixedPosition && j.position === "fixed") break; d = i ? i.getComputedStyle(a, null) : a.currentStyle, k -= a.scrollTop, l -= a.scrollLeft, a === e && (k += a.offsetTop, l += a.offsetLeft, f.support.doesNotAddBorder && (!f.support.doesAddBorderForTableAndCells || !cw.test(a.nodeName)) && (k += parseFloat(d.borderTopWidth) || 0, l += parseFloat(d.borderLeftWidth) || 0), g = e, e = a.offsetParent), f.support.subtractsBorderForOverflowNotVisible && d.overflow !== "visible" && (k += parseFloat(d.borderTopWidth) || 0, l += parseFloat(d.borderLeftWidth) || 0), j = d } if (j.position === "relative" || j.position === "static") k += h.offsetTop, l += h.offsetLeft; f.support.fixedPosition && j.position === "fixed" && (k += Math.max(c.scrollTop, h.scrollTop), l += Math.max(c.scrollLeft, h.scrollLeft)); return { top: k, left: l } }, f.fn.offset = function (a) { if (arguments.length) return a === b ? this : this.each(function (b) { f.offset.setOffset(this, a, b) }); var c = this[0], d = c && c.ownerDocument; if (!d) return null; if (c === d.body) return f.offset.bodyOffset(c); return cv(c, d, d.documentElement) }, f.offset = { bodyOffset: function (a) { var b = a.offsetTop, c = a.offsetLeft; f.support.doesNotIncludeMarginInBodyOffset && (b += parseFloat(f.css(a, "marginTop")) || 0, c += parseFloat(f.css(a, "marginLeft")) || 0); return { top: b, left: c } }, setOffset: function (a, b, c) { var d = f.css(a, "position"); d === "static" && (a.style.position = "relative"); var e = f(a), g = e.offset(), h = f.css(a, "top"), i = f.css(a, "left"), j = (d === "absolute" || d === "fixed") && f.inArray("auto", [h, i]) > -1, k = {}, l = {}, m, n; j ? (l = e.position(), m = l.top, n = l.left) : (m = parseFloat(h) || 0, n = parseFloat(i) || 0), f.isFunction(b) && (b = b.call(a, c, g)), b.top != null && (k.top = b.top - g.top + m), b.left != null && (k.left = b.left - g.left + n), "using" in b ? b.using.call(a, k) : e.css(k) } }, f.fn.extend({ position: function () { if (!this[0]) return null; var a = this[0], b = this.offsetParent(), c = this.offset(), d = cx.test(b[0].nodeName) ? { top: 0, left: 0 } : b.offset(); c.top -= parseFloat(f.css(a, "marginTop")) || 0, c.left -= parseFloat(f.css(a, "marginLeft")) || 0, d.top += parseFloat(f.css(b[0], "borderTopWidth")) || 0, d.left += parseFloat(f.css(b[0], "borderLeftWidth")) || 0; return { top: c.top - d.top, left: c.left - d.left } }, offsetParent: function () { return this.map(function () { var a = this.offsetParent || c.body; while (a && !cx.test(a.nodeName) && f.css(a, "position") === "static") a = a.offsetParent; return a }) } }), f.each({ scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function (a, c) { var d = /Y/.test(c); f.fn[a] = function (e) { return f.access(this, function (a, e, g) { var h = cy(a); if (g === b) return h ? c in h ? h[c] : f.support.boxModel && h.document.documentElement[e] || h.document.body[e] : a[e]; h ? h.scrollTo(d ? f(h).scrollLeft() : g, d ? g : f(h).scrollTop()) : a[e] = g }, a, e, arguments.length, null) } }), f.each({ Height: "height", Width: "width" }, function (a, c) { var d = "client" + a, e = "scroll" + a, g = "offset" + a; f.fn["inner" + a] = function () { var a = this[0]; return a ? a.style ? parseFloat(f.css(a, c, "padding")) : this[c]() : null }, f.fn["outer" + a] = function (a) { var b = this[0]; return b ? b.style ? parseFloat(f.css(b, c, a ? "margin" : "border")) : this[c]() : null }, f.fn[c] = function (a) { return f.access(this, function (a, c, h) { var i, j, k, l; if (f.isWindow(a)) { i = a.document, j = i.documentElement[d]; return f.support.boxModel && j || i.body && i.body[d] || j } if (a.nodeType === 9) { i = a.documentElement; if (i[d] >= i[e]) return i[d]; return Math.max(a.body[e], i[e], a.body[g], i[g]) } if (h === b) { k = f.css(a, c), l = parseFloat(k); return f.isNumeric(l) ? l : k } f(a).css(c, h) }, c, a, arguments.length, null) } }), a.jQuery = a.$ = f, typeof define == "function" && define.amd && define.amd.jQuery && define("jquery", [], function () { return f }) })(window); !function (t, e) { "object" == typeof exports && "object" == typeof module ? module.exports = e() : "function" == typeof define && define.amd ? define("Noty", [], e) : "object" == typeof exports ? exports.Noty = e() : t.Noty = e() }(this, function () { return function (t) { function e(o) { if (n[o]) return n[o].exports; var i = n[o] = { i: o, l: !1, exports: {} }; return t[o].call(i.exports, i, i.exports, e), i.l = !0, i.exports } var n = {}; return e.m = t, e.c = n, e.i = function (t) { return t }, e.d = function (t, n, o) { e.o(t, n) || Object.defineProperty(t, n, { configurable: !1, enumerable: !0, get: o }) }, e.n = function (t) { var n = t && t.__esModule ? function () { return t.default } : function () { return t }; return e.d(n, "a", n), n }, e.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, e.p = "", e(e.s = 6) }([function (t, e, n) { "use strict"; function o(t, e, n) { var o = void 0; if (!n) { for (o in e) if (e.hasOwnProperty(o) && e[o] === t) return !0 } else for (o in e) if (e.hasOwnProperty(o) && e[o] === t) return !0; return !1 } function i(t) { t = t || window.event, void 0 !== t.stopPropagation ? t.stopPropagation() : t.cancelBubble = !0 } function r() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "", e = "noty_" + t + "_"; return e += "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (t) { var e = 16 * Math.random() | 0; return ("x" === t ? e : 3 & e | 8).toString(16) }) } function s(t) { var e = t.offsetHeight, n = window.getComputedStyle(t); return e += parseInt(n.marginTop) + parseInt(n.marginBottom) } function u(t, e, n) { var o = arguments.length > 3 && void 0 !== arguments[3] && arguments[3]; e = e.split(" "); for (var i = 0; i < e.length; i++)document.addEventListener ? t.addEventListener(e[i], n, o) : document.attachEvent && t.attachEvent("on" + e[i], n) } function a(t, e) { return ("string" == typeof t ? t : f(t)).indexOf(" " + e + " ") >= 0 } function c(t, e) { var n = f(t), o = n + e; a(n, e) || (t.className = o.substring(1)) } function l(t, e) { var n = f(t), o = void 0; a(t, e) && (o = n.replace(" " + e + " ", " "), t.className = o.substring(1, o.length - 1)) } function d(t) { t.parentNode && t.parentNode.removeChild(t) } function f(t) { return (" " + (t && t.className || "") + " ").replace(/\s+/gi, " ") } function h() { function t() { b.PageHidden = document[s], o() } function e() { b.PageHidden = !0, o() } function n() { b.PageHidden = !1, o() } function o() { b.PageHidden ? i() : r() } function i() { setTimeout(function () { Object.keys(b.Store).forEach(function (t) { b.Store.hasOwnProperty(t) && b.Store[t].options.visibilityControl && b.Store[t].stop() }) }, 100) } function r() { setTimeout(function () { Object.keys(b.Store).forEach(function (t) { b.Store.hasOwnProperty(t) && b.Store[t].options.visibilityControl && b.Store[t].resume() }), b.queueRenderAll() }, 100) } var s = void 0, a = void 0; void 0 !== document.hidden ? (s = "hidden", a = "visibilitychange") : void 0 !== document.msHidden ? (s = "msHidden", a = "msvisibilitychange") : void 0 !== document.webkitHidden && (s = "webkitHidden", a = "webkitvisibilitychange"), u(document, a, t), u(window, "blur", e), u(window, "focus", n) } function p(t) { if (t.hasSound) { var e = document.createElement("audio"); t.options.sounds.sources.forEach(function (t) { var n = document.createElement("source"); n.src = t, n.type = "audio/" + m(t), e.appendChild(n) }), t.barDom ? t.barDom.appendChild(e) : document.querySelector("body").appendChild(e), e.volume = t.options.sounds.volume, t.soundPlayed || (e.play(), t.soundPlayed = !0), e.onended = function () { d(e) } } } function m(t) { return t.match(/\.([^.]+)$/)[1] } Object.defineProperty(e, "__esModule", { value: !0 }), e.css = e.deepExtend = e.animationEndEvents = void 0; var v = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }; e.inArray = o, e.stopPropagation = i, e.generateID = r, e.outerHeight = s, e.addListener = u, e.hasClass = a, e.addClass = c, e.removeClass = l, e.remove = d, e.classList = f, e.visibilityChangeFlow = h, e.createAudioElements = p; var y = n(1), b = function (t) { if (t && t.__esModule) return t; var e = {}; if (null != t) for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]); return e.default = t, e }(y); e.animationEndEvents = "webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend", e.deepExtend = function t(e) { e = e || {}; for (var n = 1; n < arguments.length; n++) { var o = arguments[n]; if (o) for (var i in o) o.hasOwnProperty(i) && (Array.isArray(o[i]) ? e[i] = o[i] : "object" === v(o[i]) && null !== o[i] ? e[i] = t(e[i], o[i]) : e[i] = o[i]) } return e }, e.css = function () { function t(t) { return t.replace(/^-ms-/, "ms-").replace(/-([\da-z])/gi, function (t, e) { return e.toUpperCase() }) } function e(t) { var e = document.body.style; if (t in e) return t; for (var n = i.length, o = t.charAt(0).toUpperCase() + t.slice(1), r = void 0; n--;)if ((r = i[n] + o) in e) return r; return t } function n(n) { return n = t(n), r[n] || (r[n] = e(n)) } function o(t, e, o) { e = n(e), t.style[e] = o } var i = ["Webkit", "O", "Moz", "ms"], r = {}; return function (t, e) { var n = arguments, i = void 0, r = void 0; if (2 === n.length) for (i in e) e.hasOwnProperty(i) && void 0 !== (r = e[i]) && e.hasOwnProperty(i) && o(t, i, r); else o(t, n[1], n[2]) } }() }, function (t, e, n) { "use strict"; function o() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "global", e = 0, n = x; return E.hasOwnProperty(t) && (n = E[t].maxVisible, Object.keys(P).forEach(function (n) { P[n].options.queue !== t || P[n].closed || e++ })), { current: e, maxVisible: n } } function i(t) { E.hasOwnProperty(t.options.queue) || (E[t.options.queue] = { maxVisible: x, queue: [] }), E[t.options.queue].queue.push(t) } function r(t) { if (E.hasOwnProperty(t.options.queue)) { var e = []; Object.keys(E[t.options.queue].queue).forEach(function (n) { E[t.options.queue].queue[n].id !== t.id && e.push(E[t.options.queue].queue[n]) }), E[t.options.queue].queue = e } } function s() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "global"; if (E.hasOwnProperty(t)) { var e = E[t].queue.shift(); e && e.show() } } function u() { Object.keys(E).forEach(function (t) { s(t) }) } function a(t) { var e = k.generateID("ghost"), n = document.createElement("div"); n.setAttribute("id", e), k.css(n, { height: k.outerHeight(t.barDom) + "px" }), t.barDom.insertAdjacentHTML("afterend", n.outerHTML), k.remove(t.barDom), n = document.getElementById(e), k.addClass(n, "noty_fix_effects_height"), k.addListener(n, k.animationEndEvents, function () { k.remove(n) }) } function c(t) { m(t); var e = '<div class="noty_body">' + t.options.text + "</div>" + d(t) + '<div class="noty_progressbar"></div>'; t.barDom = document.createElement("div"), t.barDom.setAttribute("id", t.id), k.addClass(t.barDom, "noty_bar noty_type__" + t.options.type + " noty_theme__" + t.options.theme), t.barDom.innerHTML = e, b(t, "onTemplate") } function l(t) { return !(!t.options.buttons || !Object.keys(t.options.buttons).length) } function d(t) { if (l(t)) { var e = document.createElement("div"); return k.addClass(e, "noty_buttons"), Object.keys(t.options.buttons).forEach(function (n) { e.appendChild(t.options.buttons[n].dom) }), t.options.buttons.forEach(function (t) { e.appendChild(t.dom) }), e.outerHTML } return "" } function f(t) { t.options.modal && (0 === C && p(), e.DocModalCount = C += 1) } function h(t) { if (t.options.modal && C > 0 && (e.DocModalCount = C -= 1, C <= 0)) { var n = document.querySelector(".noty_modal"); n && (k.removeClass(n, "noty_modal_open"), k.addClass(n, "noty_modal_close"), k.addListener(n, k.animationEndEvents, function () { k.remove(n) })) } } function p() { var t = document.querySelector("body"), e = document.createElement("div"); k.addClass(e, "noty_modal"), t.insertBefore(e, t.firstChild), k.addClass(e, "noty_modal_open"), k.addListener(e, k.animationEndEvents, function () { k.removeClass(e, "noty_modal_open") }) } function m(t) { if (t.options.container) return void (t.layoutDom = document.querySelector(t.options.container)); var e = "noty_layout__" + t.options.layout; t.layoutDom = document.querySelector("div#" + e), t.layoutDom || (t.layoutDom = document.createElement("div"), t.layoutDom.setAttribute("id", e), k.addClass(t.layoutDom, "noty_layout"), document.querySelector("body").appendChild(t.layoutDom)) } function v(t) { t.options.timeout && (t.options.progressBar && t.progressDom && k.css(t.progressDom, { transition: "width " + t.options.timeout + "ms linear", width: "0%" }), clearTimeout(t.closeTimer), t.closeTimer = setTimeout(function () { t.close() }, t.options.timeout)) } function y(t) { t.options.timeout && t.closeTimer && (clearTimeout(t.closeTimer), t.closeTimer = -1, t.options.progressBar && t.progressDom && k.css(t.progressDom, { transition: "width 0ms linear", width: "100%" })) } function b(t, e) { t.listeners.hasOwnProperty(e) && t.listeners[e].forEach(function (e) { "function" == typeof e && e.apply(t) }) } function w(t) { b(t, "afterShow"), v(t), k.addListener(t.barDom, "mouseenter", function () { y(t) }), k.addListener(t.barDom, "mouseleave", function () { v(t) }) } function g(t) { delete P[t.id], t.closing = !1, b(t, "afterClose"), k.remove(t.barDom), 0 !== t.layoutDom.querySelectorAll(".noty_bar").length || t.options.container || k.remove(t.layoutDom), (k.inArray("docVisible", t.options.titleCount.conditions) || k.inArray("docHidden", t.options.titleCount.conditions)) && D.decrement(), s(t.options.queue) } Object.defineProperty(e, "__esModule", { value: !0 }), e.Defaults = e.Store = e.Queues = e.DefaultMaxVisible = e.docTitle = e.DocModalCount = e.PageHidden = void 0, e.getQueueCounts = o, e.addToQueue = i, e.removeFromQueue = r, e.queueRender = s, e.queueRenderAll = u, e.ghostFix = a, e.build = c, e.hasButtons = l, e.handleModal = f, e.handleModalClose = h, e.queueClose = v, e.dequeueClose = y, e.fire = b, e.openFlow = w, e.closeFlow = g; var _ = n(0), k = function (t) { if (t && t.__esModule) return t; var e = {}; if (null != t) for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]); return e.default = t, e }(_), C = (e.PageHidden = !1, e.DocModalCount = 0), S = { originalTitle: null, count: 0, changed: !1, timer: -1 }, D = e.docTitle = { increment: function () { S.count++, D._update() }, decrement: function () { if (--S.count <= 0) return void D._clear(); D._update() }, _update: function () { var t = document.title; S.changed ? document.title = "(" + S.count + ") " + S.originalTitle : (S.originalTitle = t, document.title = "(" + S.count + ") " + t, S.changed = !0) }, _clear: function () { S.changed && (S.count = 0, document.title = S.originalTitle, S.changed = !1) } }, x = e.DefaultMaxVisible = 5, E = e.Queues = { global: { maxVisible: x, queue: [] } }, P = e.Store = {}; e.Defaults = { type: "alert", layout: "topRight", theme: "mint", text: "", timeout: !1, progressBar: !0, closeWith: ["click"], animation: { open: "noty_effects_open", close: "noty_effects_close" }, id: !1, force: !1, killer: !1, queue: "global", container: !1, buttons: [], callbacks: { beforeShow: null, onShow: null, afterShow: null, onClose: null, afterClose: null, onClick: null, onHover: null, onTemplate: null }, sounds: { sources: [], volume: 1, conditions: [] }, titleCount: { conditions: [] }, modal: !1, visibilityControl: !1 } }, function (t, e, n) { "use strict"; function o(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(e, "__esModule", { value: !0 }), e.NotyButton = void 0; var i = n(0), r = function (t) { if (t && t.__esModule) return t; var e = {}; if (null != t) for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]); return e.default = t, e }(i); e.NotyButton = function t(e, n, i) { var s = this, u = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {}; return o(this, t), this.dom = document.createElement("button"), this.dom.innerHTML = e, this.id = u.id = u.id || r.generateID("button"), this.cb = i, Object.keys(u).forEach(function (t) { s.dom.setAttribute(t, u[t]) }), r.addClass(this.dom, n || "noty_btn"), this } }, function (t, e, n) { "use strict"; function o(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(e, "__esModule", { value: !0 }); var i = function () { function t(t, e) { for (var n = 0; n < e.length; n++) { var o = e[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o) } } return function (e, n, o) { return n && t(e.prototype, n), o && t(e, o), e } }(); e.Push = function () { function t() { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "/service-worker.js"; return o(this, t), this.subData = {}, this.workerPath = e, this.listeners = { onPermissionGranted: [], onPermissionDenied: [], onSubscriptionSuccess: [], onSubscriptionCancel: [], onWorkerError: [], onWorkerSuccess: [], onWorkerNotSupported: [] }, this } return i(t, [{ key: "on", value: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : function () { }; return "function" == typeof e && this.listeners.hasOwnProperty(t) && this.listeners[t].push(e), this } }, { key: "fire", value: function (t) { var e = this, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : []; this.listeners.hasOwnProperty(t) && this.listeners[t].forEach(function (t) { "function" == typeof t && t.apply(e, n) }) } }, { key: "create", value: function () { console.log("NOT IMPLEMENTED YET") } }, { key: "isSupported", value: function () { var t = !1; try { t = window.Notification || window.webkitNotifications || navigator.mozNotification || window.external && void 0 !== window.external.msIsSiteMode() } catch (t) { } return t } }, { key: "getPermissionStatus", value: function () { var t = "default"; if (window.Notification && window.Notification.permissionLevel) t = window.Notification.permissionLevel; else if (window.webkitNotifications && window.webkitNotifications.checkPermission) switch (window.webkitNotifications.checkPermission()) { case 1: t = "default"; break; case 0: t = "granted"; break; default: t = "denied" } else window.Notification && window.Notification.permission ? t = window.Notification.permission : navigator.mozNotification ? t = "granted" : window.external && void 0 !== window.external.msIsSiteMode() && (t = window.external.msIsSiteMode() ? "granted" : "default"); return t.toString().toLowerCase() } }, { key: "getEndpoint", value: function (t) { var e = t.endpoint, n = t.subscriptionId; return n && -1 === e.indexOf(n) && (e += "/" + n), e } }, { key: "isSWRegistered", value: function () { try { return "activated" === navigator.serviceWorker.controller.state } catch (t) { return !1 } } }, { key: "unregisterWorker", value: function () { var t = this; "serviceWorker" in navigator && navigator.serviceWorker.getRegistrations().then(function (e) { var n = !0, o = !1, i = void 0; try { for (var r, s = e[Symbol.iterator](); !(n = (r = s.next()).done); n = !0) { r.value.unregister(), t.fire("onSubscriptionCancel") } } catch (t) { o = !0, i = t } finally { try { !n && s.return && s.return() } finally { if (o) throw i } } }) } }, { key: "requestSubscription", value: function () { var t = this, e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0], n = this, o = this.getPermissionStatus(), i = function (o) { "granted" === o ? (t.fire("onPermissionGranted"), "serviceWorker" in navigator ? navigator.serviceWorker.register(t.workerPath).then(function () { navigator.serviceWorker.ready.then(function (t) { n.fire("onWorkerSuccess"), t.pushManager.subscribe({ userVisibleOnly: e }).then(function (t) { var e = t.getKey("p256dh"), o = t.getKey("auth"); n.subData = { endpoint: n.getEndpoint(t), p256dh: e ? window.btoa(String.fromCharCode.apply(null, new Uint8Array(e))) : null, auth: o ? window.btoa(String.fromCharCode.apply(null, new Uint8Array(o))) : null }, n.fire("onSubscriptionSuccess", [n.subData]) }).catch(function (t) { n.fire("onWorkerError", [t]) }) }) }) : n.fire("onWorkerNotSupported")) : "denied" === o && (t.fire("onPermissionDenied"), t.unregisterWorker()) }; "default" === o ? window.Notification && window.Notification.requestPermission ? window.Notification.requestPermission(i) : window.webkitNotifications && window.webkitNotifications.checkPermission && window.webkitNotifications.requestPermission(i) : i(o) } }]), t }() }, function (t, e, n) { (function (e, o) { !function (e, n) { t.exports = n() }(0, function () { "use strict"; function t(t) { return "function" == typeof t || "object" == typeof t && null !== t } function i(t) { return "function" == typeof t } function r(t) { z = t } function s(t) { U = t } function u() { return void 0 !== R ? function () { R(c) } : a() } function a() { var t = setTimeout; return function () { return t(c, 1) } } function c() { for (var t = 0; t < Q; t += 2) { (0, X[t])(X[t + 1]), X[t] = void 0, X[t + 1] = void 0 } Q = 0 } function l(t, e) { var n = arguments, o = this, i = new this.constructor(f); void 0 === i[tt] && A(i); var r = o._state; return r ? function () { var t = n[r - 1]; U(function () { return P(r, i, t, o._result) }) }() : S(o, i, t, e), i } function d(t) { var e = this; if (t && "object" == typeof t && t.constructor === e) return t; var n = new e(f); return g(n, t), n } function f() { } function h() { return new TypeError("You cannot resolve a promise with itself") } function p() { return new TypeError("A promises callback cannot return that same promise.") } function m(t) { try { return t.then } catch (t) { return it.error = t, it } } function v(t, e, n, o) { try { t.call(e, n, o) } catch (t) { return t } } function y(t, e, n) { U(function (t) { var o = !1, i = v(n, e, function (n) { o || (o = !0, e !== n ? g(t, n) : k(t, n)) }, function (e) { o || (o = !0, C(t, e)) }, "Settle: " + (t._label || " unknown promise")); !o && i && (o = !0, C(t, i)) }, t) } function b(t, e) { e._state === nt ? k(t, e._result) : e._state === ot ? C(t, e._result) : S(e, void 0, function (e) { return g(t, e) }, function (e) { return C(t, e) }) } function w(t, e, n) { e.constructor === t.constructor && n === l && e.constructor.resolve === d ? b(t, e) : n === it ? (C(t, it.error), it.error = null) : void 0 === n ? k(t, e) : i(n) ? y(t, e, n) : k(t, e) } function g(e, n) { e === n ? C(e, h()) : t(n) ? w(e, n, m(n)) : k(e, n) } function _(t) { t._onerror && t._onerror(t._result), D(t) } function k(t, e) { t._state === et && (t._result = e, t._state = nt, 0 !== t._subscribers.length && U(D, t)) } function C(t, e) { t._state === et && (t._state = ot, t._result = e, U(_, t)) } function S(t, e, n, o) { var i = t._subscribers, r = i.length; t._onerror = null, i[r] = e, i[r + nt] = n, i[r + ot] = o, 0 === r && t._state && U(D, t) } function D(t) { var e = t._subscribers, n = t._state; if (0 !== e.length) { for (var o = void 0, i = void 0, r = t._result, s = 0; s < e.length; s += 3)o = e[s], i = e[s + n], o ? P(n, o, i, r) : i(r); t._subscribers.length = 0 } } function x() { this.error = null } function E(t, e) { try { return t(e) } catch (t) { return rt.error = t, rt } } function P(t, e, n, o) { var r = i(n), s = void 0, u = void 0, a = void 0, c = void 0; if (r) { if (s = E(n, o), s === rt ? (c = !0, u = s.error, s.error = null) : a = !0, e === s) return void C(e, p()) } else s = o, a = !0; e._state !== et || (r && a ? g(e, s) : c ? C(e, u) : t === nt ? k(e, s) : t === ot && C(e, s)) } function T(t, e) { try { e(function (e) { g(t, e) }, function (e) { C(t, e) }) } catch (e) { C(t, e) } } function O() { return st++ } function A(t) { t[tt] = st++, t._state = void 0, t._result = void 0, t._subscribers = [] } function M(t, e) { this._instanceConstructor = t, this.promise = new t(f), this.promise[tt] || A(this.promise), I(e) ? (this._input = e, this.length = e.length, this._remaining = e.length, this._result = new Array(this.length), 0 === this.length ? k(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(), 0 === this._remaining && k(this.promise, this._result))) : C(this.promise, q()) } function q() { return new Error("Array Methods must be provided an Array") } function j(t) { return new M(this, t).promise } function N(t) { var e = this; return new e(I(t) ? function (n, o) { for (var i = t.length, r = 0; r < i; r++)e.resolve(t[r]).then(n, o) } : function (t, e) { return e(new TypeError("You must pass an array to race.")) }) } function L(t) { var e = this, n = new e(f); return C(n, t), n } function H() { throw new TypeError("You must pass a resolver function as the first argument to the promise constructor") } function W() { throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.") } function V(t) { this[tt] = O(), this._result = this._state = void 0, this._subscribers = [], f !== t && ("function" != typeof t && H(), this instanceof V ? T(this, t) : W()) } function B() { var t = void 0; if (void 0 !== o) t = o; else if ("undefined" != typeof self) t = self; else try { t = Function("return this")() } catch (t) { throw new Error("polyfill failed because global object is unavailable in this environment") } var e = t.Promise; if (e) { var n = null; try { n = Object.prototype.toString.call(e.resolve()) } catch (t) { } if ("[object Promise]" === n && !e.cast) return } t.Promise = V } var F = void 0; F = Array.isArray ? Array.isArray : function (t) { return "[object Array]" === Object.prototype.toString.call(t) }; var I = F, Q = 0, R = void 0, z = void 0, U = function (t, e) { X[Q] = t, X[Q + 1] = e, 2 === (Q += 2) && (z ? z(c) : Z()) }, Y = "undefined" != typeof window ? window : void 0, K = Y || {}, G = K.MutationObserver || K.WebKitMutationObserver, $ = "undefined" == typeof self && void 0 !== e && "[object process]" === {}.toString.call(e), J = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel, X = new Array(1e3), Z = void 0; Z = $ ? function () { return function () { return e.nextTick(c) } }() : G ? function () { var t = 0, e = new G(c), n = document.createTextNode(""); return e.observe(n, { characterData: !0 }), function () { n.data = t = ++t % 2 } }() : J ? function () { var t = new MessageChannel; return t.port1.onmessage = c, function () { return t.port2.postMessage(0) } }() : void 0 === Y ? function () { try { var t = n(9); return R = t.runOnLoop || t.runOnContext, u() } catch (t) { return a() } }() : a(); var tt = Math.random().toString(36).substring(16), et = void 0, nt = 1, ot = 2, it = new x, rt = new x, st = 0; return M.prototype._enumerate = function () { for (var t = this.length, e = this._input, n = 0; this._state === et && n < t; n++)this._eachEntry(e[n], n) }, M.prototype._eachEntry = function (t, e) { var n = this._instanceConstructor, o = n.resolve; if (o === d) { var i = m(t); if (i === l && t._state !== et) this._settledAt(t._state, e, t._result); else if ("function" != typeof i) this._remaining--, this._result[e] = t; else if (n === V) { var r = new n(f); w(r, t, i), this._willSettleAt(r, e) } else this._willSettleAt(new n(function (e) { return e(t) }), e) } else this._willSettleAt(o(t), e) }, M.prototype._settledAt = function (t, e, n) { var o = this.promise; o._state === et && (this._remaining--, t === ot ? C(o, n) : this._result[e] = n), 0 === this._remaining && k(o, this._result) }, M.prototype._willSettleAt = function (t, e) { var n = this; S(t, void 0, function (t) { return n._settledAt(nt, e, t) }, function (t) { return n._settledAt(ot, e, t) }) }, V.all = j, V.race = N, V.resolve = d, V.reject = L, V._setScheduler = r, V._setAsap = s, V._asap = U, V.prototype = { constructor: V, then: l, catch: function (t) { return this.then(null, t) } }, V.polyfill = B, V.Promise = V, V }) }).call(e, n(7), n(8)) }, function (t, e) { }, function (t, e, n) { "use strict"; function o(t) { if (t && t.__esModule) return t; var e = {}; if (null != t) for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]); return e.default = t, e } function i(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") } Object.defineProperty(e, "__esModule", { value: !0 }); var r = function () { function t(t, e) { for (var n = 0; n < e.length; n++) { var o = e[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o) } } return function (e, n, o) { return n && t(e.prototype, n), o && t(e, o), e } }(); n(5); var s = n(4), u = function (t) { return t && t.__esModule ? t : { default: t } }(s), a = n(0), c = o(a), l = n(1), d = o(l), f = n(2), h = n(3), p = function () { function t() { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return i(this, t), this.options = c.deepExtend({}, d.Defaults, e), this.id = this.options.id || c.generateID("bar"), this.closeTimer = -1, this.barDom = null, this.layoutDom = null, this.progressDom = null, this.showing = !1, this.shown = !1, this.closed = !1, this.closing = !1, this.killable = this.options.timeout || this.options.closeWith.length > 0, this.hasSound = this.options.sounds.sources.length > 0, this.soundPlayed = !1, this.listeners = { beforeShow: [], onShow: [], afterShow: [], onClose: [], afterClose: [], onClick: [], onHover: [], onTemplate: [] }, this.promises = { show: null, close: null }, this.on("beforeShow", this.options.callbacks.beforeShow), this.on("onShow", this.options.callbacks.onShow), this.on("afterShow", this.options.callbacks.afterShow), this.on("onClose", this.options.callbacks.onClose), this.on("afterClose", this.options.callbacks.afterClose), this.on("onClick", this.options.callbacks.onClick), this.on("onHover", this.options.callbacks.onHover), this.on("onTemplate", this.options.callbacks.onTemplate), this } return r(t, [{ key: "on", value: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : function () { }; return "function" == typeof e && this.listeners.hasOwnProperty(t) && this.listeners[t].push(e), this } }, { key: "show", value: function () { var e = this; !0 === this.options.killer ? t.closeAll() : "string" == typeof this.options.killer && t.closeAll(this.options.killer); var n = d.getQueueCounts(this.options.queue); if (n.current >= n.maxVisible || d.PageHidden && this.options.visibilityControl) return d.addToQueue(this), d.PageHidden && this.hasSound && c.inArray("docHidden", this.options.sounds.conditions) && c.createAudioElements(this), d.PageHidden && c.inArray("docHidden", this.options.titleCount.conditions) && d.docTitle.increment(), this; if (d.Store[this.id] = this, d.fire(this, "beforeShow"), this.showing = !0, this.closing) return this.showing = !1, this; if (d.build(this), d.handleModal(this), this.options.force ? this.layoutDom.insertBefore(this.barDom, this.layoutDom.firstChild) : this.layoutDom.appendChild(this.barDom), this.hasSound && !this.soundPlayed && c.inArray("docVisible", this.options.sounds.conditions) && c.createAudioElements(this), c.inArray("docVisible", this.options.titleCount.conditions) && d.docTitle.increment(), this.shown = !0, this.closed = !1, d.hasButtons(this) && Object.keys(this.options.buttons).forEach(function (t) { var n = e.barDom.querySelector("#" + e.options.buttons[t].id); c.addListener(n, "click", function (n) { c.stopPropagation(n), e.options.buttons[t].cb() }) }), this.progressDom = this.barDom.querySelector(".noty_progressbar"), c.inArray("click", this.options.closeWith) && (c.addClass(this.barDom, "noty_close_with_click"), c.addListener(this.barDom, "click", function (t) { c.stopPropagation(t), d.fire(e, "onClick"), e.close() }, !1)), c.addListener(this.barDom, "mouseenter", function () { d.fire(e, "onHover") }, !1), this.options.timeout && c.addClass(this.barDom, "noty_has_timeout"), this.options.progressBar && c.addClass(this.barDom, "noty_has_progressbar"), c.inArray("button", this.options.closeWith)) { c.addClass(this.barDom, "noty_close_with_button"); var o = document.createElement("div"); c.addClass(o, "noty_close_button"), o.innerHTML = "Ã", this.barDom.appendChild(o), c.addListener(o, "click", function (t) { c.stopPropagation(t), e.close() }, !1) } return d.fire(this, "onShow"), null === this.options.animation.open ? this.promises.show = new u.default(function (t) { t() }) : "function" == typeof this.options.animation.open ? this.promises.show = new u.default(this.options.animation.open.bind(this)) : (c.addClass(this.barDom, this.options.animation.open), this.promises.show = new u.default(function (t) { c.addListener(e.barDom, c.animationEndEvents, function () { c.removeClass(e.barDom, e.options.animation.open), t() }) })), this.promises.show.then(function () { var t = e; setTimeout(function () { d.openFlow(t) }, 100) }), this } }, { key: "stop", value: function () { return d.dequeueClose(this), this } }, { key: "resume", value: function () { return d.queueClose(this), this } }, { key: "setTimeout", value: function (t) { function e(e) { return t.apply(this, arguments) } return e.toString = function () { return t.toString() }, e }(function (t) { if (this.stop(), this.options.timeout = t, this.barDom) { this.options.timeout ? c.addClass(this.barDom, "noty_has_timeout") : c.removeClass(this.barDom, "noty_has_timeout"); var e = this; setTimeout(function () { e.resume() }, 100) } return this }) }, { key: "setText", value: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; return this.barDom && (this.barDom.querySelector(".noty_body").innerHTML = t), e && (this.options.text = t), this } }, { key: "setType", value: function (t) { var e = this, n = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; if (this.barDom) { c.classList(this.barDom).split(" ").forEach(function (t) { "noty_type__" === t.substring(0, 11) && c.removeClass(e.barDom, t) }), c.addClass(this.barDom, "noty_type__" + t) } return n && (this.options.type = t), this } }, { key: "setTheme", value: function (t) { var e = this, n = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; if (this.barDom) { c.classList(this.barDom).split(" ").forEach(function (t) { "noty_theme__" === t.substring(0, 12) && c.removeClass(e.barDom, t) }), c.addClass(this.barDom, "noty_theme__" + t) } return n && (this.options.theme = t), this } }, { key: "close", value: function () { var t = this; return this.closed ? this : this.shown ? (d.fire(this, "onClose"), this.closing = !0, null === this.options.animation.close ? this.promises.close = new u.default(function (t) { t() }) : "function" == typeof this.options.animation.close ? this.promises.close = new u.default(this.options.animation.close.bind(this)) : (c.addClass(this.barDom, this.options.animation.close), this.promises.close = new u.default(function (e) { c.addListener(t.barDom, c.animationEndEvents, function () { t.options.force ? c.remove(t.barDom) : d.ghostFix(t), e() }) })), this.promises.close.then(function () { d.closeFlow(t), d.handleModalClose(t) }), this.closed = !0, this) : (d.removeFromQueue(this), this) } }], [{ key: "closeAll", value: function () { var t = arguments.length > 0 && void 0 !== arguments[0] && arguments[0]; return Object.keys(d.Store).forEach(function (e) { t ? d.Store[e].options.queue === t && d.Store[e].killable && d.Store[e].close() : d.Store[e].killable && d.Store[e].close() }), this } }, { key: "overrideDefaults", value: function (t) { return d.Defaults = c.deepExtend({}, d.Defaults, t), this } }, { key: "setMaxVisible", value: function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : d.DefaultMaxVisible, e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "global"; return d.Queues.hasOwnProperty(e) || (d.Queues[e] = { maxVisible: t, queue: [] }), d.Queues[e].maxVisible = t, this } }, { key: "button", value: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null, n = arguments[2], o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {}; return new f.NotyButton(t, e, n, o) } }, { key: "version", value: function () { return "3.1.3" } }, { key: "Push", value: function (t) { return new h.Push(t) } }]), t }(); e.default = p, c.visibilityChangeFlow(), t.exports = e.default }, function (t, e) { function n() { throw new Error("setTimeout has not been defined") } function o() { throw new Error("clearTimeout has not been defined") } function i(t) { if (l === setTimeout) return setTimeout(t, 0); if ((l === n || !l) && setTimeout) return l = setTimeout, setTimeout(t, 0); try { return l(t, 0) } catch (e) { try { return l.call(null, t, 0) } catch (e) { return l.call(this, t, 0) } } } function r(t) { if (d === clearTimeout) return clearTimeout(t); if ((d === o || !d) && clearTimeout) return d = clearTimeout, clearTimeout(t); try { return d(t) } catch (e) { try { return d.call(null, t) } catch (e) { return d.call(this, t) } } } function s() { m && h && (m = !1, h.length ? p = h.concat(p) : v = -1, p.length && u()) } function u() { if (!m) { var t = i(s); m = !0; for (var e = p.length; e;) { for (h = p, p = []; ++v < e;)h && h[v].run(); v = -1, e = p.length } h = null, m = !1, r(t) } } function a(t, e) { this.fun = t, this.array = e } function c() { } var l, d, f = t.exports = {}; !function () { try { l = "function" == typeof setTimeout ? setTimeout : n } catch (t) { l = n } try { d = "function" == typeof clearTimeout ? clearTimeout : o } catch (t) { d = o } }(); var h, p = [], m = !1, v = -1; f.nextTick = function (t) { var e = new Array(arguments.length - 1); if (arguments.length > 1) for (var n = 1; n < arguments.length; n++)e[n - 1] = arguments[n]; p.push(new a(t, e)), 1 !== p.length || m || i(u) }, a.prototype.run = function () { this.fun.apply(null, this.array) }, f.title = "browser", f.browser = !0, f.env = {}, f.argv = [], f.version = "", f.versions = {}, f.on = c, f.addListener = c, f.once = c, f.off = c, f.removeListener = c, f.removeAllListeners = c, f.emit = c, f.prependListener = c, f.prependOnceListener = c, f.listeners = function (t) { return [] }, f.binding = function (t) { throw new Error("process.binding is not supported") }, f.cwd = function () { return "/" }, f.chdir = function (t) { throw new Error("process.chdir is not supported") }, f.umask = function () { return 0 } }, function (t, e) { var n; n = function () { return this }(); try { n = n || Function("return this")() || (0, eval)("this") } catch (t) { "object" == typeof window && (n = window) } t.exports = n }, function (t, e) { }]) }); "use strict"; var janusReturnResult = { result_success: 200, result_success_message: "load data success", result_failed: 201, result_failed_message: "load data failed", result_error: 202, result_error_message: "load data error", result_exception: 203, result_exception_message: "load data exception", result_params: 204, result_params_message: "param is not invalid" }; var janus_host = document.domain; var static_server_url = "http://" + janus_host + ":8088/janus"; var ice_servers_tcp = []; var ice_servers_all = []; var server; var isAudioSend = false; var token = "123456"; function getInstanceKey(name) { var reg = new RegExp("[?&]" + name + "=([^?&]*)[&]?", "i"); var match = location.search.match(reg); return match == null ? "" : match[1] } Janus.sessions = {}; Janus.extensionId = "hapfgfdkleiggjjpfpenajgdnfckjpaj"; Janus.isExtensionEnabled = function () { if (window.navigator.userAgent.match("Chrome")) { var chromever = parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1], 10); var maxver = 33; if (window.navigator.userAgent.match("Linux")) maxver = 35; if (chromever >= 26 && chromever <= maxver) { return true } return $("#janus-extension-installed").length > 0 } else { return true } }; Janus.noop = function () { }; Janus.init = function (options) { options = options || {}; options.callback = typeof options.callback == "function" ? options.callback : Janus.noop; if (Janus.initDone === true) { options.callback() } else { if (typeof console == "undefined" || typeof console.log == "undefined") console = { log: function () { } }; Janus.trace = Janus.noop; Janus.debug = Janus.noop; Janus.log = Janus.noop; Janus.warn = Janus.noop; Janus.error = Janus.noop; if (options.debug === true || options.debug === "all") { Janus.trace = console.trace.bind(console); Janus.warn = console.warn.bind(console); Janus.error = console.error.bind(console) } else if (Array.isArray(options.debug)) { for (var i in options.debug) { var d = options.debug[i]; switch (d) { case "trace": Janus.trace = console.trace.bind(console); break; case "debug": break; case "log": break; case "warn": Janus.warn = console.warn.bind(console); break; case "error": Janus.error = console.error.bind(console); break; default: console.error("Unknown debugging option '" + d + "' (supported: 'trace', 'debug', 'log', warn', 'error')"); break } } } Janus.log("Initializing library"); Janus.listDevices = function (callback) { callback = typeof callback == "function" ? callback : Janus.noop; if (navigator.mediaDevices) { getUserMedia({ audio: true, video: true }, function (stream) { navigator.mediaDevices.enumerateDevices().then(function (devices) { Janus.debug(devices); callback(devices); try { stream.stop() } catch (e) { } try { var tracks = stream.getTracks(); for (var i in tracks) { var mst = tracks[i]; if (mst !== null && mst !== undefined) mst.stop() } } catch (e) { } }) }, function (err) { Janus.error(err); callback([]) }) } else { Janus.warn("navigator.mediaDevices unavailable"); callback([]) } }; window.onbeforeunload = function () { Janus.log("Closing window"); for (var s in Janus.sessions) { if (Janus.sessions[s] !== null && Janus.sessions[s] !== undefined && Janus.sessions[s].destroyOnUnload) { Janus.log("Destroying session " + s); Janus.sessions[s].destroy() } } }; function addJsList(srcArray) { if (!srcArray || !Array.isArray(srcArray) || srcArray.length == 0) { options.callback() } var count = 0; addJs(srcArray[count], next); function next() { count++; if (count < srcArray.length) { addJs(srcArray[count], next) } else { options.callback() } } } function addJs(src, done) { if (src === "jquery.min.js") { if (window.jQuery) { done(); return } } if (src === "adapter.js") { if (window.getUserMedia && window.RTCPeerConnection) { done(); return } } var oHead = document.getElementsByTagName("head").item(0); var oScript = document.createElement("script"); oScript.type = "text/javascript"; oScript.src = src; oScript.onload = function () { Janus.log("Library " + src + " loaded"); done() }; oHead.appendChild(oScript) } Janus.initDone = true; addJsList(["adapter.js", "jquery.min.js"]) } }; Janus.isWebrtcSupported = function () { return window.RTCPeerConnection && window.getUserMedia }; function Janus(gatewayCallbacks) { if (Janus.initDone === undefined) { gatewayCallbacks.error("Library not initialized"); return {} } if (!Janus.isWebrtcSupported()) { gatewayCallbacks.error("WebRTC not supported by this browser"); return {} } Janus.log("Library initialized: " + Janus.initDone); gatewayCallbacks = gatewayCallbacks || {}; gatewayCallbacks.success = typeof gatewayCallbacks.success == "function" ? gatewayCallbacks.success : jQuery.noop; gatewayCallbacks.error = typeof gatewayCallbacks.error == "function" ? gatewayCallbacks.error : jQuery.noop; gatewayCallbacks.destroyed = typeof gatewayCallbacks.destroyed == "function" ? gatewayCallbacks.destroyed : jQuery.noop; if (gatewayCallbacks.server === null || gatewayCallbacks.server === undefined) { gatewayCallbacks.error("Invalid gateway url"); return {} } var websockets = false; var ws = null; var wsHandlers = {}; var wsKeepaliveTimeoutId = null; var servers = null, serversIndex = 0; var server = gatewayCallbacks.server; if ($.isArray(server)) { Janus.log("Multiple servers provided (" + server.length + "), will use the first that works"); server = null; servers = gatewayCallbacks.server; Janus.debug(servers) } else { if (server.indexOf("ws") === 0) { websockets = true; Janus.log("Using WebSockets to contact Janus: " + server) } else { websockets = false; Janus.log("Using REST API to contact Janus: " + server) } } var transport_type = gatewayCallbacks.transportType; var iceServers = gatewayCallbacks.iceServers; if (iceServers === undefined || iceServers === null) iceServers = [{ url: "stun:stun.l.google.com:19302" }]; var ipv6Support = gatewayCallbacks.ipv6; if (ipv6Support === undefined || ipv6Support === null) ipv6Support = false; var maxev = null; if (gatewayCallbacks.max_poll_events !== undefined && gatewayCallbacks.max_poll_events !== null) maxev = gatewayCallbacks.max_poll_events; if (maxev < 1) maxev = 1; var token = null; if (gatewayCallbacks.token !== undefined && gatewayCallbacks.token !== null) token = gatewayCallbacks.token; var apisecret = null; if (gatewayCallbacks.apisecret !== undefined && gatewayCallbacks.apisecret !== null) apisecret = gatewayCallbacks.apisecret; this.destroyOnUnload = true; if (gatewayCallbacks.destroyOnUnload !== undefined && gatewayCallbacks.destroyOnUnload !== null) this.destroyOnUnload = gatewayCallbacks.destroyOnUnload === true; var connected = false; var sessionId = null; var pluginHandles = {}; var that = this; var retries = 0; var transactions = {}; var transactions = {}; createSession(gatewayCallbacks); this.getServer = function () { return server }; this.isConnected = function () { return connected }; this.getSessionId = function () { return sessionId }; this.destroy = function (callbacks) { destroySession(callbacks) }; this.attach = function (callbacks) { createHandle(callbacks) }; function randomString(len) { var charSet = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"; var randomString = ""; for (var i = 0; i < len; i++) { var randomPoz = Math.floor(Math.random() * charSet.length); randomString += charSet.substring(randomPoz, randomPoz + 1) } return randomString } function eventHandler() { if (sessionId == null) return; Janus.debug("Long poll..."); if (!connected) { Janus.warn("Is the gateway down? (connected=false)"); return } var longpoll = server + "/" + sessionId + "?rid=" + (new Date).getTime(); if (maxev !== undefined && maxev !== null) longpoll = longpoll + "&maxev=" + maxev; if (token !== null && token !== undefined) longpoll = longpoll + "&token=" + token; if (apisecret !== null && apisecret !== undefined) longpoll = longpoll + "&apisecret=" + apisecret; $.ajax({ type: "GET", url: longpoll, cache: false, timeout: 6e4, success: handleEvent, error: function (XMLHttpRequest, textStatus, errorThrown) { Janus.error(textStatus + ": " + errorThrown); retries++; if (retries > 3) { connected = false; gatewayCallbacks.error("è¿æ¥æ­å¼ï¼è¯·ç¨åå·æ°é¡µé¢"); return } eventHandler() }, dataType: "json" }) } function handleEvent(json) { retries = 0; if (!websockets && sessionId !== undefined && sessionId !== null) setTimeout(eventHandler, 200); Janus.debug("Got event on session " + sessionId); Janus.debug(json); if (!websockets && $.isArray(json)) { for (var i = 0; i < json.length; i++) { handleEvent(json[i]) } return } if (json["janus"] === "keepalive") { return } else if (json["janus"] === "ack") { var transaction = json["transaction"]; if (transaction !== null && transaction !== undefined) { var reportSuccess = transactions[transaction]; if (reportSuccess !== null && reportSuccess !== undefined) { reportSuccess(json) } delete transactions[transaction] } return } else if (json["janus"] === "success") { var transaction = json["transaction"]; if (transaction !== null && transaction !== undefined) { var reportSuccess = transactions[transaction]; if (reportSuccess !== null && reportSuccess !== undefined) { reportSuccess(json) } delete transactions[transaction] } return } else if (json["janus"] === "webrtcup") { var sender = json["sender"]; if (sender === undefined || sender === null) { Janus.warn("Missing sender..."); return } var pluginHandle = pluginHandles[sender]; if (pluginHandle === undefined || pluginHandle === null) { Janus.warn("This handle is not attached to this session"); return } pluginHandle.webrtcState(true); return } else if (json["janus"] === "hangup") { var sender = json["sender"]; if (sender === undefined || sender === null) { Janus.warn("Missing sender..."); return } var pluginHandle = pluginHandles[sender]; if (pluginHandle === undefined || pluginHandle === null) { Janus.warn("This handle is not attached to this session"); return } pluginHandle.webrtcState(false); pluginHandle.hangup() } else if (json["janus"] === "detached") { var sender = json["sender"]; if (sender === undefined || sender === null) { Janus.warn("Missing sender..."); return } var pluginHandle = pluginHandles[sender]; if (pluginHandle === undefined || pluginHandle === null) { return } pluginHandle.ondetached(); pluginHandle.detach() } else if (json["janus"] === "media") { var sender = json["sender"]; if (sender === undefined || sender === null) { Janus.warn("Missing sender..."); return } var pluginHandle = pluginHandles[sender]; if (pluginHandle === undefined || pluginHandle === null) { Janus.warn("This handle is not attached to this session"); return } pluginHandle.mediaState(json["type"], json["receiving"]) } else if (json["janus"] === "error") { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason); var transaction = json["transaction"]; if (transaction !== null && transaction !== undefined) { var reportSuccess = transactions[transaction]; if (reportSuccess !== null && reportSuccess !== undefined) { reportSuccess(json) } delete transactions[transaction] } return } else if (json["janus"] === "event") { var sender = json["sender"]; if (sender === undefined || sender === null) { Janus.warn("Missing sender..."); return } var plugindata = json["plugindata"]; if (plugindata === undefined || plugindata === null) { Janus.warn("Missing plugindata..."); return } Janus.debug("  -- Event is coming from " + sender + " (" + plugindata["plugin"] + ")"); var data = plugindata["data"]; Janus.debug(data); var pluginHandle = pluginHandles[sender]; if (pluginHandle === undefined || pluginHandle === null) { Janus.warn("This handle is not attached to this session"); return } var jsep = json["jsep"]; if (jsep !== undefined && jsep !== null) { Janus.debug("Handling SDP as well..."); Janus.debug(jsep) } var callback = pluginHandle.onmessage; if (callback !== null && callback !== undefined) { Janus.debug("Notifying application..."); callback(data, jsep) } else { Janus.debug("No provided notification callback") } } else { Janus.warn("Unknown message '" + json["janus"] + "'") } } function keepAlive() { if (server === null || !websockets || !connected) return; wsKeepaliveTimeoutId = setTimeout(keepAlive, 3e4); var request = { janus: "keepalive", session_id: sessionId, transaction: randomString(12) }; if (token !== null && token !== undefined) request["token"] = token; if (apisecret !== null && apisecret !== undefined) request["apisecret"] = apisecret; ws.send(JSON.stringify(request)) } function createSession(callbacks) { var transaction = randomString(12); var request = { janus: "create", transaction: transaction }; if (token !== null && token !== undefined) request["token"] = token; if (apisecret !== null && apisecret !== undefined) request["apisecret"] = apisecret; if (server === null && $.isArray(servers)) { server = servers[serversIndex]; if (server.indexOf("ws") === 0) { websockets = true; Janus.log("Server #" + (serversIndex + 1) + ": trying WebSockets to contact Janus (" + server + ")") } else { websockets = false; Janus.log("Server #" + (serversIndex + 1) + ": trying REST API to contact Janus (" + server + ")") } } if (websockets) { ws = new WebSocket(server, "janus-protocol"); wsHandlers = { error: function () { Janus.error("Error connecting to the Janus WebSockets server... " + server); if ($.isArray(servers)) { serversIndex++; if (serversIndex == servers.length) { callbacks.error("Error connecting to any of the provided Janus servers: Is the gateway down?"); return } server = null; setTimeout(function () { createSession(callbacks) }, 200); return } callbacks.error("Error connecting to the Janus WebSockets server: Is the gateway down?") }, open: function () { transactions[transaction] = function (json) { Janus.debug(json); if (json["janus"] !== "success") { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason); callbacks.error(json["error"].reason); return } wsKeepaliveTimeoutId = setTimeout(keepAlive, 3e4); connected = true; sessionId = json.data["id"]; Janus.log("Created session: " + sessionId); Janus.sessions[sessionId] = that; callbacks.success() }; ws.send(JSON.stringify(request)) }, message: function (event) { handleEvent(JSON.parse(event.data)) }, close: function () { if (server === null || !connected) { return } connected = false; gatewayCallbacks.error("Lost connection to the gateway (is it down?)") } }; for (var eventName in wsHandlers) { ws.addEventListener(eventName, wsHandlers[eventName]) } return } $.ajax({ type: "POST", url: server, cache: false, contentType: "application/json", data: JSON.stringify(request), success: function (json) { Janus.debug(json); if (json["janus"] !== "success") { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason); callbacks.error(json["error"].reason); return } connected = true; sessionId = json.data["id"]; Janus.log("Created session: " + sessionId); Janus.sessions[sessionId] = that; eventHandler(); callbacks.success() }, error: function (XMLHttpRequest, textStatus, errorThrown) { if ($.isArray(servers)) { serversIndex++; if (serversIndex == servers.length) { callbacks.error("Error connecting to any of the provided Janus servers: Is the gateway down?"); return } server = null; setTimeout(function () { createSession(callbacks) }, 200); return } if (errorThrown === "") { var htmlStr = $("#h_showmessage").text(); if (htmlStr.indexOf("è£è½½") >= 0) { $("#h_showmessage").text("å½åæ¸¸æå¯å¨å¤±è´¥ï¼è¯·å°è¯éæ°å¯å¨æ¸¸æ â¦â¦â¦"); $("#div_processbar").removeClass("progress-bar-others"); $("#div_processbar").addClass("progress-bar-failed") } else if (htmlStr.indexOf("å¯å¨") >= 0) { $("#h_showmessage").text("å½åæ¸¸æå¯å¨å¤±è´¥ï¼è¯·å°è¯éæ°å¯å¨æ¸¸æ â¦â¦â¦"); $("#div_processbar").removeClass("progress-bar-others"); $("#div_processbar").addClass("progress-bar-failed") } else if (htmlStr.indexOf("èµæº") >= 0) { $("#h_showmessage").text("å½åæ¸¸æå¯å¨å¤±è´¥ï¼è¯·å°è¯éæ°å¯å¨æ¸¸æ â¦â¦â¦"); $("#div_processbar").removeClass("progress-bar-others"); $("#div_processbar").addClass("progress-bar-failed") } callbacks.error(textStatus + ": Is the gateway down?") } else callbacks.error(textStatus + ": " + errorThrown) }, dataType: "json" }) } function destroySession(callbacks, syncRequest) { syncRequest = syncRequest === true; Janus.log("Destroying session " + sessionId + " (sync=" + syncRequest + ")"); callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; if (!connected) { Janus.warn("Is the gateway down? (connected=false)"); callbacks.success(); return } if (sessionId === undefined || sessionId === null) { Janus.warn("No session to destroy"); callbacks.success(); gatewayCallbacks.destroyed(); return } delete Janus.sessions[sessionId]; for (var ph in pluginHandles) { var phv = pluginHandles[ph]; Janus.log("Destroying handle " + phv.id + " (" + phv.plugin + ")"); destroyHandle(phv.id, null, syncRequest) } var request = { janus: "destroy", transaction: randomString(12) }; if (token !== null && token !== undefined) request["token"] = token; if (apisecret !== null && apisecret !== undefined) request["apisecret"] = apisecret; if (websockets) { request["session_id"] = sessionId; var unbindWebSocket = function () { for (var eventName in wsHandlers) { ws.removeEventListener(eventName, wsHandlers[eventName]) } ws.removeEventListener("message", onUnbindMessage); ws.removeEventListener("error", onUnbindError); if (wsKeepaliveTimeoutId) { clearTimeout(wsKeepaliveTimeoutId) } }; var onUnbindMessage = function (event) { var data = JSON.parse(event.data); if (data.session_id == request.session_id && data.transaction == request.transaction) { unbindWebSocket(); callbacks.success(); gatewayCallbacks.destroyed() } }; var onUnbindError = function (event) { unbindWebSocket(); callbacks.error("Failed to destroy the gateway: Is the gateway down?"); gatewayCallbacks.destroyed() }; ws.addEventListener("message", onUnbindMessage); ws.addEventListener("error", onUnbindError); ws.send(JSON.stringify(request)); return } $.ajax({ type: "POST", url: server + "/" + sessionId, async: syncRequest, cache: false, contentType: "application/json", data: JSON.stringify(request), success: function (json) { Janus.log("Destroyed session:"); Janus.debug(json); sessionId = null; connected = false; if (json["janus"] !== "success") { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason) } callbacks.success(); gatewayCallbacks.destroyed() }, error: function (XMLHttpRequest, textStatus, errorThrown) { Janus.error(textStatus + ": " + errorThrown); sessionId = null; connected = false; callbacks.success(); gatewayCallbacks.destroyed() }, dataType: "json" }) } function createHandle(callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : jQuery.noop; callbacks.consentDialog = typeof callbacks.consentDialog == "function" ? callbacks.consentDialog : jQuery.noop; callbacks.mediaState = typeof callbacks.mediaState == "function" ? callbacks.mediaState : jQuery.noop; callbacks.webrtcState = typeof callbacks.webrtcState == "function" ? callbacks.webrtcState : jQuery.noop; callbacks.onmessage = typeof callbacks.onmessage == "function" ? callbacks.onmessage : jQuery.noop; callbacks.onlocalstream = typeof callbacks.onlocalstream == "function" ? callbacks.onlocalstream : jQuery.noop; callbacks.onremotestream = typeof callbacks.onremotestream == "function" ? callbacks.onremotestream : jQuery.noop; callbacks.ondata = typeof callbacks.ondata == "function" ? callbacks.ondata : jQuery.noop; callbacks.ondataopen = typeof callbacks.ondataopen == "function" ? callbacks.ondataopen : jQuery.noop; callbacks.oncleanup = typeof callbacks.oncleanup == "function" ? callbacks.oncleanup : jQuery.noop; callbacks.ondetached = typeof callbacks.ondetached == "function" ? callbacks.ondetached : jQuery.noop; if (!connected) { Janus.warn("Is the gateway down? (connected=false)"); callbacks.error("Is the gateway down? (connected=false)"); return } var plugin = callbacks.plugin; if (plugin === undefined || plugin === null) { Janus.error("Invalid plugin"); callbacks.error("Invalid plugin"); return } var transaction = randomString(12); var request = { janus: "attach", plugin: plugin, transaction: transaction }; if (token !== null && token !== undefined) request["token"] = token; if (apisecret !== null && apisecret !== undefined) request["apisecret"] = apisecret; if (websockets) { transactions[transaction] = function (json) { Janus.debug(json); if (json["janus"] !== "success") { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason); callbacks.error("Ooops: " + json["error"].code + " " + json["error"].reason); return } var handleId = json.data["id"]; Janus.log("Created handle: " + handleId); var pluginHandle = { session: that, plugin: plugin, id: handleId, webrtcStuff: { started: false, myStream: null, streamExternal: false, remoteStream: null, mySdp: null, pc: null, dataChannel: null, dtmfSender: null, trickle: true, iceDone: false, sdpSent: false, volume: { value: null, timer: null }, bitrate: { value: null, bsnow: null, bsbefore: null, tsnow: null, tsbefore: null, timer: null } }, getId: function () { return handleId }, getPlugin: function () { return plugin }, getVolume: function () { return getVolume(handleId) }, isAudioMuted: function () { return isMuted(handleId, false) }, muteAudio: function () { return mute(handleId, false, true) }, unmuteAudio: function () { return mute(handleId, false, false) }, isVideoMuted: function () { return isMuted(handleId, true) }, muteVideo: function () { return mute(handleId, true, true) }, unmuteVideo: function () { return mute(handleId, true, false) }, getBitrate: function () { return getBitrate(handleId) }, send: function (callbacks) { sendMessage(handleId, callbacks) }, data: function (callbacks) { sendData(handleId, callbacks) }, dtmf: function (callbacks) { sendDtmf(handleId, callbacks) }, consentDialog: callbacks.consentDialog, mediaState: callbacks.mediaState, webrtcState: callbacks.webrtcState, onmessage: callbacks.onmessage, createOffer: function (callbacks) { prepareWebrtc(handleId, callbacks) }, createAnswer: function (callbacks) { prepareWebrtc(handleId, callbacks) }, handleRemoteJsep: function (callbacks) { prepareWebrtcPeer(handleId, callbacks) }, onlocalstream: callbacks.onlocalstream, onremotestream: callbacks.onremotestream, ondata: callbacks.ondata, ondataopen: callbacks.ondataopen, oncleanup: callbacks.oncleanup, ondetached: callbacks.ondetached, hangup: function (sendRequest) { cleanupWebrtc(handleId, sendRequest === true) }, detach: function (callbacks) { destroyHandle(handleId, callbacks) } }; pluginHandles[handleId] = pluginHandle; callbacks.success(pluginHandle) }; request["session_id"] = sessionId; ws.send(JSON.stringify(request)); return } $.ajax({ type: "POST", url: server + "/" + sessionId, cache: false, contentType: "application/json", data: JSON.stringify(request), success: function (json) { Janus.debug(json); if (json["janus"] !== "success") { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason); callbacks.error("Ooops: " + json["error"].code + " " + json["error"].reason); return } var handleId = json.data["id"]; Janus.log("Created handle: " + handleId); var pluginHandle = { session: that, plugin: plugin, id: handleId, webrtcStuff: { started: false, myStream: null, streamExternal: false, remoteStream: null, mySdp: null, pc: null, dataChannel: null, dtmfSender: null, trickle: true, iceDone: false, sdpSent: false, volume: { value: null, timer: null }, bitrate: { value: null, bsnow: null, bsbefore: null, tsnow: null, tsbefore: null, timer: null } }, getId: function () { return handleId }, getPlugin: function () { return plugin }, getVolume: function () { return getVolume(handleId) }, isAudioMuted: function () { return isMuted(handleId, false) }, muteAudio: function () { return mute(handleId, false, true) }, unmuteAudio: function () { return mute(handleId, false, false) }, isVideoMuted: function () { return isMuted(handleId, true) }, muteVideo: function () { return mute(handleId, true, true) }, unmuteVideo: function () { return mute(handleId, true, false) }, getBitrate: function () { return getBitrate(handleId) }, send: function (callbacks) { sendMessage(handleId, callbacks) }, data: function (callbacks) { sendData(handleId, callbacks) }, dtmf: function (callbacks) { sendDtmf(handleId, callbacks) }, consentDialog: callbacks.consentDialog, mediaState: callbacks.mediaState, webrtcState: callbacks.webrtcState, onmessage: callbacks.onmessage, createOffer: function (callbacks) { prepareWebrtc(handleId, callbacks) }, createAnswer: function (callbacks) { prepareWebrtc(handleId, callbacks) }, handleRemoteJsep: function (callbacks) { prepareWebrtcPeer(handleId, callbacks) }, onlocalstream: callbacks.onlocalstream, onremotestream: callbacks.onremotestream, ondata: callbacks.ondata, ondataopen: callbacks.ondataopen, oncleanup: callbacks.oncleanup, ondetached: callbacks.ondetached, hangup: function (sendRequest) { cleanupWebrtc(handleId, sendRequest === true) }, detach: function (callbacks) { destroyHandle(handleId, callbacks) } }; pluginHandles[handleId] = pluginHandle; callbacks.success(pluginHandle) }, error: function (XMLHttpRequest, textStatus, errorThrown) { Janus.error(textStatus + ": " + errorThrown) }, dataType: "json" }) } function sendMessage(handleId, callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : jQuery.noop; if (!connected) { Janus.warn("Is the gateway down? (connected=false)"); callbacks.error("Is the gateway down? (connected=false)"); return } var message = callbacks.message; var jsep = callbacks.jsep; var transaction = randomString(12); var request = { janus: "message", body: message, transaction: transaction }; if (token !== null && token !== undefined) request["token"] = token; if (apisecret !== null && apisecret !== undefined) request["apisecret"] = apisecret; if (jsep !== null && jsep !== undefined) request.jsep = jsep; Janus.debug("Sending message to plugin (handle=" + handleId + "):"); Janus.debug(request); if (websockets) { request["session_id"] = sessionId; request["handle_id"] = handleId; transactions[transaction] = function (json) { Janus.debug("Message sent!"); Janus.debug(json); if (json["janus"] === "success") { var plugindata = json["plugindata"]; if (plugindata === undefined || plugindata === null) { Janus.warn("Request succeeded, but missing plugindata..."); callbacks.success(); return } Janus.log("Synchronous transaction successful (" + plugindata["plugin"] + ")"); var data = plugindata["data"]; Janus.debug(data); callbacks.success(data); return } else if (json["janus"] !== "ack") { if (json["error"] !== undefined && json["error"] !== null) { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason); callbacks.error(json["error"].code + " " + json["error"].reason) } else { Janus.error("Unknown error"); callbacks.error("Unknown error") } return } callbacks.success() }; ws.send(JSON.stringify(request)); return } $.ajax({ type: "POST", url: server + "/" + sessionId + "/" + handleId, cache: false, contentType: "application/json", data: JSON.stringify(request), success: function (json) { Janus.debug("Message sent!"); Janus.debug(json); if (json["janus"] === "success") { var plugindata = json["plugindata"]; if (plugindata === undefined || plugindata === null) { Janus.warn("Request succeeded, but missing plugindata..."); callbacks.success(); return } Janus.log("Synchronous transaction successful (" + plugindata["plugin"] + ")"); var data = plugindata["data"]; Janus.debug(data); callbacks.success(data); return } else if (json["janus"] !== "ack") { if (json["error"] !== undefined && json["error"] !== null) { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason); callbacks.error(json["error"].code + " " + json["error"].reason) } else { Janus.error("Unknown error"); callbacks.error("Unknown error") } return } callbacks.success() }, error: function (XMLHttpRequest, textStatus, errorThrown) { Janus.error(textStatus + ": " + errorThrown); callbacks.error(textStatus + ": " + errorThrown) }, dataType: "json" }) } function sendTrickleCandidate(handleId, candidate) { if (!connected) { Janus.warn("Is the gateway down? (connected=false)"); return } var request = { janus: "trickle", candidate: candidate, transaction: randomString(12) }; if (token !== null && token !== undefined) request["token"] = token; if (apisecret !== null && apisecret !== undefined) request["apisecret"] = apisecret; Janus.debug("Sending trickle candidate (handle=" + handleId + "):"); Janus.debug(request); if (websockets) { request["session_id"] = sessionId; request["handle_id"] = handleId; ws.send(JSON.stringify(request)); return } $.ajax({ type: "POST", url: server + "/" + sessionId + "/" + handleId, cache: false, contentType: "application/json", data: JSON.stringify(request), success: function (json) { Janus.debug("Candidate sent!"); Janus.debug(json); if (json["janus"] !== "ack") { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason); return } }, error: function (XMLHttpRequest, textStatus, errorThrown) { Janus.error(textStatus + ": " + errorThrown) }, dataType: "json" }) } function sendData(handleId, callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : jQuery.noop; var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); callbacks.error("Invalid handle"); return } var config = pluginHandle.webrtcStuff; var text = callbacks.text; if (text === null || text === undefined) { Janus.warn("Invalid text"); callbacks.error("Invalid text"); return } config.dataChannel.send(text); callbacks.success() } function sendDtmf(handleId, callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : jQuery.noop; var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); callbacks.error("Invalid handle"); return } var config = pluginHandle.webrtcStuff; if (config.dtmfSender === null || config.dtmfSender === undefined) { if (config.myStream !== undefined && config.myStream !== null) { var tracks = config.myStream.getAudioTracks(); if (tracks !== null && tracks !== undefined && tracks.length > 0) { var local_audio_track = tracks[0]; config.dtmfSender = config.pc.createDTMFSender(local_audio_track); Janus.log("Created DTMF Sender"); config.dtmfSender.ontonechange = function (tone) { Janus.debug("Sent DTMF tone: " + tone.tone) } } } if (config.dtmfSender === null || config.dtmfSender === undefined) { Janus.warn("Invalid DTMF configuration"); callbacks.error("Invalid DTMF configuration"); return } } var dtmf = callbacks.dtmf; if (dtmf === null || dtmf === undefined) { Janus.warn("Invalid DTMF parameters"); callbacks.error("Invalid DTMF parameters"); return } var tones = dtmf.tones; if (tones === null || tones === undefined) { Janus.warn("Invalid DTMF string"); callbacks.error("Invalid DTMF string"); return } var duration = dtmf.duration; if (duration === null || duration === undefined) duration = 500; var gap = dtmf.gap; if (gap === null || gap === undefined) gap = 50; Janus.debug("Sending DTMF string " + tones + " (duration " + duration + "ms, gap " + gap + "ms"); config.dtmfSender.insertDTMF(tones, duration, gap) } function destroyHandle(handleId, callbacks, syncRequest) { syncRequest = syncRequest === true; Janus.log("Destroying handle " + handleId + " (sync=" + syncRequest + ")"); callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : jQuery.noop; cleanupWebrtc(handleId); if (!connected) { Janus.warn("Is the gateway down? (connected=false)"); callbacks.error("Is the gateway down? (connected=false)"); return } var request = { janus: "detach", transaction: randomString(12) }; if (token !== null && token !== undefined) request["token"] = token; if (apisecret !== null && apisecret !== undefined) request["apisecret"] = apisecret; if (websockets) { request["session_id"] = sessionId; request["handle_id"] = handleId; ws.send(JSON.stringify(request)); delete pluginHandles[handleId]; callbacks.success(); return } $.ajax({ type: "POST", url: server + "/" + sessionId + "/" + handleId, async: syncRequest, cache: false, contentType: "application/json", data: JSON.stringify(request), success: function (json) { Janus.log("Destroyed handle:"); Janus.debug(json); if (json["janus"] !== "success") { Janus.error("Ooops: " + json["error"].code + " " + json["error"].reason) } delete pluginHandles[handleId]; callbacks.success() }, error: function (XMLHttpRequest, textStatus, errorThrown) { Janus.error(textStatus + ": " + errorThrown); delete pluginHandles[handleId]; callbacks.success() }, dataType: "json" }) } function streamsDone(handleId, jsep, media, callbacks, stream) { var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); callbacks.error("Invalid handle"); return } var config = pluginHandle.webrtcStuff; Janus.debug("streamsDone:", stream); config.myStream = stream; var pc_config = { iceServers: iceServers, iceTransportPolicy: transport_type }; var pc_constraints = { optional: [{ DtlsSrtpKeyAgreement: true }] }; if (ipv6Support === true) { pc_constraints.optional.push({ googIPv6: true }) } Janus.log("Creating PeerConnection"); Janus.debug(pc_constraints); config.pc = new RTCPeerConnection(pc_config, pc_constraints); handlePCStats(config.pc, pc_config); Janus.debug(config.pc); if (config.pc.getStats) { config.volume.value = 0; config.bitrate.value = "0 kbits/sec" } Janus.log("Preparing local SDP and gathering candidates (trickle=" + config.trickle + ")"); config.pc.onicecandidate = function (event) { if (event.candidate == null || webrtcDetectedBrowser === "edge" && event.candidate.candidate.indexOf("endOfCandidates") > 0) { Janus.log("End of candidates."); config.iceDone = true; if (config.trickle === true) { sendTrickleCandidate(handleId, { completed: true }) } else { sendSDP(handleId, callbacks) } } else { var candidate = { candidate: event.candidate.candidate, sdpMid: event.candidate.sdpMid, sdpMLineIndex: event.candidate.sdpMLineIndex }; if (config.trickle === true) { sendTrickleCandidate(handleId, candidate) } } }; if (stream !== null && stream !== undefined) { Janus.log("Adding local stream"); config.pc.addStream(stream); pluginHandle.onlocalstream(stream) } config.pc.onaddstream = function (remoteStream) { Janus.log("Handling Remote Stream"); Janus.debug(remoteStream); config.remoteStream = remoteStream; pluginHandle.onremotestream(remoteStream.stream) }; if (isDataEnabled(media)) { Janus.log("Creating data channel"); var onDataChannelMessage = function (event) { pluginHandle.ondata(event.data) }; var onDataChannelStateChange = function () { var dcState = config.dataChannel !== null ? config.dataChannel.readyState : "null"; Janus.log("State change on data channel: " + dcState); if (dcState === "open") { pluginHandle.ondataopen() } }; var onDataChannelError = function (error) { Janus.error("Got error on data channel:", error) }; config.dataChannel = config.pc.createDataChannel("JanusDataChannel", { ordered: false }); config.dataChannel.onmessage = onDataChannelMessage; config.dataChannel.onopen = onDataChannelStateChange; config.dataChannel.onclose = onDataChannelStateChange; config.dataChannel.onerror = onDataChannelError } if (jsep === null || jsep === undefined) { createOffer(handleId, media, callbacks) } else { config.pc.setRemoteDescription(new RTCSessionDescription(jsep), function () { Janus.log("Remote description accepted!"); createAnswer(handleId, media, callbacks) }, callbacks.error) } } function prepareWebrtc(handleId, callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : webrtcError; var jsep = callbacks.jsep; var media = callbacks.media; var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); callbacks.error("Invalid handle"); return } var config = pluginHandle.webrtcStuff; if (config.pc !== undefined && config.pc !== null) { Janus.log("Updating existing media session"); if (jsep === null || jsep === undefined) { createOffer(handleId, media, callbacks) } else { config.pc.setRemoteDescription(new RTCSessionDescription(jsep), function () { Janus.log("Remote description accepted!"); createAnswer(handleId, media, callbacks) }, callbacks.error) } return } if (callbacks.stream !== null && callbacks.stream !== undefined) { var stream = callbacks.stream; Janus.log("MediaStream provided by the application"); Janus.debug(stream); config.streamExternal = true; streamsDone(handleId, jsep, media, callbacks, stream); return } config.trickle = isTrickleEnabled(callbacks.trickle); if (isAudioSendEnabled(media) || isVideoSendEnabled(media)) { var constraints = { mandatory: {}, optional: [] }; pluginHandle.consentDialog(true); var audioSupport = isAudioSendEnabled(media); if (audioSupport === true && media != undefined && media != null) { if (typeof media.audio === "object") { audioSupport = media.audio } } var videoSupport = isVideoSendEnabled(media); if (videoSupport === true && media != undefined && media != null) { if (media.video && media.video != "screen" && media.video != "window") { var width = 0; var height = 0, maxHeight = 0; if (media.video === "lowres") { height = 240; maxHeight = 240; width = 320 } else if (media.video === "lowres-16:9") { height = 180; maxHeight = 180; width = 320 } else if (media.video === "hires" || media.video === "hires-16:9") { height = 720; maxHeight = 720; width = 1280; if (navigator.mozGetUserMedia) { var firefoxVer = parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1], 10); if (firefoxVer < 38) { Janus.warn(media.video + " unsupported, falling back to stdres (old Firefox)"); height = 480; maxHeight = 480; width = 640 } } } else if (media.video === "stdres") { height = 480; maxHeight = 480; width = 640 } else if (media.video === "stdres-16:9") { height = 360; maxHeight = 360; width = 640 } else { Janus.log("Default video setting (" + media.video + ") is stdres 4:3"); height = 480; maxHeight = 480; width = 640 } Janus.log("Adding media constraint " + media.video); if (navigator.mozGetUserMedia) { var firefoxVer = parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1], 10); if (firefoxVer < 38) { videoSupport = { require: ["height", "width"], height: { max: maxHeight, min: height }, width: { max: width, min: width } } } else { videoSupport = { height: { ideal: height }, width: { ideal: width } } } } else { videoSupport = { mandatory: { maxHeight: maxHeight, minHeight: height, maxWidth: width, minWidth: width }, optional: [] } } if (typeof media.video === "object") { videoSupport = media.video } Janus.debug(videoSupport) } else if (media.video === "screen" || media.video === "window") { if (window.location.protocol !== "https:") { Janus.warn("Screen sharing only works on HTTPS, try the https:// version of this page"); pluginHandle.consentDialog(false); callbacks.error("Screen sharing only works on HTTPS, try the https:// version of this page"); return } var cache = {}; function callbackUserMedia(error, stream) { pluginHandle.consentDialog(false); if (error) { callbacks.error({ code: error.code, name: error.name, message: error.message }) } else { streamsDone(handleId, jsep, media, callbacks, stream) } } function getScreenMedia(constraints, gsmCallback) { Janus.log("Adding media constraint (screen capture)"); Janus.debug(constraints); navigator.mediaDevices.getUserMedia(constraints).then(function (stream) { gsmCallback(null, stream) }).catch(function (error) { pluginHandle.consentDialog(false); gsmCallback(error) }) } if (window.navigator.userAgent.match("Chrome")) { var chromever = parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1], 10); var maxver = 33; if (window.navigator.userAgent.match("Linux")) maxver = 35; if (chromever >= 26 && chromever <= maxver) { constraints = { video: { mandatory: { googLeakyBucket: true, maxWidth: window.screen.width, maxHeight: window.screen.height, maxFrameRate: 3, chromeMediaSource: "screen" } }, audio: isAudioSendEnabled(media) }; getScreenMedia(constraints, callbackUserMedia) } else { var pending = window.setTimeout(function () { error = new Error("NavigatorUserMediaError"); error.name = 'The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)'; pluginHandle.consentDialog(false); return callbacks.error(error) }, 1e3); cache[pending] = [callbackUserMedia, null]; window.postMessage({ type: "janusGetScreen", id: pending }, "*") } } else if (window.navigator.userAgent.match("Firefox")) { var ffver = parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1], 10); if (ffver >= 33) { constraints = { video: { mozMediaSource: media.video, mediaSource: media.video }, audio: isAudioSendEnabled(media) }; getScreenMedia(constraints, function (err, stream) { callbackUserMedia(err, stream); if (!err) { var lastTime = stream.currentTime; var polly = window.setInterval(function () { if (!stream) window.clearInterval(polly); if (stream.currentTime == lastTime) { window.clearInterval(polly); if (stream.onended) { stream.onended() } } lastTime = stream.currentTime }, 500) } }) } else { var error = new Error("NavigatorUserMediaError"); error.name = "Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)"; pluginHandle.consentDialog(false); callbacks.error(error); return } } window.addEventListener("message", function (event) { if (event.origin != window.location.origin) return; if (event.data.type == "janusGotScreen" && cache[event.data.id]) { var data = cache[event.data.id]; var callback = data[0]; delete cache[event.data.id]; if (event.data.sourceId === "") { var error = new Error("NavigatorUserMediaError"); error.name = "You cancelled the request for permission, giving up..."; pluginHandle.consentDialog(false); callbacks.error(error) } else { constraints = { audio: isAudioSendEnabled(media), video: { mandatory: { chromeMediaSource: "desktop", maxWidth: window.screen.width, maxHeight: window.screen.height, maxFrameRate: 3 }, optional: [{ googLeakyBucket: true }, { googTemporalLayeredScreencast: true }] } }; constraints.video.mandatory.chromeMediaSourceId = event.data.sourceId; getScreenMedia(constraints, callback) } } else if (event.data.type == "janusGetScreenPending") { window.clearTimeout(event.data.id) } }); return } } if (media === null || media === undefined || media.video !== "screen") { navigator.mediaDevices.enumerateDevices().then(function (devices) { var audioExist = devices.some(function (device) { return device.kind === "audioinput" }), videoExist = devices.some(function (device) { return device.kind === "videoinput" }); var audioSend = isAudioSendEnabled(media); var videoSend = isVideoSendEnabled(media); if (audioSend || videoSend) { var haveAudioDevice = audioSend ? audioExist : false; var haveVideoDevice = videoSend ? videoExist : false; if (!haveAudioDevice && !haveVideoDevice) { pluginHandle.consentDialog(false); callbacks.error("No capture device found"); return false } } navigator.mediaDevices.getUserMedia({ audio: audioExist ? audioSupport : false, video: videoExist ? videoSupport : false }).then(function (stream) { pluginHandle.consentDialog(false); streamsDone(handleId, jsep, media, callbacks, stream) }).catch(function (error) { pluginHandle.consentDialog(false); callbacks.error({ code: error.code, name: error.name, message: error.message }) }) }).catch(function (error) { pluginHandle.consentDialog(false); callbacks.error("enumerateDevices error", error) }) } } else { streamsDone(handleId, jsep, media, callbacks) } } function prepareWebrtcPeer(handleId, callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : webrtcError; var jsep = callbacks.jsep; var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); callbacks.error("Invalid handle"); return } var config = pluginHandle.webrtcStuff; if (jsep !== undefined && jsep !== null) { if (config.pc === null) { Janus.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"); callbacks.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep"); return } config.pc.setRemoteDescription(new RTCSessionDescription(jsep), function () { Janus.log("Remote description accepted!"); callbacks.success() }, callbacks.error) } else { callbacks.error("Invalid JSEP") } } function createOffer(handleId, media, callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : jQuery.noop; var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); callbacks.error("Invalid handle"); return } var config = pluginHandle.webrtcStuff; Janus.log("Creating offer (iceDone=" + config.iceDone + ")"); var mediaConstraints = null; if (webrtcDetectedBrowser == "firefox" || webrtcDetectedBrowser == "edge") { mediaConstraints = { offerToReceiveAudio: isAudioRecvEnabled(media), offerToReceiveVideo: isVideoRecvEnabled(media) } } else { mediaConstraints = { mandatory: { OfferToReceiveAudio: isAudioRecvEnabled(media), OfferToReceiveVideo: isVideoRecvEnabled(media) } } } Janus.debug(mediaConstraints); config.pc.createOffer(function (offer) { Janus.debug(offer); if (config.mySdp === null || config.mySdp === undefined) { Janus.log("Setting local description"); config.mySdp = offer.sdp; config.pc.setLocalDescription(offer) } if (!config.iceDone && !config.trickle) { Janus.log("Waiting for all candidates..."); return } if (config.sdpSent) { Janus.log("Offer already sent, not sending it again"); return } Janus.log("Offer ready"); Janus.debug(callbacks); config.sdpSent = true; var jsep = { type: offer.type, sdp: offer.sdp }; callbacks.success(jsep) }, callbacks.error, mediaConstraints) } function createAnswer(handleId, media, callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : jQuery.noop; var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); callbacks.error("Invalid handle"); return } var config = pluginHandle.webrtcStuff; Janus.log("Creating answer (iceDone=" + config.iceDone + ")"); var mediaConstraints = null; if (webrtcDetectedBrowser == "firefox" || webrtcDetectedBrowser == "edge") { mediaConstraints = { offerToReceiveAudio: isAudioRecvEnabled(media), offerToReceiveVideo: isVideoRecvEnabled(media) } } else { mediaConstraints = { mandatory: { OfferToReceiveAudio: isAudioRecvEnabled(media), OfferToReceiveVideo: isVideoRecvEnabled(media) } } } Janus.debug(mediaConstraints); config.pc.createAnswer(function (answer) { Janus.debug(answer); if (config.mySdp === null || config.mySdp === undefined) { Janus.log("Setting local description"); config.mySdp = answer.sdp; var newchar = "fmtp:111 stereo=1;"; answer.sdp = answer.sdp.split("fmtp:111").join(newchar); config.pc.setLocalDescription(answer) } if (!config.iceDone && !config.trickle) { Janus.log("Waiting for all candidates..."); return } if (config.sdpSent) { Janus.log("Answer already sent, not sending it again"); return } config.sdpSent = true; var jsep = { type: answer.type, sdp: answer.sdp }; callbacks.success(jsep) }, callbacks.error, mediaConstraints) } function sendSDP(handleId, callbacks) { callbacks = callbacks || {}; callbacks.success = typeof callbacks.success == "function" ? callbacks.success : jQuery.noop; callbacks.error = typeof callbacks.error == "function" ? callbacks.error : jQuery.noop; var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle, not sending anything"); return } var config = pluginHandle.webrtcStuff; Janus.log("Sending offer/answer SDP..."); if (config.mySdp === null || config.mySdp === undefined) { Janus.warn("Local SDP instance is invalid, not sending anything..."); return } config.mySdp = { type: config.pc.localDescription.type, sdp: config.pc.localDescription.sdp }; if (config.sdpSent) { Janus.log("Offer/Answer SDP already sent, not sending it again"); return } if (config.trickle === false) config.mySdp["trickle"] = false; Janus.debug(callbacks); config.sdpSent = true; callbacks.success(config.mySdp) } function getVolume(handleId) { var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); return 0 } var config = pluginHandle.webrtcStuff; if (config.pc.getStats && webrtcDetectedBrowser == "chrome") { if (config.remoteStream === null || config.remoteStream === undefined) { Janus.warn("Remote stream unavailable"); return 0 } if (config.volume.timer === null || config.volume.timer === undefined) { Janus.log("Starting volume monitor"); config.volume.timer = setInterval(function () { config.pc.getStats(function (stats) { var results = stats.result(); for (var i = 0; i < results.length; i++) { var res = results[i]; if (res.type == "ssrc" && res.stat("audioOutputLevel")) { config.volume.value = res.stat("audioOutputLevel") } } }) }, 200); return 0 } return config.volume.value } else { Janus.log("Getting the remote volume unsupported by browser"); return 0 } } function isMuted(handleId, video) { var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); return true } var config = pluginHandle.webrtcStuff; if (config.pc === null || config.pc === undefined) { Janus.warn("Invalid PeerConnection"); return true } if (config.myStream === undefined || config.myStream === null) { Janus.warn("Invalid local MediaStream"); return true } if (video) { if (config.myStream.getVideoTracks() === null || config.myStream.getVideoTracks() === undefined || config.myStream.getVideoTracks().length === 0) { Janus.warn("No video track"); return true } return !config.myStream.getVideoTracks()[0].enabled } else { if (config.myStream.getAudioTracks() === null || config.myStream.getAudioTracks() === undefined || config.myStream.getAudioTracks().length === 0) { Janus.warn("No audio track"); return true } return !config.myStream.getAudioTracks()[0].enabled } } function mute(handleId, video, mute) { var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); return false } var config = pluginHandle.webrtcStuff; if (config.pc === null || config.pc === undefined) { Janus.warn("Invalid PeerConnection"); return false } if (config.myStream === undefined || config.myStream === null) { Janus.warn("Invalid local MediaStream"); return false } if (video) { if (config.myStream.getVideoTracks() === null || config.myStream.getVideoTracks() === undefined || config.myStream.getVideoTracks().length === 0) { Janus.warn("No video track"); return false } config.myStream.getVideoTracks()[0].enabled = mute ? false : true; return true } else { if (config.myStream.getAudioTracks() === null || config.myStream.getAudioTracks() === undefined || config.myStream.getAudioTracks().length === 0) { Janus.warn("No audio track"); return false } config.myStream.getAudioTracks()[0].enabled = mute ? false : true; return true } } function getBitrate(handleId) { var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined || pluginHandle.webrtcStuff === null || pluginHandle.webrtcStuff === undefined) { Janus.warn("Invalid handle"); return "Invalid handle" } var config = pluginHandle.webrtcStuff; if (config.pc === null || config.pc === undefined) return "Invalid PeerConnection"; if (config.pc.getStats && webrtcDetectedBrowser == "chrome") { if (config.remoteStream === null || config.remoteStream === undefined) { Janus.warn("Remote stream unavailable"); return "Remote stream unavailable" } if (config.bitrate.timer === null || config.bitrate.timer === undefined) { Janus.log("Starting bitrate timer (Chrome)"); config.bitrate.timer = setInterval(function () { config.pc.getStats(function (stats) { var results = stats.result(); for (var i = 0; i < results.length; i++) { var res = results[i]; if (res.type == "ssrc" && res.stat("googFrameHeightReceived")) { config.bitrate.bsnow = res.stat("bytesReceived"); config.bitrate.tsnow = res.timestamp; if (config.bitrate.bsbefore === null || config.bitrate.tsbefore === null) { config.bitrate.bsbefore = config.bitrate.bsnow; config.bitrate.tsbefore = config.bitrate.tsnow } else { var bitRate = Math.round((config.bitrate.bsnow - config.bitrate.bsbefore) * 8 / (config.bitrate.tsnow - config.bitrate.tsbefore)); config.bitrate.value = bitRate + " kbits/sec"; config.bitrate.bsbefore = config.bitrate.bsnow; config.bitrate.tsbefore = config.bitrate.tsnow } } } }) }, 1e3); return "0 kbits/sec" } return config.bitrate.value } else if (config.pc.getStats && webrtcDetectedBrowser == "firefox") { if (config.remoteStream === null || config.remoteStream === undefined || config.remoteStream.stream === null || config.remoteStream.stream === undefined) { Janus.warn("Remote stream unavailable"); return "Remote stream unavailable" } var videoTracks = config.remoteStream.stream.getVideoTracks(); if (videoTracks === null || videoTracks === undefined || videoTracks.length < 1) { Janus.warn("No video track"); return "No video track" } if (config.bitrate.timer === null || config.bitrate.timer === undefined) { Janus.log("Starting bitrate timer (Firefox)"); config.bitrate.timer = setInterval(function () { var cb = function (res) { if (res === null || res === undefined || res.inbound_rtp_video_1 == null || res.inbound_rtp_video_1 == null) { config.bitrate.value = "Missing inbound_rtp_video_1"; return } config.bitrate.bsnow = res.inbound_rtp_video_1.bytesReceived; config.bitrate.tsnow = res.inbound_rtp_video_1.timestamp; if (config.bitrate.bsbefore === null || config.bitrate.tsbefore === null) { config.bitrate.bsbefore = config.bitrate.bsnow; config.bitrate.tsbefore = config.bitrate.tsnow } else { var bitRate = Math.round((config.bitrate.bsnow - config.bitrate.bsbefore) * 8 / (config.bitrate.tsnow - config.bitrate.tsbefore)); config.bitrate.value = bitRate + " kbits/sec"; config.bitrate.bsbefore = config.bitrate.bsnow; config.bitrate.tsbefore = config.bitrate.tsnow } }; config.pc.getStats(videoTracks[0], function (stats) { cb(stats) }, cb) }, 1e3); return "0 kbits/sec" } return config.bitrate.value } else { Janus.warn("Getting the video bitrate unsupported by browser"); return "Feature unsupported by browser" } } function webrtcError(error) { Janus.error("WebRTC error:", error) } function cleanupWebrtc(handleId, hangupRequest) { Janus.log("Cleaning WebRTC stuff"); var pluginHandle = pluginHandles[handleId]; if (pluginHandle === null || pluginHandle === undefined) { return } var config = pluginHandle.webrtcStuff; if (config !== null && config !== undefined) { if (hangupRequest === true) { var request = { janus: "hangup", transaction: randomString(12) }; if (token !== null && token !== undefined) request["token"] = token; if (apisecret !== null && apisecret !== undefined) request["apisecret"] = apisecret; Janus.debug("Sending hangup request (handle=" + handleId + "):"); Janus.debug(request); if (websockets) { request["session_id"] = sessionId; request["handle_id"] = handleId; ws.send(JSON.stringify(request)) } else { $.ajax({ type: "POST", url: server + "/" + sessionId + "/" + handleId, cache: false, contentType: "application/json", data: JSON.stringify(request), dataType: "json" }) } } config.remoteStream = null; if (config.volume.timer) clearInterval(config.volume.timer); config.volume.value = null; if (config.bitrate.timer) clearInterval(config.bitrate.timer); config.bitrate.timer = null; config.bitrate.bsnow = null; config.bitrate.bsbefore = null; config.bitrate.tsnow = null; config.bitrate.tsbefore = null; config.bitrate.value = null; try { if (!config.streamExternal && config.myStream !== null && config.myStream !== undefined) { Janus.log("Stopping local stream"); config.myStream.stop() } } catch (e) { } try { if (!config.streamExternal && config.myStream !== null && config.myStream !== undefined) { Janus.log("Stopping local stream tracks"); var tracks = config.myStream.getTracks(); for (var i in tracks) { var mst = tracks[i]; Janus.log(mst); if (mst !== null && mst !== undefined) mst.stop() } } } catch (e) { } config.streamExternal = false; config.myStream = null; try { config.pc.close() } catch (e) { } config.pc = null; config.mySdp = null; config.iceDone = false; config.sdpSent = false; config.dataChannel = null; config.dtmfSender = null } pluginHandle.oncleanup() } function isAudioSendEnabled(media) { Janus.debug("isAudioSendEnabled:", media); if (media === undefined || media === null) return true; if (media.audio === false) return false; if (media.audioSend === undefined || media.audioSend === null) return true; return media.audioSend === true } function isAudioRecvEnabled(media) { Janus.debug("isAudioRecvEnabled:", media); if (media === undefined || media === null) return true; if (media.audio === false) return false; if (media.audioRecv === undefined || media.audioRecv === null) return true; return media.audioRecv === true } function isVideoSendEnabled(media) { Janus.debug("isVideoSendEnabled:", media); if (webrtcDetectedBrowser == "edge") { Janus.warn("Edge doesn't support compatible video yet"); return false } if (media === undefined || media === null) return true; if (media.video === false) return false; if (media.videoSend === undefined || media.videoSend === null) return true; return media.videoSend === true } function isVideoRecvEnabled(media) { Janus.debug("isVideoRecvEnabled:", media); if (webrtcDetectedBrowser == "edge") { Janus.warn("Edge doesn't support compatible video yet"); return false } if (media === undefined || media === null) return true; if (media.video === false) return false; if (media.videoRecv === undefined || media.videoRecv === null) return true; return media.videoRecv === true } function isDataEnabled(media) { Janus.debug("isDataEnabled:", media); if (webrtcDetectedBrowser == "edge") { Janus.warn("Edge doesn't support data channels yet"); return false } if (media === undefined || media === null) return false; return media.data === true } function isTrickleEnabled(trickle) { Janus.debug("isTrickleEnabled:", trickle); if (trickle === undefined || trickle === null) return true; return trickle === true } } "use strict"; var startTime_input = undefined; var endTime_input = undefined; var doubleClick = false; var lastEven; var mobile = mobileCheck(); var pressKeyList = []; function mobileCheck() { var check = false; (function (a, b) { if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true })(navigator.userAgent || navigator.vendor || window.opera); return check } function handle_mouse_motion(e) { var msg = new DataChannelMsg; var mouseEvent; if (xc.cursorLock) { mouseEvent = new DataChannelMsgMouseMotion(xc, e); if (mouseEvent.x == 0 && mouseEvent.y == 0) return; if (mouseEvent.x >= 127) mouseEvent.x = 127; if (mouseEvent.y >= 127) mouseEvent.y = 127; if (mouseEvent.x <= -127) mouseEvent.x = -127; if (mouseEvent.y <= -127) mouseEvent.y = -127; if (xc.localCursorVisible) { $("#simulated-cursor-img").show(); xc.posX += mouseEvent.x; xc.posY += mouseEvent.y; var hotSpotX = parseInt($("#simulated-cursor").data("hotSpotX")); var hotSpotY = parseInt($("#simulated-cursor").data("hotSpotY")); if (xc.posX <= 0) { xc.posX = 0 } else if (xc.posX >= xc.videoWidth) { xc.posX = xc.videoWidth } if (xc.posY <= 0) { xc.posY = 0 } else if (xc.posY >= xc.videoHeight) { xc.posY = xc.videoHeight } var newPosX = xc.posX / xc.scaleX - hotSpotX + xc.display.offsetLeft; var newPosY = xc.posY / xc.scaleY - hotSpotY + xc.display.offsetTop; var xMax = xc.display.offsetLeft + xc.videoWidth / xc.scaleX; var yMax = xc.display.offsetTop + xc.videoHeight / xc.scaleY; var img_height = $("#simulated-cursor-img").height(); var img_width = $("#simulated-cursor-img").width(); var clip_height, clip_width; if (newPosY >= yMax - img_height) { clip_height = yMax - newPosY } else { clip_height = img_height } if (newPosX >= xMax - img_width) { clip_width = xMax - newPosX } else { clip_width = img_width } $("#simulated-cursor").css({ height: clip_height, width: clip_width, overflow: "hidden" }); $("#simulated-cursor").css({ top: newPosY, left: newPosX }); var localCursorPos = new DataChannelMsgMousePosition(xc); localCursorPos.x = resolution_scale(xc.posX, xc.videoWidth); localCursorPos.y = resolution_scale(xc.posY, xc.videoHeight); localCursorPos.button = xc.button; if (xc.selectedMouseMode == 4) sendMsg(msg.build_msg(INPUT_TYPE_MOUSE, localCursorPos)); if (xc.selectedMouseMode == 5) sendMsg(msg.build_msg(INPUT_TYPE_MOUSE_MOTION, mouseEvent)) } else { sendMsg(msg.build_msg(INPUT_TYPE_MOUSE_MOTION, changeSensitivity(mouseEvent))) } } else if (xc.cursorLockEnabled && !xc.cursorLock) { return } else { mouseEvent = new DataChannelMsgMousePosition(xc, e); sendMsg(msg.build_msg(INPUT_TYPE_MOUSE, mouseEvent)) } } function handle_mouse_press(e) { if (mobile) { if (startTime_input == undefined) { startTime_input = (new Date).getTime() } else { if (endTime_input == undefined) { endTime_input = (new Date).getTime(); var diff = endTime_input - startTime_input; if (diff < 1e3) { doubleClick = true; lastEven = e } startTime_input = undefined; endTime_input = undefined } } } if (xc.cursorLockEnabled) { toggleCursorLock() } var msg = new DataChannelMsg; var press = new DataChannelMsgMousePress(xc, e); if (xc.cursorLock) { sendMsg(msg.build_msg(INPUT_TYPE_MOUSE_MOTION, press)) } else if (xc.cursorLockEnabled && !xc.cursorLock) { return } else { sendMsg(msg.build_msg(INPUT_TYPE_MOUSE, press)) } e.preventDefault() } function handle_mouse_release(e) { var msg = new DataChannelMsg; var release = new DataChannelMsgMouseRelease(xc, e); if (xc.cursorLock) { sendMsg(msg.build_msg(INPUT_TYPE_MOUSE_MOTION, release)) } else if (xc.cursorLockEnabled && !xc.cursorLock) { return } else { if (doubleClick) { doubleClick = false; var press = new DataChannelMsgMousePress(xc, lastEven); sendMsg(msg.build_msg(INPUT_TYPE_MOUSE, press)); sendMsg(msg.build_msg(INPUT_TYPE_MOUSE, release)); sendMsg(msg.build_msg(INPUT_TYPE_MOUSE, press)) } sendMsg(msg.build_msg(INPUT_TYPE_MOUSE, release)) } xc.button = 0; e.preventDefault() } function handle_mouse_scroll(e) { var msg = new DataChannelMsg; var scroll = new DataChannelMsgMouseScroll(e); if (xc.cursorLock) { sendMsg(msg.build_msg(INPUT_TYPE_MOUSE_MOTION, scroll)) } else if (xc.cursorLockEnabled && !xc.cursorLock) { return } else { sendMsg(msg.build_msg(INPUT_TYPE_MOUSE, scroll)) } e.preventDefault() } function handle_key_press(e) { if (xc.cursorLockEnabled && !xc.cursorLock) { return } pushPressKeyList(e.keyCode); var msg = new DataChannelMsg; var key_press = new DataChannelMsgKeyPress(xc, e); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_press)); e.preventDefault() } function handle_key_release(e) { if (xc.cursorLockEnabled && !xc.cursorLock) { return } removePressKeyList(e.keyCode); var msg = new DataChannelMsg; var key_release = new DataChannelMsgKeyRelease(xc, e); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_release)); e.preventDefault() } function changeCNOrEng() { var e = {}; e.keyCode = 16; var msg = new DataChannelMsg; var key_press = new DataChannelMsgKeyPress(xc, e); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_press)); var msg = new DataChannelMsg; var key_release = new DataChannelMsgKeyRelease(xc, e); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_release)) } function sendChangeWindowsKey() { var e_alt = {}; e_alt.keyCode = 18; var msg = new DataChannelMsg; var key_press_alt = new DataChannelMsgKeyPress(xc, e_alt); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_press_alt)); var e_tab = {}; e_tab.keyCode = 9; msg = new DataChannelMsg; var key_press_tab = new DataChannelMsgKeyPress(xc, e_tab); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_press_tab)); msg = new DataChannelMsg; var key_release_alt = new DataChannelMsgKeyRelease(xc, e_alt); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_release_alt)); msg = new DataChannelMsg; var key_release_tab = new DataChannelMsgKeyRelease(xc, e_tab); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_release_tab)) } function changeSensitivity(mouseEvent) { if (null == sensitivity || typeof sensitivity == "undefined") { return mouseEvent } var changeCursorPost = mouseEvent; var oldX = mouseEvent.x; var oldY = mouseEvent.y; var newX = parseInt(mouseEvent.x * sensitivity); var newY = parseInt(mouseEvent.y * sensitivity); if (oldX >= 1 && newX == 0) { newX = 1 } else if (oldX <= -1 && newX == 0) { newX = -1 } if (oldY >= 1 && newY == 0) { newY = 1 } else if (oldY <= -1 && newY == 0) { newY = -1 } changeCursorPost.x = newX; changeCursorPost.y = newY; return changeCursorPost } function clearPressKeyList() { if (typeof pressKeyList == "undefined" || null == pressKeyList || pressKeyList.length == 0) { return } for (var i = 0; i < pressKeyList.length; i++) { var e = {}; e.keyCode = pressKeyList[i]; var msg = new DataChannelMsg; var key_release = new DataChannelMsgKeyRelease(xc, e); sendMsg(msg.build_msg(INPUT_TYPE_KEYBOARD, key_release)) } pressKeyList.splice(0, pressKeyList.length) } function removePressKeyList(keyCode) { var index = pressKeyList.indexOf(keyCode); if (index > -1) { pressKeyList.splice(index, 1) } } function pushPressKeyList(keyCode) { var index = pressKeyList.indexOf(keyCode); if (index > -1) { return } pressKeyList.push(keyCode) } "use strict"; var getUserMedia = null; var attachMediaStream = null; var reattachMediaStream = null; var webrtcDetectedBrowser = null; var webrtcDetectedVersion = null; var webrtcMinimumVersion = null; var webrtcUtils = { log: function () { if (typeof module !== "undefined" || typeof require === "function" && typeof define === "function") { return } console.log.apply(console, arguments) }, extractVersion: function (uastring, expr, pos) { var match = uastring.match(expr); return match && match.length >= pos && parseInt(match[pos], 10) } }; function trace(text) { if (text[text.length - 1] === "\n") { text = text.substring(0, text.length - 1) } if (window.performance) { var now = (window.performance.now() / 1e3).toFixed(3); webrtcUtils.log(now + ": " + text) } else { webrtcUtils.log(text) } } if (typeof window === "object") { if (window.HTMLMediaElement && !("srcObject" in window.HTMLMediaElement.prototype)) { Object.defineProperty(window.HTMLMediaElement.prototype, "srcObject", { get: function () { return "mozSrcObject" in this ? this.mozSrcObject : this._srcObject }, set: function (stream) { if ("mozSrcObject" in this) { this.mozSrcObject = stream } else { this._srcObject = stream; this.src = URL.createObjectURL(stream) } } }) } getUserMedia = window.navigator && window.navigator.getUserMedia } attachMediaStream = function (element, stream) { element.srcObject = stream }; reattachMediaStream = function (to, from) { to.srcObject = from.srcObject }; if (typeof window === "undefined" || !window.navigator) { webrtcUtils.log("This does not appear to be a browser"); webrtcDetectedBrowser = "not a browser" } else if (navigator.mozGetUserMedia) { webrtcUtils.log("This appears to be Firefox"); webrtcDetectedBrowser = "firefox"; webrtcDetectedVersion = webrtcUtils.extractVersion(navigator.userAgent, /Firefox\/([0-9]+)\./, 1); webrtcMinimumVersion = 31; if (!window.RTCPeerConnection) { window.RTCPeerConnection = function (pcConfig, pcConstraints) { if (webrtcDetectedVersion < 38) { if (pcConfig && pcConfig.iceServers) { var newIceServers = []; for (var i = 0; i < pcConfig.iceServers.length; i++) { var server = pcConfig.iceServers[i]; if (server.hasOwnProperty("urls")) { for (var j = 0; j < server.urls.length; j++) { var newServer = { url: server.urls[j] }; if (server.urls[j].indexOf("turn") === 0) { newServer.username = server.username; newServer.credential = server.credential } newIceServers.push(newServer) } } else { newIceServers.push(pcConfig.iceServers[i]) } } pcConfig.iceServers = newIceServers } } return new mozRTCPeerConnection(pcConfig, pcConstraints) }; window.RTCPeerConnection.prototype = mozRTCPeerConnection.prototype; if (mozRTCPeerConnection.generateCertificate) { Object.defineProperty(window.RTCPeerConnection, "generateCertificate", { get: function () { if (arguments.length) { return mozRTCPeerConnection.generateCertificate.apply(null, arguments) } else { return mozRTCPeerConnection.generateCertificate } } }) } window.RTCSessionDescription = mozRTCSessionDescription; window.RTCIceCandidate = mozRTCIceCandidate } getUserMedia = function (constraints, onSuccess, onError) { var constraintsToFF37 = function (c) { if (typeof c !== "object" || c.require) { return c } var require = []; Object.keys(c).forEach(function (key) { if (key === "require" || key === "advanced" || key === "mediaSource") { return } var r = c[key] = typeof c[key] === "object" ? c[key] : { ideal: c[key] }; if (r.min !== undefined || r.max !== undefined || r.exact !== undefined) { require.push(key) } if (r.exact !== undefined) { if (typeof r.exact === "number") { r.min = r.max = r.exact } else { c[key] = r.exact } delete r.exact } if (r.ideal !== undefined) { c.advanced = c.advanced || []; var oc = {}; if (typeof r.ideal === "number") { oc[key] = { min: r.ideal, max: r.ideal } } else { oc[key] = r.ideal } c.advanced.push(oc); delete r.ideal; if (!Object.keys(r).length) { delete c[key] } } }); if (require.length) { c.require = require } return c }; if (webrtcDetectedVersion < 38) { webrtcUtils.log("spec: " + JSON.stringify(constraints)); if (constraints.audio) { constraints.audio = constraintsToFF37(constraints.audio) } if (constraints.video) { constraints.video = constraintsToFF37(constraints.video) } webrtcUtils.log("ff37: " + JSON.stringify(constraints)) } return navigator.mozGetUserMedia(constraints, onSuccess, onError) }; navigator.getUserMedia = getUserMedia; if (!navigator.mediaDevices) { navigator.mediaDevices = { getUserMedia: requestUserMedia, addEventListener: function () { }, removeEventListener: function () { } } } navigator.mediaDevices.enumerateDevices = navigator.mediaDevices.enumerateDevices || function () { return new Promise(function (resolve) { var infos = [{ kind: "audioinput", deviceId: "default", label: "", groupId: "" }, { kind: "videoinput", deviceId: "default", label: "", groupId: "" }]; resolve(infos) }) }; if (webrtcDetectedVersion < 41) { var orgEnumerateDevices = navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices); navigator.mediaDevices.enumerateDevices = function () { return orgEnumerateDevices().then(undefined, function (e) { if (e.name === "NotFoundError") { return [] } throw e }) } } } else if (navigator.webkitGetUserMedia && window.webkitRTCPeerConnection) { webrtcUtils.log("This appears to be Chrome"); webrtcDetectedBrowser = "chrome"; webrtcDetectedVersion = webrtcUtils.extractVersion(navigator.userAgent, /Chrom(e|ium)\/([0-9]+)\./, 2); webrtcMinimumVersion = 38; window.RTCPeerConnection = function (pcConfig, pcConstraints) { if (pcConfig && pcConfig.iceTransportPolicy) { pcConfig.iceTransports = pcConfig.iceTransportPolicy } var pc = new webkitRTCPeerConnection(pcConfig, pcConstraints); var origGetStats = pc.getStats.bind(pc); pc.getStats = function (selector, successCallback, errorCallback) { var self = this; var args = arguments; if (arguments.length > 0 && typeof selector === "function") { return origGetStats(selector, successCallback) } var fixChromeStats = function (response) { var standardReport = {}; var reports = response.result(); reports.forEach(function (report) { var standardStats = { id: report.id, timestamp: report.timestamp, type: report.type }; report.names().forEach(function (name) { standardStats[name] = report.stat(name) }); standardReport[standardStats.id] = standardStats }); return standardReport }; if (arguments.length >= 2) { var successCallbackWrapper = function (response) { args[1](fixChromeStats(response)) }; return origGetStats.apply(this, [successCallbackWrapper, arguments[0]]) } return new Promise(function (resolve, reject) { if (args.length === 1 && selector === null) { origGetStats.apply(self, [function (response) { resolve.apply(null, [fixChromeStats(response)]) }, reject]) } else { origGetStats.apply(self, [resolve, reject]) } }) }; return pc }; window.RTCPeerConnection.prototype = webkitRTCPeerConnection.prototype; if (webkitRTCPeerConnection.generateCertificate) { Object.defineProperty(window.RTCPeerConnection, "generateCertificate", { get: function () { if (arguments.length) { return webkitRTCPeerConnection.generateCertificate.apply(null, arguments) } else { return webkitRTCPeerConnection.generateCertificate } } }) } ["createOffer", "createAnswer"].forEach(function (method) { var nativeMethod = webkitRTCPeerConnection.prototype[method]; webkitRTCPeerConnection.prototype[method] = function () { var self = this; if (arguments.length < 1 || arguments.length === 1 && typeof arguments[0] === "object") { var opts = arguments.length === 1 ? arguments[0] : undefined; return new Promise(function (resolve, reject) { nativeMethod.apply(self, [resolve, reject, opts]) }) } else { return nativeMethod.apply(this, arguments) } } });["setLocalDescription", "setRemoteDescription", "addIceCandidate"].forEach(function (method) { var nativeMethod = webkitRTCPeerConnection.prototype[method]; webkitRTCPeerConnection.prototype[method] = function () { var args = arguments; var self = this; return new Promise(function (resolve, reject) { nativeMethod.apply(self, [args[0], function () { resolve(); if (args.length >= 2) { args[1].apply(null, []) } }, function (err) { reject(err); if (args.length >= 3) { args[2].apply(null, [err]) } }]) }) } }); var constraintsToChrome = function (c) { if (typeof c !== "object" || c.mandatory || c.optional) { return c } var cc = {}; Object.keys(c).forEach(function (key) { if (key === "require" || key === "advanced" || key === "mediaSource") { return } var r = typeof c[key] === "object" ? c[key] : { ideal: c[key] }; if (r.exact !== undefined && typeof r.exact === "number") { r.min = r.max = r.exact } var oldname = function (prefix, name) { if (prefix) { return prefix + name.charAt(0).toUpperCase() + name.slice(1) } return name === "deviceId" ? "sourceId" : name }; if (r.ideal !== undefined) { cc.optional = cc.optional || []; var oc = {}; if (typeof r.ideal === "number") { oc[oldname("min", key)] = r.ideal; cc.optional.push(oc); oc = {}; oc[oldname("max", key)] = r.ideal; cc.optional.push(oc) } else { oc[oldname("", key)] = r.ideal; cc.optional.push(oc) } } if (r.exact !== undefined && typeof r.exact !== "number") { cc.mandatory = cc.mandatory || {}; cc.mandatory[oldname("", key)] = r.exact } else { ["min", "max"].forEach(function (mix) { if (r[mix] !== undefined) { cc.mandatory = cc.mandatory || {}; cc.mandatory[oldname(mix, key)] = r[mix] } }) } }); if (c.advanced) { cc.optional = (cc.optional || []).concat(c.advanced) } return cc }; getUserMedia = function (constraints, onSuccess, onError) { if (constraints.audio) { constraints.audio = constraintsToChrome(constraints.audio) } if (constraints.video) { constraints.video = constraintsToChrome(constraints.video) } webrtcUtils.log("chrome: " + JSON.stringify(constraints)); return navigator.webkitGetUserMedia(constraints, onSuccess, onError) }; navigator.getUserMedia = getUserMedia; if (!navigator.mediaDevices) { navigator.mediaDevices = { getUserMedia: requestUserMedia, enumerateDevices: function () { return new Promise(function (resolve) { var kinds = { audio: "audioinput", video: "videoinput" }; return MediaStreamTrack.getSources(function (devices) { resolve(devices.map(function (device) { return { label: device.label, kind: kinds[device.kind], deviceId: device.id, groupId: "" } })) }) }) } } } if (!navigator.mediaDevices.getUserMedia) { navigator.mediaDevices.getUserMedia = function (constraints) { return requestUserMedia(constraints) } } else { var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices); navigator.mediaDevices.getUserMedia = function (c) { webrtcUtils.log("spec:   " + JSON.stringify(c)); c.audio = constraintsToChrome(c.audio); c.video = constraintsToChrome(c.video); webrtcUtils.log("chrome: " + JSON.stringify(c)); return origGetUserMedia(c) } } if (typeof navigator.mediaDevices.addEventListener === "undefined") { navigator.mediaDevices.addEventListener = function () { webrtcUtils.log("Dummy mediaDevices.addEventListener called.") } } if (typeof navigator.mediaDevices.removeEventListener === "undefined") { navigator.mediaDevices.removeEventListener = function () { webrtcUtils.log("Dummy mediaDevices.removeEventListener called.") } } attachMediaStream = function (element, stream) { if (webrtcDetectedVersion >= 43) { element.srcObject = stream } else if (typeof element.src !== "undefined") { element.src = URL.createObjectURL(stream) } else { webrtcUtils.log("Error attaching stream to element.") } }; reattachMediaStream = function (to, from) { if (webrtcDetectedVersion >= 43) { to.srcObject = from.srcObject } else { to.src = from.src } } } else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)) { webrtcUtils.log("This appears to be Edge"); webrtcDetectedBrowser = "edge"; webrtcDetectedVersion = webrtcUtils.extractVersion(navigator.userAgent, /Edge\/(\d+).(\d+)$/, 2); webrtcMinimumVersion = 10547; if (window.RTCIceGatherer) { var generateIdentifier = function () { return Math.random().toString(36).substr(2, 10) }; var localCName = generateIdentifier(); var SDPUtils = {}; SDPUtils.splitLines = function (blob) { return blob.trim().split("\n").map(function (line) { return line.trim() }) }; SDPUtils.splitSections = function (blob) { var parts = blob.split("\r\nm="); return parts.map(function (part, index) { return (index > 0 ? "m=" + part : part).trim() + "\r\n" }) }; SDPUtils.matchPrefix = function (blob, prefix) { return SDPUtils.splitLines(blob).filter(function (line) { return line.indexOf(prefix) === 0 }) }; SDPUtils.parseCandidate = function (line) { var parts; if (line.indexOf("a=candidate:") === 0) { parts = line.substring(12).split(" ") } else { parts = line.substring(10).split(" ") } var candidate = { foundation: parts[0], component: parts[1], protocol: parts[2].toLowerCase(), priority: parseInt(parts[3], 10), ip: parts[4], port: parseInt(parts[5], 10), type: parts[7] }; for (var i = 8; i < parts.length; i += 2) { switch (parts[i]) { case "raddr": candidate.relatedAddress = parts[i + 1]; break; case "rport": candidate.relatedPort = parseInt(parts[i + 1], 10); break; case "tcptype": candidate.tcpType = parts[i + 1]; break; default: break } } return candidate }; SDPUtils.writeCandidate = function (candidate) { var sdp = []; sdp.push(candidate.foundation); sdp.push(candidate.component); sdp.push(candidate.protocol.toUpperCase()); sdp.push(candidate.priority); sdp.push(candidate.ip); sdp.push(candidate.port); var type = candidate.type; sdp.push("typ"); sdp.push(type); if (type !== "host" && candidate.relatedAddress && candidate.relatedPort) { sdp.push("raddr"); sdp.push(candidate.relatedAddress); sdp.push("rport"); sdp.push(candidate.relatedPort) } if (candidate.tcpType && candidate.protocol.toLowerCase() === "tcp") { sdp.push("tcptype"); sdp.push(candidate.tcpType) } return "candidate:" + sdp.join(" ") }; SDPUtils.parseRtpMap = function (line) { var parts = line.substr(9).split(" "); var parsed = { payloadType: parseInt(parts.shift(), 10) }; parts = parts[0].split("/"); parsed.name = parts[0]; parsed.clockRate = parseInt(parts[1], 10); parsed.numChannels = parts.length === 3 ? parseInt(parts[2], 10) : 1; return parsed }; SDPUtils.writeRtpMap = function (codec) { var pt = codec.payloadType; if (codec.preferredPayloadType !== undefined) { pt = codec.preferredPayloadType } return "a=rtpmap:" + pt + " " + codec.name + "/" + codec.clockRate + (codec.numChannels !== 1 ? "/" + codec.numChannels : "") + "\r\n" }; SDPUtils.parseFmtp = function (line) { var parsed = {}; var kv; var parts = line.substr(line.indexOf(" ") + 1).split(";"); for (var j = 0; j < parts.length; j++) { kv = parts[j].trim().split("="); parsed[kv[0].trim()] = kv[1] } return parsed }; SDPUtils.writeFtmp = function (codec) { var line = ""; var pt = codec.payloadType; if (codec.preferredPayloadType !== undefined) { pt = codec.preferredPayloadType } if (codec.parameters && codec.parameters.length) { var params = []; Object.keys(codec.parameters).forEach(function (param) { params.push(param + "=" + codec.parameters[param]) }); line += "a=fmtp:" + pt + " " + params.join(";") + "\r\n" } return line }; SDPUtils.parseRtcpFb = function (line) { var parts = line.substr(line.indexOf(" ") + 1).split(" "); return { type: parts.shift(), parameter: parts.join(" ") } }; SDPUtils.writeRtcpFb = function (codec) { var lines = ""; var pt = codec.payloadType; if (codec.preferredPayloadType !== undefined) { pt = codec.preferredPayloadType } if (codec.rtcpFeedback && codec.rtcpFeedback.length) { codec.rtcpFeedback.forEach(function (fb) { lines += "a=rtcp-fb:" + pt + " " + fb.type + " " + fb.parameter + "\r\n" }) } return lines }; SDPUtils.parseSsrcMedia = function (line) { var sp = line.indexOf(" "); var parts = { ssrc: line.substr(7, sp - 7) }; var colon = line.indexOf(":", sp); if (colon > -1) { parts.attribute = line.substr(sp + 1, colon - sp - 1); parts.value = line.substr(colon + 1) } else { parts.attribute = line.substr(sp + 1) } return parts }; SDPUtils.getDtlsParameters = function (mediaSection, sessionpart) { var lines = SDPUtils.splitLines(mediaSection); lines = lines.concat(SDPUtils.splitLines(sessionpart)); var fpLine = lines.filter(function (line) { return line.indexOf("a=fingerprint:") === 0 })[0].substr(14); var dtlsParameters = { role: "auto", fingerprints: [{ algorithm: fpLine.split(" ")[0], value: fpLine.split(" ")[1] }] }; return dtlsParameters }; SDPUtils.writeDtlsParameters = function (params, setupType) { var sdp = "a=setup:" + setupType + "\r\n"; params.fingerprints.forEach(function (fp) { sdp += "a=fingerprint:" + fp.algorithm + " " + fp.value + "\r\n" }); return sdp }; SDPUtils.getIceParameters = function (mediaSection, sessionpart) { var lines = SDPUtils.splitLines(mediaSection); lines = lines.concat(SDPUtils.splitLines(sessionpart)); var iceParameters = { usernameFragment: lines.filter(function (line) { return line.indexOf("a=ice-ufrag:") === 0 })[0].substr(12), password: lines.filter(function (line) { return line.indexOf("a=ice-pwd:") === 0 })[0].substr(10) }; return iceParameters }; SDPUtils.writeIceParameters = function (params) { return "a=ice-ufrag:" + params.usernameFragment + "\r\n" + "a=ice-pwd:" + params.password + "\r\n" }; SDPUtils.parseRtpParameters = function (mediaSection) { var description = { codecs: [], headerExtensions: [], fecMechanisms: [], rtcp: [] }; var lines = SDPUtils.splitLines(mediaSection); var mline = lines[0].split(" "); for (var i = 3; i < mline.length; i++) { var pt = mline[i]; var rtpmapline = SDPUtils.matchPrefix(mediaSection, "a=rtpmap:" + pt + " ")[0]; if (rtpmapline) { var codec = SDPUtils.parseRtpMap(rtpmapline); var fmtps = SDPUtils.matchPrefix(mediaSection, "a=fmtp:" + pt + " "); codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {}; codec.rtcpFeedback = SDPUtils.matchPrefix(mediaSection, "a=rtcp-fb:" + pt + " ").map(SDPUtils.parseRtcpFb); description.codecs.push(codec) } } return description }; SDPUtils.writeRtpDescription = function (kind, caps) { var sdp = ""; sdp += "m=" + kind + " "; sdp += caps.codecs.length > 0 ? "9" : "0"; sdp += " UDP/TLS/RTP/SAVPF "; sdp += caps.codecs.map(function (codec) { if (codec.preferredPayloadType !== undefined) { return codec.preferredPayloadType } return codec.payloadType }).join(" ") + "\r\n"; sdp += "c=IN IP4 0.0.0.0\r\n"; sdp += "a=rtcp:9 IN IP4 0.0.0.0\r\n"; caps.codecs.forEach(function (codec) { sdp += SDPUtils.writeRtpMap(codec); sdp += SDPUtils.writeFtmp(codec); sdp += SDPUtils.writeRtcpFb(codec) }); sdp += "a=rtcp-mux\r\n"; return sdp }; SDPUtils.writeSessionBoilerplate = function () { return "v=0\r\n" + "o=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\n" + "s=-\r\n" + "t=0 0\r\n" }; SDPUtils.writeMediaSection = function (transceiver, caps, type, stream) { var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps); sdp += SDPUtils.writeIceParameters(transceiver.iceGatherer.getLocalParameters()); sdp += SDPUtils.writeDtlsParameters(transceiver.dtlsTransport.getLocalParameters(), type === "offer" ? "actpass" : "active"); sdp += "a=mid:" + transceiver.mid + "\r\n"; if (transceiver.rtpSender && transceiver.rtpReceiver) { sdp += "a=sendrecv\r\n" } else if (transceiver.rtpSender) { sdp += "a=sendonly\r\n" } else if (transceiver.rtpReceiver) { sdp += "a=recvonly\r\n" } else { sdp += "a=inactive\r\n" } if (transceiver.rtpSender) { var msid = "msid:" + stream.id + " " + transceiver.rtpSender.track.id + "\r\n"; sdp += "a=" + msid; sdp += "a=ssrc:" + transceiver.sendSsrc + " " + msid } sdp += "a=ssrc:" + transceiver.sendSsrc + " cname:" + localCName + "\r\n"; return sdp }; SDPUtils.getDirection = function (mediaSection, sessionpart) { var lines = SDPUtils.splitLines(mediaSection); for (var i = 0; i < lines.length; i++) { switch (lines[i]) { case "a=sendrecv": case "a=sendonly": case "a=recvonly": case "a=inactive": return lines[i].substr(2) } } if (sessionpart) { return SDPUtils.getDirection(sessionpart) } return "sendrecv" }; if (!window.RTCIceCandidate) { window.RTCIceCandidate = function (args) { return args } } if (!window.RTCSessionDescription) { window.RTCSessionDescription = function (args) { return args } } window.RTCPeerConnection = function (config) { var self = this; this.onicecandidate = null; this.onaddstream = null; this.onremovestream = null; this.onsignalingstatechange = null; this.oniceconnectionstatechange = null; this.onnegotiationneeded = null; this.ondatachannel = null; this.localStreams = []; this.remoteStreams = []; this.getLocalStreams = function () { return self.localStreams }; this.getRemoteStreams = function () { return self.remoteStreams }; this.localDescription = new RTCSessionDescription({ type: "", sdp: "" }); this.remoteDescription = new RTCSessionDescription({ type: "", sdp: "" }); this.signalingState = "stable"; this.iceConnectionState = "new"; this.iceOptions = { gatherPolicy: "all", iceServers: [] }; if (config && config.iceTransportPolicy) { switch (config.iceTransportPolicy) { case "all": case "relay": this.iceOptions.gatherPolicy = config.iceTransportPolicy; break; case "none": throw new TypeError('iceTransportPolicy "none" not supported') } } if (config && config.iceServers) { config.iceServers.forEach(function (server) { if (server.urls) { var url; if (typeof server.urls === "string") { url = server.urls } else { url = server.urls[0] } if (url.indexOf("transport=udp") !== -1) { self.iceServers.push({ username: server.username, credential: server.credential, urls: url }) } } }) } this.transceivers = []; this._localIceCandidatesBuffer = [] }; window.RTCPeerConnection.prototype._emitBufferedCandidates = function () { var self = this; this._localIceCandidatesBuffer.forEach(function (event) { if (self.onicecandidate !== null) { self.onicecandidate(event) } }); this._localIceCandidatesBuffer = [] }; window.RTCPeerConnection.prototype.addStream = function (stream) { this.localStreams.push(stream.clone()); this._maybeFireNegotiationNeeded() }; window.RTCPeerConnection.prototype.removeStream = function (stream) { var idx = this.localStreams.indexOf(stream); if (idx > -1) { this.localStreams.splice(idx, 1); this._maybeFireNegotiationNeeded() } }; window.RTCPeerConnection.prototype._getCommonCapabilities = function (localCapabilities, remoteCapabilities) { var commonCapabilities = { codecs: [], headerExtensions: [], fecMechanisms: [] }; localCapabilities.codecs.forEach(function (lCodec) { for (var i = 0; i < remoteCapabilities.codecs.length; i++) { var rCodec = remoteCapabilities.codecs[i]; if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() && lCodec.clockRate === rCodec.clockRate && lCodec.numChannels === rCodec.numChannels) { commonCapabilities.codecs.push(rCodec); break } } }); localCapabilities.headerExtensions.forEach(function (lHeaderExtension) { for (var i = 0; i < remoteCapabilities.headerExtensions.length; i++) { var rHeaderExtension = remoteCapabilities.headerExtensions[i]; if (lHeaderExtension.uri === rHeaderExtension.uri) { commonCapabilities.headerExtensions.push(rHeaderExtension); break } } }); return commonCapabilities }; window.RTCPeerConnection.prototype._createIceAndDtlsTransports = function (mid, sdpMLineIndex) { var self = this; var iceGatherer = new RTCIceGatherer(self.iceOptions); var iceTransport = new RTCIceTransport(iceGatherer); iceGatherer.onlocalcandidate = function (evt) { var event = {}; event.candidate = { sdpMid: mid, sdpMLineIndex: sdpMLineIndex }; var cand = evt.candidate; if (!cand || Object.keys(cand).length === 0) { if (iceGatherer.state === undefined) { iceGatherer.state = "completed" } event.candidate.candidate = "candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates" } else { cand.component = iceTransport.component === "RTCP" ? 2 : 1; event.candidate.candidate = SDPUtils.writeCandidate(cand) } var complete = self.transceivers.every(function (transceiver) { return transceiver.iceGatherer && transceiver.iceGatherer.state === "completed" }); if (self.onicecandidate !== null) { if (self.localDescription && self.localDescription.type === "") { self._localIceCandidatesBuffer.push(event); if (complete) { self._localIceCandidatesBuffer.push({}) } } else { self.onicecandidate(event); if (complete) { self.onicecandidate({}) } } } }; iceTransport.onicestatechange = function () { self._updateConnectionState() }; var dtlsTransport = new RTCDtlsTransport(iceTransport); dtlsTransport.ondtlsstatechange = function () { self._updateConnectionState() }; dtlsTransport.onerror = function () { dtlsTransport.state = "failed"; self._updateConnectionState() }; return { iceGatherer: iceGatherer, iceTransport: iceTransport, dtlsTransport: dtlsTransport } }; window.RTCPeerConnection.prototype._transceive = function (transceiver, send, recv) { var params = this._getCommonCapabilities(transceiver.localCapabilities, transceiver.remoteCapabilities); if (send && transceiver.rtpSender) { params.encodings = [{ ssrc: transceiver.sendSsrc }]; params.rtcp = { cname: localCName, ssrc: transceiver.recvSsrc }; transceiver.rtpSender.send(params) } if (recv && transceiver.rtpReceiver) { params.encodings = [{ ssrc: transceiver.recvSsrc }]; params.rtcp = { cname: transceiver.cname, ssrc: transceiver.sendSsrc }; transceiver.rtpReceiver.receive(params) } }; window.RTCPeerConnection.prototype.setLocalDescription = function (description) { var self = this; if (description.type === "offer") { if (!this._pendingOffer) { } else { this.transceivers = this._pendingOffer; delete this._pendingOffer } } else if (description.type === "answer") { var sections = SDPUtils.splitSections(self.remoteDescription.sdp); var sessionpart = sections.shift(); sections.forEach(function (mediaSection, sdpMLineIndex) { var transceiver = self.transceivers[sdpMLineIndex]; var iceGatherer = transceiver.iceGatherer; var iceTransport = transceiver.iceTransport; var dtlsTransport = transceiver.dtlsTransport; var localCapabilities = transceiver.localCapabilities; var remoteCapabilities = transceiver.remoteCapabilities; var rejected = mediaSection.split("\n", 1)[0].split(" ", 2)[1] === "0"; if (!rejected) { var remoteIceParameters = SDPUtils.getIceParameters(mediaSection, sessionpart); iceTransport.start(iceGatherer, remoteIceParameters, "controlled"); var remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection, sessionpart); dtlsTransport.start(remoteDtlsParameters); var params = self._getCommonCapabilities(localCapabilities, remoteCapabilities); self._transceive(transceiver, params.codecs.length > 0, false) } }) } this.localDescription = description; switch (description.type) { case "offer": this._updateSignalingState("have-local-offer"); break; case "answer": this._updateSignalingState("stable"); break; default: throw new TypeError('unsupported type "' + description.type + '"') }var hasCallback = arguments.length > 1 && typeof arguments[1] === "function"; if (hasCallback) { var cb = arguments[1]; window.setTimeout(function () { cb(); self._emitBufferedCandidates() }, 0) } var p = Promise.resolve(); p.then(function () { if (!hasCallback) { window.setTimeout(self._emitBufferedCandidates.bind(self), 0) } }); return p }; window.RTCPeerConnection.prototype.setRemoteDescription = function (description) { var self = this; var stream = new MediaStream; var sections = SDPUtils.splitSections(description.sdp); var sessionpart = sections.shift(); sections.forEach(function (mediaSection, sdpMLineIndex) { var lines = SDPUtils.splitLines(mediaSection); var mline = lines[0].substr(2).split(" "); var kind = mline[0]; var rejected = mline[1] === "0"; var direction = SDPUtils.getDirection(mediaSection, sessionpart); var transceiver; var iceGatherer; var iceTransport; var dtlsTransport; var rtpSender; var rtpReceiver; var sendSsrc; var recvSsrc; var localCapabilities; var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection); var remoteIceParameters; var remoteDtlsParameters; if (!rejected) { remoteIceParameters = SDPUtils.getIceParameters(mediaSection, sessionpart); remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection, sessionpart) } var mid = SDPUtils.matchPrefix(mediaSection, "a=mid:")[0].substr(6); var cname; var remoteSsrc = SDPUtils.matchPrefix(mediaSection, "a=ssrc:").map(function (line) { return SDPUtils.parseSsrcMedia(line) }).filter(function (obj) { return obj.attribute === "cname" })[0]; if (remoteSsrc) { recvSsrc = parseInt(remoteSsrc.ssrc, 10); cname = remoteSsrc.value } if (description.type === "offer") { var transports = self._createIceAndDtlsTransports(mid, sdpMLineIndex); localCapabilities = RTCRtpReceiver.getCapabilities(kind); sendSsrc = (2 * sdpMLineIndex + 2) * 1001; rtpReceiver = new RTCRtpReceiver(transports.dtlsTransport, kind); stream.addTrack(rtpReceiver.track); if (self.localStreams.length > 0 && self.localStreams[0].getTracks().length >= sdpMLineIndex) { var localtrack = self.localStreams[0].getTracks()[sdpMLineIndex]; rtpSender = new RTCRtpSender(localtrack, transports.dtlsTransport) } self.transceivers[sdpMLineIndex] = { iceGatherer: transports.iceGatherer, iceTransport: transports.iceTransport, dtlsTransport: transports.dtlsTransport, localCapabilities: localCapabilities, remoteCapabilities: remoteCapabilities, rtpSender: rtpSender, rtpReceiver: rtpReceiver, kind: kind, mid: mid, cname: cname, sendSsrc: sendSsrc, recvSsrc: recvSsrc }; self._transceive(self.transceivers[sdpMLineIndex], false, direction === "sendrecv" || direction === "sendonly") } else if (description.type === "answer" && !rejected) { transceiver = self.transceivers[sdpMLineIndex]; iceGatherer = transceiver.iceGatherer; iceTransport = transceiver.iceTransport; dtlsTransport = transceiver.dtlsTransport; rtpSender = transceiver.rtpSender; rtpReceiver = transceiver.rtpReceiver; sendSsrc = transceiver.sendSsrc; localCapabilities = transceiver.localCapabilities; self.transceivers[sdpMLineIndex].recvSsrc = recvSsrc; self.transceivers[sdpMLineIndex].remoteCapabilities = remoteCapabilities; self.transceivers[sdpMLineIndex].cname = cname; iceTransport.start(iceGatherer, remoteIceParameters, "controlling"); dtlsTransport.start(remoteDtlsParameters); self._transceive(transceiver, direction === "sendrecv" || direction === "recvonly", direction === "sendrecv" || direction === "sendonly"); if (rtpReceiver && (direction === "sendrecv" || direction === "sendonly")) { stream.addTrack(rtpReceiver.track) } else { delete transceiver.rtpReceiver } } }); this.remoteDescription = description; switch (description.type) { case "offer": this._updateSignalingState("have-remote-offer"); break; case "answer": this._updateSignalingState("stable"); break; default: throw new TypeError('unsupported type "' + description.type + '"') }window.setTimeout(function () { if (self.onaddstream !== null && stream.getTracks().length) { self.remoteStreams.push(stream); window.setTimeout(function () { self.onaddstream({ stream: stream }) }, 0) } }, 0); if (arguments.length > 1 && typeof arguments[1] === "function") { window.setTimeout(arguments[1], 0) } return Promise.resolve() }; window.RTCPeerConnection.prototype.close = function () { this.transceivers.forEach(function (transceiver) { if (transceiver.iceTransport) { transceiver.iceTransport.stop() } if (transceiver.dtlsTransport) { transceiver.dtlsTransport.stop() } if (transceiver.rtpSender) { transceiver.rtpSender.stop() } if (transceiver.rtpReceiver) { transceiver.rtpReceiver.stop() } }); this._updateSignalingState("closed") }; window.RTCPeerConnection.prototype._updateSignalingState = function (newState) { this.signalingState = newState; if (this.onsignalingstatechange !== null) { this.onsignalingstatechange() } }; window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function () { if (this.onnegotiationneeded !== null) { this.onnegotiationneeded() } }; window.RTCPeerConnection.prototype._updateConnectionState = function () { var self = this; var newState; var states = { new: 0, closed: 0, connecting: 0, checking: 0, connected: 0, completed: 0, failed: 0 }; this.transceivers.forEach(function (transceiver) { states[transceiver.iceTransport.state]++; states[transceiver.dtlsTransport.state]++ }); states.connected += states.completed; newState = "new"; if (states.failed > 0) { newState = "failed" } else if (states.connecting > 0 || states.checking > 0) { newState = "connecting" } else if (states.disconnected > 0) { newState = "disconnected" } else if (states.new > 0) { newState = "new" } else if (states.connecting > 0 || states.completed > 0) { newState = "connected" } if (newState !== self.iceConnectionState) { self.iceConnectionState = newState; if (this.oniceconnectionstatechange !== null) { this.oniceconnectionstatechange() } } }; window.RTCPeerConnection.prototype.createOffer = function () { var self = this; if (this._pendingOffer) { throw new Error("createOffer called while there is a pending offer.") } var offerOptions; if (arguments.length === 1 && typeof arguments[0] !== "function") { offerOptions = arguments[0] } else if (arguments.length === 3) { offerOptions = arguments[2] } var tracks = []; var numAudioTracks = 0; var numVideoTracks = 0; if (this.localStreams.length) { numAudioTracks = this.localStreams[0].getAudioTracks().length; numVideoTracks = this.localStreams[0].getVideoTracks().length } if (offerOptions) { if (offerOptions.mandatory || offerOptions.optional) { throw new TypeError("Legacy mandatory/optional constraints not supported.") } if (offerOptions.offerToReceiveAudio !== undefined) { numAudioTracks = offerOptions.offerToReceiveAudio } if (offerOptions.offerToReceiveVideo !== undefined) { numVideoTracks = offerOptions.offerToReceiveVideo } } if (this.localStreams.length) { this.localStreams[0].getTracks().forEach(function (track) { tracks.push({ kind: track.kind, track: track, wantReceive: track.kind === "audio" ? numAudioTracks > 0 : numVideoTracks > 0 }); if (track.kind === "audio") { numAudioTracks-- } else if (track.kind === "video") { numVideoTracks-- } }) } while (numAudioTracks > 0 || numVideoTracks > 0) { if (numAudioTracks > 0) { tracks.push({ kind: "audio", wantReceive: true }); numAudioTracks-- } if (numVideoTracks > 0) { tracks.push({ kind: "video", wantReceive: true }); numVideoTracks-- } } var sdp = SDPUtils.writeSessionBoilerplate(); var transceivers = []; tracks.forEach(function (mline, sdpMLineIndex) { var track = mline.track; var kind = mline.kind; var mid = generateIdentifier(); var transports = self._createIceAndDtlsTransports(mid, sdpMLineIndex); var localCapabilities = RTCRtpSender.getCapabilities(kind); var rtpSender; var rtpReceiver; var sendSsrc = (2 * sdpMLineIndex + 1) * 1001; if (track) { rtpSender = new RTCRtpSender(track, transports.dtlsTransport) } if (mline.wantReceive) { rtpReceiver = new RTCRtpReceiver(transports.dtlsTransport, kind) } transceivers[sdpMLineIndex] = { iceGatherer: transports.iceGatherer, iceTransport: transports.iceTransport, dtlsTransport: transports.dtlsTransport, localCapabilities: localCapabilities, remoteCapabilities: null, rtpSender: rtpSender, rtpReceiver: rtpReceiver, kind: kind, mid: mid, sendSsrc: sendSsrc, recvSsrc: null }; var transceiver = transceivers[sdpMLineIndex]; sdp += SDPUtils.writeMediaSection(transceiver, transceiver.localCapabilities, "offer", self.localStreams[0]) }); this._pendingOffer = transceivers; var desc = new RTCSessionDescription({ type: "offer", sdp: sdp }); if (arguments.length && typeof arguments[0] === "function") { window.setTimeout(arguments[0], 0, desc) } return Promise.resolve(desc) }; window.RTCPeerConnection.prototype.createAnswer = function () { var self = this; var answerOptions; if (arguments.length === 1 && typeof arguments[0] !== "function") { answerOptions = arguments[0] } else if (arguments.length === 3) { answerOptions = arguments[2] } var sdp = SDPUtils.writeSessionBoilerplate(); this.transceivers.forEach(function (transceiver) { var commonCapabilities = self._getCommonCapabilities(transceiver.localCapabilities, transceiver.remoteCapabilities); sdp += SDPUtils.writeMediaSection(transceiver, commonCapabilities, "answer", self.localStreams[0]) }); var desc = new RTCSessionDescription({ type: "answer", sdp: sdp }); if (arguments.length && typeof arguments[0] === "function") { window.setTimeout(arguments[0], 0, desc) } return Promise.resolve(desc) }; window.RTCPeerConnection.prototype.addIceCandidate = function (candidate) { var mLineIndex = candidate.sdpMLineIndex; if (candidate.sdpMid) { for (var i = 0; i < this.transceivers.length; i++) { if (this.transceivers[i].mid === candidate.sdpMid) { mLineIndex = i; break } } } var transceiver = this.transceivers[mLineIndex]; if (transceiver) { var cand = Object.keys(candidate.candidate).length > 0 ? SDPUtils.parseCandidate(candidate.candidate) : {}; if (cand.protocol === "tcp" && cand.port === 0) { return } if (cand.component !== "1") { return } if (cand.type === "endOfCandidates") { cand = {} } transceiver.iceTransport.addRemoteCandidate(cand) } if (arguments.length > 1 && typeof arguments[1] === "function") { window.setTimeout(arguments[1], 0) } return Promise.resolve() }; window.RTCPeerConnection.prototype.getStats = function () { var promises = []; this.transceivers.forEach(function (transceiver) { ["rtpSender", "rtpReceiver", "iceGatherer", "iceTransport", "dtlsTransport"].forEach(function (method) { if (transceiver[method]) { promises.push(transceiver[method].getStats()) } }) }); var cb = arguments.length > 1 && typeof arguments[1] === "function" && arguments[1]; return new Promise(function (resolve) { var results = {}; Promise.all(promises).then(function (res) { res.forEach(function (result) { Object.keys(result).forEach(function (id) { results[id] = result[id] }) }); if (cb) { window.setTimeout(cb, 0, results) } resolve(results) }) }) } } } else { webrtcUtils.log("Browser does not appear to be WebRTC-capable") } if (typeof window === "object" && window.RTCPeerConnection && !("ontrack" in window.RTCPeerConnection.prototype)) { Object.defineProperty(window.RTCPeerConnection.prototype, "ontrack", { get: function () { return this._ontrack }, set: function (f) { var self = this; if (this._ontrack) { this.removeEventListener("track", this._ontrack); this.removeEventListener("addstream", this._ontrackpoly) } this.addEventListener("track", this._ontrack = f); this.addEventListener("addstream", this._ontrackpoly = function (e) { if (webrtcDetectedBrowser === "chrome") { e.stream.addEventListener("addtrack", function (te) { var event = new Event("track"); event.track = te.track; event.receiver = { track: te.track }; event.streams = [e.stream]; self.dispatchEvent(event) }) } e.stream.getTracks().forEach(function (track) { var event = new Event("track"); event.track = track; event.receiver = { track: track }; event.streams = [e.stream]; this.dispatchEvent(event) }.bind(this)) }.bind(this)) } }) } function requestUserMedia(constraints) { return new Promise(function (resolve, reject) { getUserMedia(constraints, resolve, reject) }) } var webrtcTesting = {}; try { Object.defineProperty(webrtcTesting, "version", { set: function (version) { webrtcDetectedVersion = version } }) } catch (e) { } if (typeof module !== "undefined") { var RTCPeerConnection; var RTCIceCandidate; var RTCSessionDescription; if (typeof window !== "undefined") { RTCPeerConnection = window.RTCPeerConnection; RTCIceCandidate = window.RTCIceCandidate; RTCSessionDescription = window.RTCSessionDescription } module.exports = { RTCPeerConnection: RTCPeerConnection, RTCIceCandidate: RTCIceCandidate, RTCSessionDescription: RTCSessionDescription, getUserMedia: getUserMedia, attachMediaStream: attachMediaStream, reattachMediaStream: reattachMediaStream, webrtcDetectedBrowser: webrtcDetectedBrowser, webrtcDetectedVersion: webrtcDetectedVersion, webrtcMinimumVersion: webrtcMinimumVersion, webrtcTesting: webrtcTesting, webrtcUtils: webrtcUtils } } else if (typeof require === "function" && typeof define === "function") { define([], function () { return { RTCPeerConnection: window.RTCPeerConnection, RTCIceCandidate: window.RTCIceCandidate, RTCSessionDescription: window.RTCSessionDescription, getUserMedia: getUserMedia, attachMediaStream: attachMediaStream, reattachMediaStream: reattachMediaStream, webrtcDetectedBrowser: webrtcDetectedBrowser, webrtcDetectedVersion: webrtcDetectedVersion, webrtcMinimumVersion: webrtcMinimumVersion, webrtcTesting: webrtcTesting, webrtcUtils: webrtcUtils } }) } "use strict"; var INPUT_TYPE_BITERATE = 1, INPUT_TYPE_KEYBOARD = 4, INPUT_TYPE_MOUSE = 5, INPUT_TYPE_MOUSE_MOTION = 10, INPUT_TYPE_GAMEPAD = 19, INPUT_TYPE_TOGGLE_RECORD_START = 8, INPUT_TYPE_TOGGLE_RECORD_STOP = 9; var INPUT_MOUSE_BUTTON_LEFT = 1, INPUT_MOUSE_BUTTON_MIDDLE = 4, INPUT_MOUSE_BUTTON_RIGHT = 2; var INPUT_KEYBOARD_PRESS = 0, INPUT_KEYBOARD_RELEASE = 1; var DATA_CHANNEL_MSG_CURSOR = 102, DATA_CHANNEL_MSG_CURSOR_VISABLE = 101, DATA_CHANNEL_MSG_VIDEO_TYPE = 104, DATA_CHANNEL_MSG_REFRESH = 115, DATA_CHANNEL_MSG_APP_INSTANCE = 103, DATA_CHANNEL_MSG_VIDEO_PARAM = 107, DATA_CHANNEL_MSG_INPUT_SOURCE = 108, DATA_CHANNEL_MSG_SIMULATED_CURSOR_POS = 109, DATA_CHANNEL_MSG_VIDEO_QUALITY_LIST = 110, DATA_CHANNEL_MSG_MOUSE_MODE_LIST = 111, DATA_CHANNEL_MSG_TEXT_MSG = 112, DATA_CHANNEL_MSG_RC_MODE_LIST = 113, DATA_CHANNEL_MSG_ROI_LIST = 114, DATA_CHANNEL_MSG_GAMEPAD_VIBRATION = 119, DATA_CHANNEL_MSG_MOUSE_POS_RESET = 121, DATA_CHANNEL_MSG_VIDEO_STREAM_HANDSHAKE = 11, DATA_CHANNEL_MSG_SELECT_INPUT_SOURCE = 12, DATA_CHANNEL_MSG_SELECT_MOUSE_MODE = 13, DATA_CHANNEL_MSG_SELECT_RC_MODE = 16, DATA_CHANNEL_MSG_SELECT_ROI = 17, DATA_CHANNEL_MSG_PC_INFO = 18, RESTART_APP = 27, REFRESH_APP_FPS = 29; var VirtualAppMessageCode_None = 0, StartupAppFromSandboxSuccess = 1, StartupAppFromSandboxError = 2, SandboxFullNeedToCreateMore = 3, FocusWindowCannotFindPleaseRefresh = 4, gotLastWindow = 5; "use strict"; var MouseType = true; var Mouseselect = true; var mChangeFrameNumber = false; var isLockShow = true; var qualityHtml = ""; function DataChannelMsg() { this.type = 0; this.data = undefined } DataChannelMsg.prototype = { build_msg: function (type, msg) { this.type = type; this.data = msg.toStr(); return this.type + "," + this.data }, toData: function (data) { if (data instanceof ArrayBuffer) { } else { this.type = data.split(",", 1)[0]; this.data = data.replace(this.type + ",", "") } } }; function DataChannelMsgPCInfo(frame_rate, bps, delay, packets_lost, pbs, nacks_sent, frameRateOutput) { this.frame_rate = frame_rate; this.bps = bps; this.delay = delay; this.packtes_lost = packets_lost; this.pbs = pbs; this.nacks_sent = nacks_sent; this.frame_rate_output = frameRateOutput } DataChannelMsgPCInfo.prototype = { toStr: function () { return this.frame_rate + "," + this.bps + "," + this.delay + "," + this.packtes_lost + "," + this.pbs + "," + this.nacks_sent + "," + this.rtt + "," + this.frame_rate_output } }; function DataChannelMsgGamePad(button, LTrigger, RTrigger, LAxisX, LAxisY, RAxisX, RAxisY) { this.button = button; this.LTrigger = LTrigger; this.RTrigger = RTrigger; this.LAxisX = LAxisX; this.LAxisY = LAxisY; this.RAxisX = RAxisX; this.RAxisY = RAxisY } DataChannelMsgGamePad.prototype = { toStr: function () { return this.button + "," + this.LTrigger + "," + this.RTrigger + "," + this.LAxisX + "," + this.LAxisY + "," + this.RAxisX + "," + this.RAxisY } }; function DataChannelMsgMouseMotion(xc, e) { if (e) { this.x = e.movementX; this.y = e.movementY; this.z = 0; this.button = xc.button } else { this.x = this.y = this.z = this.button = 0 } } DataChannelMsgMouseMotion.prototype = { toStr: function () { return this.x + "," + this.y + "," + this.z + "," + this.button } }; function DataChannelMsgMousePosition(xc, e) { if (e) { var scrollTop = document.body.scrollTop || document.documentElement.scrollTop; var scrollLeft = document.body.scrollLeft || document.documentElement.scrollLeft; this.x = resolution_scale((e.clientX - xc.display.offsetLeft + scrollLeft) * xc.scaleX, xc.videoWidth); this.y = resolution_scale((e.clientY - xc.display.offsetTop + scrollTop) * xc.scaleY, xc.videoHeight); this.z = 0; this.button = xc.button } else { this.x = this.y = this.z = this.button = 0 } } DataChannelMsgMousePosition.prototype = { toStr: function () { return this.x + "," + this.y + "," + this.z + "," + this.button } }; function DataChannelMsgMousePress(xc, e) { if (e) { switch (e.button) { case 0: this.button = 1; break; case 1: this.button = 4; break; case 2: this.button = 2; break }xc.button = this.button } } DataChannelMsgMousePress.prototype = { toStr: function () { return "0,0,0," + this.button } }; function DataChannelMsgMouseRelease(xc, e) { if (e) { switch (e.button) { case 0: this.button = 3; break; case 1: this.button = 9; break; case 2: this.button = 6; break }xc.button = this.button } } DataChannelMsgMouseRelease.prototype.toStr = DataChannelMsgMousePress.prototype.toStr; function DataChannelMsgMouseScroll(e) { if (e) { this.z = e.deltaY > 0 ? 1 : -1 } } DataChannelMsgMouseScroll.prototype = { toStr: function () { return "0,0," + this.z + "," + xc.button } }; function DataChannelMsgKeyPress(xc, e) { if (e) { this.keyCode = keycode_to_start_scan(e.keyCode); xc.keyCode = this.keyCode; xc.keyState = INPUT_KEYBOARD_PRESS } } DataChannelMsgKeyPress.prototype = { toStr: function () { return INPUT_KEYBOARD_PRESS + "," + this.keyCode + ",0,0" } }; function DataChannelMsgKeyRelease(xc, e) { if (e) { this.keyCode = keycode_to_start_scan(e.keyCode); xc.keyCode = this.keyCode; xc.keyState = INPUT_KEYBOARD_RELEASE } } DataChannelMsgKeyRelease.prototype = { toStr: function () { return INPUT_KEYBOARD_RELEASE + "," + this.keyCode + ",0,0" } }; function DataChannelMsgCursor(cursorMsg) { if (cursorMsg) { var hotSpot = cursorMsg.split(",", 2); this.hotSpotX = hotSpot[0]; this.hotSpotY = hotSpot[1]; this.pngStr = cursorMsg.replace(hotSpot + ",", "") } else { this.hotSpotX = ""; this.hotSpotY = ""; this.pngStr = "" } } function DataChannelMsgSimulatedCursorPos(posMsg) { if (posMsg) { var pos = posMsg.split(",", 4); this.posX = pos[0]; this.posY = pos[1]; this.hotSpotX = pos[2]; this.hotSpotY = pos[3] } else { this.posX = null; this.posY = null; this.hotSpotX = null; this.hotSpotY = null } } function resolution_scale(current_axis, max_res) { return current_axis; var scaled_axis = current_axis * 32767 / (max_res - 1); return parseInt(scaled_axis) } function onData(data) { var msg = new DataChannelMsg; msg.toData(data); switch (parseInt(msg.type)) { case DATA_CHANNEL_MSG_CURSOR: setCursor(msg.data); break; case DATA_CHANNEL_MSG_CURSOR_VISABLE: setCursorVisible(msg.data); break; case DATA_CHANNEL_MSG_REFRESH: setTimeout(function () { window.location.reload(true) }, 3e3); break; case DATA_CHANNEL_MSG_APP_INSTANCE: handleAppInstanceMsg(msg.data); break; case DATA_CHANNEL_MSG_VIDEO_PARAM: var param = msg.data.split(",", 3); xc.frameRate = parseInt(param[3]); sendMsg(DATA_CHANNEL_MSG_VIDEO_STREAM_HANDSHAKE + "," + msg.data); break; case DATA_CHANNEL_MSG_INPUT_SOURCE: handleInputSourceListDefault(msg.data); break; case DATA_CHANNEL_MSG_SIMULATED_CURSOR_POS: break; case DATA_CHANNEL_MSG_VIDEO_QUALITY_LIST: handleVideoQualityList(msg.data); break; case DATA_CHANNEL_MSG_MOUSE_MODE_LIST: handleMouseModeList(msg.data); break; case DATA_CHANNEL_MSG_TEXT_MSG: layer.msg(JSON.parse(msg.data), { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }); break; case DATA_CHANNEL_MSG_RC_MODE_LIST: handleRCModeList(msg.data); break; case DATA_CHANNEL_MSG_ROI_LIST: handleROI(msg.data); break; case DATA_CHANNEL_MSG_GAMEPAD_VIBRATION: var left = parseInt(msg.data.split(",", 2)[0]); var right = parseInt(msg.data.split(",", 2)[1]); handleGamePadEffect(left, right); break; case DATA_CHANNEL_MSG_MOUSE_POS_RESET: var localCursorPos = new DataChannelMsgMousePosition(xc); xc.posX = 1; xc.posY = 1; localCursorPos.x = xc.posX; localCursorPos.y = xc.posY; localCursorPos.button = xc.button; var tmp = new DataChannelMsg; sendMsg(tmp.build_msg(INPUT_TYPE_MOUSE, localCursorPos)); break; case DATA_CHANNEL_MSG_VIDEO_TYPE: handleChangeFrameNumber(msg.data); break } } function handleRCModeList(data) { var RCMode = JSON.parse(data); if (RCMode["list"] != undefined && RCMode["list"] !== null) { var list = RCMode["list"]; var selectedRCMode, selectedRCModeName; $("#RCModeList").empty(); for (var i = 0; i < list.length; i++) { $("#RCModeList").append("<div class='item' data-id='" + list[i]["id"] + "' onclick='sendRCMode(this)'>" + list[i]["name"] + "</div>"); if (list[i]["selected"] == true) { selectedRCMode = list[i]["id"]; selectedRCModeName = list[i]["name"] } } $(".ui.dropdown").dropdown({ action: "nothing" }); $(".ui.left.dropdown").dropdown("set selected", selectedRCModeName) } } function handleROI(data) { var ROI = JSON.parse(data); if (ROI["list"] != undefined && ROI["list"] !== null) { var list = ROI["list"]; var selectedROI, selectedROIName; $("#ROIList").empty(); for (var i = 0; i < list.length; i++) { $("#ROIList").append("<div class='item' data-id='" + list[i]["id"] + "' onclick='sendROI(this)'>" + list[i]["name"] + "</div>"); if (list[i]["selected"] == true) { selectedROI = list[i]["id"]; selectedROIName = list[i]["name"] } } $(".ui.dropdown").dropdown({ action: "nothing" }); var selectedROIValue = "[data-id=" + selectedROI + "]"; setSelected($("#ROIList").find(selectedROIValue)) } } function handleVideoQualityList(data) { qualityHtml = ""; var videoQualityList = JSON.parse(data); if (videoQualityList["list"] != undefined && videoQualityList["list"] !== null) { var list = videoQualityList["list"]; var selectedVideoQuality, selectedVideoQualityName; $("#videoQualityList").empty(); list.map(val => { if (findQuality(val, 1) == false) { qualityHtml += `<li><input id=${val.id} value=${val.name} type="radio" name="quality"><label for=${val.id}>${val.name}</label></li>` } if (val.selected) { selectedVideoQuality = val.id; selectedVideoQualityName = val.name } }); $("#videoQualityList").html(qualityHtml); $("#videoQualityList input").off("click").on("click", videoQualityClick); var clientObj = JSON.parse(localStorage.getItem("client")); var selectObj = clientObj.now; var find = false; if (selectObj.qualityName != selectedVideoQualityName) { list.map(val => { if (selectObj.qualityName == val.name) { if (findQuality(val)) { var req = {}; var instanceKey = getInstanceKey("key"); req.pictureQualityId = val.pictureQualityId; req.serverInstanceKey = instanceKey; asyncPost("/api/v1/web/running/checkPictureQuality", req, null, false, function (data) { if (data.code == 200) { $(`#videoQualityList #${val.id}`).attr("checked", true); sendMsg(INPUT_TYPE_BITERATE + "," + val.id); find = true } else { $(`#videoQualityList #${client.default.qualityId}`).attr("checked", true) } }) } else { $(`#videoQualityList #${val.id}`).attr("checked", true); selectObj.qualityId = val.id; localStorage.setItem("client", JSON.stringify(client)); sendMsg(INPUT_TYPE_BITERATE + "," + val.id); find = true } } }) } if (find) { return } if (!clientObj.default.hasOwnProperty("qualityName")) { client.default.qualityName = selectedVideoQualityName; client.default.qualityId = selectedVideoQuality } else { client.now.qualityName = selectedVideoQualityName; client.now.qualityId = selectedVideoQuality } localStorage.setItem("client", JSON.stringify(client)); $(`#videoQualityList #${selectedVideoQuality}`).attr("checked", true) } } function findQuality(val, flag) { if (pictureQualityList) { for (var i = 0; i < pictureQualityList.length; i++) { var pictureQuality = pictureQualityList[i]; if (pictureQuality.cnName === val.name) { if (flag == 1) { qualityHtml += `<li><input id=${val.id} data-id=${pictureQuality.id} value=${val.name} type="radio" name="quality"><label for=${val.id}>${val.name}</label><img src=${pictureQuality.imageUrl} alt=""></li>` } val.pictureQualityId = pictureQuality.id; return true } } } return false } function handleInputSourceList(data) { var inputSouceList = JSON.parse(data); if (inputSouceList["list"] !== undefined && inputSouceList["list"] !== null) { var list = inputSouceList["list"]; var selectedInputSourceId, selectedInputSourceName; $("#inputSourceList").empty(); for (var i = 0; i < list.length; i++) { $("#inputSourceList").append("<div class='item' data-id='" + list[i]["id"] + "' onclick='selectInputSource(this)'>" + list[i]["name"] + "</div>"); if (list[i]["selected"] == true) { selectedInputSourceId = list[i]["id"]; selectedInputSourceName = list[i]["name"] } } $(".ui.dropdown").dropdown(); $(".dropdown").dropdown("set selected", selectedInputSourceName) } } function handleMouseModeList(data) { xc.gotMouseModeList = true; var mouseModeList = JSON.parse(data); var selectedMouseMode, selectedMouseModeName; if (mouseModeList["list"] !== undefined && mouseModeList["list"] !== null) { var list = mouseModeList["list"]; for (var i = 0; i < list.length; i++) { if (list[i]["name"].indexOf("æ¬å°") > -1) { list.splice(i, 1); i-- } } $("#mouseModelList").empty(); var html = ""; list.map(val => { html += `<li><input data-id=${val.type} id=${val.type + 10} type="radio" value=${val.name} name="mouseMode"><label for=${val.type + 10}>${val.name}</label></li>`; if (val.selected) { selectedMouseMode = val.type; selectedMouseModeName = val.name } }); if (typeof selectedMouseMode == "undefined") { selectedMouseMode = list[0].type; selectedMouseModeName = list[0].name } $("#mouseModelList").html(html); $("#mouseModelList input").off("click").on("click", mouseModelClick); $(`#mouseModelList input[data-id=${selectedMouseMode}]`).attr("checked", true); if (MouseType) { MouseType = false; if (!localStorage.getItem("client")) { client.default.MouseName = selectedMouseModeName; client.default.MouseId = selectedMouseMode } else { client.default.MouseName = selectedMouseModeName; client.default.MouseId = selectedMouseMode; client.now.MouseName = selectedMouseModeName; client.now.MouseId = selectedMouseMode; localStorage.setItem("client", JSON.stringify(client)) } } if (Mouseselect) { Mouseselect = false; var select = JSON.parse(localStorage.getItem("client")).now; list.map(val => { if (select.MouseId == val.type) { $(`#mouseModelList input[data-id=${val.type}]`).attr("checked", true); sendMsg(DATA_CHANNEL_MSG_SELECT_MOUSE_MODE + ", " + val.type) } }) } xc.selectedMouseMode = selectedMouseMode; var cursorMsg; var top = xc.videoHeight / xc.scaleY / 2 + $("#remote_video").offset().top; var left = xc.videoWidth / xc.scaleX / 2 + $("#remote_video").offset().left; cursorMsg = xc.cursorVisible + "," + left + "," + top; if (xc.selectedMouseMode == 4 || xc.selectedMouseMode == 5) { if (xc.cursorVisible) { $("#simulated-cursor-img").show() } else { $("#simulated-cursor-img").hide() } xc.cursorLockEnabled = true; $("#full_screen_with_cursorLock").show() } else { if (xc.cursorVisible) { xc.display.style.cursor = xc.cursorCache } else { xc.display.style.cursor = "none" } $("#full_screen_with_cursorLock").hide(); xc.cursorLockEnabled = false } if (isLockShow) { isLockShow = false; $(".dimmer").dimmer("show") } dimmerShow(); setCursorVisible(cursorMsg) } } function selectInputSource(item) { var selectedId = $(item).attr("data-id"); sendMsg(DATA_CHANNEL_MSG_SELECT_INPUT_SOURCE + ", " + selectedId) } function changeInputSource(iptVale) { sendMsg(DATA_CHANNEL_MSG_SELECT_INPUT_SOURCE + ", " + iptVale) } function sendRCMode(item) { setSelected(item); var selectedId = $(item).attr("data-id"); sendMsg(DATA_CHANNEL_MSG_SELECT_RC_MODE + ", " + selectedId) } function sendROI(item) { setSelected(item); var selectedId = $(item).attr("data-id"); sendMsg(DATA_CHANNEL_MSG_SELECT_ROI + ", " + selectedId) } function selectMouseMode(item) { var selectedType = item; sendMsg(DATA_CHANNEL_MSG_SELECT_MOUSE_MODE + ", " + selectedType); if (selectedType == 4 || selectedType == 5) { $("#full_screen").hide(); $("#full_screen_with_cursorLock").show(); xc.cursorLockEnabled = true; $(".dimmer").dimmer("hide") } else { xc.display.style.cursor = xc.cursorCache; $("#simulated-cursor-img").hide(); $("#full_screen").show(); $("#full_screen_with_cursorLock").hide(); xc.cursorLockEnabled = false; $(".dimmer").dimmer("hide") } } function handleAppInstanceMsg(data) { switch (parseInt(data)) { case StartupAppFromSandboxSuccess: Janus.log("Create App Instance successful"); break; case StartupAppFromSandboxError: layer.msg("æå¡å¨åé¨éè¯¯ï¼", { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }); break; case SandboxFullNeedToCreateMore: layer.msg("ç¨æ·è¿æ¥æ°è¾¾å°ä¸éï¼æ æ³ç»§ç»­åå»ºå®ä¾ï¼", { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }); break; case FocusWindowCannotFindPleaseRefresh: Janus.log("Unable get active window"); window.location.reload(true); break; case gotLastWindow: Janus.log("got last window"); xc.gotLastWindow = true; if (xc.selectedMouseMode == 4) { xc.cursorLockEnabled = true; $("#full_screen_with_cursorLock").show(); $("#full_screen").hide(); $(".dimmer").dimmer("hide"); dimmerShow() } else { $("#full_screen").show(); $("#full_screen_with_cursorLock").hide(); xc.cursorLockEnabled = false; $(".dimmer").dimmer("hide") } if (xc.gotMouseModeList) { $("#mouseMode").show() } break } } function sendVideoQuality(id, name) { setTimeout(() => { $("#videoQualityList input").attr("disabled", true) }, 100); layer.msg("æ­£å¨åæ¢å°" + name + "ç»è´¨ï¼è¯·ç¨åâ¦â¦", { time: 3e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }); sendMsg(INPUT_TYPE_BITERATE + "," + id); setTimeout(() => { $("#videoQualityList input").attr("disabled", false); $("#frameDeduct input").attr("disabled", false) }, 3e3) } function handleInputSourceListDefault(data) { var inputSouceList = JSON.parse(data); if (inputSouceList["list"] !== undefined && inputSouceList["list"] !== null) { var list = inputSouceList["list"]; var selectedInputSourceId, selectedInputSourceName; $("#inputSourceList").empty(); var sourceId = null; for (var i = 0; i < list.length; i++) { if (connectType != 1 && list[i]["name"] == "å¾®è½¯æ¼é³") { sourceId = list[i]["id"] } if (list[i]["selected"] == true) { selectedInputSourceId = list[i]["id"]; selectedInputSourceName = list[i]["name"] } } if (sourceId != null && selectedInputSourceId != sourceId) { sendMsg(DATA_CHANNEL_MSG_SELECT_INPUT_SOURCE + ", " + sourceId) } } } function sendRestartApp() { layer.msg("æ­£å¨éå¯æ¸¸æä¸­ï¼è¯·ç¨åâ¦â¦", { time: 3e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }); $("#restart").off("click", sendRestartApp); $("#restart").css("color", "#666666"); $("#restart").on({ mouseenter: () => { $("#restart").css("color", "#666666") }, mouseleave: () => { $("p").css("color", "#cdcdcd") } }); setTimeout(() => { $("#restart").css("color", "#cdcdcd"); $("#restart").on({ mouseenter: () => { $("#restart").css("color", "#fff") }, mouseleave: () => { $("p").css("color", "#cdcdcd") } }); $("#restart").on("click", sendRestartApp) }, 1e3 * 10); sendMsg(RESTART_APP + ", " + "") } function handleChangeFrameNumber(data) { if (mChangeFrameNumber) { mChangeFrameNumber = false; var frameNumber = $("#frameDeduct input:checked").attr("data-frameNumber"); var array = data.split(","); if (typeof array != "undefined" && array.length > 3) { if (array[3] == frameNumber) { } } } } "use strict"; function detectZoom() { var ratio = 0, screen = window.screen, ua = navigator.userAgent.toLowerCase(); if (window.devicePixelRatio !== undefined) { ratio = window.devicePixelRatio } else if (~ua.indexOf("msie")) { if (screen.deviceXDPI && screen.logicalXDPI) { ratio = screen.deviceXDPI / screen.logicalXDPI } } else if (window.outerWidth != undefined && window.innerWidth != undefined) { ratio = window.outerWidth / window.innerWidth } if (ratio) { ratio = Math.round(ratio * 100) } return ratio } var mCurWidth = null; var mCurHeight = null; var mRatio = null; function setCursor(cursorMsg) { var cursor = new DataChannelMsgCursor(cursorMsg); var preHotSpotX = parseInt($("#simulated-cursor").data("hotSpotX")); var preHotSpotY = parseInt($("#simulated-cursor").data("hotSpotY")); if (cursor.pngStr == "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAVklEQVR4nO3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOBvAI8AAT4ZY7sAAAAASUVORK5CYII") { xc.display.style.cursor = "none" } else { xc.display.style.cursor = "url(data:image/png;base64," + cursor.pngStr + ") " + cursor.hotSpotX + " " + cursor.hotSpotY + ", default" } xc.cursorCache = xc.display.style.cursor; $("#simulated-cursor-img").attr("src", "data:image/png;base64," + cursor.pngStr); $("#simulated-cursor").css({ "z-index": 9999 }); $("#simulated-cursor").data("hotSpotX", cursor.hotSpotX); $("#simulated-cursor").data("hotSpotY", cursor.hotSpotY); $("#simulated-cursor").css({ position: "absolute" }); var left = (xc.posX - cursor.hotSpotX) / xc.scaleX + xc.display.offsetLeft; var top = (xc.posY - cursor.hotSpotY) / xc.scaleY + xc.display.offsetTop; $("#simulated-cursor").css({ top: top, left: left }); $("#simulated-cursor-img").hide(); if (xc.cursorLockEnabled && xc.cursorVisible) { xc.display.style.cursor = "none"; $("#simulated-cursor-img").show() } xc.cursorPngCache = cursor.pngStr } function setCursorVisible(isVisible) { var msg = isVisible.split(",", 3); var visible = msg[0]; var x = parseInt(msg[1]); var y = parseInt(msg[2]); var hotSpotX = parseInt($("#simulated-cursor").data("hotSpotX")); var hotSpotY = parseInt($("#simulated-cursor").data("hotSpotY")); if (visible == "0") { xc.cursorVisible = 0; if (xc.cursorLockEnabled) { $("#simulated-cursor-img").hide(); xc.localCursorVisible = false } if (xc.display.style.cursor != "none") { xc.cursorCache = xc.display.style.cursor } xc.display.style.cursor = "none" } else { xc.cursorVisible = 1; if (!xc.cursorLockEnabled) { xc.display.style.cursor = xc.cursorCache } else { xc.localCursorVisible = true; if (!$("#simulated-cursor-img")[0].src) { setCursor(xc.defaultCursor) } var left = parseInt($("#simulated-cursor").css("left")); var top = parseInt($("#simulated-cursor").css("top")); $("#simulated-cursor").css({ top: top, left: left }); var localCursorPos = new DataChannelMsgMousePosition(xc); localCursorPos.x = xc.posX; localCursorPos.y = xc.posY; localCursorPos.button = xc.button; var tmp = new DataChannelMsg; sendMsg(tmp.build_msg(INPUT_TYPE_MOUSE, localCursorPos)); $("#simulated-cursor-img").show() } } } function handleSimulatedCursorPos(pos) { if (xc.cursorLockEnabled) { var cursPos = new DataChannelMsgSimulatedCursorPos(pos); var posX = (cursPos.posX - cursPos.hotSpotX) / xc.scaleX + $("#remote_video").offset().left; var posY = (cursPos.posY - cursPos.hotSpotY) / xc.scaleY + $("#remote_video").offset().top; $("#simulated-cursor").css({ top: posY, left: posX, position: "absolute" }); $("#simulated-cursor-img").show() } else { $("#simulated-cursor-img").hide(); xc.display.style.cursor = xc.cursorCache } } function setCursorScale() { } "use strict"; var KEY_Escape = 1; var KEY_1 = 2; var KEY_2 = 3; var KEY_3 = 4; var KEY_4 = 5; var KEY_5 = 6; var KEY_6 = 7; var KEY_7 = 8; var KEY_8 = 9; var KEY_9 = 10; var KEY_0 = 11; var KEY_Minus = 12; var KEY_Equal = 13; var KEY_BackSpace = 14; var KEY_Tab = 15; var KEY_Q = 16; var KEY_W = 17; var KEY_E = 18; var KEY_R = 19; var KEY_T = 20; var KEY_Y = 21; var KEY_U = 22; var KEY_I = 23; var KEY_O = 24; var KEY_P = 25; var KEY_LBrace = 26; var KEY_RBrace = 27; var KEY_Enter = 28; var KEY_LCtrl = 29; var KEY_A = 30; var KEY_S = 31; var KEY_D = 32; var KEY_F = 33; var KEY_G = 34; var KEY_H = 35; var KEY_J = 36; var KEY_K = 37; var KEY_L = 38; var KEY_SemiColon = 39; var KEY_Quote = 40; var KEY_Tilde = 41; var KEY_ShiftL = 42; var KEY_BSlash = 43; var KEY_Z = 44; var KEY_X = 45; var KEY_C = 46; var KEY_V = 47; var KEY_B = 48; var KEY_N = 49; var KEY_M = 50; var KEY_Comma = 51; var KEY_Period = 52; var KEY_Slash = 53; var KEY_ShiftR = 54; var KEY_KP_Multiply = 55; var KEY_Alt = 56; var KEY_Space = 57; var KEY_CapsLock = 58; var KEY_F1 = 59; var KEY_F2 = 60; var KEY_F3 = 61; var KEY_F4 = 62; var KEY_F5 = 63; var KEY_F6 = 64; var KEY_F7 = 65; var KEY_F8 = 66; var KEY_F9 = 67; var KEY_F10 = 68; var KEY_NumLock = 69; var KEY_ScrollLock = 70; var KEY_KP_7 = 71; var KEY_KP_8 = 72; var KEY_KP_9 = 73; var KEY_KP_Minus = 74; var KEY_KP_4 = 75; var KEY_KP_5 = 76; var KEY_KP_6 = 77; var KEY_KP_Plus = 78; var KEY_KP_1 = 79; var KEY_KP_2 = 80; var KEY_KP_3 = 81; var KEY_KP_0 = 82; var KEY_KP_Decimal = 83; var KEY_SysReqest = 84; var KEY_Less = 86; var KEY_F11 = 87; var KEY_F12 = 88; var KEY_Prefix0 = 96; var KEY_Prefix1 = 97; var common_scanmap = []; common_scanmap["Q".charCodeAt(0)] = KEY_Q; common_scanmap["W".charCodeAt(0)] = KEY_W; common_scanmap["E".charCodeAt(0)] = KEY_E; common_scanmap["R".charCodeAt(0)] = KEY_R; common_scanmap["T".charCodeAt(0)] = KEY_T; common_scanmap["Y".charCodeAt(0)] = KEY_Y; common_scanmap["U".charCodeAt(0)] = KEY_U; common_scanmap["I".charCodeAt(0)] = KEY_I; common_scanmap["O".charCodeAt(0)] = KEY_O; common_scanmap["P".charCodeAt(0)] = KEY_P; common_scanmap["A".charCodeAt(0)] = KEY_A; common_scanmap["S".charCodeAt(0)] = KEY_S; common_scanmap["D".charCodeAt(0)] = KEY_D; common_scanmap["F".charCodeAt(0)] = KEY_F; common_scanmap["G".charCodeAt(0)] = KEY_G; common_scanmap["H".charCodeAt(0)] = KEY_H; common_scanmap["J".charCodeAt(0)] = KEY_J; common_scanmap["K".charCodeAt(0)] = KEY_K; common_scanmap["L".charCodeAt(0)] = KEY_L; common_scanmap["Z".charCodeAt(0)] = KEY_Z; common_scanmap["X".charCodeAt(0)] = KEY_X; common_scanmap["C".charCodeAt(0)] = KEY_C; common_scanmap["V".charCodeAt(0)] = KEY_V; common_scanmap["B".charCodeAt(0)] = KEY_B; common_scanmap["N".charCodeAt(0)] = KEY_N; common_scanmap["M".charCodeAt(0)] = KEY_M; common_scanmap[" ".charCodeAt(0)] = KEY_Space; common_scanmap[13] = KEY_Enter; common_scanmap[27] = KEY_Escape; common_scanmap[8] = KEY_BackSpace; common_scanmap[9] = KEY_Tab; common_scanmap[16] = KEY_ShiftL; common_scanmap[17] = KEY_LCtrl; common_scanmap[18] = KEY_Alt; common_scanmap[20] = KEY_CapsLock; common_scanmap[144] = KEY_NumLock; common_scanmap[112] = KEY_F1; common_scanmap[113] = KEY_F2; common_scanmap[114] = KEY_F3; common_scanmap[115] = KEY_F4; common_scanmap[116] = KEY_F5; common_scanmap[117] = KEY_F6; common_scanmap[118] = KEY_F7; common_scanmap[119] = KEY_F8; common_scanmap[120] = KEY_F9; common_scanmap[121] = KEY_F10; common_scanmap[122] = KEY_F11; common_scanmap[123] = KEY_F12; common_scanmap[42] = 99; common_scanmap[19] = 101; common_scanmap[111] = 181; common_scanmap[106] = 55; common_scanmap[36] = 199; common_scanmap[38] = 200; common_scanmap[33] = 201; common_scanmap[37] = 203; common_scanmap[39] = 205; common_scanmap[35] = 207; common_scanmap[40] = 208; common_scanmap[34] = 209; common_scanmap[45] = 210; common_scanmap[46] = 211; common_scanmap[44] = 183; common_scanmap[44] = 183; common_scanmap[12] = 0; common_scanmap["1".charCodeAt(0)] = KEY_1; common_scanmap["2".charCodeAt(0)] = KEY_2; common_scanmap["3".charCodeAt(0)] = KEY_3; common_scanmap["4".charCodeAt(0)] = KEY_4; common_scanmap["5".charCodeAt(0)] = KEY_5; common_scanmap["6".charCodeAt(0)] = KEY_6; common_scanmap["7".charCodeAt(0)] = KEY_7; common_scanmap["8".charCodeAt(0)] = KEY_8; common_scanmap["9".charCodeAt(0)] = KEY_9; common_scanmap["0".charCodeAt(0)] = KEY_0; common_scanmap[145] = KEY_ScrollLock; common_scanmap[103] = KEY_KP_7; common_scanmap[104] = KEY_KP_8; common_scanmap[105] = KEY_KP_9; common_scanmap[100] = KEY_KP_4; common_scanmap[101] = KEY_KP_5; common_scanmap[102] = KEY_KP_6; common_scanmap[107] = KEY_KP_Plus; common_scanmap[109] = KEY_KP_Minus; common_scanmap[97] = KEY_KP_1; common_scanmap[98] = KEY_KP_2; common_scanmap[99] = KEY_KP_3; common_scanmap[96] = KEY_KP_0; common_scanmap[110] = KEY_KP_Decimal; common_scanmap[191] = KEY_Slash; common_scanmap[190] = KEY_Period; common_scanmap[188] = KEY_Comma; common_scanmap[220] = KEY_BSlash; common_scanmap[192] = KEY_Tilde; common_scanmap[222] = KEY_Quote; common_scanmap[219] = KEY_LBrace; common_scanmap[221] = KEY_RBrace; common_scanmap[91] = 57435; common_scanmap[92] = 57436; common_scanmap[93] = 57437; var firefox_scanmap = []; firefox_scanmap[173] = KEY_Minus; firefox_scanmap[109] = KEY_Minus; firefox_scanmap[61] = KEY_Equal; firefox_scanmap[59] = KEY_SemiColon; var DOM_scanmap = []; DOM_scanmap[189] = KEY_Minus; DOM_scanmap[187] = KEY_Equal; DOM_scanmap[186] = KEY_SemiColon; function get_scancode(code) { if (common_scanmap[code] === undefined) { if (navigator.userAgent.indexOf("Firefox") != -1) return firefox_scanmap[code]; else return DOM_scanmap[code] } else return common_scanmap[code] } function keycode_to_start_scan(code) { var scancode = get_scancode(code); if (scancode === undefined) { Janus.log("no map for " + code); return 0 } if (scancode < 256) { return scancode } else { return 224 | scancode - 256 << 8 } } function keycode_to_end_scan(code) { var scancode = get_scancode(code); if (scancode === undefined) return 0; if (scancode < 256) { return scancode | 128 } else { return 32992 | scancode - 256 << 8 } } (function () { var RTCPeerConnection; if (typeof webkitRTCPeerConnection !== "undefined") { RTCPeerConnection = webkitRTCPeerConnection } if (typeof mozRTCPeerConnection !== "undefined") { RTCPeerConnection = mozRTCPeerConnection } if (typeof MediaStreamTrack === "undefined") { MediaStreamTrack = {} } function getStats(mediaStreamTrack, callback, interval) { var peer = this; if (arguments[0] instanceof RTCPeerConnection) { peer = arguments[0]; if (!!navigator.mozGetUserMedia) { mediaStreamTrack = arguments[1]; callback = arguments[2]; interval = arguments[3] } if (!(mediaStreamTrack instanceof MediaStreamTrack) && !!navigator.mozGetUserMedia) { throw "2nd argument is not instance of MediaStreamTrack." } } else if (!(mediaStreamTrack instanceof MediaStreamTrack) && !!navigator.mozGetUserMedia) { throw "1st argument is not instance of MediaStreamTrack." } var globalObject = { audio: {}, video: {} }; var nomore = false; (function getPrivateStats() { _getStats(function (results) { var result = { audio: {}, video: {}, results: results, nomore: function () { nomore = true } }; for (var i = 0; i < results.length; ++i) { var res = results[i]; if (res.datachannelid && res.type === "datachannel") { result.datachannel = { state: res.state } } if (res.type === "googLibjingleSession") { result.isOfferer = res.googInitiator } if (res.type == "googCertificate") { result.encryption = res.googFingerprintAlgorithm } if (res.googCodecName == "opus" && res.bytesSent) { var kilobytes = 0; if (!!res.bytesSent) { if (!globalObject.audio.prevBytesSent) { globalObject.audio.prevBytesSent = res.bytesSent } var bytes = res.bytesSent - globalObject.audio.prevBytesSent; globalObject.audio.prevBytesSent = res.bytesSent; kilobytes = bytes / 1024 } if (!result.audio) { result.audio = res } result.audio.availableBandwidth = kilobytes.toFixed(1) } if (res.googCodecName == "VP8") { var kilobytes = 0; if (!!res.bytesSent) { if (!globalObject.video.prevBytesSent) { globalObject.video.prevBytesSent = res.bytesSent } var bytes = res.bytesSent - globalObject.video.prevBytesSent; globalObject.video.prevBytesSent = res.bytesSent; kilobytes = bytes / 1024 } if (!result.video) { result.video = res } result.video.availableBandwidth = kilobytes.toFixed(1); if (res.googFrameHeightReceived && res.googFrameWidthReceived) { result.resolutions = { width: res.googFrameWidthReceived, height: res.googFrameHeightReceived } } } if (res.type == "VideoBwe") { result.video.bandwidth = { googActualEncBitrate: res.googActualEncBitrate, googAvailableSendBandwidth: res.googAvailableSendBandwidth, googAvailableReceiveBandwidth: res.googAvailableReceiveBandwidth, googRetransmitBitrate: res.googRetransmitBitrate, googTargetEncBitrate: res.googTargetEncBitrate, googBucketDelay: res.googBucketDelay, googTransmitBitrate: res.googTransmitBitrate } } if (res.type == "googCandidatePair" && res.googActiveConnection == "true") { result.connectionType = { localcandidateType: res.googLocalCandidateType, localipAddress: res.googLocalAddress, remotecandidateType: res.googRemoteCandidateType, remoteipAddress: res.googRemoteAddress, transport: res.googTransportType } } var systemNetworkType = ((navigator.connection || {}).type || "unknown").toString().toLowerCase(); if (res.type === "localcandidate") { if (!result.connectionType) { result.connectionType = {} } } if (res.type === "remotecandidate") { if (!result.connectionType) { result.connectionType = {} } } } try { if (peer.iceConnectionState.search(/failed|closed/gi) !== -1) { nomore = true } } catch (e) { nomore = true } if (nomore === true) { if (result.datachannel) { result.datachannel.state = "close" } result.ended = true } callback(result); if (!nomore) { typeof interval != undefined && interval && setTimeout(getPrivateStats, interval || 1e3) } }) })(); function _getStats(cb) { if (!!navigator.mozGetUserMedia) { peer.getStats(mediaStreamTrack, function (res) { var items = []; res.forEach(function (result) { items.push(result) }); cb(items) }, cb) } else { peer.getStats(function (res) { var items = []; res.result().forEach(function (result) { var item = {}; result.names().forEach(function (name) { item[name] = result.stat(name) }); item.id = result.id; item.type = result.type; item.timestamp = result.timestamp; items.push(item) }); cb(items) }) } } } function merge(mergein, mergeto) { if (!mergein) mergein = {}; if (!mergeto) return mergein; for (var item in mergeto) { mergein[item] = mergeto[item] } return mergein } if (typeof module !== "undefined") { module.exports = getStats } if (typeof window !== "undefined") { window.getStats = getStats } })(); (function (factory) { var registeredInModuleLoader = false; if (typeof define === "function" && define.amd) { define(factory); registeredInModuleLoader = true } if (typeof exports === "object") { module.exports = factory(); registeredInModuleLoader = true } if (!registeredInModuleLoader) { var OldCookies = window.Cookies; var api = window.Cookies = factory(); api.noConflict = function () { window.Cookies = OldCookies; return api } } })(function () { function extend() { var i = 0; var result = {}; for (; i < arguments.length; i++) { var attributes = arguments[i]; for (var key in attributes) { result[key] = attributes[key] } } return result } function init(converter) { function api(key, value, attributes) { var result; if (typeof document === "undefined") { return } if (arguments.length > 1) { attributes = extend({ path: "/" }, api.defaults, attributes); if (typeof attributes.expires === "number") { var expires = new Date; expires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e5); attributes.expires = expires } try { result = JSON.stringify(value); if (/^[\{\[]/.test(result)) { value = result } } catch (e) { } if (!converter.write) { value = encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent) } else { value = converter.write(value, key) } key = encodeURIComponent(String(key)); key = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent); key = key.replace(/[\(\)]/g, escape); return document.cookie = [key, "=", value, attributes.expires ? "; expires=" + attributes.expires.toUTCString() : "", attributes.path ? "; path=" + attributes.path : "", attributes.domain ? "; domain=" + attributes.domain : "", attributes.secure ? "; secure" : ""].join("") } if (!key) { result = {} } var cookies = document.cookie ? document.cookie.split("; ") : []; var rdecode = /(%[0-9A-Z]{2})+/g; var i = 0; for (; i < cookies.length; i++) { var parts = cookies[i].split("="); var cookie = parts.slice(1).join("="); if (cookie.charAt(0) === '"') { cookie = cookie.slice(1, -1) } try { var name = parts[0].replace(rdecode, decodeURIComponent); cookie = converter.read ? converter.read(cookie, name) : converter(cookie, name) || cookie.replace(rdecode, decodeURIComponent); if (this.json) { try { cookie = JSON.parse(cookie) } catch (e) { } } if (key === name) { result = cookie; break } if (!key) { result[name] = cookie } } catch (e) { } } return result } api.set = api; api.get = function (key) { return api.call(api, key) }; api.getJSON = function () { return api.apply({ json: true }, [].slice.call(arguments)) }; api.defaults = {}; api.remove = function (key, attributes) { api(key, "", extend(attributes, { expires: -1 })) }; api.withConverter = init; return api } return init(function () { }) }); var Browser = function (userAgent) { var u = userAgent || navigator.userAgent; var _this = this; var match = { Trident: u.indexOf("Trident") > 0 || u.indexOf("NET CLR") > 0, Presto: u.indexOf("Presto") > 0, WebKit: u.indexOf("AppleWebKit") > 0, Gecko: u.indexOf("Gecko/") > 0, UC: u.indexOf("UC") > 0 || u.indexOf(" UBrowser") > 0, QQ: u.indexOf("QQBrowser") > 0, BaiDu: u.indexOf("Baidu") > 0 || u.indexOf("BIDUBrowser") > 0, Maxthon: u.indexOf("Maxthon") > 0, LBBROWSER: u.indexOf("LBBROWSER") > 0, SouGou: u.indexOf("MetaSr") > 0 || u.indexOf("Sogou") > 0, IE: u.indexOf("MSIE") > 0 || u.indexOf("Trident") > 0, Firefox: u.indexOf("Firefox") > 0, Opera: u.indexOf("Opera") > 0 || u.indexOf("OPR") > 0, Safari: u.indexOf("Safari") > 0, Chrome: u.indexOf("Chrome") > 0 || u.indexOf("CriOS") > 0, Wechat: u.indexOf("MicroMessenger") > 0, Windows: u.indexOf("Windows") > 0, Linux: u.indexOf("Linux") > 0, Mac: u.indexOf("Macintosh") > 0, Android: u.indexOf("Android") > 0 || u.indexOf("Adr") > 0, WP: u.indexOf("IEMobile") > 0, BlackBerry: u.indexOf("BlackBerry") > 0 || u.indexOf("RIM") > 0 || u.indexOf("BB") > 0, MeeGo: u.indexOf("MeeGo") > 0, Symbian: u.indexOf("Symbian") > 0, iOS: u.indexOf("like Mac OS X") > 0, iPhone: u.indexOf("iPh") > 0, iPad: u.indexOf("iPad") > 0, Mobile: u.indexOf("Mobi") > 0 || u.indexOf("iPh") > 0 || u.indexOf("480") > 0, Tablet: u.indexOf("Tablet") > 0 || u.indexOf("iPad") > 0 || u.indexOf("Nexus 7") > 0 }; if (match.Chrome) { match.Chrome = !(match.Opera + match.BaiDu + match.Maxthon + match.SouGou + match.UC + match.QQ + match.LBBROWSER) } if (match.Safari) { match.Safari = !(match.Chrome + match.Opera + match.BaiDu + match.Maxthon + match.SouGou + match.UC + match.LBBROWSER) } if (match.Mobile) { match.Mobile = !match.iPad } var hash = { engine: ["WebKit", "Trident", "Gecko", "Presto"], browser: ["Chrome", "IE", "Firefox", "Opera", "Safari", "UC", "BaiDu", "Maxthon", "SouGou", "LBBROWSER", "Wechat"], os: ["Windows", "Linux", "Mac", "Android", "iOS", "iPhone", "iPad", "WP", "BlackBerry", "MeeGo", "Symbian"], device: ["Mobile", "Tablet"] }; _this.device = "PC"; _this.language = function () { var g = (navigator.browserLanguage || navigator.language).toLowerCase(); return g == "c" ? "zh-cn" : g }(); for (var s in hash) { for (var i = 0; i < hash[s].length; i++) { var value = hash[s][i]; if (match[value]) { _this[s] = value } } } var version = { Chrome: function () { return u.replace(/^.*Chrome\/([\d.]+).*$/, "$1") }, IE: function () { var v = u.replace(/^.*MSIE ([\d.]+).*$/, "$1"); if (v == u) { v = u.replace(/^.*rv:([\d.]+).*$/, "$1") } return v != u ? v : "" }, Firefox: function () { return u.replace(/^.*Firefox\/([\d.]+).*$/, "$1") }, Safari: function () { return u.replace(/^.*Version\/([\d.]+).*$/, "$1") }, Maxthon: function () { return u.replace(/^.*Maxthon\/([\d.]+).*$/, "$1") }, QQ: function () { return u.replace(/^.*QQBrowser\/([\d.]+).*$/, "$1") }, BaiDu: function () { return u.replace(/^.*BIDUBrowser[\s\/]([\d.]+).*$/, "$1") }, UC: function () { return u.replace(/^.*UBrowser\/([\d.]+).*$/, "$1") }, Wechat: function () { return u.replace(/^.*MicroMessenger\/([\d.]+).*$/, "$1") } }; _this.version = ""; if (version[_this.browser]) { _this.version = version[_this.browser]() } }; function checkBrowserCapability() { var browser = new Browser; var device = browser.device; var browserName = browser.browser; var browserVersion = parseInt(browser.version); if (device == "PC") { if (browserName == "Chrome" && (browserVersion < 52 || browserVersion > 57)) { return false } else if (browserName != "Chrome") { return false } } return true } var janus = null; var streaming = null; var selectedStream = null; var xc; var transport_type = "all"; var ice_servers = []; var is_tcp = false; var timerCount = 0; var msgLayer; $(document).ready(function () { var server_url = static_server_url; var instancekey = getInstanceKey("key"); asyncGet("/api/v1/web/client/application/loadJanusServerInfo", { key: instancekey }, null, false, function (data) { if (data.code == janusReturnResult.result_success) { server_url = data.obj.janusUrl + ":" + data.obj.janusPort + "/janus"; ice_servers = JSON.parse(data.obj.iceServerInfo); server = server_url } }, true, false); init(); setInterval("setTimerCount()", 1e3) }); function setTimerCount() { timerCount += 1; if (timerCount == 180) { msgLayer = layer.msg("äº²ï¼ä½ è¿å¨çµèååï¼", { time: 0, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }) } } function restart_tcp(item) { is_tcp = true; for (var s in Janus.sessions) { if (Janus.sessions[s] !== null && Janus.sessions[s] !== undefined && Janus.sessions[s].destroyOnUnload) { Janus.log("Destroying session " + s); Janus.sessions[s].destroy() } } Janus.initDone = false; init("tcp"); setSelected(item) } var maskHidden = false; function init(type) { if (type == "tcp") { transport_type = "relay"; ice_servers = ice_servers_tcp } Janus.init({ debug: "all", callback: function () { if (!Janus.isWebrtcSupported()) { layer.msg("No WebRTC support... ", { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }); return } janus = new Janus({ server: server, iceServers: ice_servers, transportType: transport_type, success: function () { Noty.overrideDefaults({ closeWith: ["click", "button"] }); janus.attach({ plugin: "janus.plugin.streaming", success: function (pluginHandle) { streaming = pluginHandle; Janus.log("Plugin attached! (" + streaming.getPlugin() + ", key=" + streaming.getId() + ")"); startStream() }, error: function (error) { Janus.error("  -- Error attaching plugin... ", error); layer.msg("Error attaching plugin... ", { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }) }, onmessage: function (msg, jsep) { Janus.debug(" ::: Got a message :::"); Janus.debug(JSON.stringify(msg)); var result = msg["result"]; if (result !== null && result !== undefined) { if (result["status"] !== undefined && result["status"] !== null) { var status = result["status"]; if (status === "stopped") stopStream() } } else if (msg["error"] !== undefined && msg["error"] !== null) { layer.msg(msg["error"], { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }); stopStream(); return } if (jsep !== undefined && jsep !== null) { Janus.debug("Handling SDP as well..."); Janus.debug(jsep); streaming.createAnswer({ jsep: jsep, media: { audioSend: isAudioSend, videoSend: false, data: true }, success: function (jsep) { Janus.debug("Got SDP!"); Janus.debug(jsep); var body = { request: "start" }; streaming.send({ message: body, jsep: jsep }) }, error: function (error) { Janus.error("WebRTC error:", error); layer.msg("WebRTC error... ", { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }) } }) } }, onremotestream: function (stream) { Janus.debug(" ::: Got a remote stream :::"); Janus.debug(JSON.stringify(stream)); xc = new XenConnection; xc.display = document.getElementById("remote_video"); xc.selectedMouseMode = $.trim($("#hid_mouseType").val()); $("#remote_video").bind("playing", function () { $("#remote_video").removeClass("hide"); xc.scaleY = $("#remote_video")[0].videoHeight / $("#remote_video").height(); xc.scaleX = $("#remote_video")[0].videoWidth / $("#remote_video").width(); xc.videoHeight = $("#remote_video")[0].videoHeight; xc.videoWidth = $("#remote_video")[0].videoWidth; if (!maskHidden) { $("#div_loadingMask").addClass("displaynone"); var gameStartList = JSON.parse(localStorage.getItem("gameStartList")); if (gameStartList) { var anGame_enter = { game_ID: `${gameStartList.game_ID}`, game_name: `${gameStartList.game_name}`, game_area: `${gameStartList.game_area}` }; sendAnalysysAgent("track", anGame_enter, "game_enter") } } }); attachMediaStream($("#remote_video").get(0), stream); if (xc.selectedMouseMode != 4 && xc.selectedMouseMode != 5) { $("#full_screen").show(); $("#full_screen_with_cursorLock").hide(); xc.cursorLockEnabled = false; $(".dimmer").dimmer("hide") } hook_events() }, ondataopen: function (data) { window.dataOpen = true }, ondata: function (data) { onData(data) }, oncleanup: function () { unhook_events(); if (!is_tcp) { window.close() } is_tcp = false } }) }, error: function (error) { Janus.error(error); layer.msg(error, { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }) }, destroyed: function () { } }) } }) } function startStream() { startTime(); var key = getUrlParam("key"); var id = getUrlParam("id"); var ip = getUrlParam("ip"); var port = getUrlParam("port"); var body; if (key) { window.useREST = true; selectedStream = key; body = { request: "watch", key: selectedStream } } else if (ip) { selectedStream = id; body = { request: "watch", id: parseInt(selectedStream), ip: ip, port: port } } if (selectedStream === undefined || selectedStream === null) { layer.msg("unknown stream", { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }); return } streaming.send({ message: body }) } function stopStream() { var body = { request: "stop" }; streaming.send({ message: body }); streaming.hangup() } function sendMsg(msg) { var isKeyboard = msg.indexOf(INPUT_TYPE_KEYBOARD); var isMouse = msg.indexOf(INPUT_TYPE_MOUSE); var isMouseMotion = msg.indexOf(INPUT_TYPE_MOUSE_MOTION); var isGamePad = msg.indexOf(INPUT_TYPE_GAMEPAD); if (isKeyboard == 0 || isMouse == 0 || isMouseMotion == 0 || isGamePad == 0) { timerCount = 0; layer.close(msgLayer) } if (!window.dataOpen) return; var Msg = msg + "\0"; streaming.data({ text: Msg, error: function (reason) { layer.msg(reason, { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }) }, success: function () { } }) } function hook_events() { if ($("#remote_video") !== undefined) { window.onresize = function () { xc.scaleY = $("#remote_video")[0].videoHeight / $("#remote_video").height(); xc.scaleX = $("#remote_video")[0].videoWidth / $("#remote_video").width() }; $("#remote_video")[0].onresize = function () { xc.scaleY = $("#remote_video")[0].videoHeight / $("#remote_video").height(); xc.scaleX = $("#remote_video")[0].videoWidth / $("#remote_video").width(); xc.videoHeight = $("#remote_video")[0].videoHeight; xc.videoWidth = $("#remote_video")[0].videoWidth; var preHotSpotX = parseInt($("#simulated-cursor").data("hotSpotX")); var preHotSpotY = parseInt($("#simulated-cursor").data("hotSpotY")); $("#simulated-cursor").data("hotSpotX", preHotSpotX / xc.scaleX); $("#simulated-cursor").data("hotSpotY", preHotSpotY / xc.scaleY) }; $(window).blur(function () { if (xc.keyCode && xc.keyState == 0) { sendMsg(INPUT_TYPE_KEYBOARD + "," + INPUT_KEYBOARD_RELEASE + "," + xc.keyCode + ",0,0") } }); var screen = document.getElementById("remote_video"); $("#remote_video").bind("contextmenu", function () { return false }); screen.addEventListener("mousemove", handle_mouse_motion); screen.addEventListener("mousedown", handle_mouse_press); screen.addEventListener("mouseup", handle_mouse_release); screen.addEventListener("wheel", handle_mouse_scroll); window.addEventListener("keydown", handle_key_press); window.addEventListener("keyup", handle_key_release); document.addEventListener("pointerlockchange", cursorLockChange, false); document.addEventListener("mozpointerlockchange", cursorLockChange, false); var screen_change_events = "webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange"; $(document).on(screen_change_events, function () { $("#tool-bar").toggle(); $("#remote_video").toggleClass("padding"); xc.scaleY = $("#remote_video")[0].videoHeight / $("#remote_video").height(); xc.scaleX = $("#remote_video")[0].videoWidth / $("#remote_video").width(); xc.videoHeight = $("#remote_video")[0].videoHeight; xc.videoWidth = $("#remote_video")[0].videoWidth }); $(".ui.dropdown").dropdown({ action: "nothing" }); $("#full_screen_with_cursorLock").popup({ content: "fullscreen with cursorLock", position: "right center" }); if ($("#full_screen_with_cursorLock")) { $("#full_screen_with_cursorLock").css("display", "none") } if (haveEvents) { window.addEventListener("gamepadconnected", function (e) { connecthandler(e, true) }, false); window.addEventListener("gamepaddisconnected", function (e) { disconnecthandler(e, true) }, false) } else if (haveWebkitEvents) { window.addEventListener("webkitgamepadconnected", function (e) { connecthandler(e, true) }, false); window.addEventListener("webkitgamepaddisconnected", function (e) { disconnecthandler(e, true) }, false) } screen.focus() } } function unhook_events() { var screen = document.getElementById("remote_video"); if (screen) { screen.removeEventListener("mousemove", handle_mouse_motion); screen.removeEventListener("mousedown", handle_mouse_press); screen.removeEventListener("mouseup", handle_mouse_release); screen.removeEventListener("wheel", handle_mouse_scroll); window.removeEventListener("keydown", handle_key_press); window.removeEventListener("keyup", handle_key_release) } } function XenConnection() { this.display = undefined; this.button = 0; this.keyCode = 0; this.keyState = 1; this.scale = 1; this.scaleX = 1; this.scaleY = 1; this.videoHeight = 0; this.videoWidth = 0; this.posX = 1; this.posY = 1; this.cursorCache = undefined; this.cursorLockEnabled = false; this.gamepadButton = 0; this.LAxisX = 0; this.LAxisY = 0; this.RAxisX = 0; this.RAxisY = 0; this.defaultCursor = "0,0,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABA0lEQVRYhe3TsU4CQRSF4XMvTGJCsrNrwmJ8C6t9Cl/Rl3BLsKAzoTEkCy2xWGJF4hIxFscC0A0KWjAzzfzlNPfLyS4gSa0mLxAsSWrRdBQOIUlNkuEQO0A4RAsQBnEA8I/4BeAXcQTgD3ECsHn/8IA4ASDJ1erVMeIPAEkuly8OEf8AkORi8UzRdHTu893Dh/V6g17vAgCgnezh3Ad/1lqgad4IJM19Odz/BUPt9m+9APbH1eSFiJ1+zS526hzQPg4Aolk5Hj/uVshKpytsP6zv4wCgJi8gdkaSVTWniH1yBjgOy8qqmm9XkHTiHdAxV9cQOxO9vFMzuPEOiMVisVjMV5/GX0Zvt4+cPAAAAABJRU5ErkJggg==" } function getUrlParam(name) { var reg = new RegExp("[?&]" + name + "=([^?&]*)[&]?", "i"); var match = location.search.match(reg); return match == null ? "" : match[1] } function fullScreen() { var el = document.documentElement; var rfs = el.requestFullScreen || el.webkitRequestFullScreen || el.mozRequestFullScreen || el.msRequestFullScreen; rfs.call(el) } function toggleRecord() { $("#mic").toggleClass("unmute mute"); if ($("#mic").hasClass("unmute")) { sendMsg(INPUT_TYPE_TOGGLE_RECORD_START) } else { sendMsg(INPUT_TYPE_TOGGLE_RECORD_STOP) } } function toggleCursorLock() { if (typeof $("#remote_video")[0] != "undefined") { if ($("#remote_video")[0].paused) { $("#remote_video")[0].play() } if ($("#remote_video")[0].muted) { $("#remote_video")[0].muted = false } } if (!_mStatic_exit) { return } xc.display.requestPointerLock = xc.display.requestPointerLock || xc.display.mozRequestPointerLock; xc.display.requestPointerLock() } function toggleCursorLockWithFullScreen() { if (typeof $("#remote_video")[0] != "undefined") { if ($("#remote_video")[0].paused) { $("#remote_video")[0].play() } if ($("#remote_video")[0].muted) { $("#remote_video")[0].muted = false } } browserKeyLock(); var el = document.documentElement; var rfs = el.requestFullScreen || el.webkitRequestFullScreen || el.mozRequestFullScreen || el.msRequestFullScreen; rfs.call(el); xc.display.requestPointerLock = xc.display.requestPointerLock || xc.display.mozRequestPointerLock; xc.display.requestPointerLock(); clearPressKeyList() } function cursorLockChange() { if (!_mStatic_exit) { return } if (!xc.cursorLockEnabled) { document.exitPointerLock(); $(".dimmer").dimmer("hide"); return } if (document.pointerLockElement === xc.display || document.mozPointerLockElement === xc.display) { xc.cursorLock = true; $("#full_screen_with_cursorLock").popup("hide"); $(".dimmer").dimmer("hide") } else { sendMsg("4,0,1,0,0"); sendMsg("4,1,1,0,0"); xc.cursorLock = false; $(".dimmer").dimmer("show"); dimmerShow(); clearPressKeyList() } } function setSelected(item) { $(item).siblings().removeClass("active selected"); $(item).addClass("active selected") } function startTime() { $("#time").text(parseInt($("#time").text()) + 1); setTimeout(startTime, 1e3) } function dumpBitrates() { var blob = new Blob([window.bitrate]); var a = document.createElement("a"); a.href = window.URL.createObjectURL(blob); a.download = "bitrate.txt"; a.textContent = ""; var tmp = document.body.appendChild(a); tmp.click() } function browserKeyLock() { var browser = new Browser; var device = browser.device; var browserName = browser.browser; var browserVersion = parseInt(browser.version); if (device == "PC") { if (browserName == "Chrome" && browserVersion > 67) { if (window.location.protocol == "https:") { navigator.keyboard.lock() } } } } !function (e, t, n, i) { e.site = e.fn.site = function (o) { var a, r, s = (new Date).getTime(), l = [], c = arguments[0], u = "string" == typeof c, d = [].slice.call(arguments, 1), f = e.isPlainObject(o) ? e.extend(!0, {}, e.site.settings, o) : e.extend({}, e.site.settings), m = f.namespace, g = f.error, p = "module-" + m, h = e(n), v = h, b = this, y = v.data(p); return a = { initialize: function () { a.instantiate() }, instantiate: function () { a.verbose("Storing instance of site", a), y = a, v.data(p, a) }, normalize: function () { a.fix.console(), a.fix.requestAnimationFrame() }, fix: { console: function () { a.debug("Normalizing window.console"), console !== i && console.log !== i || (a.verbose("Console not available, normalizing events"), a.disable.console()), "undefined" != typeof console.group && "undefined" != typeof console.groupEnd && "undefined" != typeof console.groupCollapsed || (a.verbose("Console group not available, normalizing events"), t.console.group = function () { }, t.console.groupEnd = function () { }, t.console.groupCollapsed = function () { }), "undefined" == typeof console.markTimeline && (a.verbose("Mark timeline not available, normalizing events"), t.console.markTimeline = function () { }) }, consoleClear: function () { a.debug("Disabling programmatic console clearing"), t.console.clear = function () { } }, requestAnimationFrame: function () { a.debug("Normalizing requestAnimationFrame"), t.requestAnimationFrame === i && (a.debug("RequestAnimationFrame not available, normalizing event"), t.requestAnimationFrame = t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }) } }, moduleExists: function (t) { return e.fn[t] !== i && e.fn[t].settings !== i }, enabled: { modules: function (t) { var n = []; return t = t || f.modules, e.each(t, function (e, t) { a.moduleExists(t) && n.push(t) }), n } }, disabled: { modules: function (t) { var n = []; return t = t || f.modules, e.each(t, function (e, t) { a.moduleExists(t) || n.push(t) }), n } }, change: { setting: function (t, n, o, r) { o = "string" == typeof o ? "all" === o ? f.modules : [o] : o || f.modules, r = r === i || r, e.each(o, function (i, o) { var s, l = !a.moduleExists(o) || (e.fn[o].settings.namespace || !1); a.moduleExists(o) && (a.verbose("Changing default setting", t, n, o), e.fn[o].settings[t] = n, r && l && (s = e(":data(module-" + l + ")"), s.length > 0 && (a.verbose("Modifying existing settings", s), s[o]("setting", t, n)))) }) }, settings: function (t, n, o) { n = "string" == typeof n ? [n] : n || f.modules, o = o === i || o, e.each(n, function (n, i) { var r; a.moduleExists(i) && (a.verbose("Changing default setting", t, i), e.extend(!0, e.fn[i].settings, t), o && m && (r = e(":data(module-" + m + ")"), r.length > 0 && (a.verbose("Modifying existing settings", r), r[i]("setting", t)))) }) } }, enable: { console: function () { a.console(!0) }, debug: function (e, t) { e = e || f.modules, a.debug("Enabling debug for modules", e), a.change.setting("debug", !0, e, t) }, verbose: function (e, t) { e = e || f.modules, a.debug("Enabling verbose debug for modules", e), a.change.setting("verbose", !0, e, t) } }, disable: { console: function () { a.console(!1) }, debug: function (e, t) { e = e || f.modules, a.debug("Disabling debug for modules", e), a.change.setting("debug", !1, e, t) }, verbose: function (e, t) { e = e || f.modules, a.debug("Disabling verbose debug for modules", e), a.change.setting("verbose", !1, e, t) } }, console: function (e) { if (e) { if (y.cache.console === i) return void a.error(g.console); a.debug("Restoring console function"), t.console = y.cache.console } else a.debug("Disabling console function"), y.cache.console = t.console, t.console = { clear: function () { }, error: function () { }, group: function () { }, groupCollapsed: function () { }, groupEnd: function () { }, info: function () { }, log: function () { }, markTimeline: function () { }, warn: function () { } } }, destroy: function () { a.verbose("Destroying previous site for", v), v.removeData(p) }, cache: {}, setting: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, f, t); else { if (n === i) return f[t]; f[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, a, t); else { if (n === i) return a[t]; a[t] = n } }, debug: function () { f.debug && (f.performance ? a.performance.log(arguments) : (a.debug = Function.prototype.bind.call(console.info, console, f.name + ":"), a.debug.apply(console, arguments))) }, verbose: function () { f.verbose && f.debug && (f.performance ? a.performance.log(arguments) : (a.verbose = Function.prototype.bind.call(console.info, console, f.name + ":"), a.verbose.apply(console, arguments))) }, error: function () { a.error = Function.prototype.bind.call(console.error, console, f.name + ":"), a.error.apply(console, arguments) }, performance: { log: function (e) { var t, n, i; f.performance && (t = (new Date).getTime(), i = s || t, n = t - i, s = t, l.push({ Element: b, Name: e[0], Arguments: [].slice.call(e, 1) || "", "Execution Time": n })), clearTimeout(a.performance.timer), a.performance.timer = setTimeout(a.performance.display, 500) }, display: function () { var t = f.name + ":", n = 0; s = !1, clearTimeout(a.performance.timer), e.each(l, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, n, o) { var s, l, c, u = y; return n = n || d, o = b || o, "string" == typeof t && u !== i && (t = t.split(/[\. ]/), s = t.length - 1, e.each(t, function (n, o) { var r = n != s ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(u[r]) && n != s) u = u[r]; else { if (u[r] !== i) return l = u[r], !1; if (!e.isPlainObject(u[o]) || n == s) return u[o] !== i ? (l = u[o], !1) : (a.error(g.method, t), !1); u = u[o] } })), e.isFunction(l) ? c = l.apply(o, n) : l !== i && (c = l), e.isArray(r) ? r.push(c) : r !== i ? r = [r, c] : c !== i && (r = c), l } }, u ? (y === i && a.initialize(), a.invoke(c)) : (y !== i && a.destroy(), a.initialize()), r !== i ? r : this }, e.site.settings = { name: "Site", namespace: "site", error: { console: "Console cannot be restored, most likely it was overwritten outside of module", method: "The method you called is not defined." }, debug: !1, verbose: !1, performance: !0, modules: ["accordion", "api", "checkbox", "dimmer", "dropdown", "embed", "form", "modal", "nag", "popup", "rating", "shape", "sidebar", "state", "sticky", "tab", "transition", "visit", "visibility"], siteNamespace: "site", namespaceStub: { cache: {}, config: {}, sections: {}, section: {}, utilities: {} } }, e.extend(e.expr[":"], { data: e.expr.createPseudo ? e.expr.createPseudo(function (t) { return function (n) { return !!e.data(n, t) } }) : function (t, n, i) { return !!e.data(t, i[3]) } }) }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.form = function (t) { var o, a = e(this), r = a.selector || "", s = (new Date).getTime(), l = [], c = arguments[0], u = arguments[1], d = "string" == typeof c, f = [].slice.call(arguments, 1); return a.each(function () { var m, g, p, h, v, b, y, x, C, w, k, S, T, A, R, P, E, F, O, D = e(this), q = this, j = [], z = !1; O = { initialize: function () { O.get.settings(), d ? (F === i && O.instantiate(), O.invoke(c)) : (F !== i && F.invoke("destroy"), O.verbose("Initializing form validation", D, x), O.bindEvents(), O.set.defaults(), O.instantiate()) }, instantiate: function () { O.verbose("Storing instance of module", O), F = O, D.data(P, O) }, destroy: function () { O.verbose("Destroying previous module", F), O.removeEvents(), D.removeData(P) }, refresh: function () { O.verbose("Refreshing selector cache"), m = D.find(k.field), g = D.find(k.group), p = D.find(k.message), h = D.find(k.prompt), v = D.find(k.submit), b = D.find(k.clear), y = D.find(k.reset) }, submit: function () { O.verbose("Submitting form", D), D.submit() }, attachEvents: function (t, n) { n = n || "submit", e(t).on("click" + E, function (e) { O[n](), e.preventDefault() }) }, bindEvents: function () { O.verbose("Attaching form events"), D.on("submit" + E, O.validate.form).on("blur" + E, k.field, O.event.field.blur).on("click" + E, k.submit, O.submit).on("click" + E, k.reset, O.reset).on("click" + E, k.clear, O.clear), x.keyboardShortcuts && D.on("keydown" + E, k.field, O.event.field.keydown), m.each(function () { var t = e(this), n = t.prop("type"), i = O.get.changeEvent(n, t); e(this).on(i + E, O.event.field.change) }) }, clear: function () { m.each(function () { var t = e(this), n = t.parent(), i = t.closest(g), o = i.find(k.prompt), a = t.data(w.defaultValue) || "", r = n.is(k.uiCheckbox), s = n.is(k.uiDropdown), l = i.hasClass(S.error); l && (O.verbose("Resetting error on field", i), i.removeClass(S.error), o.remove()), s ? (O.verbose("Resetting dropdown value", n, a), n.dropdown("clear")) : r ? t.prop("checked", !1) : (O.verbose("Resetting field value", t, a), t.val("")) }) }, reset: function () { m.each(function () { var t = e(this), n = t.parent(), o = t.closest(g), a = o.find(k.prompt), r = t.data(w.defaultValue), s = n.is(k.uiCheckbox), l = n.is(k.uiDropdown), c = o.hasClass(S.error); r !== i && (c && (O.verbose("Resetting error on field", o), o.removeClass(S.error), a.remove()), l ? (O.verbose("Resetting dropdown value", n, r), n.dropdown("restore defaults")) : s ? (O.verbose("Resetting checkbox value", n, r), t.prop("checked", r)) : (O.verbose("Resetting field value", t, r), t.val(r))) }) }, determine: { isValid: function () { var t = !0; return e.each(C, function (e, n) { O.validate.field(n, e, !0) || (t = !1) }), t } }, is: { bracketedRule: function (e) { return e.type && e.type.match(x.regExp.bracket) }, empty: function (e) { return !e || 0 === e.length || (e.is('input[type="checkbox"]') ? !e.is(":checked") : O.is.blank(e)) }, blank: function (t) { return "" === e.trim(t.val()) }, valid: function (t) { var n = !0; return t ? (O.verbose("Checking if field is valid", t), O.validate.field(C[t], t, !1)) : (O.verbose("Checking if form is valid"), e.each(C, function (e, t) { O.is.valid(e) || (n = !1) }), n) } }, removeEvents: function () { D.off(E), m.off(E), v.off(E), m.off(E) }, event: { field: { keydown: function (t) { var n = e(this), i = t.which, o = n.is(k.input), a = n.is(k.checkbox), r = n.closest(k.uiDropdown).length > 0, s = { enter: 13, escape: 27 }; i == s.escape && (O.verbose("Escape key pressed blurring field"), n.blur()), t.ctrlKey || i != s.enter || !o || r || a || (z || (n.one("keyup" + E, O.event.field.keyup), O.submit(), O.debug("Enter pressed on input submitting form")), z = !0) }, keyup: function () { z = !1 }, blur: function (t) { var n = e(this), i = n.closest(g), o = O.get.validation(n); i.hasClass(S.error) ? (O.debug("Revalidating field", n, o), o && O.validate.field(o)) : "blur" != x.on && "change" != x.on || o && O.validate.field(o) }, change: function (t) { var n = e(this), i = n.closest(g), o = O.get.validation(n); o && ("change" == x.on || i.hasClass(S.error) && x.revalidate) && (clearTimeout(O.timer), O.timer = setTimeout(function () { O.debug("Revalidating field", n, O.get.validation(n)), O.validate.field(o) }, x.delay)) } } }, get: { ancillaryValue: function (e) { return !(!e.type || !e.value && !O.is.bracketedRule(e)) && (e.value !== i ? e.value : e.type.match(x.regExp.bracket)[1] + "") }, ruleName: function (e) { return O.is.bracketedRule(e) ? e.type.replace(e.type.match(x.regExp.bracket)[0], "") : e.type }, changeEvent: function (e, t) { return "checkbox" == e || "radio" == e || "hidden" == e || t.is("select") ? "change" : O.get.inputEvent() }, inputEvent: function () { return n.createElement("input").oninput !== i ? "input" : n.createElement("input").onpropertychange !== i ? "propertychange" : "keyup" }, prompt: function (e, t) { var n, i, o, a = O.get.ruleName(e), r = O.get.ancillaryValue(e), s = e.prompt || x.prompt[a] || x.text.unspecifiedRule, l = s.search("{value}") !== -1, c = s.search("{name}") !== -1; return (c || l) && (i = O.get.field(t.identifier)), l && (s = s.replace("{value}", i.val())), c && (n = i.closest(k.group).find("label").eq(0), o = 1 == n.length ? n.text() : i.prop("placeholder") || x.text.unspecifiedField, s = s.replace("{name}", o)), s = s.replace("{identifier}", t.identifier), s = s.replace("{ruleValue}", r), e.prompt || O.verbose("Using default validation prompt for type", s, a), s }, settings: function () { if (e.isPlainObject(t)) { var n, o = Object.keys(t), a = o.length > 0 && (t[o[0]].identifier !== i && t[o[0]].rules !== i); a ? (x = e.extend(!0, {}, e.fn.form.settings, u), C = e.extend({}, e.fn.form.settings.defaults, t), O.error(x.error.oldSyntax, q), O.verbose("Extending settings from legacy parameters", C, x)) : (t.fields && (n = Object.keys(t.fields), ("string" == typeof t.fields[n[0]] || e.isArray(t.fields[n[0]])) && e.each(t.fields, function (n, i) { "string" == typeof i && (i = [i]), t.fields[n] = { rules: [] }, e.each(i, function (e, i) { t.fields[n].rules.push({ type: i }) }) })), x = e.extend(!0, {}, e.fn.form.settings, t), C = e.extend({}, e.fn.form.settings.defaults, x.fields), O.verbose("Extending settings", C, x)) } else x = e.fn.form.settings, C = e.fn.form.settings.defaults, O.verbose("Using default form validation", C, x); R = x.namespace, w = x.metadata, k = x.selector, S = x.className, T = x.regExp, A = x.error, P = "module-" + R, E = "." + R, F = D.data(P), O.refresh() }, field: function (t) { return O.verbose("Finding field with identifier", t), t = O.escape.string(t), m.filter("#" + t).length > 0 ? m.filter("#" + t) : m.filter('[name="' + t + '"]').length > 0 ? m.filter('[name="' + t + '"]') : m.filter('[name="' + t + '[]"]').length > 0 ? m.filter('[name="' + t + '[]"]') : m.filter("[data-" + w.validate + '="' + t + '"]').length > 0 ? m.filter("[data-" + w.validate + '="' + t + '"]') : e("<input/>") }, fields: function (t) { var n = e(); return e.each(t, function (e, t) { n = n.add(O.get.field(t)) }), n }, validation: function (t) { var n, i; return !!C && (e.each(C, function (e, o) { i = o.identifier || e, O.get.field(i)[0] == t[0] && (o.identifier = i, n = o) }), n || !1) }, value: function (e) { var t, n = []; return n.push(e), t = O.get.values.call(q, n), t[e] }, values: function (t) { var n = e.isArray(t) ? O.get.fields(t) : m, i = {}; return n.each(function (t, n) { var o = e(n), a = (o.prop("type"), o.prop("name")), r = o.val(), s = o.is(k.checkbox), l = o.is(k.radio), c = a.indexOf("[]") !== -1, u = !!s && o.is(":checked"); a && (c ? (a = a.replace("[]", ""), i[a] || (i[a] = []), s ? u ? i[a].push(r || !0) : i[a].push(!1) : i[a].push(r)) : l ? u && (i[a] = r) : s ? u ? i[a] = r || !0 : i[a] = !1 : i[a] = r) }), i } }, has: { field: function (e) { return O.verbose("Checking for existence of a field with identifier", e), e = O.escape.string(e), "string" != typeof e && O.error(A.identifier, e), m.filter("#" + e).length > 0 || (m.filter('[name="' + e + '"]').length > 0 || m.filter("[data-" + w.validate + '="' + e + '"]').length > 0) } }, escape: { string: function (e) { return e = String(e), e.replace(T.escape, "\\$&") } }, add: { prompt: function (t, n) { var o = O.get.field(t), a = o.closest(g), r = a.children(k.prompt), s = 0 !== r.length; n = "string" == typeof n ? [n] : n, O.verbose("Adding field error state", t), a.addClass(S.error), x.inline && (s || (r = x.templates.prompt(n), r.appendTo(a)), r.html(n[0]), s ? O.verbose("Inline errors are disabled, no inline error added", t) : x.transition && e.fn.transition !== i && D.transition("is supported") ? (O.verbose("Displaying error with css transition", x.transition), r.transition(x.transition + " in", x.duration)) : (O.verbose("Displaying error with fallback javascript animation"), r.fadeIn(x.duration))) }, errors: function (e) { O.debug("Adding form error messages", e), O.set.error(), p.html(x.templates.error(e)) } }, remove: { prompt: function (t) { var n = O.get.field(t), o = n.closest(g), a = o.children(k.prompt); o.removeClass(S.error), x.inline && a.is(":visible") && (O.verbose("Removing prompt for field", t), x.transition && e.fn.transition !== i && D.transition("is supported") ? a.transition(x.transition + " out", x.duration, function () { a.remove() }) : a.fadeOut(x.duration, function () { a.remove() })) } }, set: { success: function () { D.removeClass(S.error).addClass(S.success) }, defaults: function () { m.each(function () { var t = e(this), n = t.filter(k.checkbox).length > 0, i = n ? t.is(":checked") : t.val(); t.data(w.defaultValue, i) }) }, error: function () { D.removeClass(S.success).addClass(S.error) }, value: function (e, t) { var n = {}; return n[e] = t, O.set.values.call(q, n) }, values: function (t) { e.isEmptyObject(t) || e.each(t, function (t, n) { var i, o = O.get.field(t), a = o.parent(), r = e.isArray(n), s = a.is(k.uiCheckbox), l = a.is(k.uiDropdown), c = o.is(k.radio) && s, u = o.length > 0; u && (r && s ? (O.verbose("Selecting multiple", n, o), a.checkbox("uncheck"), e.each(n, function (e, t) { i = o.filter('[value="' + t + '"]'), a = i.parent(), i.length > 0 && a.checkbox("check") })) : c ? (O.verbose("Selecting radio value", n, o), o.filter('[value="' + n + '"]').parent(k.uiCheckbox).checkbox("check")) : s ? (O.verbose("Setting checkbox value", n, a), n === !0 ? a.checkbox("check") : a.checkbox("uncheck")) : l ? (O.verbose("Setting dropdown value", n, a), a.dropdown("set selected", n)) : (O.verbose("Setting field value", n, o), o.val(n))) }) } }, validate: { form: function (e, t) { var n = O.get.values(); if (z) return !1; if (j = [], O.determine.isValid()) { if (O.debug("Form has no validation errors, submitting"), O.set.success(), t !== !0) return x.onSuccess.call(q, e, n) } else if (O.debug("Form has errors"), O.set.error(), x.inline || O.add.errors(j), D.data("moduleApi") !== i && e.stopImmediatePropagation(), t !== !0) return x.onFailure.call(q, j, n) }, field: function (t, n, o) { o = o === i || o, "string" == typeof t && (O.verbose("Validating field", t), n = t, t = C[t]); var a = t.identifier || n, r = O.get.field(a), s = !!t.depends && O.get.field(t.depends), l = !0, c = []; return t.identifier || (O.debug("Using field name as identifier", a), t.identifier = a), r.prop("disabled") ? (O.debug("Field is disabled. Skipping", a), l = !0) : t.optional && O.is.blank(r) ? (O.debug("Field is optional and blank. Skipping", a), l = !0) : t.depends && O.is.empty(s) ? (O.debug("Field depends on another value that is not present or empty. Skipping", s), l = !0) : t.rules !== i && e.each(t.rules, function (e, n) { O.has.field(a) && !O.validate.rule(t, n) && (O.debug("Field is invalid", a, n.type), c.push(O.get.prompt(n, t)), l = !1) }), l ? (o && (O.remove.prompt(a, c), x.onValid.call(r)), !0) : (o && (j = j.concat(c), O.add.prompt(a, c), x.onInvalid.call(r, c)), !1) }, rule: function (t, n) { var o = O.get.field(t.identifier), a = (n.type, o.val()), r = O.get.ancillaryValue(n), s = O.get.ruleName(n), l = x.rules[s]; return e.isFunction(l) ? (a = a === i || "" === a || null === a ? "" : e.trim(a + ""), l.call(o, a, r)) : void O.error(A.noRule, s) } }, setting: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, x, t); else { if (n === i) return x[t]; x[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, O, t); else { if (n === i) return O[t]; O[t] = n } }, debug: function () { !x.silent && x.debug && (x.performance ? O.performance.log(arguments) : (O.debug = Function.prototype.bind.call(console.info, console, x.name + ":"), O.debug.apply(console, arguments))) }, verbose: function () { !x.silent && x.verbose && x.debug && (x.performance ? O.performance.log(arguments) : (O.verbose = Function.prototype.bind.call(console.info, console, x.name + ":"), O.verbose.apply(console, arguments))) }, error: function () { x.silent || (O.error = Function.prototype.bind.call(console.error, console, x.name + ":"), O.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; x.performance && (t = (new Date).getTime(), i = s || t, n = t - i, s = t, l.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: q, "Execution Time": n })), clearTimeout(O.performance.timer), O.performance.timer = setTimeout(O.performance.display, 500) }, display: function () { var t = x.name + ":", n = 0; s = !1, clearTimeout(O.performance.timer), e.each(l, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", r && (t += " '" + r + "'"), a.length > 1 && (t += " (" + a.length + ")"), (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, n, a) { var r, s, l, c = F; return n = n || f, a = q || a, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i && (s = c[o], !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(a, n) : s !== i && (l = s), e.isArray(o) ? o.push(l) : o !== i ? o = [o, l] : l !== i && (o = l), s } }, O.initialize() }), o !== i ? o : this }, e.fn.form.settings = { name: "Form", namespace: "form", debug: !1, verbose: !1, performance: !0, fields: !1, keyboardShortcuts: !0, on: "submit", inline: !1, delay: 200, revalidate: !0, transition: "scale", duration: 200, onValid: function () { }, onInvalid: function () { }, onSuccess: function () { return !0 }, onFailure: function () { return !1 }, metadata: { defaultValue: "default", validate: "validate" }, regExp: { htmlID: /^[a-zA-Z][\w:.-]*$/g, bracket: /\[(.*)\]/i, decimal: /^\d+\.?\d*$/, email: /^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i, escape: /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, flags: /^\/(.*)\/(.*)?/, integer: /^\-?\d+$/, number: /^\-?\d*(\.\d+)?$/, url: /(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/i }, text: { unspecifiedRule: "Please enter a valid value", unspecifiedField: "This field" }, prompt: { empty: "{name} must have a value", checked: "{name} must be checked", email: "{name} must be a valid e-mail", url: "{name} must be a valid url", regExp: "{name} is not formatted correctly", integer: "{name} must be an integer", decimal: "{name} must be a decimal number", number: "{name} must be set to a number", is: '{name} must be "{ruleValue}"', isExactly: '{name} must be exactly "{ruleValue}"', not: '{name} cannot be set to "{ruleValue}"', notExactly: '{name} cannot be set to exactly "{ruleValue}"', contain: '{name} cannot contain "{ruleValue}"', containExactly: '{name} cannot contain exactly "{ruleValue}"', doesntContain: '{name} must contain  "{ruleValue}"', doesntContainExactly: '{name} must contain exactly "{ruleValue}"', minLength: "{name} must be at least {ruleValue} characters", length: "{name} must be at least {ruleValue} characters", exactLength: "{name} must be exactly {ruleValue} characters", maxLength: "{name} cannot be longer than {ruleValue} characters", match: "{name} must match {ruleValue} field", different: "{name} must have a different value than {ruleValue} field", creditCard: "{name} must be a valid credit card number", minCount: "{name} must have at least {ruleValue} choices", exactCount: "{name} must have exactly {ruleValue} choices", maxCount: "{name} must have {ruleValue} or less choices" }, selector: { checkbox: 'input[type="checkbox"], input[type="radio"]', clear: ".clear", field: "input, textarea, select", group: ".field", input: "input", message: ".error.message", prompt: ".prompt.label", radio: 'input[type="radio"]', reset: '.reset:not([type="reset"])', submit: '.submit:not([type="submit"])', uiCheckbox: ".ui.checkbox", uiDropdown: ".ui.dropdown" }, className: { error: "error", label: "ui prompt label", pressed: "down", success: "success" }, error: { identifier: "You must specify a string identifier for each field", method: "The method you called is not defined.", noRule: "There is no rule matching the one you specified", oldSyntax: "Starting in 2.0 forms now only take a single settings object. Validation settings converted to new syntax automatically." }, templates: { error: function (t) { var n = '<ul class="list">'; return e.each(t, function (e, t) { n += "<li>" + t + "</li>" }), n += "</ul>", e(n) }, prompt: function (t) { return e("<div/>").addClass("ui basic red pointing prompt label").html(t[0]) } }, rules: { empty: function (t) { return !(t === i || "" === t || e.isArray(t) && 0 === t.length) }, checked: function () { return e(this).filter(":checked").length > 0 }, email: function (t) { return e.fn.form.settings.regExp.email.test(t) }, url: function (t) { return e.fn.form.settings.regExp.url.test(t) }, regExp: function (t, n) { if (n instanceof RegExp) return t.match(n); var i, o = n.match(e.fn.form.settings.regExp.flags); return o && (n = o.length >= 2 ? o[1] : n, i = o.length >= 3 ? o[2] : ""), t.match(new RegExp(n, i)) }, integer: function (t, n) { var o, a, r, s = e.fn.form.settings.regExp.integer; return n && ["", ".."].indexOf(n) === -1 && (n.indexOf("..") == -1 ? s.test(n) && (o = a = n - 0) : (r = n.split("..", 2), s.test(r[0]) && (o = r[0] - 0), s.test(r[1]) && (a = r[1] - 0))), s.test(t) && (o === i || t >= o) && (a === i || t <= a) }, decimal: function (t) { return e.fn.form.settings.regExp.decimal.test(t) }, number: function (t) { return e.fn.form.settings.regExp.number.test(t) }, is: function (e, t) { return t = "string" == typeof t ? t.toLowerCase() : t, e = "string" == typeof e ? e.toLowerCase() : e, e == t }, isExactly: function (e, t) { return e == t }, not: function (e, t) { return e = "string" == typeof e ? e.toLowerCase() : e, t = "string" == typeof t ? t.toLowerCase() : t, e != t }, notExactly: function (e, t) { return e != t }, contains: function (t, n) { return n = n.replace(e.fn.form.settings.regExp.escape, "\\$&"), t.search(new RegExp(n, "i")) !== -1 }, containsExactly: function (t, n) { return n = n.replace(e.fn.form.settings.regExp.escape, "\\$&"), t.search(new RegExp(n)) !== -1 }, doesntContain: function (t, n) { return n = n.replace(e.fn.form.settings.regExp.escape, "\\$&"), t.search(new RegExp(n, "i")) === -1 }, doesntContainExactly: function (t, n) { return n = n.replace(e.fn.form.settings.regExp.escape, "\\$&"), t.search(new RegExp(n)) === -1 }, minLength: function (e, t) { return e !== i && e.length >= t }, length: function (e, t) { return e !== i && e.length >= t }, exactLength: function (e, t) { return e !== i && e.length == t }, maxLength: function (e, t) { return e !== i && e.length <= t }, match: function (t, n) { var o; e(this); return e('[data-validate="' + n + '"]').length > 0 ? o = e('[data-validate="' + n + '"]').val() : e("#" + n).length > 0 ? o = e("#" + n).val() : e('[name="' + n + '"]').length > 0 ? o = e('[name="' + n + '"]').val() : e('[name="' + n + '[]"]').length > 0 && (o = e('[name="' + n + '[]"]')), o !== i && t.toString() == o.toString() }, different: function (t, n) { var o; e(this); return e('[data-validate="' + n + '"]').length > 0 ? o = e('[data-validate="' + n + '"]').val() : e("#" + n).length > 0 ? o = e("#" + n).val() : e('[name="' + n + '"]').length > 0 ? o = e('[name="' + n + '"]').val() : e('[name="' + n + '[]"]').length > 0 && (o = e('[name="' + n + '[]"]')), o !== i && t.toString() !== o.toString() }, creditCard: function (t, n) { var i, o, a = { visa: { pattern: /^4/, length: [16] }, amex: { pattern: /^3[47]/, length: [15] }, mastercard: { pattern: /^5[1-5]/, length: [16] }, discover: { pattern: /^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/, length: [16] }, unionPay: { pattern: /^(62|88)/, length: [16, 17, 18, 19] }, jcb: { pattern: /^35(2[89]|[3-8][0-9])/, length: [16] }, maestro: { pattern: /^(5018|5020|5038|6304|6759|676[1-3])/, length: [12, 13, 14, 15, 16, 17, 18, 19] }, dinersClub: { pattern: /^(30[0-5]|^36)/, length: [14] }, laser: { pattern: /^(6304|670[69]|6771)/, length: [16, 17, 18, 19] }, visaElectron: { pattern: /^(4026|417500|4508|4844|491(3|7))/, length: [16] } }, r = {}, s = !1, l = "string" == typeof n && n.split(","); if ("string" == typeof t && 0 !== t.length) { if (l && (e.each(l, function (n, i) { o = a[i], o && (r = { length: e.inArray(t.length, o.length) !== -1, pattern: t.search(o.pattern) !== -1 }, r.length && r.pattern && (s = !0)) }), !s)) return !1; if (i = { number: e.inArray(t.length, a.unionPay.length) !== -1, pattern: t.search(a.unionPay.pattern) !== -1 }, i.number && i.pattern) return !0; for (var c = t.length, u = 0, d = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [0, 2, 4, 6, 8, 1, 3, 5, 7, 9]], f = 0; c--;)f += d[u][parseInt(t.charAt(c), 10)], u ^= 1; return f % 10 === 0 && f > 0 } }, minCount: function (e, t) { return 0 == t || (1 == t ? "" !== e : e.split(",").length >= t) }, exactCount: function (e, t) { return 0 == t ? "" === e : 1 == t ? "" !== e && e.search(",") === -1 : e.split(",").length == t }, maxCount: function (e, t) { return 0 != t && (1 == t ? e.search(",") === -1 : e.split(",").length <= t) } } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.accordion = function (n) { var o, a = e(this), r = (new Date).getTime(), s = [], l = arguments[0], c = "string" == typeof l, u = [].slice.call(arguments, 1); t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }; return a.each(function () { var d, f, m = e.isPlainObject(n) ? e.extend(!0, {}, e.fn.accordion.settings, n) : e.extend({}, e.fn.accordion.settings), g = m.className, p = m.namespace, h = m.selector, v = m.error, b = "." + p, y = "module-" + p, x = a.selector || "", C = e(this), w = C.find(h.title), k = C.find(h.content), S = this, T = C.data(y); f = { initialize: function () { f.debug("Initializing", C), f.bind.events(), m.observeChanges && f.observeChanges(), f.instantiate() }, instantiate: function () { T = f, C.data(y, f) }, destroy: function () { f.debug("Destroying previous instance", C), C.off(b).removeData(y) }, refresh: function () { w = C.find(h.title), k = C.find(h.content) }, observeChanges: function () { "MutationObserver" in t && (d = new MutationObserver(function (e) { f.debug("DOM tree modified, updating selector cache"), f.refresh() }), d.observe(S, { childList: !0, subtree: !0 }), f.debug("Setting up mutation observer", d)) }, bind: { events: function () { f.debug("Binding delegated events"), C.on(m.on + b, h.trigger, f.event.click) } }, event: { click: function () { f.toggle.call(this) } }, toggle: function (t) { var n = t !== i ? "number" == typeof t ? w.eq(t) : e(t).closest(h.title) : e(this).closest(h.title), o = n.next(k), a = o.hasClass(g.animating), r = o.hasClass(g.active), s = r && !a, l = !r && a; f.debug("Toggling visibility of content", n), s || l ? m.collapsible ? f.close.call(n) : f.debug("Cannot close accordion content collapsing is disabled") : f.open.call(n) }, open: function (t) { var n = t !== i ? "number" == typeof t ? w.eq(t) : e(t).closest(h.title) : e(this).closest(h.title), o = n.next(k), a = o.hasClass(g.animating), r = o.hasClass(g.active), s = r || a; return s ? void f.debug("Accordion already open, skipping", o) : (f.debug("Opening accordion content", n), m.onOpening.call(o), m.exclusive && f.closeOthers.call(n), n.addClass(g.active), o.stop(!0, !0).addClass(g.animating), m.animateChildren && (e.fn.transition !== i && C.transition("is supported") ? o.children().transition({ animation: "fade in", queue: !1, useFailSafe: !0, debug: m.debug, verbose: m.verbose, duration: m.duration }) : o.children().stop(!0, !0).animate({ opacity: 1 }, m.duration, f.resetOpacity)), void o.slideDown(m.duration, m.easing, function () { o.removeClass(g.animating).addClass(g.active), f.reset.display.call(this), m.onOpen.call(this), m.onChange.call(this) })) }, close: function (t) { var n = t !== i ? "number" == typeof t ? w.eq(t) : e(t).closest(h.title) : e(this).closest(h.title), o = n.next(k), a = o.hasClass(g.animating), r = o.hasClass(g.active), s = !r && a, l = r && a; !r && !s || l || (f.debug("Closing accordion content", o), m.onClosing.call(o), n.removeClass(g.active), o.stop(!0, !0).addClass(g.animating), m.animateChildren && (e.fn.transition !== i && C.transition("is supported") ? o.children().transition({ animation: "fade out", queue: !1, useFailSafe: !0, debug: m.debug, verbose: m.verbose, duration: m.duration }) : o.children().stop(!0, !0).animate({ opacity: 0 }, m.duration, f.resetOpacity)), o.slideUp(m.duration, m.easing, function () { o.removeClass(g.animating).removeClass(g.active), f.reset.display.call(this), m.onClose.call(this), m.onChange.call(this) })) }, closeOthers: function (t) { var n, o, a, r = t !== i ? w.eq(t) : e(this).closest(h.title), s = r.parents(h.content).prev(h.title), l = r.closest(h.accordion), c = h.title + "." + g.active + ":visible", u = h.content + "." + g.active + ":visible"; m.closeNested ? (n = l.find(c).not(s), a = n.next(k)) : (n = l.find(c).not(s), o = l.find(u).find(c).not(s), n = n.not(o), a = n.next(k)), n.length > 0 && (f.debug("Exclusive enabled, closing other content", n), n.removeClass(g.active), a.removeClass(g.animating).stop(!0, !0), m.animateChildren && (e.fn.transition !== i && C.transition("is supported") ? a.children().transition({ animation: "fade out", useFailSafe: !0, debug: m.debug, verbose: m.verbose, duration: m.duration }) : a.children().stop(!0, !0).animate({ opacity: 0 }, m.duration, f.resetOpacity)), a.slideUp(m.duration, m.easing, function () { e(this).removeClass(g.active), f.reset.display.call(this) })) }, reset: { display: function () { f.verbose("Removing inline display from element", this), e(this).css("display", ""), "" === e(this).attr("style") && e(this).attr("style", "").removeAttr("style") }, opacity: function () { f.verbose("Removing inline opacity from element", this), e(this).css("opacity", ""), "" === e(this).attr("style") && e(this).attr("style", "").removeAttr("style") } }, setting: function (t, n) { if (f.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, m, t); else { if (n === i) return m[t]; e.isPlainObject(m[t]) ? e.extend(!0, m[t], n) : m[t] = n } }, internal: function (t, n) { return f.debug("Changing internal", t, n), n === i ? f[t] : void (e.isPlainObject(t) ? e.extend(!0, f, t) : f[t] = n) }, debug: function () { !m.silent && m.debug && (m.performance ? f.performance.log(arguments) : (f.debug = Function.prototype.bind.call(console.info, console, m.name + ":"), f.debug.apply(console, arguments))) }, verbose: function () { !m.silent && m.verbose && m.debug && (m.performance ? f.performance.log(arguments) : (f.verbose = Function.prototype.bind.call(console.info, console, m.name + ":"), f.verbose.apply(console, arguments))) }, error: function () { m.silent || (f.error = Function.prototype.bind.call(console.error, console, m.name + ":"), f.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; m.performance && (t = (new Date).getTime(), i = r || t, n = t - i, r = t, s.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: S, "Execution Time": n })), clearTimeout(f.performance.timer), f.performance.timer = setTimeout(f.performance.display, 500) }, display: function () { var t = m.name + ":", n = 0; r = !1, clearTimeout(f.performance.timer), e.each(s, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", x && (t += " '" + x + "'"), (console.group !== i || console.table !== i) && s.length > 0 && (console.groupCollapsed(t), console.table ? console.table(s) : e.each(s, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), s = [] } }, invoke: function (t, n, a) { var r, s, l, c = T; return n = n || u, a = S || a, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (f.error(v.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(a, n) : s !== i && (l = s), e.isArray(o) ? o.push(l) : o !== i ? o = [o, l] : l !== i && (o = l), s } }, c ? (T === i && f.initialize(), f.invoke(l)) : (T !== i && T.invoke("destroy"), f.initialize()) }), o !== i ? o : this }, e.fn.accordion.settings = { name: "Accordion", namespace: "accordion", silent: !1, debug: !1, verbose: !1, performance: !0, on: "click", observeChanges: !0, exclusive: !0, collapsible: !0, closeNested: !1, animateChildren: !0, duration: 350, easing: "easeOutQuad", onOpening: function () { }, onOpen: function () { }, onClosing: function () { }, onClose: function () { }, onChange: function () { }, error: { method: "The method you called is not defined" }, className: { active: "active", animating: "animating" }, selector: { accordion: ".accordion", title: ".title", trigger: ".title", content: ".content" } }, e.extend(e.easing, { easeOutQuad: function (e, t, n, i, o) { return -i * (t /= o) * (t - 2) + n } }) }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.checkbox = function (o) { var a, r = e(this), s = r.selector || "", l = (new Date).getTime(), c = [], u = arguments[0], d = "string" == typeof u, f = [].slice.call(arguments, 1); return r.each(function () { var r, m, g = e.extend(!0, {}, e.fn.checkbox.settings, o), p = g.className, h = g.namespace, v = g.selector, b = g.error, y = "." + h, x = "module-" + h, C = e(this), w = e(this).children(v.label), k = e(this).children(v.input), S = k[0], T = !1, A = !1, R = C.data(x), P = this; m = { initialize: function () { m.verbose("Initializing checkbox", g), m.create.label(), m.bind.events(), m.set.tabbable(), m.hide.input(), m.observeChanges(), m.instantiate(), m.setup() }, instantiate: function () { m.verbose("Storing instance of module", m), R = m, C.data(x, m) }, destroy: function () { m.verbose("Destroying module"), m.unbind.events(), m.show.input(), C.removeData(x) }, fix: { reference: function () { C.is(v.input) && (m.debug("Behavior called on <input> adjusting invoked element"), C = C.closest(v.checkbox), m.refresh()) } }, setup: function () { m.set.initialLoad(), m.is.indeterminate() ? (m.debug("Initial value is indeterminate"), m.indeterminate()) : m.is.checked() ? (m.debug("Initial value is checked"), m.check()) : (m.debug("Initial value is unchecked"), m.uncheck()), m.remove.initialLoad() }, refresh: function () { w = C.children(v.label), k = C.children(v.input), S = k[0] }, hide: { input: function () { m.verbose("Modifying <input> z-index to be unselectable"), k.addClass(p.hidden) } }, show: { input: function () { m.verbose("Modifying <input> z-index to be selectable"), k.removeClass(p.hidden) } }, observeChanges: function () { "MutationObserver" in t && (r = new MutationObserver(function (e) { m.debug("DOM tree modified, updating selector cache"), m.refresh() }), r.observe(P, { childList: !0, subtree: !0 }), m.debug("Setting up mutation observer", r)) }, attachEvents: function (t, n) { var i = e(t); n = e.isFunction(m[n]) ? m[n] : m.toggle, i.length > 0 ? (m.debug("Attaching checkbox events to element", t, n), i.on("click" + y, n)) : m.error(b.notFound) }, event: { click: function (t) { var n = e(t.target); return n.is(v.input) ? void m.verbose("Using default check action on initialized checkbox") : n.is(v.link) ? void m.debug("Clicking link inside checkbox, skipping toggle") : (m.toggle(), k.focus(), void t.preventDefault()) }, keydown: function (e) { var t = e.which, n = { enter: 13, space: 32, escape: 27 }; t == n.escape ? (m.verbose("Escape key pressed blurring field"), k.blur(), A = !0) : e.ctrlKey || t != n.space && t != n.enter ? A = !1 : (m.verbose("Enter/space key pressed, toggling checkbox"), m.toggle(), A = !0) }, keyup: function (e) { A && e.preventDefault() } }, check: function () { m.should.allowCheck() && (m.debug("Checking checkbox", k), m.set.checked(), m.should.ignoreCallbacks() || (g.onChecked.call(S), g.onChange.call(S))) }, uncheck: function () { m.should.allowUncheck() && (m.debug("Unchecking checkbox"), m.set.unchecked(), m.should.ignoreCallbacks() || (g.onUnchecked.call(S), g.onChange.call(S))) }, indeterminate: function () { return m.should.allowIndeterminate() ? void m.debug("Checkbox is already indeterminate") : (m.debug("Making checkbox indeterminate"), m.set.indeterminate(), void (m.should.ignoreCallbacks() || (g.onIndeterminate.call(S), g.onChange.call(S)))) }, determinate: function () { return m.should.allowDeterminate() ? void m.debug("Checkbox is already determinate") : (m.debug("Making checkbox determinate"), m.set.determinate(), void (m.should.ignoreCallbacks() || (g.onDeterminate.call(S), g.onChange.call(S)))) }, enable: function () { return m.is.enabled() ? void m.debug("Checkbox is already enabled") : (m.debug("Enabling checkbox"), m.set.enabled(), g.onEnable.call(S), void g.onEnabled.call(S)) }, disable: function () { return m.is.disabled() ? void m.debug("Checkbox is already disabled") : (m.debug("Disabling checkbox"), m.set.disabled(), g.onDisable.call(S), void g.onDisabled.call(S)) }, get: { radios: function () { var t = m.get.name(); return e('input[name="' + t + '"]').closest(v.checkbox) }, otherRadios: function () { return m.get.radios().not(C) }, name: function () { return k.attr("name") } }, is: { initialLoad: function () { return T }, radio: function () { return k.hasClass(p.radio) || "radio" == k.attr("type") }, indeterminate: function () { return k.prop("indeterminate") !== i && k.prop("indeterminate") }, checked: function () { return k.prop("checked") !== i && k.prop("checked") }, disabled: function () { return k.prop("disabled") !== i && k.prop("disabled") }, enabled: function () { return !m.is.disabled() }, determinate: function () { return !m.is.indeterminate() }, unchecked: function () { return !m.is.checked() } }, should: { allowCheck: function () { return m.is.determinate() && m.is.checked() && !m.should.forceCallbacks() ? (m.debug("Should not allow check, checkbox is already checked"), !1) : g.beforeChecked.apply(S) !== !1 || (m.debug("Should not allow check, beforeChecked cancelled"), !1) }, allowUncheck: function () { return m.is.determinate() && m.is.unchecked() && !m.should.forceCallbacks() ? (m.debug("Should not allow uncheck, checkbox is already unchecked"), !1) : g.beforeUnchecked.apply(S) !== !1 || (m.debug("Should not allow uncheck, beforeUnchecked cancelled"), !1) }, allowIndeterminate: function () { return m.is.indeterminate() && !m.should.forceCallbacks() ? (m.debug("Should not allow indeterminate, checkbox is already indeterminate"), !1) : g.beforeIndeterminate.apply(S) !== !1 || (m.debug("Should not allow indeterminate, beforeIndeterminate cancelled"), !1) }, allowDeterminate: function () { return m.is.determinate() && !m.should.forceCallbacks() ? (m.debug("Should not allow determinate, checkbox is already determinate"), !1) : g.beforeDeterminate.apply(S) !== !1 || (m.debug("Should not allow determinate, beforeDeterminate cancelled"), !1) }, forceCallbacks: function () { return m.is.initialLoad() && g.fireOnInit }, ignoreCallbacks: function () { return T && !g.fireOnInit } }, can: { change: function () { return !(C.hasClass(p.disabled) || C.hasClass(p.readOnly) || k.prop("disabled") || k.prop("readonly")) }, uncheck: function () { return "boolean" == typeof g.uncheckable ? g.uncheckable : !m.is.radio() } }, set: { initialLoad: function () { T = !0 }, checked: function () { return m.verbose("Setting class to checked"), C.removeClass(p.indeterminate).addClass(p.checked), m.is.radio() && m.uncheckOthers(), !m.is.indeterminate() && m.is.checked() ? void m.debug("Input is already checked, skipping input property change") : (m.verbose("Setting state to checked", S), k.prop("indeterminate", !1).prop("checked", !0), void m.trigger.change()) }, unchecked: function () { return m.verbose("Removing checked class"), C.removeClass(p.indeterminate).removeClass(p.checked), !m.is.indeterminate() && m.is.unchecked() ? void m.debug("Input is already unchecked") : (m.debug("Setting state to unchecked"), k.prop("indeterminate", !1).prop("checked", !1), void m.trigger.change()) }, indeterminate: function () { return m.verbose("Setting class to indeterminate"), C.addClass(p.indeterminate), m.is.indeterminate() ? void m.debug("Input is already indeterminate, skipping input property change") : (m.debug("Setting state to indeterminate"), k.prop("indeterminate", !0), void m.trigger.change()) }, determinate: function () { return m.verbose("Removing indeterminate class"), C.removeClass(p.indeterminate), m.is.determinate() ? void m.debug("Input is already determinate, skipping input property change") : (m.debug("Setting state to determinate"), void k.prop("indeterminate", !1)) }, disabled: function () { return m.verbose("Setting class to disabled"), C.addClass(p.disabled), m.is.disabled() ? void m.debug("Input is already disabled, skipping input property change") : (m.debug("Setting state to disabled"), k.prop("disabled", "disabled"), void m.trigger.change()) }, enabled: function () { return m.verbose("Removing disabled class"), C.removeClass(p.disabled), m.is.enabled() ? void m.debug("Input is already enabled, skipping input property change") : (m.debug("Setting state to enabled"), k.prop("disabled", !1), void m.trigger.change()) }, tabbable: function () { m.verbose("Adding tabindex to checkbox"), k.attr("tabindex") === i && k.attr("tabindex", 0) } }, remove: { initialLoad: function () { T = !1 } }, trigger: { change: function () { var e = n.createEvent("HTMLEvents"), t = k[0]; t && (m.verbose("Triggering native change event"), e.initEvent("change", !0, !1), t.dispatchEvent(e)) } }, create: { label: function () { k.prevAll(v.label).length > 0 ? (k.prev(v.label).detach().insertAfter(k), m.debug("Moving existing label", w)) : m.has.label() || (w = e("<label>").insertAfter(k), m.debug("Creating label", w)) } }, has: { label: function () { return w.length > 0 } }, bind: { events: function () { m.verbose("Attaching checkbox events"), C.on("click" + y, m.event.click).on("keydown" + y, v.input, m.event.keydown).on("keyup" + y, v.input, m.event.keyup) } }, unbind: { events: function () { m.debug("Removing events"), C.off(y) } }, uncheckOthers: function () { var e = m.get.otherRadios(); m.debug("Unchecking other radios", e), e.removeClass(p.checked) }, toggle: function () { return m.can.change() ? void (m.is.indeterminate() || m.is.unchecked() ? (m.debug("Currently unchecked"), m.check()) : m.is.checked() && m.can.uncheck() && (m.debug("Currently checked"), m.uncheck())) : void (m.is.radio() || m.debug("Checkbox is read-only or disabled, ignoring toggle")) }, setting: function (t, n) { if (m.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, g, t); else { if (n === i) return g[t]; e.isPlainObject(g[t]) ? e.extend(!0, g[t], n) : g[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, m, t); else { if (n === i) return m[t]; m[t] = n } }, debug: function () { !g.silent && g.debug && (g.performance ? m.performance.log(arguments) : (m.debug = Function.prototype.bind.call(console.info, console, g.name + ":"), m.debug.apply(console, arguments))) }, verbose: function () { !g.silent && g.verbose && g.debug && (g.performance ? m.performance.log(arguments) : (m.verbose = Function.prototype.bind.call(console.info, console, g.name + ":"), m.verbose.apply(console, arguments))) }, error: function () { g.silent || (m.error = Function.prototype.bind.call(console.error, console, g.name + ":"), m.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; g.performance && (t = (new Date).getTime(), i = l || t, n = t - i, l = t, c.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: P, "Execution Time": n })), clearTimeout(m.performance.timer), m.performance.timer = setTimeout(m.performance.display, 500) }, display: function () { var t = g.name + ":", n = 0; l = !1, clearTimeout(m.performance.timer), e.each(c, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", s && (t += " '" + s + "'"), (console.group !== i || console.table !== i) && c.length > 0 && (console.groupCollapsed(t), console.table ? console.table(c) : e.each(c, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), c = [] } }, invoke: function (t, n, o) { var r, s, l, c = R; return n = n || f, o = P || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (m.error(b.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, d ? (R === i && m.initialize(), m.invoke(u)) : (R !== i && R.invoke("destroy"), m.initialize()) }), a !== i ? a : this }, e.fn.checkbox.settings = { name: "Checkbox", namespace: "checkbox", silent: !1, debug: !1, verbose: !0, performance: !0, uncheckable: "auto", fireOnInit: !1, onChange: function () { }, beforeChecked: function () { }, beforeUnchecked: function () { }, beforeDeterminate: function () { }, beforeIndeterminate: function () { }, onChecked: function () { }, onUnchecked: function () { }, onDeterminate: function () { }, onIndeterminate: function () { }, onEnable: function () { }, onDisable: function () { }, onEnabled: function () { }, onDisabled: function () { }, className: { checked: "checked", indeterminate: "indeterminate", disabled: "disabled", hidden: "hidden", radio: "radio", readOnly: "read-only" }, error: { method: "The method you called is not defined" }, selector: { checkbox: ".ui.checkbox", label: "label, .box", input: 'input[type="checkbox"], input[type="radio"]', link: "a[href]" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.dimmer = function (t) { var o, a = e(this), r = (new Date).getTime(), s = [], l = arguments[0], c = "string" == typeof l, u = [].slice.call(arguments, 1); return a.each(function () { var d, f, m, g = e.isPlainObject(t) ? e.extend(!0, {}, e.fn.dimmer.settings, t) : e.extend({}, e.fn.dimmer.settings), p = g.selector, h = g.namespace, v = g.className, b = g.error, y = "." + h, x = "module-" + h, C = a.selector || "", w = "ontouchstart" in n.documentElement ? "touchstart" : "click", k = e(this), S = this, T = k.data(x); m = { preinitialize: function () { m.is.dimmer() ? (f = k.parent(), d = k) : (f = k, d = m.has.dimmer() ? g.dimmerName ? f.find(p.dimmer).filter("." + g.dimmerName) : f.find(p.dimmer) : m.create(), m.set.variation()) }, initialize: function () { m.debug("Initializing dimmer", g), m.bind.events(), m.set.dimmable(), m.instantiate() }, instantiate: function () { m.verbose("Storing instance of module", m), T = m, k.data(x, T) }, destroy: function () { m.verbose("Destroying previous module", d), m.unbind.events(), m.remove.variation(), f.off(y) }, bind: { events: function () { "hover" == g.on ? f.on("mouseenter" + y, m.show).on("mouseleave" + y, m.hide) : "click" == g.on && f.on(w + y, m.toggle), m.is.page() && (m.debug("Setting as a page dimmer", f), m.set.pageDimmer()), m.is.closable() && (m.verbose("Adding dimmer close event", d), f.on(w + y, p.dimmer, m.event.click)) } }, unbind: { events: function () { k.removeData(x), f.off(y) } }, event: { click: function (t) { m.verbose("Determining if event occured on dimmer", t), (0 === d.find(t.target).length || e(t.target).is(p.content)) && (m.hide(), t.stopImmediatePropagation()) } }, addContent: function (t) { var n = e(t); m.debug("Add content to dimmer", n), n.parent()[0] !== d[0] && n.detach().appendTo(d) }, create: function () { var t = e(g.template.dimmer()); return g.dimmerName && (m.debug("Creating named dimmer", g.dimmerName), t.addClass(g.dimmerName)), t.appendTo(f), t }, show: function (t) { t = e.isFunction(t) ? t : function () { }, m.debug("Showing dimmer", d, g), m.is.dimmed() && !m.is.animating() || !m.is.enabled() ? m.debug("Dimmer is already shown or disabled") : (m.animate.show(t), g.onShow.call(S), g.onChange.call(S)) }, hide: function (t) { t = e.isFunction(t) ? t : function () { }, m.is.dimmed() || m.is.animating() ? (m.debug("Hiding dimmer", d), m.animate.hide(t), g.onHide.call(S), g.onChange.call(S)) : m.debug("Dimmer is not visible") }, toggle: function () { m.verbose("Toggling dimmer visibility", d), m.is.dimmed() ? m.hide() : m.show() }, animate: { show: function (t) { t = e.isFunction(t) ? t : function () { }, g.useCSS && e.fn.transition !== i && d.transition("is supported") ? ("auto" !== g.opacity && m.set.opacity(), d.transition({ animation: g.transition + " in", queue: !1, duration: m.get.duration(), useFailSafe: !0, onStart: function () { m.set.dimmed() }, onComplete: function () { m.set.active(), t() } })) : (m.verbose("Showing dimmer animation with javascript"), m.set.dimmed(), "auto" == g.opacity && (g.opacity = .8), d.stop().css({ opacity: 0, width: "100%", height: "100%" }).fadeTo(m.get.duration(), g.opacity, function () { d.removeAttr("style"), m.set.active(), t() })) }, hide: function (t) { t = e.isFunction(t) ? t : function () { }, g.useCSS && e.fn.transition !== i && d.transition("is supported") ? (m.verbose("Hiding dimmer with css"), d.transition({ animation: g.transition + " out", queue: !1, duration: m.get.duration(), useFailSafe: !0, onStart: function () { m.remove.dimmed() }, onComplete: function () { m.remove.active(), t() } })) : (m.verbose("Hiding dimmer with javascript"), m.remove.dimmed(), d.stop().fadeOut(m.get.duration(), function () { m.remove.active(), d.removeAttr("style"), t() })) } }, get: { dimmer: function () { return d }, duration: function () { return "object" == typeof g.duration ? m.is.active() ? g.duration.hide : g.duration.show : g.duration } }, has: { dimmer: function () { return g.dimmerName ? k.find(p.dimmer).filter("." + g.dimmerName).length > 0 : k.find(p.dimmer).length > 0 } }, is: { active: function () { return d.hasClass(v.active) }, animating: function () { return d.is(":animated") || d.hasClass(v.animating) }, closable: function () { return "auto" == g.closable ? "hover" != g.on : g.closable }, dimmer: function () { return k.hasClass(v.dimmer) }, dimmable: function () { return k.hasClass(v.dimmable) }, dimmed: function () { return f.hasClass(v.dimmed) }, disabled: function () { return f.hasClass(v.disabled) }, enabled: function () { return !m.is.disabled() }, page: function () { return f.is("body") }, pageDimmer: function () { return d.hasClass(v.pageDimmer) } }, can: { show: function () { return !d.hasClass(v.disabled) } }, set: { opacity: function (e) { var t = d.css("background-color"), n = t.split(","), i = n && 3 == n.length, o = n && 4 == n.length; e = 0 === g.opacity ? 0 : g.opacity || e, i || o ? (n[3] = e + ")", t = n.join(",")) : t = "rgba(0, 0, 0, " + e + ")", m.debug("Setting opacity to", e), d.css("background-color", t) }, active: function () { d.addClass(v.active) }, dimmable: function () { f.addClass(v.dimmable) }, dimmed: function () { f.addClass(v.dimmed) }, pageDimmer: function () { d.addClass(v.pageDimmer) }, disabled: function () { d.addClass(v.disabled) }, variation: function (e) { e = e || g.variation, e && d.addClass(e) } }, remove: { active: function () { d.removeClass(v.active) }, dimmed: function () { f.removeClass(v.dimmed) }, disabled: function () { d.removeClass(v.disabled) }, variation: function (e) { e = e || g.variation, e && d.removeClass(e) } }, setting: function (t, n) { if (m.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, g, t); else { if (n === i) return g[t]; e.isPlainObject(g[t]) ? e.extend(!0, g[t], n) : g[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, m, t); else { if (n === i) return m[t]; m[t] = n } }, debug: function () { !g.silent && g.debug && (g.performance ? m.performance.log(arguments) : (m.debug = Function.prototype.bind.call(console.info, console, g.name + ":"), m.debug.apply(console, arguments))) }, verbose: function () { !g.silent && g.verbose && g.debug && (g.performance ? m.performance.log(arguments) : (m.verbose = Function.prototype.bind.call(console.info, console, g.name + ":"), m.verbose.apply(console, arguments))) }, error: function () { g.silent || (m.error = Function.prototype.bind.call(console.error, console, g.name + ":"), m.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; g.performance && (t = (new Date).getTime(), i = r || t, n = t - i, r = t, s.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: S, "Execution Time": n })), clearTimeout(m.performance.timer), m.performance.timer = setTimeout(m.performance.display, 500) }, display: function () { var t = g.name + ":", n = 0; r = !1, clearTimeout(m.performance.timer), e.each(s, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", C && (t += " '" + C + "'"), a.length > 1 && (t += " (" + a.length + ")"), (console.group !== i || console.table !== i) && s.length > 0 && (console.groupCollapsed(t), console.table ? console.table(s) : e.each(s, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), s = [] } }, invoke: function (t, n, a) { var r, s, l, c = T; return n = n || u, a = S || a, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (m.error(b.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(a, n) : s !== i && (l = s), e.isArray(o) ? o.push(l) : o !== i ? o = [o, l] : l !== i && (o = l), s } }, m.preinitialize(), c ? (T === i && m.initialize(), m.invoke(l)) : (T !== i && T.invoke("destroy"), m.initialize()) }), o !== i ? o : this }, e.fn.dimmer.settings = { name: "Dimmer", namespace: "dimmer", silent: !1, debug: !1, verbose: !1, performance: !0, dimmerName: !1, variation: !1, closable: "auto", useCSS: !0, transition: "fade", on: !1, opacity: "auto", duration: { show: 500, hide: 500 }, onChange: function () { }, onShow: function () { }, onHide: function () { }, error: { method: "The method you called is not defined." }, className: { active: "active", animating: "animating", dimmable: "dimmable", dimmed: "dimmed", dimmer: "dimmer", disabled: "disabled", hide: "hide", pageDimmer: "page", show: "show" }, selector: { dimmer: "> .ui.dimmer", content: ".ui.dimmer > .content, .ui.dimmer > .content > .center" }, template: { dimmer: function () { return e("<div />").attr("class", "ui dimmer") } } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.dropdown = function (o) { var a, r = e(this), s = e(n), l = r.selector || "", c = "ontouchstart" in n.documentElement, u = (new Date).getTime(), d = [], f = arguments[0], m = "string" == typeof f, g = [].slice.call(arguments, 1); return r.each(function (p) { var h, v, b, y, x, C, w, k, S = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.dropdown.settings, o) : e.extend({}, e.fn.dropdown.settings), T = S.className, A = S.message, R = S.fields, P = S.keys, E = S.metadata, F = S.namespace, O = S.regExp, D = S.selector, q = S.error, j = S.templates, z = "." + F, I = "module-" + F, M = e(this), L = e(S.context), N = M.find(D.text), V = M.find(D.search), H = M.find(D.sizer), U = M.find(D.input), W = M.find(D.icon), B = M.prev().find(D.text).length > 0 ? M.prev().find(D.text) : M.prev(), Q = M.children(D.menu), X = Q.find(D.item), $ = !1, Y = !1, Z = !1, K = this, J = M.data(I); k = { initialize: function () { k.debug("Initializing dropdown", S), k.is.alreadySetup() ? k.setup.reference() : (k.setup.layout(), k.refreshData(), k.save.defaults(), k.restore.selected(), k.create.id(), k.bind.events(), k.observeChanges(), k.instantiate()) }, instantiate: function () { k.verbose("Storing instance of dropdown", k), J = k, M.data(I, k) }, destroy: function () { k.verbose("Destroying previous dropdown", M), k.remove.tabbable(), M.off(z).removeData(I), Q.off(z), s.off(y), k.disconnect.menuObserver(), k.disconnect.selectObserver() }, observeChanges: function () { "MutationObserver" in t && (C = new MutationObserver(k.event.select.mutation), w = new MutationObserver(k.event.menu.mutation), k.debug("Setting up mutation observer", C, w), k.observe.select(), k.observe.menu()) }, disconnect: { menuObserver: function () { w && w.disconnect() }, selectObserver: function () { C && C.disconnect() } }, observe: { select: function () { k.has.input() && C.observe(U[0], { childList: !0, subtree: !0 }) }, menu: function () { k.has.menu() && w.observe(Q[0], { childList: !0, subtree: !0 }) } }, create: { id: function () { x = (Math.random().toString(16) + "000000000").substr(2, 8), y = "." + x, k.verbose("Creating unique id for element", x) }, userChoice: function (t) { var n, o, a; return !!(t = t || k.get.userValues()) && (t = e.isArray(t) ? t : [t], e.each(t, function (t, r) { k.get.item(r) === !1 && (a = S.templates.addition(k.add.variables(A.addResult, r)), o = e("<div />").html(a).attr("data-" + E.value, r).attr("data-" + E.text, r).addClass(T.addition).addClass(T.item), S.hideAdditions && o.addClass(T.hidden), n = n === i ? o : n.add(o), k.verbose("Creating user choices for value", r, o)) }), n) }, userLabels: function (t) { var n = k.get.userValues(); n && (k.debug("Adding user labels", n), e.each(n, function (e, t) { k.verbose("Adding custom user value"), k.add.label(t, t) })) }, menu: function () { Q = e("<div />").addClass(T.menu).appendTo(M) }, sizer: function () { H = e("<span />").addClass(T.sizer).insertAfter(V) } }, search: function (e) { e = e !== i ? e : k.get.query(), k.verbose("Searching for query", e), k.has.minCharacters(e) ? k.filter(e) : k.hide() }, select: { firstUnfiltered: function () { k.verbose("Selecting first non-filtered element"), k.remove.selectedItem(), X.not(D.unselectable).not(D.addition + D.hidden).eq(0).addClass(T.selected) }, nextAvailable: function (e) { e = e.eq(0); var t = e.nextAll(D.item).not(D.unselectable).eq(0), n = e.prevAll(D.item).not(D.unselectable).eq(0), i = t.length > 0; i ? (k.verbose("Moving selection to", t), t.addClass(T.selected)) : (k.verbose("Moving selection to", n), n.addClass(T.selected)) } }, setup: { api: function () { var e = { debug: S.debug, urlData: { value: k.get.value(), query: k.get.query() }, on: !1 }; k.verbose("First request, initializing API"), M.api(e) }, layout: function () { M.is("select") && (k.setup.select(), k.setup.returnedObject()), k.has.menu() || k.create.menu(), k.is.search() && !k.has.search() && (k.verbose("Adding search input"), V = e("<input />").addClass(T.search).prop("autocomplete", "off").insertBefore(N)), k.is.multiple() && k.is.searchSelection() && !k.has.sizer() && k.create.sizer(), S.allowTab && k.set.tabbable() }, select: function () { var t = k.get.selectValues(); k.debug("Dropdown initialized on a select", t), M.is("select") && (U = M), U.parent(D.dropdown).length > 0 ? (k.debug("UI dropdown already exists. Creating dropdown menu only"), M = U.closest(D.dropdown), k.has.menu() || k.create.menu(), Q = M.children(D.menu), k.setup.menu(t)) : (k.debug("Creating entire dropdown from select"), M = e("<div />").attr("class", U.attr("class")).addClass(T.selection).addClass(T.dropdown).html(j.dropdown(t)).insertBefore(U), U.hasClass(T.multiple) && U.prop("multiple") === !1 && (k.error(q.missingMultiple), U.prop("multiple", !0)), U.is("[multiple]") && k.set.multiple(), U.prop("disabled") && (k.debug("Disabling dropdown"), M.addClass(T.disabled)), U.removeAttr("class").detach().prependTo(M)), k.refresh() }, menu: function (e) { Q.html(j.menu(e, R)), X = Q.find(D.item) }, reference: function () { k.debug("Dropdown behavior was called on select, replacing with closest dropdown"), M = M.parent(D.dropdown), k.refresh(), k.setup.returnedObject(), m && (J = k, k.invoke(f)) }, returnedObject: function () { var e = r.slice(0, p), t = r.slice(p + 1); r = e.add(M).add(t) } }, refresh: function () { k.refreshSelectors(), k.refreshData() }, refreshItems: function () { X = Q.find(D.item) }, refreshSelectors: function () { k.verbose("Refreshing selector cache"), N = M.find(D.text), V = M.find(D.search), U = M.find(D.input), W = M.find(D.icon), B = M.prev().find(D.text).length > 0 ? M.prev().find(D.text) : M.prev(), Q = M.children(D.menu), X = Q.find(D.item) }, refreshData: function () { k.verbose("Refreshing cached metadata"), X.removeData(E.text).removeData(E.value) }, clearData: function () { k.verbose("Clearing metadata"), X.removeData(E.text).removeData(E.value), M.removeData(E.defaultText).removeData(E.defaultValue).removeData(E.placeholderText) }, toggle: function () { k.verbose("Toggling menu visibility"), k.is.active() ? k.hide() : k.show() }, show: function (t) { if (t = e.isFunction(t) ? t : function () { }, !k.can.show() && k.is.remote() && (k.debug("No API results retrieved, searching before show"), k.queryRemote(k.get.query(), k.show)), k.can.show() && !k.is.active()) { if (k.debug("Showing dropdown"), !k.has.message() || k.has.maxSelections() || k.has.allResultsFiltered() || k.remove.message(), k.is.allFiltered()) return !0; S.onShow.call(K) !== !1 && k.animate.show(function () { k.can.click() && k.bind.intent(), k.has.menuSearch() && k.focusSearch(), k.set.visible(), t.call(K) }) } }, hide: function (t) { t = e.isFunction(t) ? t : function () { }, k.is.active() && (k.debug("Hiding dropdown"), S.onHide.call(K) !== !1 && k.animate.hide(function () { k.remove.visible(), t.call(K) })) }, hideOthers: function () { k.verbose("Finding other dropdowns to hide"), r.not(M).has(D.menu + "." + T.visible).dropdown("hide") }, hideMenu: function () { k.verbose("Hiding menu  instantaneously"), k.remove.active(), k.remove.visible(), Q.transition("hide") }, hideSubMenus: function () { var e = Q.children(D.item).find(D.menu); k.verbose("Hiding sub menus", e), e.transition("hide") }, bind: { events: function () { c && k.bind.touchEvents(), k.bind.keyboardEvents(), k.bind.inputEvents(), k.bind.mouseEvents() }, touchEvents: function () { k.debug("Touch device detected binding additional touch events"), k.is.searchSelection() || k.is.single() && M.on("touchstart" + z, k.event.test.toggle), Q.on("touchstart" + z, D.item, k.event.item.mouseenter) }, keyboardEvents: function () { k.verbose("Binding keyboard events"), M.on("keydown" + z, k.event.keydown), k.has.search() && M.on(k.get.inputEvent() + z, D.search, k.event.input), k.is.multiple() && s.on("keydown" + y, k.event.document.keydown) }, inputEvents: function () { k.verbose("Binding input change events"), M.on("change" + z, D.input, k.event.change) }, mouseEvents: function () { k.verbose("Binding mouse events"), k.is.multiple() && M.on("click" + z, D.label, k.event.label.click).on("click" + z, D.remove, k.event.remove.click), k.is.searchSelection() ? (M.on("mousedown" + z, k.event.mousedown).on("mouseup" + z, k.event.mouseup).on("mousedown" + z, D.menu, k.event.menu.mousedown).on("mouseup" + z, D.menu, k.event.menu.mouseup).on("click" + z, D.icon, k.event.icon.click).on("focus" + z, D.search, k.event.search.focus).on("click" + z, D.search, k.event.search.focus).on("blur" + z, D.search, k.event.search.blur).on("click" + z, D.text, k.event.text.focus), k.is.multiple() && M.on("click" + z, k.event.click)) : ("click" == S.on ? M.on("click" + z, D.icon, k.event.icon.click).on("click" + z, k.event.test.toggle) : "hover" == S.on ? M.on("mouseenter" + z, k.delay.show).on("mouseleave" + z, k.delay.hide) : M.on(S.on + z, k.toggle), M.on("mousedown" + z, k.event.mousedown).on("mouseup" + z, k.event.mouseup).on("focus" + z, k.event.focus), k.has.menuSearch() ? M.on("blur" + z, D.search, k.event.search.blur) : M.on("blur" + z, k.event.blur)), Q.on("mouseenter" + z, D.item, k.event.item.mouseenter).on("mouseleave" + z, D.item, k.event.item.mouseleave).on("click" + z, D.item, k.event.item.click) }, intent: function () { k.verbose("Binding hide intent event to document"), c && s.on("touchstart" + y, k.event.test.touch).on("touchmove" + y, k.event.test.touch), s.on("click" + y, k.event.test.hide) } }, unbind: { intent: function () { k.verbose("Removing hide intent event from document"), c && s.off("touchstart" + y).off("touchmove" + y), s.off("click" + y) } }, filter: function (e) { var t = e !== i ? e : k.get.query(), n = function () { k.is.multiple() && k.filterActive(), k.select.firstUnfiltered(), k.has.allResultsFiltered() ? S.onNoResults.call(K, t) ? S.allowAdditions ? S.hideAdditions && (k.verbose("User addition with no menu, setting empty style"), k.set.empty(), k.hideMenu()) : (k.verbose("All items filtered, showing message", t), k.add.message(A.noResults)) : (k.verbose("All items filtered, hiding dropdown", t), k.hideMenu()) : (k.remove.empty(), k.remove.message()), S.allowAdditions && k.add.userSuggestion(e), k.is.searchSelection() && k.can.show() && k.is.focusedOnSearch() && k.show() }; S.useLabels && k.has.maxSelections() || (S.apiSettings ? k.can.useAPI() ? k.queryRemote(t, function () { S.filterRemoteData && k.filterItems(t), n() }) : k.error(q.noAPI) : (k.filterItems(t), n())) }, queryRemote: function (t, n) { var i = { errorDuration: !1, cache: "local", throttle: S.throttle, urlData: { query: t }, onError: function () { k.add.message(A.serverError), n() }, onFailure: function () { k.add.message(A.serverError), n() }, onSuccess: function (e) { k.remove.message(), k.setup.menu({ values: e[R.remoteValues] }), n() } }; M.api("get request") || k.setup.api(), i = e.extend(!0, {}, i, S.apiSettings), M.api("setting", i).api("query") }, filterItems: function (t) { var n = t !== i ? t : k.get.query(), o = null, a = k.escape.string(n), r = new RegExp("^" + a, "igm"); k.has.query() && (o = [], k.verbose("Searching for matching values", n), X.each(function () { var t, i, a = e(this); if ("both" == S.match || "text" == S.match) { if (t = String(k.get.choiceText(a, !1)), t.search(r) !== -1) return o.push(this), !0; if ("exact" === S.fullTextSearch && k.exactSearch(n, t)) return o.push(this), !0; if (S.fullTextSearch === !0 && k.fuzzySearch(n, t)) return o.push(this), !0 } if ("both" == S.match || "value" == S.match) { if (i = String(k.get.choiceValue(a, t)), i.search(r) !== -1) return o.push(this), !0; if ("exact" === S.fullTextSearch && k.exactSearch(n, i)) return o.push(this), !0; if (S.fullTextSearch === !0 && k.fuzzySearch(n, i)) return o.push(this), !0 } })), k.debug("Showing only matched items", n), k.remove.filteredItem(), o && X.not(o).addClass(T.filtered) }, fuzzySearch: function (e, t) { var n = t.length, i = e.length; if (e = e.toLowerCase(), t = t.toLowerCase(), i > n) return !1; if (i === n) return e === t; e: for (var o = 0, a = 0; o < i; o++) { for (var r = e.charCodeAt(o); a < n;)if (t.charCodeAt(a++) === r) continue e; return !1 } return !0 }, exactSearch: function (e, t) { return e = e.toLowerCase(), t = t.toLowerCase(), t.indexOf(e) > -1 }, filterActive: function () { S.useLabels && X.filter("." + T.active).addClass(T.filtered) }, focusSearch: function (e) { k.has.search() && !k.is.focusedOnSearch() && (e ? (M.off("focus" + z, D.search), V.focus(), M.on("focus" + z, D.search, k.event.search.focus)) : V.focus()) }, forceSelection: function () { var e = X.not(T.filtered).filter("." + T.selected).eq(0), t = X.not(T.filtered).filter("." + T.active).eq(0), n = e.length > 0 ? e : t, i = n.length > 0; return i && !k.is.multiple() ? (k.debug("Forcing partial selection to selected item", n), void k.event.item.click.call(n, {}, !0)) : void (S.allowAdditions ? (k.set.selected(k.get.query()), k.remove.searchTerm()) : k.remove.searchTerm()) }, event: { change: function () { Z || (k.debug("Input changed, updating selection"), k.set.selected()) }, focus: function () { S.showOnFocus && !$ && k.is.hidden() && !v && k.show() }, blur: function (e) { v = n.activeElement === this, $ || v || (k.remove.activeLabel(), k.hide()) }, mousedown: function () { k.is.searchSelection() ? b = !0 : $ = !0 }, mouseup: function () { k.is.searchSelection() ? b = !1 : $ = !1 }, click: function (t) { var n = e(t.target); n.is(M) && (k.is.focusedOnSearch() ? k.show() : k.focusSearch()) }, search: { focus: function () { $ = !0, k.is.multiple() && k.remove.activeLabel(), S.showOnFocus && k.search() }, blur: function (e) { v = n.activeElement === this, b || Y || v || (S.forceSelection && k.forceSelection(), k.hide()), b = !1 } }, icon: { click: function (e) { k.toggle() } }, text: { focus: function (e) { $ = !0, k.focusSearch() } }, input: function (e) { (k.is.multiple() || k.is.searchSelection()) && k.set.filtered(), clearTimeout(k.timer), k.timer = setTimeout(k.search, S.delay.search) }, label: { click: function (t) { var n = e(this), i = M.find(D.label), o = i.filter("." + T.active), a = n.nextAll("." + T.active), r = n.prevAll("." + T.active), s = a.length > 0 ? n.nextUntil(a).add(o).add(n) : n.prevUntil(r).add(o).add(n); t.shiftKey ? (o.removeClass(T.active), s.addClass(T.active)) : t.ctrlKey ? n.toggleClass(T.active) : (o.removeClass(T.active), n.addClass(T.active)), S.onLabelSelect.apply(this, i.filter("." + T.active)) } }, remove: { click: function () { var t = e(this).parent(); t.hasClass(T.active) ? k.remove.activeLabels() : k.remove.activeLabels(t) } }, test: { toggle: function (e) { var t = k.is.multiple() ? k.show : k.toggle; k.is.bubbledLabelClick(e) || k.is.bubbledIconClick(e) || k.determine.eventOnElement(e, t) && e.preventDefault() }, touch: function (e) { k.determine.eventOnElement(e, function () { "touchstart" == e.type ? k.timer = setTimeout(function () { k.hide() }, S.delay.touch) : "touchmove" == e.type && clearTimeout(k.timer) }), e.stopPropagation() }, hide: function (e) { k.determine.eventInModule(e, k.hide) } }, select: { mutation: function (e) { k.debug("<select> modified, recreating menu"), k.setup.select() } }, menu: { mutation: function (t) { var n = t[0], i = e(n.addedNodes ? n.addedNodes[0] : !1), o = e(n.removedNodes ? n.removedNodes[0] : !1), a = i.add(o), r = a.is(D.addition) || a.closest(D.addition).length > 0, s = a.is(D.message) || a.closest(D.message).length > 0; r || s ? (k.debug("Updating item selector cache"), k.refreshItems()) : (k.debug("Menu modified, updating selector cache"), k.refresh()) }, mousedown: function () { Y = !0 }, mouseup: function () { Y = !1 } }, item: { mouseenter: function (t) { var n = e(t.target), i = e(this), o = i.children(D.menu), a = i.siblings(D.item).children(D.menu), r = o.length > 0, s = o.find(n).length > 0; !s && r && (clearTimeout(k.itemTimer), k.itemTimer = setTimeout(function () { k.verbose("Showing sub-menu", o), e.each(a, function () { k.animate.hide(!1, e(this)) }), k.animate.show(!1, o) }, S.delay.show), t.preventDefault()) }, mouseleave: function (t) { var n = e(this).children(D.menu); n.length > 0 && (clearTimeout(k.itemTimer), k.itemTimer = setTimeout(function () { k.verbose("Hiding sub-menu", n), k.animate.hide(!1, n) }, S.delay.hide)) }, click: function (t, n) { var i = e(this), o = e(t ? t.target : ""), a = i.find(D.menu), r = k.get.choiceText(i), s = k.get.choiceValue(i, r), l = a.length > 0, c = a.find(o).length > 0; c || l && !S.allowCategorySelection || (k.is.searchSelection() && (S.allowAdditions && k.remove.userAddition(), k.remove.searchTerm(), k.is.focusedOnSearch() || 1 == n || k.focusSearch(!0)), S.useLabels || (k.remove.filteredItem(), k.set.scrollPosition(i)), k.determine.selectAction.call(this, r, s)) } }, document: { keydown: function (e) { var t = e.which, n = k.is.inObject(t, P); if (n) { var i = M.find(D.label), o = i.filter("." + T.active), a = (o.data(E.value), i.index(o)), r = i.length, s = o.length > 0, l = o.length > 1, c = 0 === a, u = a + 1 == r, d = k.is.searchSelection(), f = k.is.focusedOnSearch(), m = k.is.focused(), g = f && 0 === k.get.caretPosition(); if (d && !s && !f) return; t == P.leftArrow ? !m && !g || s ? s && (e.shiftKey ? k.verbose("Adding previous label to selection") : (k.verbose("Selecting previous label"), i.removeClass(T.active)), c && !l ? o.addClass(T.active) : o.prev(D.siblingLabel).addClass(T.active).end(), e.preventDefault()) : (k.verbose("Selecting previous label"), i.last().addClass(T.active)) : t == P.rightArrow ? (m && !s && i.first().addClass(T.active), s && (e.shiftKey ? k.verbose("Adding next label to selection") : (k.verbose("Selecting next label"), i.removeClass(T.active)), u ? d ? f ? i.removeClass(T.active) : k.focusSearch() : l ? o.next(D.siblingLabel).addClass(T.active) : o.addClass(T.active) : o.next(D.siblingLabel).addClass(T.active), e.preventDefault())) : t == P.deleteKey || t == P.backspace ? s ? (k.verbose("Removing active labels"), u && d && !f && k.focusSearch(), o.last().next(D.siblingLabel).addClass(T.active), k.remove.activeLabels(o), e.preventDefault()) : g && !s && t == P.backspace && (k.verbose("Removing last label on input backspace"), o = i.last().addClass(T.active), k.remove.activeLabels(o)) : o.removeClass(T.active) } } }, keydown: function (e) { var t = e.which, n = k.is.inObject(t, P); if (n) { var i, o, a = X.not(D.unselectable).filter("." + T.selected).eq(0), r = Q.children("." + T.active).eq(0), s = a.length > 0 ? a : r, l = s.length > 0 ? s.siblings(":not(." + T.filtered + ")").addBack() : Q.children(":not(." + T.filtered + ")"), c = s.children(D.menu), u = s.closest(D.menu), d = u.hasClass(T.visible) || u.hasClass(T.animating) || u.parent(D.menu).length > 0, f = c.length > 0, m = s.length > 0, g = s.not(D.unselectable).length > 0, p = t == P.delimiter && S.allowAdditions && k.is.multiple(), h = S.allowAdditions && S.hideAdditions && (t == P.enter || p) && g; if (h && (k.verbose("Selecting item from keyboard shortcut", s), k.event.item.click.call(s, e), k.is.searchSelection() && k.remove.searchTerm()), k.is.visible()) { if ((t == P.enter || p) && (t == P.enter && m && f && !S.allowCategorySelection ? (k.verbose("Pressed enter on unselectable category, opening sub menu"), t = P.rightArrow) : g && (k.verbose("Selecting item from keyboard shortcut", s), k.event.item.click.call(s, e), k.is.searchSelection() && k.remove.searchTerm()), e.preventDefault()), m && (t == P.leftArrow && (o = u[0] !== Q[0], o && (k.verbose("Left key pressed, closing sub-menu"), k.animate.hide(!1, u), s.removeClass(T.selected), u.closest(D.item).addClass(T.selected), e.preventDefault())), t == P.rightArrow && f && (k.verbose("Right key pressed, opening sub-menu"), k.animate.show(!1, c), s.removeClass(T.selected), c.find(D.item).eq(0).addClass(T.selected), e.preventDefault())), t == P.upArrow) { if (i = m && d ? s.prevAll(D.item + ":not(" + D.unselectable + ")").eq(0) : X.eq(0), l.index(i) < 0) return k.verbose("Up key pressed but reached top of current menu"), void e.preventDefault(); k.verbose("Up key pressed, changing active item"), s.removeClass(T.selected), i.addClass(T.selected), k.set.scrollPosition(i), S.selectOnKeydown && k.is.single() && k.set.selectedItem(i), e.preventDefault() } if (t == P.downArrow) { if (i = m && d ? i = s.nextAll(D.item + ":not(" + D.unselectable + ")").eq(0) : X.eq(0), 0 === i.length) return k.verbose("Down key pressed but reached bottom of current menu"), void e.preventDefault(); k.verbose("Down key pressed, changing active item"), X.removeClass(T.selected), i.addClass(T.selected), k.set.scrollPosition(i), S.selectOnKeydown && k.is.single() && k.set.selectedItem(i), e.preventDefault() } t == P.pageUp && (k.scrollPage("up"), e.preventDefault()), t == P.pageDown && (k.scrollPage("down"), e.preventDefault()), t == P.escape && (k.verbose("Escape key pressed, closing dropdown"), k.hide()) } else p && e.preventDefault(), t != P.downArrow || k.is.visible() || (k.verbose("Down key pressed, showing dropdown"), k.select.firstUnfiltered(), k.show(), e.preventDefault()) } else k.has.search() || k.set.selectedLetter(String.fromCharCode(t)) } }, trigger: { change: function () { var e = n.createEvent("HTMLEvents"), t = U[0]; t && (k.verbose("Triggering native change event"), e.initEvent("change", !0, !1), t.dispatchEvent(e)) } }, determine: { selectAction: function (t, n) { k.verbose("Determining action", S.action), e.isFunction(k.action[S.action]) ? (k.verbose("Triggering preset action", S.action, t, n), k.action[S.action].call(K, t, n, this)) : e.isFunction(S.action) ? (k.verbose("Triggering user action", S.action, t, n), S.action.call(K, t, n, this)) : k.error(q.action, S.action) }, eventInModule: function (t, i) { var o = e(t.target), a = o.closest(n.documentElement).length > 0, r = o.closest(M).length > 0; return i = e.isFunction(i) ? i : function () { }, a && !r ? (k.verbose("Triggering event", i), i(), !0) : (k.verbose("Event occurred in dropdown, canceling callback"), !1) }, eventOnElement: function (t, i) { var o = e(t.target), a = o.closest(D.siblingLabel), r = n.body.contains(t.target), s = 0 === M.find(a).length, l = 0 === o.closest(Q).length; return i = e.isFunction(i) ? i : function () { }, r && s && l ? (k.verbose("Triggering event", i), i(), !0) : (k.verbose("Event occurred in dropdown menu, canceling callback"), !1) } }, action: { nothing: function () { }, activate: function (t, n, o) { if (n = n !== i ? n : t, k.can.activate(e(o))) { if (k.set.selected(n, e(o)), k.is.multiple() && !k.is.allFiltered()) return; k.hideAndClear() } }, select: function (t, n, o) { if (n = n !== i ? n : t, k.can.activate(e(o))) { if (k.set.value(n, e(o)), k.is.multiple() && !k.is.allFiltered()) return; k.hideAndClear() } }, combo: function (t, n, o) { n = n !== i ? n : t, k.set.selected(n, e(o)), k.hideAndClear() }, hide: function (e, t, n) { k.set.value(t, e), k.hideAndClear() } }, get: { id: function () { return x }, defaultText: function () { return M.data(E.defaultText) }, defaultValue: function () { return M.data(E.defaultValue) }, placeholderText: function () { return M.data(E.placeholderText) || "" }, text: function () { return N.text() }, query: function () { return e.trim(V.val()) }, searchWidth: function (e) { return e = e !== i ? e : V.val(), H.text(e), Math.ceil(H.width() + 1) }, selectionCount: function () { var t, n = k.get.values(); return t = k.is.multiple() ? e.isArray(n) ? n.length : 0 : "" !== k.get.value() ? 1 : 0 }, transition: function (e) { return "auto" == S.transition ? k.is.upward(e) ? "slide up" : "slide down" : S.transition }, userValues: function () { var t = k.get.values(); return !!t && (t = e.isArray(t) ? t : [t], e.grep(t, function (e) { return k.get.item(e) === !1 })) }, uniqueArray: function (t) { return e.grep(t, function (n, i) { return e.inArray(n, t) === i }) }, caretPosition: function () { var e, t, i = V.get(0); return "selectionStart" in i ? i.selectionStart : n.selection ? (i.focus(), e = n.selection.createRange(), t = e.text.length, e.moveStart("character", -i.value.length), e.text.length - t) : void 0 }, value: function () { var t = U.length > 0 ? U.val() : M.data(E.value), n = e.isArray(t) && 1 === t.length && "" === t[0]; return t === i || n ? "" : t }, values: function () { var e = k.get.value(); return "" === e ? "" : !k.has.selectInput() && k.is.multiple() ? "string" == typeof e ? e.split(S.delimiter) : "" : e }, remoteValues: function () { var t = k.get.values(), n = !1; return t && ("string" == typeof t && (t = [t]), e.each(t, function (e, t) { var i = k.read.remoteData(t); k.verbose("Restoring value from session data", i, t), i && (n || (n = {}), n[t] = i) })), n }, choiceText: function (t, n) { if (n = n !== i ? n : S.preserveHTML, t) return t.find(D.menu).length > 0 && (k.verbose("Retrieving text of element with sub-menu"), t = t.clone(), t.find(D.menu).remove(), t.find(D.menuIcon).remove()), t.data(E.text) !== i ? t.data(E.text) : n ? e.trim(t.html()) : e.trim(t.text()) }, choiceValue: function (t, n) { return n = n || k.get.choiceText(t), !!t && (t.data(E.value) !== i ? String(t.data(E.value)) : "string" == typeof n ? e.trim(n.toLowerCase()) : String(n)) }, inputEvent: function () { var e = V[0]; return !!e && (e.oninput !== i ? "input" : e.onpropertychange !== i ? "propertychange" : "keyup") }, selectValues: function () { var t = {}; return t.values = [], M.find("option").each(function () { var n = e(this), o = n.html(), a = n.attr("disabled"), r = n.attr("value") !== i ? n.attr("value") : o; "auto" === S.placeholder && "" === r ? t.placeholder = o : t.values.push({ name: o, value: r, disabled: a }) }), S.placeholder && "auto" !== S.placeholder && (k.debug("Setting placeholder value to", S.placeholder), t.placeholder = S.placeholder), S.sortSelect ? (t.values.sort(function (e, t) { return e.name > t.name ? 1 : -1 }), k.debug("Retrieved and sorted values from select", t)) : k.debug("Retrieved values from select", t), t }, activeItem: function () { return X.filter("." + T.active) }, selectedItem: function () { var e = X.not(D.unselectable).filter("." + T.selected); return e.length > 0 ? e : X.eq(0) }, itemWithAdditions: function (e) { var t = k.get.item(e), n = k.create.userChoice(e), i = n && n.length > 0; return i && (t = t.length > 0 ? t.add(n) : n), t }, item: function (t, n) { var o, a, r = !1; return t = t !== i ? t : k.get.values() !== i ? k.get.values() : k.get.text(), o = a ? t.length > 0 : t !== i && null !== t, a = k.is.multiple() && e.isArray(t), n = "" === t || 0 === t || (n || !1), o && X.each(function () { var o = e(this), s = k.get.choiceText(o), l = k.get.choiceValue(o, s); if (null !== l && l !== i) if (a) e.inArray(String(l), t) === -1 && e.inArray(s, t) === -1 || (r = r ? r.add(o) : o); else if (n) { if (k.verbose("Ambiguous dropdown value using strict type check", o, t), l === t || s === t) return r = o, !0 } else if (String(l) == String(t) || s == t) return k.verbose("Found select item by value", l, t), r = o, !0 }), r } }, check: { maxSelections: function (e) { return !S.maxSelections || (e = e !== i ? e : k.get.selectionCount(), e >= S.maxSelections ? (k.debug("Maximum selection count reached"), S.useLabels && (X.addClass(T.filtered), k.add.message(A.maxSelections)), !0) : (k.verbose("No longer at maximum selection count"), k.remove.message(), k.remove.filteredItem(), k.is.searchSelection() && k.filterItems(), !1)) } }, restore: { defaults: function () { k.clear(), k.restore.defaultText(), k.restore.defaultValue() }, defaultText: function () { var e = k.get.defaultText(), t = k.get.placeholderText; e === t ? (k.debug("Restoring default placeholder text", e), k.set.placeholderText(e)) : (k.debug("Restoring default text", e), k.set.text(e)) }, placeholderText: function () { k.set.placeholderText() }, defaultValue: function () { var e = k.get.defaultValue(); e !== i && (k.debug("Restoring default value", e), "" !== e ? (k.set.value(e), k.set.selected()) : (k.remove.activeItem(), k.remove.selectedItem())) }, labels: function () { S.allowAdditions && (S.useLabels || (k.error(q.labels), S.useLabels = !0), k.debug("Restoring selected values"), k.create.userLabels()), k.check.maxSelections() }, selected: function () { k.restore.values(), k.is.multiple() ? (k.debug("Restoring previously selected values and labels"), k.restore.labels()) : k.debug("Restoring previously selected values") }, values: function () { k.set.initialLoad(), S.apiSettings && S.saveRemoteData && k.get.remoteValues() ? k.restore.remoteValues() : k.set.selected(), k.remove.initialLoad() }, remoteValues: function () { var t = k.get.remoteValues(); k.debug("Recreating selected from session data", t), t && (k.is.single() ? e.each(t, function (e, t) { k.set.text(t) }) : e.each(t, function (e, t) { k.add.label(e, t) })) } }, read: { remoteData: function (e) { var n; return t.Storage === i ? void k.error(q.noStorage) : (n = sessionStorage.getItem(e), n !== i && n) } }, save: { defaults: function () { k.save.defaultText(), k.save.placeholderText(), k.save.defaultValue() }, defaultValue: function () { var e = k.get.value(); k.verbose("Saving default value as", e), M.data(E.defaultValue, e) }, defaultText: function () { var e = k.get.text(); k.verbose("Saving default text as", e), M.data(E.defaultText, e) }, placeholderText: function () { var e; S.placeholder !== !1 && N.hasClass(T.placeholder) && (e = k.get.text(), k.verbose("Saving placeholder text as", e), M.data(E.placeholderText, e)) }, remoteData: function (e, n) { return t.Storage === i ? void k.error(q.noStorage) : (k.verbose("Saving remote data to session storage", n, e), void sessionStorage.setItem(n, e)) } }, clear: function () { k.is.multiple() && S.useLabels ? k.remove.labels() : (k.remove.activeItem(), k.remove.selectedItem()), k.set.placeholderText(), k.clearValue() }, clearValue: function () { k.set.value("") }, scrollPage: function (e, t) { var n, i, o, a = t || k.get.selectedItem(), r = a.closest(D.menu), s = r.outerHeight(), l = r.scrollTop(), c = X.eq(0).outerHeight(), u = Math.floor(s / c), d = (r.prop("scrollHeight"), "up" == e ? l - c * u : l + c * u), f = X.not(D.unselectable); o = "up" == e ? f.index(a) - u : f.index(a) + u, n = "up" == e ? o >= 0 : o < f.length, i = n ? f.eq(o) : "up" == e ? f.first() : f.last(), i.length > 0 && (k.debug("Scrolling page", e, i), a.removeClass(T.selected), i.addClass(T.selected), S.selectOnKeydown && k.is.single() && k.set.selectedItem(i), r.scrollTop(d)) }, set: { filtered: function () { var e = k.is.multiple(), t = k.is.searchSelection(), n = e && t, i = t ? k.get.query() : "", o = "string" == typeof i && i.length > 0, a = k.get.searchWidth(), r = "" !== i; e && o && (k.verbose("Adjusting input width", a, S.glyphWidth), V.css("width", a)), o || n && r ? (k.verbose("Hiding placeholder text"), N.addClass(T.filtered)) : (!e || n && !r) && (k.verbose("Showing placeholder text"), N.removeClass(T.filtered)) }, empty: function () { M.addClass(T.empty) }, loading: function () { M.addClass(T.loading) }, placeholderText: function (e) { e = e || k.get.placeholderText(), k.debug("Setting placeholder text", e), k.set.text(e), N.addClass(T.placeholder) }, tabbable: function () { k.is.searchSelection() ? (k.debug("Added tabindex to searchable dropdown"), V.val("").attr("tabindex", 0), Q.attr("tabindex", -1)) : (k.debug("Added tabindex to dropdown"), M.attr("tabindex") === i && (M.attr("tabindex", 0), Q.attr("tabindex", -1))) }, initialLoad: function () { k.verbose("Setting initial load"), h = !0 }, activeItem: function (e) { S.allowAdditions && e.filter(D.addition).length > 0 ? e.addClass(T.filtered) : e.addClass(T.active) }, partialSearch: function (e) { var t = k.get.query().length; V.val(e.substr(0, t)) }, scrollPosition: function (e, t) { var n, o, a, r, s, l, c, u, d, f = 5; e = e || k.get.selectedItem(), n = e.closest(D.menu), o = e && e.length > 0, t = t !== i && t, e && n.length > 0 && o && (r = e.position().top, n.addClass(T.loading), l = n.scrollTop(), s = n.offset().top, r = e.offset().top, a = l - s + r, t || (c = n.height(), d = l + c < a + f, u = a - f < l), k.debug("Scrolling to active item", a), (t || u || d) && n.scrollTop(a), n.removeClass(T.loading)) }, text: function (e) { "select" !== S.action && ("combo" == S.action ? (k.debug("Changing combo button text", e, B), S.preserveHTML ? B.html(e) : B.text(e)) : (e !== k.get.placeholderText() && N.removeClass(T.placeholder), k.debug("Changing text", e, N), N.removeClass(T.filtered), S.preserveHTML ? N.html(e) : N.text(e))) }, selectedItem: function (e) { var t = k.get.choiceValue(e), n = k.get.choiceText(e, !1), i = k.get.choiceText(e, !0); k.debug("Setting user selection to item", e), k.remove.activeItem(), k.set.partialSearch(n), k.set.activeItem(e), k.set.selected(t, e), k.set.text(i) }, selectedLetter: function (t) { var n, i = X.filter("." + T.selected), o = i.length > 0 && k.has.firstLetter(i, t), a = !1; o && (n = i.nextAll(X).eq(0), k.has.firstLetter(n, t) && (a = n)), a || X.each(function () { if (k.has.firstLetter(e(this), t)) return a = e(this), !1 }), a && (k.verbose("Scrolling to next value with letter", t), k.set.scrollPosition(a), i.removeClass(T.selected), a.addClass(T.selected), S.selectOnKeydown && k.is.single() && k.set.selectedItem(a)) }, direction: function (e) { "auto" == S.direction ? k.is.onScreen(e) ? k.remove.upward(e) : k.set.upward(e) : "upward" == S.direction && k.set.upward(e) }, upward: function (e) { var t = e || M; t.addClass(T.upward) }, value: function (e, t, n) { var o = k.escape.value(e), a = U.length > 0, r = (!k.has.value(e), k.get.values()), s = e !== i ? String(e) : e; if (a) { if (!S.allowReselection && s == r && (k.verbose("Skipping value update already same value", e, r), !k.is.initialLoad())) return; k.is.single() && k.has.selectInput() && k.can.extendSelect() && (k.debug("Adding user option", e), k.add.optionValue(e)), k.debug("Updating input value", o, r), Z = !0, U.val(o), S.fireOnInit === !1 && k.is.initialLoad() ? k.debug("Input native change event ignored on initial load") : k.trigger.change(), Z = !1 } else k.verbose("Storing value in metadata", o, U), o !== r && M.data(E.value, s); S.fireOnInit === !1 && k.is.initialLoad() ? k.verbose("No callback on initial load", S.onChange) : S.onChange.call(K, e, t, n) }, active: function () { M.addClass(T.active) }, multiple: function () { M.addClass(T.multiple) }, visible: function () { M.addClass(T.visible) }, exactly: function (e, t) { k.debug("Setting selected to exact values"), k.clear(), k.set.selected(e, t) }, selected: function (t, n) { var i = k.is.multiple(); n = S.allowAdditions ? n || k.get.itemWithAdditions(t) : n || k.get.item(t), n && (k.debug("Setting selected menu item to", n), k.is.multiple() && k.remove.searchWidth(), k.is.single() ? (k.remove.activeItem(), k.remove.selectedItem()) : S.useLabels && k.remove.selectedItem(), n.each(function () { var t = e(this), o = k.get.choiceText(t), a = k.get.choiceValue(t, o), r = t.hasClass(T.filtered), s = t.hasClass(T.active), l = t.hasClass(T.addition), c = i && 1 == n.length; i ? !s || l ? (S.apiSettings && S.saveRemoteData && k.save.remoteData(o, a), S.useLabels ? (k.add.value(a, o, t), k.add.label(a, o, c), k.set.activeItem(t), k.filterActive(), k.select.nextAvailable(n)) : (k.add.value(a, o, t), k.set.text(k.add.variables(A.count)), k.set.activeItem(t))) : r || (k.debug("Selected active value, removing label"), k.remove.selected(a)) : (S.apiSettings && S.saveRemoteData && k.save.remoteData(o, a), k.set.text(o), k.set.value(a, o, t), t.addClass(T.active).addClass(T.selected)) })) } }, add: { label: function (t, n, i) { var o, a = k.is.searchSelection() ? V : N, r = k.escape.value(t); return o = e("<a />").addClass(T.label).attr("data-" + E.value, r).html(j.label(r, n)), o = S.onLabelCreate.call(o, r, n), k.has.label(t) ? void k.debug("Label already exists, skipping", r) : (S.label.variation && o.addClass(S.label.variation), void (i === !0 ? (k.debug("Animating in label", o), o.addClass(T.hidden).insertBefore(a).transition(S.label.transition, S.label.duration)) : (k.debug("Adding selection label", o), o.insertBefore(a)))) }, message: function (t) { var n = Q.children(D.message), i = S.templates.message(k.add.variables(t)); n.length > 0 ? n.html(i) : n = e("<div/>").html(i).addClass(T.message).appendTo(Q) }, optionValue: function (t) { var n = k.escape.value(t), i = U.find('option[value="' + k.escape.string(n) + '"]'), o = i.length > 0; o || (k.disconnect.selectObserver(), k.is.single() && (k.verbose("Removing previous user addition"), U.find("option." + T.addition).remove()), e("<option/>").prop("value", n).addClass(T.addition).html(t).appendTo(U), k.verbose("Adding user addition as an <option>", t), k.observe.select()) }, userSuggestion: function (e) { var t, n = Q.children(D.addition), i = k.get.item(e), o = i && i.not(D.addition).length, a = n.length > 0; if (!S.useLabels || !k.has.maxSelections()) { if ("" === e || o) return void n.remove(); a ? (n.data(E.value, e).data(E.text, e).attr("data-" + E.value, e).attr("data-" + E.text, e).removeClass(T.filtered), S.hideAdditions || (t = S.templates.addition(k.add.variables(A.addResult, e)), n.html(t)), k.verbose("Replacing user suggestion with new value", n)) : (n = k.create.userChoice(e), n.prependTo(Q), k.verbose("Adding item choice to menu corresponding with user choice addition", n)), S.hideAdditions && !k.is.allFiltered() || n.addClass(T.selected).siblings().removeClass(T.selected), k.refreshItems() } }, variables: function (e, t) { var n, i, o = e.search("{count}") !== -1, a = e.search("{maxCount}") !== -1, r = e.search("{term}") !== -1; return k.verbose("Adding templated variables to message", e), o && (n = k.get.selectionCount(), e = e.replace("{count}", n)), a && (n = k.get.selectionCount(), e = e.replace("{maxCount}", S.maxSelections)), r && (i = t || k.get.query(), e = e.replace("{term}", i)), e }, value: function (t, n, i) { var o, a = k.get.values(); return "" === t ? void k.debug("Cannot select blank values from multiselect") : (e.isArray(a) ? (o = a.concat([t]), o = k.get.uniqueArray(o)) : o = [t], k.has.selectInput() ? k.can.extendSelect() && (k.debug("Adding value to select", t, o, U), k.add.optionValue(t)) : (o = o.join(S.delimiter), k.debug("Setting hidden input to delimited value", o, U)), S.fireOnInit === !1 && k.is.initialLoad() ? k.verbose("Skipping onadd callback on initial load", S.onAdd) : S.onAdd.call(K, t, n, i), k.set.value(o, t, n, i), void k.check.maxSelections()) } }, remove: { active: function () { M.removeClass(T.active) }, activeLabel: function () { M.find(D.label).removeClass(T.active) }, empty: function () { M.removeClass(T.empty) }, loading: function () { M.removeClass(T.loading) }, initialLoad: function () { h = !1 }, upward: function (e) { var t = e || M; t.removeClass(T.upward) }, visible: function () { M.removeClass(T.visible) }, activeItem: function () { X.removeClass(T.active) }, filteredItem: function () { S.useLabels && k.has.maxSelections() || (S.useLabels && k.is.multiple() ? X.not("." + T.active).removeClass(T.filtered) : X.removeClass(T.filtered), k.remove.empty()) }, optionValue: function (e) { var t = k.escape.value(e), n = U.find('option[value="' + k.escape.string(t) + '"]'), i = n.length > 0; i && n.hasClass(T.addition) && (C && (C.disconnect(), k.verbose("Temporarily disconnecting mutation observer")), n.remove(), k.verbose("Removing user addition as an <option>", t), C && C.observe(U[0], { childList: !0, subtree: !0 })) }, message: function () { Q.children(D.message).remove() }, searchWidth: function () { V.css("width", "") }, searchTerm: function () { k.verbose("Cleared search term"), V.val(""), k.set.filtered() }, userAddition: function () { X.filter(D.addition).remove() }, selected: function (t, n) { return !!(n = S.allowAdditions ? n || k.get.itemWithAdditions(t) : n || k.get.item(t)) && void n.each(function () { var t = e(this), n = k.get.choiceText(t), i = k.get.choiceValue(t, n); k.is.multiple() ? S.useLabels ? (k.remove.value(i, n, t), k.remove.label(i)) : (k.remove.value(i, n, t), 0 === k.get.selectionCount() ? k.set.placeholderText() : k.set.text(k.add.variables(A.count))) : k.remove.value(i, n, t), t.removeClass(T.filtered).removeClass(T.active), S.useLabels && t.removeClass(T.selected) }) }, selectedItem: function () { X.removeClass(T.selected) }, value: function (e, t, n) { var i, o = k.get.values(); k.has.selectInput() ? (k.verbose("Input is <select> removing selected option", e), i = k.remove.arrayValue(e, o), k.remove.optionValue(e)) : (k.verbose("Removing from delimited values", e), i = k.remove.arrayValue(e, o), i = i.join(S.delimiter)), S.fireOnInit === !1 && k.is.initialLoad() ? k.verbose("No callback on initial load", S.onRemove) : S.onRemove.call(K, e, t, n), k.set.value(i, t, n), k.check.maxSelections() }, arrayValue: function (t, n) { return e.isArray(n) || (n = [n]), n = e.grep(n, function (e) { return t != e }), k.verbose("Removed value from delimited string", t, n), n }, label: function (e, t) { var n = M.find(D.label), i = n.filter("[data-" + E.value + '="' + k.escape.string(e) + '"]'); k.verbose("Removing label", i), i.remove() }, activeLabels: function (e) { e = e || M.find(D.label).filter("." + T.active), k.verbose("Removing active label selections", e), k.remove.labels(e) }, labels: function (t) { t = t || M.find(D.label), k.verbose("Removing labels", t), t.each(function () { var t = e(this), n = t.data(E.value), o = n !== i ? String(n) : n, a = k.is.userValue(o); return S.onLabelRemove.call(t, n) === !1 ? void k.debug("Label remove callback cancelled removal") : (k.remove.message(), void (a ? (k.remove.value(o), k.remove.label(o)) : k.remove.selected(o))) }) }, tabbable: function () { k.is.searchSelection() ? (k.debug("Searchable dropdown initialized"), V.removeAttr("tabindex"), Q.removeAttr("tabindex")) : (k.debug("Simple selection dropdown initialized"), M.removeAttr("tabindex"), Q.removeAttr("tabindex")) } }, has: { menuSearch: function () { return k.has.search() && V.closest(Q).length > 0 }, search: function () { return V.length > 0 }, sizer: function () { return H.length > 0 }, selectInput: function () { return U.is("select") }, minCharacters: function (e) { return !S.minCharacters || (e = e !== i ? String(e) : String(k.get.query()), e.length >= S.minCharacters) }, firstLetter: function (e, t) { var n, i; return !(!e || 0 === e.length || "string" != typeof t) && (n = k.get.choiceText(e, !1), t = t.toLowerCase(), i = String(n).charAt(0).toLowerCase(), t == i) }, input: function () { return U.length > 0 }, items: function () { return X.length > 0 }, menu: function () { return Q.length > 0 }, message: function () { return 0 !== Q.children(D.message).length }, label: function (e) { var t = k.escape.value(e), n = M.find(D.label); return n.filter("[data-" + E.value + '="' + k.escape.string(t) + '"]').length > 0 }, maxSelections: function () { return S.maxSelections && k.get.selectionCount() >= S.maxSelections }, allResultsFiltered: function () { var e = X.not(D.addition); return e.filter(D.unselectable).length === e.length }, userSuggestion: function () { return Q.children(D.addition).length > 0 }, query: function () { return "" !== k.get.query() }, value: function (t) { var n = k.get.values(), i = e.isArray(n) ? n && e.inArray(t, n) !== -1 : n == t; return !!i } }, is: { active: function () { return M.hasClass(T.active) }, bubbledLabelClick: function (t) { return e(t.target).is("select, input") && M.closest("label").length > 0 }, bubbledIconClick: function (t) { return e(t.target).closest(W).length > 0 }, alreadySetup: function () { return M.is("select") && M.parent(D.dropdown).length > 0 && 0 === M.prev().length }, animating: function (e) { return e ? e.transition && e.transition("is animating") : Q.transition && Q.transition("is animating") }, disabled: function () { return M.hasClass(T.disabled) }, focused: function () { return n.activeElement === M[0] }, focusedOnSearch: function () { return n.activeElement === V[0] }, allFiltered: function () { return (k.is.multiple() || k.has.search()) && !(0 == S.hideAdditions && k.has.userSuggestion()) && !k.has.message() && k.has.allResultsFiltered() }, hidden: function (e) { return !k.is.visible(e) }, initialLoad: function () { return h }, onScreen: function (e) { var t, n = e || Q, i = !0, o = {}; return n.addClass(T.loading), t = { context: { scrollTop: L.scrollTop(), height: L.outerHeight() }, menu: { offset: n.offset(), height: n.outerHeight() } }, o = { above: t.context.scrollTop <= t.menu.offset.top - t.menu.height, below: t.context.scrollTop + t.context.height >= t.menu.offset.top + t.menu.height }, o.below ? (k.verbose("Dropdown can fit in context downward", o), i = !0) : o.below || o.above ? (k.verbose("Dropdown cannot fit below, opening upward", o), i = !1) : (k.verbose("Dropdown cannot fit in either direction, favoring downward", o), i = !0), n.removeClass(T.loading), i }, inObject: function (t, n) { var i = !1; return e.each(n, function (e, n) { if (n == t) return i = !0, !0 }), i }, multiple: function () { return M.hasClass(T.multiple) }, remote: function () { return S.apiSettings && k.can.useAPI() }, single: function () { return !k.is.multiple() }, selectMutation: function (t) { var n = !1; return e.each(t, function (t, i) { if (i.target && e(i.target).is("select")) return n = !0, !0 }), n }, search: function () { return M.hasClass(T.search) }, searchSelection: function () { return k.has.search() && 1 === V.parent(D.dropdown).length }, selection: function () { return M.hasClass(T.selection) }, userValue: function (t) { return e.inArray(t, k.get.userValues()) !== -1 }, upward: function (e) { var t = e || M; return t.hasClass(T.upward) }, visible: function (e) { return e ? e.hasClass(T.visible) : Q.hasClass(T.visible) } }, can: { activate: function (e) { return !!S.useLabels || (!k.has.maxSelections() || !(!k.has.maxSelections() || !e.hasClass(T.active))) }, click: function () { return c || "click" == S.on }, extendSelect: function () { return S.allowAdditions || S.apiSettings }, show: function () { return !k.is.disabled() && (k.has.items() || k.has.message()) }, useAPI: function () { return e.fn.api !== i } }, animate: { show: function (t, n) { var o, a = n || Q, r = n ? function () { } : function () { k.hideSubMenus(), k.hideOthers(), k.set.active() }; t = e.isFunction(t) ? t : function () { }, k.verbose("Doing menu show animation", a), k.set.direction(n), o = k.get.transition(n), k.is.selection() && k.set.scrollPosition(k.get.selectedItem(), !0), (k.is.hidden(a) || k.is.animating(a)) && ("none" == o ? (r(), a.transition("show"), t.call(K)) : e.fn.transition !== i && M.transition("is supported") ? a.transition({ animation: o + " in", debug: S.debug, verbose: S.verbose, duration: S.duration, queue: !0, onStart: r, onComplete: function () { t.call(K) } }) : k.error(q.noTransition, o)) }, hide: function (t, n) { var o = n || Q, a = (n ? .9 * S.duration : S.duration, n ? function () { } : function () { k.can.click() && k.unbind.intent(), k.remove.active() }), r = k.get.transition(n); t = e.isFunction(t) ? t : function () { }, (k.is.visible(o) || k.is.animating(o)) && (k.verbose("Doing menu hide animation", o), "none" == r ? (a(), o.transition("hide"), t.call(K)) : e.fn.transition !== i && M.transition("is supported") ? o.transition({ animation: r + " out", duration: S.duration, debug: S.debug, verbose: S.verbose, queue: !0, onStart: a, onComplete: function () { "auto" == S.direction && k.remove.upward(n), t.call(K) } }) : k.error(q.transition)) } }, hideAndClear: function () { k.remove.searchTerm(), k.has.maxSelections() || (k.has.search() ? k.hide(function () { k.remove.filteredItem() }) : k.hide()) }, delay: { show: function () { k.verbose("Delaying show event to ensure user intent"), clearTimeout(k.timer), k.timer = setTimeout(k.show, S.delay.show) }, hide: function () { k.verbose("Delaying hide event to ensure user intent"), clearTimeout(k.timer), k.timer = setTimeout(k.hide, S.delay.hide) } }, escape: { value: function (t) { var n = e.isArray(t), i = "string" == typeof t, o = !i && !n, a = i && t.search(O.quote) !== -1, r = []; return o || !a ? t : (k.debug("Encoding quote values for use in select", t), n ? (e.each(t, function (e, t) { r.push(t.replace(O.quote, "&quot;")) }), r) : t.replace(O.quote, "&quot;")) }, string: function (e) { return e = String(e), e.replace(O.escape, "\\$&") } }, setting: function (t, n) { if (k.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, S, t); else { if (n === i) return S[t]; e.isPlainObject(S[t]) ? e.extend(!0, S[t], n) : S[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, k, t); else { if (n === i) return k[t]; k[t] = n } }, debug: function () { !S.silent && S.debug && (S.performance ? k.performance.log(arguments) : (k.debug = Function.prototype.bind.call(console.info, console, S.name + ":"), k.debug.apply(console, arguments))) }, verbose: function () { !S.silent && S.verbose && S.debug && (S.performance ? k.performance.log(arguments) : (k.verbose = Function.prototype.bind.call(console.info, console, S.name + ":"), k.verbose.apply(console, arguments))) }, error: function () { S.silent || (k.error = Function.prototype.bind.call(console.error, console, S.name + ":"), k.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; S.performance && (t = (new Date).getTime(), i = u || t, n = t - i, u = t, d.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: K, "Execution Time": n })), clearTimeout(k.performance.timer), k.performance.timer = setTimeout(k.performance.display, 500) }, display: function () { var t = S.name + ":", n = 0; u = !1, clearTimeout(k.performance.timer), e.each(d, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", l && (t += " '" + l + "'"), (console.group !== i || console.table !== i) && d.length > 0 && (console.groupCollapsed(t), console.table ? console.table(d) : e.each(d, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), d = [] } }, invoke: function (t, n, o) { var r, s, l, c = J; return n = n || g, o = K || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (k.error(q.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, m ? (J === i && k.initialize(), k.invoke(f)) : (J !== i && J.invoke("destroy"), k.initialize()) }), a !== i ? a : r }, e.fn.dropdown.settings = { silent: !1, debug: !1, verbose: !1, performance: !0, on: "click", action: "activate", apiSettings: !1, selectOnKeydown: !0, minCharacters: 0, filterRemoteData: !1, saveRemoteData: !0, throttle: 200, context: t, direction: "auto", keepOnScreen: !0, match: "both", fullTextSearch: !1, placeholder: "auto", preserveHTML: !0, sortSelect: !1, forceSelection: !0, allowAdditions: !1, hideAdditions: !0, maxSelections: !1, useLabels: !0, delimiter: ",", showOnFocus: !0, allowReselection: !1, allowTab: !0, allowCategorySelection: !1, fireOnInit: !1, transition: "auto", duration: 200, glyphWidth: 1.037, label: { transition: "scale", duration: 200, variation: !1 }, delay: { hide: 300, show: 200, search: 20, touch: 50 }, onChange: function (e, t, n) { }, onAdd: function (e, t, n) { }, onRemove: function (e, t, n) { }, onLabelSelect: function (e) { }, onLabelCreate: function (t, n) { return e(this) }, onLabelRemove: function (e) { return !0 }, onNoResults: function (e) { return !0 }, onShow: function () { }, onHide: function () { }, name: "Dropdown", namespace: "dropdown", message: { addResult: "Add <b>{term}</b>", count: "{count} selected", maxSelections: "Max {maxCount} selections", noResults: "No results found.", serverError: "There was an error contacting the server" }, error: { action: "You called a dropdown action that was not defined", alreadySetup: "Once a select has been initialized behaviors must be called on the created ui dropdown", labels: "Allowing user additions currently requires the use of labels.", missingMultiple: "<select> requires multiple property to be set to correctly preserve multiple values", method: "The method you called is not defined.", noAPI: "The API module is required to load resources remotely", noStorage: "Saving remote data requires session storage", noTransition: "This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>" }, regExp: { escape: /[-[\]{}()*+?.,\\^$|#\s]/g, quote: /"/g }, metadata: { defaultText: "defaultText", defaultValue: "defaultValue", placeholderText: "placeholder", text: "text", value: "value" }, fields: { remoteValues: "results", values: "values", disabled: "disabled", name: "name", value: "value", text: "text" }, keys: { backspace: 8, delimiter: 188, deleteKey: 46, enter: 13, escape: 27, pageUp: 33, pageDown: 34, leftArrow: 37, upArrow: 38, rightArrow: 39, downArrow: 40 }, selector: { addition: ".addition", dropdown: ".ui.dropdown", hidden: ".hidden", icon: "> .dropdown.icon", input: '> input[type="hidden"], > select', item: ".item", label: "> .label", remove: "> .label > .delete.icon", siblingLabel: ".label", menu: ".menu", message: ".message", menuIcon: ".dropdown.icon", search: "input.search, .menu > .search > input, .menu input.search", sizer: "> input.sizer", text: "> .text:not(.icon)", unselectable: ".disabled, .filtered" }, className: { active: "active", addition: "addition", animating: "animating", disabled: "disabled", empty: "empty", dropdown: "ui dropdown", filtered: "filtered", hidden: "hidden transition", item: "item", label: "ui label", loading: "loading", menu: "menu", message: "message", multiple: "multiple", placeholder: "default", sizer: "sizer", search: "search", selected: "selected", selection: "selection", upward: "upward", visible: "visible" } }, e.fn.dropdown.settings.templates = { dropdown: function (t) { var n = t.placeholder || !1, i = (t.values || {}, ""); return i += '<i class="dropdown icon"></i>', i += t.placeholder ? '<div class="default text">' + n + "</div>" : '<div class="text"></div>', i += '<div class="menu">', e.each(t.values, function (e, t) { i += t.disabled ? '<div class="disabled item" data-value="' + t.value + '">' + t.name + "</div>" : '<div class="item" data-value="' + t.value + '">' + t.name + "</div>" }), i += "</div>" }, menu: function (t, n) { var i = t[n.values] || {}, o = ""; return e.each(i, function (e, t) { var i = t[n.text] ? 'data-text="' + t[n.text] + '"' : "", a = t[n.disabled] ? "disabled " : ""; o += '<div class="' + a + 'item" data-value="' + t[n.value] + '"' + i + ">", o += t[n.name], o += "</div>" }), o }, label: function (e, t) { return t + '<i class="delete icon"></i>' }, message: function (e) { return e }, addition: function (e) { return e } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.embed = function (n) { var o, a = e(this), r = a.selector || "", s = (new Date).getTime(), l = [], c = arguments[0], u = "string" == typeof c, d = [].slice.call(arguments, 1); return a.each(function () { var f, m = e.isPlainObject(n) ? e.extend(!0, {}, e.fn.embed.settings, n) : e.extend({}, e.fn.embed.settings), g = m.selector, p = m.className, h = m.sources, v = m.error, b = m.metadata, y = m.namespace, x = m.templates, C = "." + y, w = "module-" + y, k = (e(t), e(this)), S = k.find(g.placeholder), T = k.find(g.icon), A = k.find(g.embed), R = this, P = k.data(w); f = { initialize: function () { f.debug("Initializing embed"), f.determine.autoplay(), f.create(), f.bind.events(), f.instantiate() }, instantiate: function () { f.verbose("Storing instance of module", f), P = f, k.data(w, f) }, destroy: function () { f.verbose("Destroying previous instance of embed"), f.reset(), k.removeData(w).off(C) }, refresh: function () { f.verbose("Refreshing selector cache"), S = k.find(g.placeholder), T = k.find(g.icon), A = k.find(g.embed) }, bind: { events: function () { f.has.placeholder() && (f.debug("Adding placeholder events"), k.on("click" + C, g.placeholder, f.createAndShow).on("click" + C, g.icon, f.createAndShow)) } }, create: function () { var e = f.get.placeholder(); e ? f.createPlaceholder() : f.createAndShow() }, createPlaceholder: function (e) { var t = f.get.icon(), n = f.get.url(); f.generate.embed(n); e = e || f.get.placeholder(), k.html(x.placeholder(e, t)), f.debug("Creating placeholder for embed", e, t) }, createEmbed: function (t) { f.refresh(), t = t || f.get.url(), A = e("<div/>").addClass(p.embed).html(f.generate.embed(t)).appendTo(k), m.onCreate.call(R, t), f.debug("Creating embed object", A) }, changeEmbed: function (e) { A.html(f.generate.embed(e)) }, createAndShow: function () { f.createEmbed(), f.show() }, change: function (e, t, n) { f.debug("Changing video to ", e, t, n), k.data(b.source, e).data(b.id, t), n ? k.data(b.url, n) : k.removeData(b.url), f.has.embed() ? f.changeEmbed() : f.create() }, reset: function () { f.debug("Clearing embed and showing placeholder"), f.remove.active(), f.remove.embed(), f.showPlaceholder(), m.onReset.call(R) }, show: function () { f.debug("Showing embed"), f.set.active(), m.onDisplay.call(R) }, hide: function () { f.debug("Hiding embed"), f.showPlaceholder() }, showPlaceholder: function () { f.debug("Showing placeholder image"), f.remove.active(), m.onPlaceholderDisplay.call(R) }, get: { id: function () { return m.id || k.data(b.id) }, placeholder: function () { return m.placeholder || k.data(b.placeholder) }, icon: function () { return m.icon ? m.icon : k.data(b.icon) !== i ? k.data(b.icon) : f.determine.icon() }, source: function (e) { return m.source ? m.source : k.data(b.source) !== i ? k.data(b.source) : f.determine.source() }, type: function () { var e = f.get.source(); return h[e] !== i && h[e].type }, url: function () { return m.url ? m.url : k.data(b.url) !== i ? k.data(b.url) : f.determine.url() } }, determine: { autoplay: function () { f.should.autoplay() && (m.autoplay = !0) }, source: function (t) { var n = !1; return t = t || f.get.url(), t && e.each(h, function (e, i) { if (t.search(i.domain) !== -1) return n = e, !1 }), n }, icon: function () { var e = f.get.source(); return h[e] !== i && h[e].icon }, url: function () { var e, t = m.id || k.data(b.id), n = m.source || k.data(b.source); return e = h[n] !== i && h[n].url.replace("{id}", t), e && k.data(b.url, e), e } }, set: { active: function () { k.addClass(p.active) } }, remove: { active: function () { k.removeClass(p.active) }, embed: function () { A.empty() } }, encode: { parameters: function (e) { var t, n = []; for (t in e) n.push(encodeURIComponent(t) + "=" + encodeURIComponent(e[t])); return n.join("&amp;") } }, generate: { embed: function (e) { f.debug("Generating embed html"); var t, n, i = f.get.source(); return e = f.get.url(e), e ? (n = f.generate.parameters(i), t = x.iframe(e, n)) : f.error(v.noURL, k), t }, parameters: function (t, n) { var o = h[t] && h[t].parameters !== i ? h[t].parameters(m) : {}; return n = n || m.parameters, n && (o = e.extend({}, o, n)), o = m.onEmbed(o), f.encode.parameters(o) } }, has: { embed: function () { return A.length > 0 }, placeholder: function () { return m.placeholder || k.data(b.placeholder) } }, should: { autoplay: function () { return "auto" === m.autoplay ? m.placeholder || k.data(b.placeholder) !== i : m.autoplay } }, is: { video: function () { return "video" == f.get.type() } }, setting: function (t, n) { if (f.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, m, t); else { if (n === i) return m[t]; e.isPlainObject(m[t]) ? e.extend(!0, m[t], n) : m[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, f, t); else { if (n === i) return f[t]; f[t] = n } }, debug: function () { !m.silent && m.debug && (m.performance ? f.performance.log(arguments) : (f.debug = Function.prototype.bind.call(console.info, console, m.name + ":"), f.debug.apply(console, arguments))) }, verbose: function () { !m.silent && m.verbose && m.debug && (m.performance ? f.performance.log(arguments) : (f.verbose = Function.prototype.bind.call(console.info, console, m.name + ":"), f.verbose.apply(console, arguments))) }, error: function () { m.silent || (f.error = Function.prototype.bind.call(console.error, console, m.name + ":"), f.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; m.performance && (t = (new Date).getTime(), i = s || t, n = t - i, s = t, l.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: R, "Execution Time": n })), clearTimeout(f.performance.timer), f.performance.timer = setTimeout(f.performance.display, 500) }, display: function () { var t = m.name + ":", n = 0; s = !1, clearTimeout(f.performance.timer), e.each(l, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", r && (t += " '" + r + "'"), a.length > 1 && (t += " (" + a.length + ")"), (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, n, a) { var r, s, l, c = P; return n = n || d, a = R || a, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (f.error(v.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(a, n) : s !== i && (l = s), e.isArray(o) ? o.push(l) : o !== i ? o = [o, l] : l !== i && (o = l), s } }, u ? (P === i && f.initialize(), f.invoke(c)) : (P !== i && P.invoke("destroy"), f.initialize()) }), o !== i ? o : this }, e.fn.embed.settings = { name: "Embed", namespace: "embed", silent: !1, debug: !1, verbose: !1, performance: !0, icon: !1, source: !1, url: !1, id: !1, autoplay: "auto", color: "#444444", hd: !0, brandedUI: !1, parameters: !1, onDisplay: function () { }, onPlaceholderDisplay: function () { }, onReset: function () { }, onCreate: function (e) { }, onEmbed: function (e) { return e }, metadata: { id: "id", icon: "icon", placeholder: "placeholder", source: "source", url: "url" }, error: { noURL: "No URL specified", method: "The method you called is not defined" }, className: { active: "active", embed: "embed" }, selector: { embed: ".embed", placeholder: ".placeholder", icon: ".icon" }, sources: { youtube: { name: "youtube", type: "video", icon: "video play", domain: "youtube.com", url: "//www.youtube.com/embed/{id}", parameters: function (e) { return { autohide: !e.brandedUI, autoplay: e.autoplay, color: e.color || i, hq: e.hd, jsapi: e.api, modestbranding: !e.brandedUI } } }, vimeo: { name: "vimeo", type: "video", icon: "video play", domain: "vimeo.com", url: "//player.vimeo.com/video/{id}", parameters: function (e) { return { api: e.api, autoplay: e.autoplay, byline: e.brandedUI, color: e.color || i, portrait: e.brandedUI, title: e.brandedUI } } } }, templates: { iframe: function (e, t) { var n = e; return t && (n += "?" + t), '<iframe src="' + n + '" width="100%" height="100%" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>' }, placeholder: function (e, t) { var n = ""; return t && (n += '<i class="' + t + ' icon"></i>'), e && (n += '<img class="placeholder" src="' + e + '">'), n } }, api: !1, onPause: function () { }, onPlay: function () { }, onStop: function () { } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.modal = function (o) { var a, r = e(this), s = e(t), l = e(n), c = e("body"), u = r.selector || "", d = (new Date).getTime(), f = [], m = arguments[0], g = "string" == typeof m, p = [].slice.call(arguments, 1), h = t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }; return r.each(function () { var r, v, b, y, x, C, w, k, S, T = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.modal.settings, o) : e.extend({}, e.fn.modal.settings), A = T.selector, R = T.className, P = T.namespace, E = T.error, F = "." + P, O = "module-" + P, D = e(this), q = e(T.context), j = D.find(A.close), z = this, I = D.data(O); S = { initialize: function () { S.verbose("Initializing dimmer", q), S.create.id(), S.create.dimmer(), S.refreshModals(), S.bind.events(), T.observeChanges && S.observeChanges(), S.instantiate() }, instantiate: function () { S.verbose("Storing instance of modal"), I = S, D.data(O, I) }, create: { dimmer: function () { var t = { debug: T.debug, dimmerName: "modals", duration: { show: T.duration, hide: T.duration } }, n = e.extend(!0, t, T.dimmerSettings); return T.inverted && (n.variation = n.variation !== i ? n.variation + " inverted" : "inverted"), e.fn.dimmer === i ? void S.error(E.dimmer) : (S.debug("Creating dimmer with settings", n), y = q.dimmer(n), T.detachable ? (S.verbose("Modal is detachable, moving content into dimmer"), y.dimmer("add content", D)) : S.set.undetached(), T.blurring && y.addClass(R.blurring), void (x = y.dimmer("get dimmer"))) }, id: function () { w = (Math.random().toString(16) + "000000000").substr(2, 8), C = "." + w, S.verbose("Creating unique id for element", w) } }, destroy: function () { S.verbose("Destroying previous modal"), D.removeData(O).off(F), s.off(C), x.off(C), j.off(F), q.dimmer("destroy") }, observeChanges: function () { "MutationObserver" in t && (k = new MutationObserver(function (e) { S.debug("DOM tree modified, refreshing"), S.refresh() }), k.observe(z, { childList: !0, subtree: !0 }), S.debug("Setting up mutation observer", k)) }, refresh: function () { S.remove.scrolling(), S.cacheSizes(), S.set.screenHeight(), S.set.type(), S.set.position() }, refreshModals: function () { v = D.siblings(A.modal), r = v.add(D) }, attachEvents: function (t, n) { var i = e(t); n = e.isFunction(S[n]) ? S[n] : S.toggle, i.length > 0 ? (S.debug("Attaching modal events to element", t, n), i.off(F).on("click" + F, n)) : S.error(E.notFound, t) }, bind: { events: function () { S.verbose("Attaching events"), D.on("click" + F, A.close, S.event.close).on("click" + F, A.approve, S.event.approve).on("click" + F, A.deny, S.event.deny), s.on("resize" + C, S.event.resize) } }, get: { id: function () { return (Math.random().toString(16) + "000000000").substr(2, 8) } }, event: { approve: function () { return T.onApprove.call(z, e(this)) === !1 ? void S.verbose("Approve callback returned false cancelling hide") : void S.hide() }, deny: function () { return T.onDeny.call(z, e(this)) === !1 ? void S.verbose("Deny callback returned false cancelling hide") : void S.hide() }, close: function () { S.hide() }, click: function (t) { var i = e(t.target), o = i.closest(A.modal).length > 0, a = e.contains(n.documentElement, t.target); !o && a && (S.debug("Dimmer clicked, hiding all modals"), S.is.active() && (S.remove.clickaway(), T.allowMultiple ? S.hide() : S.hideAll())) }, debounce: function (e, t) { clearTimeout(S.timer), S.timer = setTimeout(e, t) }, keyboard: function (e) { var t = e.which, n = 27; t == n && (T.closable ? (S.debug("Escape key pressed hiding modal"), S.hide()) : S.debug("Escape key pressed, but closable is set to false"), e.preventDefault()) }, resize: function () { y.dimmer("is active") && h(S.refresh) } }, toggle: function () { S.is.active() || S.is.animating() ? S.hide() : S.show() }, show: function (t) { t = e.isFunction(t) ? t : function () { }, S.refreshModals(), S.showModal(t) }, hide: function (t) { t = e.isFunction(t) ? t : function () { }, S.refreshModals(), S.hideModal(t) }, showModal: function (t) { t = e.isFunction(t) ? t : function () { }, S.is.animating() || !S.is.active() ? (S.showDimmer(), S.cacheSizes(), S.set.position(), S.set.screenHeight(), S.set.type(), S.set.clickaway(), !T.allowMultiple && S.others.active() ? S.hideOthers(S.showModal) : (T.onShow.call(z), T.transition && e.fn.transition !== i && D.transition("is supported") ? (S.debug("Showing modal with css animations"), D.transition({ debug: T.debug, animation: T.transition + " in", queue: T.queue, duration: T.duration, useFailSafe: !0, onComplete: function () { T.onVisible.apply(z), T.keyboardShortcuts && S.add.keyboardShortcuts(), S.save.focus(), S.set.active(), T.autofocus && S.set.autofocus(), t() } })) : S.error(E.noTransition))) : S.debug("Modal is already visible") }, hideModal: function (t, n) { return t = e.isFunction(t) ? t : function () { }, S.debug("Hiding modal"), T.onHide.call(z, e(this)) === !1 ? void S.verbose("Hide callback returned false cancelling hide") : void ((S.is.animating() || S.is.active()) && (T.transition && e.fn.transition !== i && D.transition("is supported") ? (S.remove.active(), D.transition({ debug: T.debug, animation: T.transition + " out", queue: T.queue, duration: T.duration, useFailSafe: !0, onStart: function () { S.others.active() || n || S.hideDimmer(), T.keyboardShortcuts && S.remove.keyboardShortcuts() }, onComplete: function () { T.onHidden.call(z), S.restore.focus(), t() } })) : S.error(E.noTransition))) }, showDimmer: function () { y.dimmer("is animating") || !y.dimmer("is active") ? (S.debug("Showing dimmer"), y.dimmer("show")) : S.debug("Dimmer already visible") }, hideDimmer: function () { return y.dimmer("is animating") || y.dimmer("is active") ? void y.dimmer("hide", function () { S.remove.clickaway(), S.remove.screenHeight() }) : void S.debug("Dimmer is not visible cannot hide") }, hideAll: function (t) { var n = r.filter("." + R.active + ", ." + R.animating); t = e.isFunction(t) ? t : function () { }, n.length > 0 && (S.debug("Hiding all visible modals"), S.hideDimmer(), n.modal("hide modal", t)) }, hideOthers: function (t) { var n = v.filter("." + R.active + ", ." + R.animating); t = e.isFunction(t) ? t : function () { }, n.length > 0 && (S.debug("Hiding other modals", v), n.modal("hide modal", t, !0)) }, others: { active: function () { return v.filter("." + R.active).length > 0 }, animating: function () { return v.filter("." + R.animating).length > 0 } }, add: { keyboardShortcuts: function () { S.verbose("Adding keyboard shortcuts"), l.on("keyup" + F, S.event.keyboard) } }, save: { focus: function () { b = e(n.activeElement).blur() } }, restore: { focus: function () { b && b.length > 0 && b.focus() } }, remove: { active: function () { D.removeClass(R.active) }, clickaway: function () { T.closable && x.off("click" + C) }, bodyStyle: function () { "" === c.attr("style") && (S.verbose("Removing style attribute"), c.removeAttr("style")) }, screenHeight: function () { S.debug("Removing page height"), c.css("height", "") }, keyboardShortcuts: function () { S.verbose("Removing keyboard shortcuts"), l.off("keyup" + F) }, scrolling: function () { y.removeClass(R.scrolling), D.removeClass(R.scrolling) } }, cacheSizes: function () { var o = D.outerHeight(); S.cache !== i && 0 === o || (S.cache = { pageHeight: e(n).outerHeight(), height: o + T.offset, contextHeight: "body" == T.context ? e(t).height() : y.height() }), S.debug("Caching modal and container sizes", S.cache) }, can: { fit: function () { return S.cache.height + 2 * T.padding < S.cache.contextHeight } }, is: { active: function () { return D.hasClass(R.active) }, animating: function () { return D.transition("is supported") ? D.transition("is animating") : D.is(":visible") }, scrolling: function () { return y.hasClass(R.scrolling) }, modernBrowser: function () { return !(t.ActiveXObject || "ActiveXObject" in t) } }, set: { autofocus: function () { var e = D.find("[tabindex], :input").filter(":visible"), t = e.filter("[autofocus]"), n = t.length > 0 ? t.first() : e.first(); n.length > 0 && n.focus() }, clickaway: function () { T.closable && x.on("click" + C, S.event.click) }, screenHeight: function () { S.can.fit() ? c.css("height", "") : (S.debug("Modal is taller than page content, resizing page height"), c.css("height", S.cache.height + 2 * T.padding)) }, active: function () { D.addClass(R.active) }, scrolling: function () { y.addClass(R.scrolling), D.addClass(R.scrolling) }, type: function () { S.can.fit() ? (S.verbose("Modal fits on screen"), S.others.active() || S.others.animating() || S.remove.scrolling()) : (S.verbose("Modal cannot fit on screen setting to scrolling"), S.set.scrolling()) }, position: function () { S.verbose("Centering modal on page", S.cache), S.can.fit() ? D.css({ top: "", marginTop: -(S.cache.height / 2) }) : D.css({ marginTop: "", top: l.scrollTop() }) }, undetached: function () { y.addClass(R.undetached) } }, setting: function (t, n) { if (S.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, T, t); else { if (n === i) return T[t]; e.isPlainObject(T[t]) ? e.extend(!0, T[t], n) : T[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, S, t); else { if (n === i) return S[t]; S[t] = n } }, debug: function () { !T.silent && T.debug && (T.performance ? S.performance.log(arguments) : (S.debug = Function.prototype.bind.call(console.info, console, T.name + ":"), S.debug.apply(console, arguments))) }, verbose: function () { !T.silent && T.verbose && T.debug && (T.performance ? S.performance.log(arguments) : (S.verbose = Function.prototype.bind.call(console.info, console, T.name + ":"), S.verbose.apply(console, arguments))) }, error: function () { T.silent || (S.error = Function.prototype.bind.call(console.error, console, T.name + ":"), S.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; T.performance && (t = (new Date).getTime(), i = d || t, n = t - i, d = t, f.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: z, "Execution Time": n })), clearTimeout(S.performance.timer), S.performance.timer = setTimeout(S.performance.display, 500) }, display: function () { var t = T.name + ":", n = 0; d = !1, clearTimeout(S.performance.timer), e.each(f, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", u && (t += " '" + u + "'"), (console.group !== i || console.table !== i) && f.length > 0 && (console.groupCollapsed(t), console.table ? console.table(f) : e.each(f, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), f = [] } }, invoke: function (t, n, o) { var r, s, l, c = I; return n = n || p, o = z || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i && (s = c[o], !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, g ? (I === i && S.initialize(), S.invoke(m)) : (I !== i && I.invoke("destroy"), S.initialize()) }), a !== i ? a : this }, e.fn.modal.settings = { name: "Modal", namespace: "modal", silent: !1, debug: !1, verbose: !1, performance: !0, observeChanges: !1, allowMultiple: !1, detachable: !0, closable: !0, autofocus: !0, inverted: !1, blurring: !1, dimmerSettings: { closable: !1, useCSS: !0 }, keyboardShortcuts: !0, context: "body", queue: !1, duration: 500, offset: 0, transition: "scale", padding: 50, onShow: function () { }, onVisible: function () { }, onHide: function () { return !0 }, onHidden: function () { }, onApprove: function () { return !0 }, onDeny: function () { return !0 }, selector: { close: "> .close", approve: ".actions .positive, .actions .approve, .actions .ok", deny: ".actions .negative, .actions .deny, .actions .cancel", modal: ".ui.modal" }, error: { dimmer: "UI Dimmer, a required component is not included in this page", method: "The method you called is not defined.", notFound: "The element you specified could not be found" }, className: { active: "active", animating: "animating", blurring: "blurring", scrolling: "scrolling", undetached: "undetached" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.nag = function (n) { var o, a = e(this), r = a.selector || "", s = (new Date).getTime(), l = [], c = arguments[0], u = "string" == typeof c, d = [].slice.call(arguments, 1); return a.each(function () { var a, f = e.isPlainObject(n) ? e.extend(!0, {}, e.fn.nag.settings, n) : e.extend({}, e.fn.nag.settings), m = (f.className, f.selector), g = f.error, p = f.namespace, h = "." + p, v = p + "-module", b = e(this), y = (b.find(m.close), e(f.context ? f.context : "body")), x = this, C = b.data(v); t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }; a = { initialize: function () { a.verbose("Initializing element"), b.on("click" + h, m.close, a.dismiss).data(v, a), f.detachable && b.parent()[0] !== y[0] && b.detach().prependTo(y), f.displayTime > 0 && setTimeout(a.hide, f.displayTime), a.show() }, destroy: function () { a.verbose("Destroying instance"), b.removeData(v).off(h) }, show: function () { a.should.show() && !b.is(":visible") && (a.debug("Showing nag", f.animation.show), "fade" == f.animation.show ? b.fadeIn(f.duration, f.easing) : b.slideDown(f.duration, f.easing)) }, hide: function () { a.debug("Showing nag", f.animation.hide), "fade" == f.animation.show ? b.fadeIn(f.duration, f.easing) : b.slideUp(f.duration, f.easing) }, onHide: function () { a.debug("Removing nag", f.animation.hide), b.remove(), f.onHide && f.onHide() }, dismiss: function (e) { f.storageMethod && a.storage.set(f.key, f.value), a.hide(), e.stopImmediatePropagation(), e.preventDefault() }, should: { show: function () { return f.persist ? (a.debug("Persistent nag is set, can show nag"), !0) : a.storage.get(f.key) != f.value.toString() ? (a.debug("Stored value is not set, can show nag", a.storage.get(f.key)), !0) : (a.debug("Stored value is set, cannot show nag", a.storage.get(f.key)), !1) } }, get: { storageOptions: function () { var e = {}; return f.expires && (e.expires = f.expires), f.domain && (e.domain = f.domain), f.path && (e.path = f.path), e } }, clear: function () { a.storage.remove(f.key) }, storage: { set: function (n, o) { var r = a.get.storageOptions(); if ("localstorage" == f.storageMethod && t.localStorage !== i) t.localStorage.setItem(n, o), a.debug("Value stored using local storage", n, o); else if ("sessionstorage" == f.storageMethod && t.sessionStorage !== i) t.sessionStorage.setItem(n, o), a.debug("Value stored using session storage", n, o); else { if (e.cookie === i) return void a.error(g.noCookieStorage); e.cookie(n, o, r), a.debug("Value stored using cookie", n, o, r) } }, get: function (n, o) { var r; return "localstorage" == f.storageMethod && t.localStorage !== i ? r = t.localStorage.getItem(n) : "sessionstorage" == f.storageMethod && t.sessionStorage !== i ? r = t.sessionStorage.getItem(n) : e.cookie !== i ? r = e.cookie(n) : a.error(g.noCookieStorage), "undefined" != r && "null" != r && r !== i && null !== r || (r = i), r }, remove: function (n) { var o = a.get.storageOptions(); "localstorage" == f.storageMethod && t.localStorage !== i ? t.localStorage.removeItem(n) : "sessionstorage" == f.storageMethod && t.sessionStorage !== i ? t.sessionStorage.removeItem(n) : e.cookie !== i ? e.removeCookie(n, o) : a.error(g.noStorage) } }, setting: function (t, n) { if (a.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, f, t); else { if (n === i) return f[t]; e.isPlainObject(f[t]) ? e.extend(!0, f[t], n) : f[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, a, t); else { if (n === i) return a[t]; a[t] = n } }, debug: function () { !f.silent && f.debug && (f.performance ? a.performance.log(arguments) : (a.debug = Function.prototype.bind.call(console.info, console, f.name + ":"), a.debug.apply(console, arguments))) }, verbose: function () { !f.silent && f.verbose && f.debug && (f.performance ? a.performance.log(arguments) : (a.verbose = Function.prototype.bind.call(console.info, console, f.name + ":"), a.verbose.apply(console, arguments))) }, error: function () { f.silent || (a.error = Function.prototype.bind.call(console.error, console, f.name + ":"), a.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; f.performance && (t = (new Date).getTime(), i = s || t, n = t - i, s = t, l.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: x, "Execution Time": n })), clearTimeout(a.performance.timer), a.performance.timer = setTimeout(a.performance.display, 500) }, display: function () { var t = f.name + ":", n = 0; s = !1, clearTimeout(a.performance.timer), e.each(l, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", r && (t += " '" + r + "'"), (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, n, r) { var s, l, c, u = C; return n = n || d, r = x || r, "string" == typeof t && u !== i && (t = t.split(/[\. ]/), s = t.length - 1, e.each(t, function (n, o) { var r = n != s ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(u[r]) && n != s) u = u[r]; else { if (u[r] !== i) return l = u[r], !1; if (!e.isPlainObject(u[o]) || n == s) return u[o] !== i ? (l = u[o], !1) : (a.error(g.method, t), !1); u = u[o] } })), e.isFunction(l) ? c = l.apply(r, n) : l !== i && (c = l), e.isArray(o) ? o.push(c) : o !== i ? o = [o, c] : c !== i && (o = c), l } }, u ? (C === i && a.initialize(), a.invoke(c)) : (C !== i && C.invoke("destroy"), a.initialize()) }), o !== i ? o : this }, e.fn.nag.settings = { name: "Nag", silent: !1, debug: !1, verbose: !1, performance: !0, namespace: "Nag", persist: !1, displayTime: 0, animation: { show: "slide", hide: "slide" }, context: !1, detachable: !1, expires: 30, domain: !1, path: "/", storageMethod: "cookie", key: "nag", value: "dismiss", error: { noCookieStorage: "$.cookie is not included. A storage solution is required.", noStorage: "Neither $.cookie or store is defined. A storage solution is required for storing state", method: "The method you called is not defined." }, className: { bottom: "bottom", fixed: "fixed" }, selector: { close: ".close.icon" }, speed: 500, easing: "easeOutQuad", onHide: function () { } }, e.extend(e.easing, { easeOutQuad: function (e, t, n, i, o) { return -i * (t /= o) * (t - 2) + n } }) }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.popup = function (o) { var a, r = e(this), s = e(n), l = e(t), c = e("body"), u = r.selector || "", d = !0, f = (new Date).getTime(), m = [], g = arguments[0], p = "string" == typeof g, h = [].slice.call(arguments, 1); return r.each(function () { var r, v, b, y, x, C, w = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.popup.settings, o) : e.extend({}, e.fn.popup.settings), k = w.selector, S = w.className, T = w.error, A = w.metadata, R = w.namespace, P = "." + w.namespace, E = "module-" + R, F = e(this), O = e(w.context), D = e(w.scrollContext), q = e(w.boundary), j = w.target ? e(w.target) : F, z = 0, I = !1, M = !1, L = this, N = F.data(E); C = { initialize: function () { C.debug("Initializing", F), C.createID(), C.bind.events(), !C.exists() && w.preserve && C.create(), w.observeChanges && C.observeChanges(), C.instantiate() }, instantiate: function () { C.verbose("Storing instance", C), N = C, F.data(E, N) }, observeChanges: function () { "MutationObserver" in t && (b = new MutationObserver(C.event.documentChanged), b.observe(n, { childList: !0, subtree: !0 }), C.debug("Setting up mutation observer", b)) }, refresh: function () { w.popup ? r = e(w.popup).eq(0) : w.inline && (r = j.nextAll(k.popup).eq(0), w.popup = r), w.popup ? (r.addClass(S.loading), v = C.get.offsetParent(), r.removeClass(S.loading), w.movePopup && C.has.popup() && C.get.offsetParent(r)[0] !== v[0] && (C.debug("Moving popup to the same offset parent as activating element"), r.detach().appendTo(v))) : v = w.inline ? C.get.offsetParent(j) : C.has.popup() ? C.get.offsetParent(r) : c, v.is("html") && v[0] !== c[0] && (C.debug("Setting page as offset parent"), v = c), C.get.variation() && C.set.variation() }, reposition: function () { C.refresh(), C.set.position() }, destroy: function () { C.debug("Destroying previous module"), b && b.disconnect(), r && !w.preserve && C.removePopup(), clearTimeout(C.hideTimer), clearTimeout(C.showTimer), C.unbind.close(), C.unbind.events(), F.removeData(E) }, event: { start: function (t) { var n = e.isPlainObject(w.delay) ? w.delay.show : w.delay; clearTimeout(C.hideTimer), M || (C.showTimer = setTimeout(C.show, n)) }, end: function () { var t = e.isPlainObject(w.delay) ? w.delay.hide : w.delay; clearTimeout(C.showTimer), C.hideTimer = setTimeout(C.hide, t) }, touchstart: function (e) { M = !0, C.show() }, resize: function () { C.is.visible() && C.set.position() }, documentChanged: function (t) { [].forEach.call(t, function (t) { t.removedNodes && [].forEach.call(t.removedNodes, function (t) { (t == L || e(t).find(L).length > 0) && (C.debug("Element removed from DOM, tearing down events"), C.destroy()) }) }) }, hideGracefully: function (t) { var i = e(t.target), o = e.contains(n.documentElement, t.target), a = i.closest(k.popup).length > 0; t && !a && o ? (C.debug("Click occurred outside popup hiding popup"), C.hide()) : C.debug("Click was inside popup, keeping popup open") } }, create: function () { var t = C.get.html(), n = C.get.title(), i = C.get.content(); t || i || n ? (C.debug("Creating pop-up html"), t || (t = w.templates.popup({ title: n, content: i })), r = e("<div/>").addClass(S.popup).data(A.activator, F).html(t), w.inline ? (C.verbose("Inserting popup element inline", r), r.insertAfter(F)) : (C.verbose("Appending popup element to body", r), r.appendTo(O)), C.refresh(), C.set.variation(), w.hoverable && C.bind.popup(), w.onCreate.call(r, L)) : 0 !== j.next(k.popup).length ? (C.verbose("Pre-existing popup found"), w.inline = !0, w.popup = j.next(k.popup).data(A.activator, F), C.refresh(), w.hoverable && C.bind.popup()) : w.popup ? (e(w.popup).data(A.activator, F), C.verbose("Used popup specified in settings"), C.refresh(), w.hoverable && C.bind.popup()) : C.debug("No content specified skipping display", L) }, createID: function () { x = (Math.random().toString(16) + "000000000").substr(2, 8), y = "." + x, C.verbose("Creating unique id for element", x) }, toggle: function () { C.debug("Toggling pop-up"), C.is.hidden() ? (C.debug("Popup is hidden, showing pop-up"), C.unbind.close(), C.show()) : (C.debug("Popup is visible, hiding pop-up"), C.hide()) }, show: function (e) { if (e = e || function () { }, C.debug("Showing pop-up", w.transition), C.is.hidden() && (!C.is.active() || !C.is.dropdown())) { if (C.exists() || C.create(), w.onShow.call(r, L) === !1) return void C.debug("onShow callback returned false, cancelling popup animation"); w.preserve || w.popup || C.refresh(), r && C.set.position() && (C.save.conditions(), w.exclusive && C.hideAll(), C.animate.show(e)) } }, hide: function (e) { if (e = e || function () { }, C.is.visible() || C.is.animating()) { if (w.onHide.call(r, L) === !1) return void C.debug("onHide callback returned false, cancelling popup animation"); C.remove.visible(), C.unbind.close(), C.restore.conditions(), C.animate.hide(e) } }, hideAll: function () { e(k.popup).filter("." + S.visible).each(function () { e(this).data(A.activator).popup("hide") }) }, exists: function () { return !!r && (w.inline || w.popup ? C.has.popup() : r.closest(O).length >= 1) }, removePopup: function () { C.has.popup() && !w.popup && (C.debug("Removing popup", r), r.remove(), r = i, w.onRemove.call(r, L)) }, save: { conditions: function () { C.cache = { title: F.attr("title") }, C.cache.title && F.removeAttr("title"), C.verbose("Saving original attributes", C.cache.title) } }, restore: { conditions: function () { return C.cache && C.cache.title && (F.attr("title", C.cache.title), C.verbose("Restoring original attributes", C.cache.title)), !0 } }, supports: { svg: function () { return typeof SVGGraphicsElement === i } }, animate: { show: function (t) { t = e.isFunction(t) ? t : function () { }, w.transition && e.fn.transition !== i && F.transition("is supported") ? (C.set.visible(), r.transition({ animation: w.transition + " in", queue: !1, debug: w.debug, verbose: w.verbose, duration: w.duration, onComplete: function () { C.bind.close(), t.call(r, L), w.onVisible.call(r, L) } })) : C.error(T.noTransition) }, hide: function (t) { return t = e.isFunction(t) ? t : function () { }, C.debug("Hiding pop-up"), w.onHide.call(r, L) === !1 ? void C.debug("onHide callback returned false, cancelling popup animation") : void (w.transition && e.fn.transition !== i && F.transition("is supported") ? r.transition({ animation: w.transition + " out", queue: !1, duration: w.duration, debug: w.debug, verbose: w.verbose, onComplete: function () { C.reset(), t.call(r, L), w.onHidden.call(r, L) } }) : C.error(T.noTransition)) } }, change: { content: function (e) { r.html(e) } }, get: { html: function () { return F.removeData(A.html), F.data(A.html) || w.html }, title: function () { return F.removeData(A.title), F.data(A.title) || w.title }, content: function () { return F.removeData(A.content), F.data(A.content) || F.attr("title") || w.content }, variation: function () { return F.removeData(A.variation), F.data(A.variation) || w.variation }, popup: function () { return r }, popupOffset: function () { return r.offset() }, calculations: function () { var e, n = j[0], i = q[0] == t, o = w.inline || w.popup && w.movePopup ? j.position() : j.offset(), a = i ? { top: 0, left: 0 } : q.offset(), s = {}, c = i ? { top: l.scrollTop(), left: l.scrollLeft() } : { top: 0, left: 0 }; return s = { target: { element: j[0], width: j.outerWidth(), height: j.outerHeight(), top: o.top, left: o.left, margin: {} }, popup: { width: r.outerWidth(), height: r.outerHeight() }, parent: { width: v.outerWidth(), height: v.outerHeight() }, screen: { top: a.top, left: a.left, scroll: { top: c.top, left: c.left }, width: q.width(), height: q.height() } }, w.setFluidWidth && C.is.fluid() && (s.container = { width: r.parent().outerWidth() }, s.popup.width = s.container.width), s.target.margin.top = w.inline ? parseInt(t.getComputedStyle(n).getPropertyValue("margin-top"), 10) : 0, s.target.margin.left = w.inline ? C.is.rtl() ? parseInt(t.getComputedStyle(n).getPropertyValue("margin-right"), 10) : parseInt(t.getComputedStyle(n).getPropertyValue("margin-left"), 10) : 0, e = s.screen, s.boundary = { top: e.top + e.scroll.top, bottom: e.top + e.scroll.top + e.height, left: e.left + e.scroll.left, right: e.left + e.scroll.left + e.width }, s }, id: function () { return x }, startEvent: function () { return "hover" == w.on ? "mouseenter" : "focus" == w.on && "focus" }, scrollEvent: function () { return "scroll" }, endEvent: function () { return "hover" == w.on ? "mouseleave" : "focus" == w.on && "blur" }, distanceFromBoundary: function (e, t) { var n, i, o = {}; return t = t || C.get.calculations(), n = t.popup, i = t.boundary, e && (o = { top: e.top - i.top, left: e.left - i.left, right: i.right - (e.left + n.width), bottom: i.bottom - (e.top + n.height) }, C.verbose("Distance from boundaries determined", e, o)), o }, offsetParent: function (t) { var n = t !== i ? t[0] : F[0], o = n.parentNode, a = e(o); if (o) for (var r = "none" === a.css("transform"), s = "static" === a.css("position"), l = a.is("html"); o && !l && s && r;)o = o.parentNode, a = e(o), r = "none" === a.css("transform"), s = "static" === a.css("position"), l = a.is("html"); return a && a.length > 0 ? a : e() }, positions: function () { return { "top left": !1, "top center": !1, "top right": !1, "bottom left": !1, "bottom center": !1, "bottom right": !1, "left center": !1, "right center": !1 } }, nextPosition: function (e) { var t = e.split(" "), n = t[0], i = t[1], o = { top: "bottom", bottom: "top", left: "right", right: "left" }, a = { left: "center", center: "right", right: "left" }, r = { "top left": "top center", "top center": "top right", "top right": "right center", "right center": "bottom right", "bottom right": "bottom center", "bottom center": "bottom left", "bottom left": "left center", "left center": "top left" }, s = "top" == n || "bottom" == n, l = !1, c = !1, u = !1; return I || (C.verbose("All available positions available"), I = C.get.positions()), C.debug("Recording last position tried", e), I[e] = !0, "opposite" === w.prefer && (u = [o[n], i], u = u.join(" "), l = I[u] === !0, C.debug("Trying opposite strategy", u)), "adjacent" === w.prefer && s && (u = [n, a[i]], u = u.join(" "), c = I[u] === !0, C.debug("Trying adjacent strategy", u)), (c || l) && (C.debug("Using backup position", u), u = r[e]), u } }, set: { position: function (e, t) { if (0 === j.length || 0 === r.length) return void C.error(T.notFound); var n, o, a, s, l, c, u, d; if (t = t || C.get.calculations(), e = e || F.data(A.position) || w.position, n = F.data(A.offset) || w.offset, o = w.distanceAway, a = t.target, s = t.popup, l = t.parent, 0 === a.width && 0 === a.height && !C.is.svg(a.element)) return C.debug("Popup target is hidden, no action taken"), !1; switch (w.inline && (C.debug("Adding margin to calculation", a.margin), "left center" == e || "right center" == e ? (n += a.margin.top, o += -a.margin.left) : "top left" == e || "top center" == e || "top right" == e ? (n += a.margin.left, o -= a.margin.top) : (n += a.margin.left, o += a.margin.top)), C.debug("Determining popup position from calculations", e, t), C.is.rtl() && (e = e.replace(/left|right/g, function (e) { return "left" == e ? "right" : "left" }), C.debug("RTL: Popup position updated", e)), z == w.maxSearchDepth && "string" == typeof w.lastResort && (e = w.lastResort), e) { case "top left": c = { top: "auto", bottom: l.height - a.top + o, left: a.left + n, right: "auto" }; break; case "top center": c = { bottom: l.height - a.top + o, left: a.left + a.width / 2 - s.width / 2 + n, top: "auto", right: "auto" }; break; case "top right": c = { bottom: l.height - a.top + o, right: l.width - a.left - a.width - n, top: "auto", left: "auto" }; break; case "left center": c = { top: a.top + a.height / 2 - s.height / 2 + n, right: l.width - a.left + o, left: "auto", bottom: "auto" }; break; case "right center": c = { top: a.top + a.height / 2 - s.height / 2 + n, left: a.left + a.width + o, bottom: "auto", right: "auto" }; break; case "bottom left": c = { top: a.top + a.height + o, left: a.left + n, bottom: "auto", right: "auto" }; break; case "bottom center": c = { top: a.top + a.height + o, left: a.left + a.width / 2 - s.width / 2 + n, bottom: "auto", right: "auto" }; break; case "bottom right": c = { top: a.top + a.height + o, right: l.width - a.left - a.width - n, left: "auto", bottom: "auto" } }if (c === i && C.error(T.invalidPosition, e), C.debug("Calculated popup positioning values", c), r.css(c).removeClass(S.position).addClass(e).addClass(S.loading), u = C.get.popupOffset(), d = C.get.distanceFromBoundary(u, t), C.is.offstage(d, e)) { if (C.debug("Position is outside viewport", e), z < w.maxSearchDepth) return z++, e = C.get.nextPosition(e), C.debug("Trying new position", e), !!r && C.set.position(e, t); if (!w.lastResort) return C.debug("Popup could not find a position to display", r), C.error(T.cannotPlace, L), C.remove.attempts(), C.remove.loading(), C.reset(), w.onUnplaceable.call(r, L), !1; C.debug("No position found, showing with last position") } return C.debug("Position is on stage", e), C.remove.attempts(), C.remove.loading(), w.setFluidWidth && C.is.fluid() && C.set.fluidWidth(t), !0 }, fluidWidth: function (e) { e = e || C.get.calculations(), C.debug("Automatically setting element width to parent width", e.parent.width), r.css("width", e.container.width) }, variation: function (e) { e = e || C.get.variation(), e && C.has.popup() && (C.verbose("Adding variation to popup", e), r.addClass(e)) }, visible: function () { F.addClass(S.visible) } }, remove: { loading: function () { r.removeClass(S.loading) }, variation: function (e) { e = e || C.get.variation(), e && (C.verbose("Removing variation", e), r.removeClass(e)) }, visible: function () { F.removeClass(S.visible) }, attempts: function () { C.verbose("Resetting all searched positions"), z = 0, I = !1 } }, bind: { events: function () { C.debug("Binding popup events to module"), "click" == w.on && F.on("click" + P, C.toggle), "hover" == w.on && d && F.on("touchstart" + P, C.event.touchstart), C.get.startEvent() && F.on(C.get.startEvent() + P, C.event.start).on(C.get.endEvent() + P, C.event.end), w.target && C.debug("Target set to element", j), l.on("resize" + y, C.event.resize) }, popup: function () { C.verbose("Allowing hover events on popup to prevent closing"), r && C.has.popup() && r.on("mouseenter" + P, C.event.start).on("mouseleave" + P, C.event.end) }, close: function () { (w.hideOnScroll === !0 || "auto" == w.hideOnScroll && "click" != w.on) && D.one(C.get.scrollEvent() + y, C.event.hideGracefully), "hover" == w.on && M && (C.verbose("Binding popup close event to document"), s.on("touchstart" + y, function (e) { C.verbose("Touched away from popup"), C.event.hideGracefully.call(L, e) })), "click" == w.on && w.closable && (C.verbose("Binding popup close event to document"), s.on("click" + y, function (e) { C.verbose("Clicked away from popup"), C.event.hideGracefully.call(L, e) })) } }, unbind: { events: function () { l.off(y), F.off(P) }, close: function () { s.off(y), D.off(y) } }, has: { popup: function () { return r && r.length > 0 } }, is: { offstage: function (t, n) { var i = []; return e.each(t, function (e, t) { t < -w.jitter && (C.debug("Position exceeds allowable distance from edge", e, t, n), i.push(e)) }), i.length > 0 }, svg: function (e) { return C.supports.svg() && e instanceof SVGGraphicsElement }, active: function () { return F.hasClass(S.active) }, animating: function () { return r !== i && r.hasClass(S.animating) }, fluid: function () { return r !== i && r.hasClass(S.fluid) }, visible: function () { return r !== i && r.hasClass(S.visible) }, dropdown: function () { return F.hasClass(S.dropdown) }, hidden: function () { return !C.is.visible() }, rtl: function () { return "rtl" == F.css("direction") } }, reset: function () { C.remove.visible(), w.preserve ? e.fn.transition !== i && r.transition("remove transition") : C.removePopup() }, setting: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, w, t); else { if (n === i) return w[t]; w[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, C, t); else { if (n === i) return C[t]; C[t] = n } }, debug: function () { !w.silent && w.debug && (w.performance ? C.performance.log(arguments) : (C.debug = Function.prototype.bind.call(console.info, console, w.name + ":"), C.debug.apply(console, arguments))) }, verbose: function () { !w.silent && w.verbose && w.debug && (w.performance ? C.performance.log(arguments) : (C.verbose = Function.prototype.bind.call(console.info, console, w.name + ":"), C.verbose.apply(console, arguments))) }, error: function () { w.silent || (C.error = Function.prototype.bind.call(console.error, console, w.name + ":"), C.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; w.performance && (t = (new Date).getTime(), i = f || t, n = t - i, f = t, m.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: L, "Execution Time": n })), clearTimeout(C.performance.timer), C.performance.timer = setTimeout(C.performance.display, 500) }, display: function () { var t = w.name + ":", n = 0; f = !1, clearTimeout(C.performance.timer), e.each(m, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", u && (t += " '" + u + "'"), (console.group !== i || console.table !== i) && m.length > 0 && (console.groupCollapsed(t), console.table ? console.table(m) : e.each(m, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), m = [] } }, invoke: function (t, n, o) { var r, s, l, c = N; return n = n || h, o = L || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i && (s = c[o], !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, p ? (N === i && C.initialize(), C.invoke(g)) : (N !== i && N.invoke("destroy"), C.initialize()) }), a !== i ? a : this }, e.fn.popup.settings = { name: "Popup", silent: !1, debug: !1, verbose: !1, performance: !0, namespace: "popup", observeChanges: !0, onCreate: function () { }, onRemove: function () { }, onShow: function () { }, onVisible: function () { }, onHide: function () { }, onUnplaceable: function () { }, onHidden: function () { }, on: "hover", boundary: t, addTouchEvents: !0, position: "top left", variation: "", movePopup: !0, target: !1, popup: !1, inline: !1, preserve: !1, hoverable: !1, content: !1, html: !1, title: !1, closable: !0, hideOnScroll: "auto", exclusive: !1, context: "body", scrollContext: t, prefer: "opposite", lastResort: !1, delay: { show: 50, hide: 70 }, setFluidWidth: !0, duration: 200, transition: "scale", distanceAway: 0, jitter: 2, offset: 0, maxSearchDepth: 15, error: { invalidPosition: "The position you specified is not a valid position", cannotPlace: "Popup does not fit within the boundaries of the viewport", method: "The method you called is not defined.", noTransition: "This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>", notFound: "The target or popup you specified does not exist on the page" }, metadata: { activator: "activator", content: "content", html: "html", offset: "offset", position: "position", title: "title", variation: "variation" }, className: { active: "active", animating: "animating", dropdown: "dropdown", fluid: "fluid", loading: "loading", popup: "ui popup", position: "top left center bottom right", visible: "visible" }, selector: { popup: ".ui.popup" }, templates: { escape: function (e) { var t = /[&<>"'`]/g, n = /[&<>"'`]/, i = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;", "`": "&#x60;" }, o = function (e) { return i[e] }; return n.test(e) ? e.replace(t, o) : e }, popup: function (t) { var n = "", o = e.fn.popup.settings.templates.escape; return typeof t !== i && (typeof t.title !== i && t.title && (t.title = o(t.title), n += '<div class="header">' + t.title + "</div>"), typeof t.content !== i && t.content && (t.content = o(t.content), n += '<div class="content">' + t.content + "</div>")), n } } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); e.fn.progress = function (t) { var o, a = e(this), r = a.selector || "", s = (new Date).getTime(), l = [], c = arguments[0], u = "string" == typeof c, d = [].slice.call(arguments, 1); return a.each(function () { var a, f, m = e.isPlainObject(t) ? e.extend(!0, {}, e.fn.progress.settings, t) : e.extend({}, e.fn.progress.settings), g = m.className, p = m.metadata, h = m.namespace, v = m.selector, b = m.error, y = "." + h, x = "module-" + h, C = e(this), w = e(this).find(v.bar), k = e(this).find(v.progress), S = e(this).find(v.label), T = this, A = C.data(x), R = !1; f = { initialize: function () { f.debug("Initializing progress bar", m), f.set.duration(), f.set.transitionEvent(), f.read.metadata(), f.read.settings(), f.instantiate() }, instantiate: function () { f.verbose("Storing instance of progress", f), A = f, C.data(x, f) }, destroy: function () { f.verbose("Destroying previous progress for", C), clearInterval(A.interval), f.remove.state(), C.removeData(x), A = i }, reset: function () { f.remove.nextValue(), f.update.progress(0) }, complete: function () { (f.percent === i || f.percent < 100) && (f.remove.progressPoll(), f.set.percent(100)) }, read: { metadata: function () { var e = { percent: C.data(p.percent), total: C.data(p.total), value: C.data(p.value) }; e.percent && (f.debug("Current percent value set from metadata", e.percent), f.set.percent(e.percent)), e.total && (f.debug("Total value set from metadata", e.total), f.set.total(e.total)), e.value && (f.debug("Current value set from metadata", e.value), f.set.value(e.value), f.set.progress(e.value)) }, settings: function () { m.total !== !1 && (f.debug("Current total set in settings", m.total), f.set.total(m.total)), m.value !== !1 && (f.debug("Current value set in settings", m.value), f.set.value(m.value), f.set.progress(f.value)), m.percent !== !1 && (f.debug("Current percent set in settings", m.percent), f.set.percent(m.percent)) } }, bind: { transitionEnd: function (e) { var t = f.get.transitionEnd(); w.one(t + y, function (t) { clearTimeout(f.failSafeTimer), e.call(this, t) }), f.failSafeTimer = setTimeout(function () { w.triggerHandler(t) }, m.duration + m.failSafeDelay), f.verbose("Adding fail safe timer", f.timer) } }, increment: function (e) { var t, n, i; f.has.total() ? (n = f.get.value(), e = e || 1, i = n + e) : (n = f.get.percent(), e = e || f.get.randomValue(), i = n + e, t = 100, f.debug("Incrementing percentage by", n, i)), i = f.get.normalizedValue(i), f.set.progress(i) }, decrement: function (e) { var t, n, i = f.get.total(); i ? (t = f.get.value(), e = e || 1, n = t - e, f.debug("Decrementing value by", e, t)) : (t = f.get.percent(), e = e || f.get.randomValue(), n = t - e, f.debug("Decrementing percentage by", e, t)), n = f.get.normalizedValue(n), f.set.progress(n) }, has: { progressPoll: function () { return f.progressPoll }, total: function () { return f.get.total() !== !1 } }, get: { text: function (e) { var t = f.value || 0, n = f.total || 0, i = R ? f.get.displayPercent() : f.percent || 0, o = f.total > 0 ? n - t : 100 - i; return e = e || "", e = e.replace("{value}", t).replace("{total}", n).replace("{left}", o).replace("{percent}", i), f.verbose("Adding variables to progress bar text", e), e }, normalizedValue: function (e) { if (e < 0) return f.debug("Value cannot decrement below 0"), 0; if (f.has.total()) { if (e > f.total) return f.debug("Value cannot increment above total", f.total), f.total } else if (e > 100) return f.debug("Value cannot increment above 100 percent"), 100; return e }, updateInterval: function () { return "auto" == m.updateInterval ? m.duration : m.updateInterval }, randomValue: function () { return f.debug("Generating random increment percentage"), Math.floor(Math.random() * m.random.max + m.random.min) }, numericValue: function (e) { return "string" == typeof e ? "" !== e.replace(/[^\d.]/g, "") && +e.replace(/[^\d.]/g, "") : e }, transitionEnd: function () { var e, t = n.createElement("element"), o = { transition: "transitionend", OTransition: "oTransitionEnd", MozTransition: "transitionend", WebkitTransition: "webkitTransitionEnd" }; for (e in o) if (t.style[e] !== i) return o[e] }, displayPercent: function () { var e = w.width(), t = C.width(), n = parseInt(w.css("min-width"), 10), i = e > n ? e / t * 100 : f.percent; return m.precision > 0 ? Math.round(i * (10 * m.precision)) / (10 * m.precision) : Math.round(i) }, percent: function () { return f.percent || 0 }, value: function () { return f.nextValue || f.value || 0 }, total: function () { return f.total || !1 } }, create: { progressPoll: function () { f.progressPoll = setTimeout(function () { f.update.toNextValue(), f.remove.progressPoll() }, f.get.updateInterval()) } }, is: { complete: function () { return f.is.success() || f.is.warning() || f.is.error() }, success: function () { return C.hasClass(g.success) }, warning: function () { return C.hasClass(g.warning) }, error: function () { return C.hasClass(g.error) }, active: function () { return C.hasClass(g.active) }, visible: function () { return C.is(":visible") } }, remove: { progressPoll: function () { f.verbose("Removing progress poll timer"), f.progressPoll && (clearTimeout(f.progressPoll), delete f.progressPoll) }, nextValue: function () { f.verbose("Removing progress value stored for next update"), delete f.nextValue }, state: function () { f.verbose("Removing stored state"), delete f.total, delete f.percent, delete f.value }, active: function () { f.verbose("Removing active state"), C.removeClass(g.active) }, success: function () { f.verbose("Removing success state"), C.removeClass(g.success) }, warning: function () { f.verbose("Removing warning state"), C.removeClass(g.warning) }, error: function () { f.verbose("Removing error state"), C.removeClass(g.error) } }, set: { barWidth: function (e) { e > 100 ? f.error(b.tooHigh, e) : e < 0 ? f.error(b.tooLow, e) : (w.css("width", e + "%"), C.attr("data-percent", parseInt(e, 10))) }, duration: function (e) { e = e || m.duration, e = "number" == typeof e ? e + "ms" : e, f.verbose("Setting progress bar transition duration", e), w.css({ "transition-duration": e }) }, percent: function (e) { e = "string" == typeof e ? +e.replace("%", "") : e, e = m.precision > 0 ? Math.round(e * (10 * m.precision)) / (10 * m.precision) : Math.round(e), f.percent = e, f.has.total() || (f.value = m.precision > 0 ? Math.round(e / 100 * f.total * (10 * m.precision)) / (10 * m.precision) : Math.round(e / 100 * f.total * 10) / 10, m.limitValues && (f.value = f.value > 100 ? 100 : f.value < 0 ? 0 : f.value)), f.set.barWidth(e), f.set.labelInterval(), f.set.labels(), m.onChange.call(T, e, f.value, f.total) }, labelInterval: function () { var t = function () { f.verbose("Bar finished animating, removing continuous label updates"), clearInterval(f.interval), R = !1, f.set.labels() }; clearInterval(f.interval), f.bind.transitionEnd(t), R = !0, f.interval = setInterval(function () { var t = e.contains(n.documentElement, T); t || (clearInterval(f.interval), R = !1), f.set.labels() }, m.framerate) }, labels: function () { f.verbose("Setting both bar progress and outer label text"), f.set.barLabel(), f.set.state() }, label: function (e) { e = e || "", e && (e = f.get.text(e), f.verbose("Setting label to text", e), S.text(e)) }, state: function (e) { e = e !== i ? e : f.percent, 100 === e ? m.autoSuccess && !(f.is.warning() || f.is.error() || f.is.success()) ? (f.set.success(), f.debug("Automatically triggering success at 100%")) : (f.verbose("Reached 100% removing active state"), f.remove.active(), f.remove.progressPoll()) : e > 0 ? (f.verbose("Adjusting active progress bar label", e), f.set.active()) : (f.remove.active(), f.set.label(m.text.active)) }, barLabel: function (e) { e !== i ? k.text(f.get.text(e)) : "ratio" == m.label && f.total ? (f.verbose("Adding ratio to bar label"), k.text(f.get.text(m.text.ratio))) : "percent" == m.label && (f.verbose("Adding percentage to bar label"), k.text(f.get.text(m.text.percent))) }, active: function (e) { e = e || m.text.active, f.debug("Setting active state"), m.showActivity && !f.is.active() && C.addClass(g.active), f.remove.warning(), f.remove.error(), f.remove.success(), e = m.onLabelUpdate("active", e, f.value, f.total), e && f.set.label(e), f.bind.transitionEnd(function () { m.onActive.call(T, f.value, f.total) }) }, success: function (e) { e = e || m.text.success || m.text.active, f.debug("Setting success state"), C.addClass(g.success), f.remove.active(), f.remove.warning(), f.remove.error(), f.complete(), m.text.success ? (e = m.onLabelUpdate("success", e, f.value, f.total), f.set.label(e)) : (e = m.onLabelUpdate("active", e, f.value, f.total), f.set.label(e)), f.bind.transitionEnd(function () { m.onSuccess.call(T, f.total) }) }, warning: function (e) { e = e || m.text.warning, f.debug("Setting warning state"), C.addClass(g.warning), f.remove.active(), f.remove.success(), f.remove.error(), f.complete(), e = m.onLabelUpdate("warning", e, f.value, f.total), e && f.set.label(e), f.bind.transitionEnd(function () { m.onWarning.call(T, f.value, f.total) }) }, error: function (e) { e = e || m.text.error, f.debug("Setting error state"), C.addClass(g.error), f.remove.active(), f.remove.success(), f.remove.warning(), f.complete(), e = m.onLabelUpdate("error", e, f.value, f.total), e && f.set.label(e), f.bind.transitionEnd(function () { m.onError.call(T, f.value, f.total) }) }, transitionEvent: function () { a = f.get.transitionEnd() }, total: function (e) { f.total = e }, value: function (e) { f.value = e }, progress: function (e) { f.has.progressPoll() ? (f.debug("Updated within interval, setting next update to use new value", e), f.set.nextValue(e)) : (f.debug("First update in progress update interval, immediately updating", e), f.update.progress(e), f.create.progressPoll()) }, nextValue: function (e) { f.nextValue = e } }, update: { toNextValue: function () { var e = f.nextValue; e && (f.debug("Update interval complete using last updated value", e), f.update.progress(e), f.remove.nextValue()) }, progress: function (e) { var t; e = f.get.numericValue(e), e === !1 && f.error(b.nonNumeric, e), e = f.get.normalizedValue(e), f.has.total() ? (f.set.value(e), t = e / f.total * 100, f.debug("Calculating percent complete from total", t), f.set.percent(t)) : (t = e, f.debug("Setting value to exact percentage value", t), f.set.percent(t)) } }, setting: function (t, n) { if (f.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, m, t); else { if (n === i) return m[t]; e.isPlainObject(m[t]) ? e.extend(!0, m[t], n) : m[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, f, t); else { if (n === i) return f[t]; f[t] = n } }, debug: function () { !m.silent && m.debug && (m.performance ? f.performance.log(arguments) : (f.debug = Function.prototype.bind.call(console.info, console, m.name + ":"), f.debug.apply(console, arguments))) }, verbose: function () { !m.silent && m.verbose && m.debug && (m.performance ? f.performance.log(arguments) : (f.verbose = Function.prototype.bind.call(console.info, console, m.name + ":"), f.verbose.apply(console, arguments))) }, error: function () { m.silent || (f.error = Function.prototype.bind.call(console.error, console, m.name + ":"), f.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; m.performance && (t = (new Date).getTime(), i = s || t, n = t - i, s = t, l.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: T, "Execution Time": n })), clearTimeout(f.performance.timer), f.performance.timer = setTimeout(f.performance.display, 500) }, display: function () { var t = m.name + ":", n = 0; s = !1, clearTimeout(f.performance.timer), e.each(l, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", r && (t += " '" + r + "'"), (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, n, a) { var r, s, l, c = A; return n = n || d, a = T || a, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (f.error(b.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(a, n) : s !== i && (l = s), e.isArray(o) ? o.push(l) : o !== i ? o = [o, l] : l !== i && (o = l), s } }, u ? (A === i && f.initialize(), f.invoke(c)) : (A !== i && A.invoke("destroy"), f.initialize()) }), o !== i ? o : this }, e.fn.progress.settings = { name: "Progress", namespace: "progress", silent: !1, debug: !1, verbose: !1, performance: !0, random: { min: 2, max: 5 }, duration: 300, updateInterval: "auto", autoSuccess: !0, showActivity: !0, limitValues: !0, label: "percent", precision: 0, framerate: 1e3 / 30, percent: !1, total: !1, value: !1, failSafeDelay: 100, onLabelUpdate: function (e, t, n, i) { return t }, onChange: function (e, t, n) { }, onSuccess: function (e) { }, onActive: function (e, t) { }, onError: function (e, t) { }, onWarning: function (e, t) { }, error: { method: "The method you called is not defined.", nonNumeric: "Progress value is non numeric", tooHigh: "Value specified is above 100%", tooLow: "Value specified is below 0%" }, regExp: { variable: /\{\$*[A-z0-9]+\}/g }, metadata: { percent: "percent", total: "total", value: "value" }, selector: { bar: "> .bar", label: "> .label", progress: ".bar > .progress" }, text: { active: !1, error: !1, success: !1, warning: !1, percent: "{percent}%", ratio: "{value} of {total}" }, className: { active: "active", error: "error", success: "success", warning: "warning" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.rating = function (t) { var n, o = e(this), a = o.selector || "", r = (new Date).getTime(), s = [], l = arguments[0], c = "string" == typeof l, u = [].slice.call(arguments, 1); return o.each(function () { var d, f, m = e.isPlainObject(t) ? e.extend(!0, {}, e.fn.rating.settings, t) : e.extend({}, e.fn.rating.settings), g = m.namespace, p = m.className, h = m.metadata, v = m.selector, b = (m.error, "." + g), y = "module-" + g, x = this, C = e(this).data(y), w = e(this), k = w.find(v.icon); f = { initialize: function () { f.verbose("Initializing rating module", m), 0 === k.length && f.setup.layout(), m.interactive ? f.enable() : f.disable(), f.set.initialLoad(), f.set.rating(f.get.initialRating()), f.remove.initialLoad(), f.instantiate() }, instantiate: function () { f.verbose("Instantiating module", m), C = f, w.data(y, f) }, destroy: function () { f.verbose("Destroying previous instance", C), f.remove.events(), w.removeData(y) }, refresh: function () { k = w.find(v.icon) }, setup: { layout: function () { var t = f.get.maxRating(), n = e.fn.rating.settings.templates.icon(t); f.debug("Generating icon html dynamically"), w.html(n), f.refresh() } }, event: { mouseenter: function () { var t = e(this); t.nextAll().removeClass(p.selected), w.addClass(p.selected), t.addClass(p.selected).prevAll().addClass(p.selected) }, mouseleave: function () { w.removeClass(p.selected), k.removeClass(p.selected) }, click: function () { var t = e(this), n = f.get.rating(), i = k.index(t) + 1, o = "auto" == m.clearable ? 1 === k.length : m.clearable; o && n == i ? f.clearRating() : f.set.rating(i) } }, clearRating: function () { f.debug("Clearing current rating"), f.set.rating(0) }, bind: { events: function () { f.verbose("Binding events"), w.on("mouseenter" + b, v.icon, f.event.mouseenter).on("mouseleave" + b, v.icon, f.event.mouseleave).on("click" + b, v.icon, f.event.click) } }, remove: { events: function () { f.verbose("Removing events"), w.off(b) }, initialLoad: function () { d = !1 } }, enable: function () { f.debug("Setting rating to interactive mode"), f.bind.events(), w.removeClass(p.disabled) }, disable: function () { f.debug("Setting rating to read-only mode"), f.remove.events(), w.addClass(p.disabled) }, is: { initialLoad: function () { return d } }, get: { initialRating: function () { return w.data(h.rating) !== i ? (w.removeData(h.rating), w.data(h.rating)) : m.initialRating }, maxRating: function () { return w.data(h.maxRating) !== i ? (w.removeData(h.maxRating), w.data(h.maxRating)) : m.maxRating }, rating: function () { var e = k.filter("." + p.active).length; return f.verbose("Current rating retrieved", e), e } }, set: { rating: function (e) { var t = e - 1 >= 0 ? e - 1 : 0, n = k.eq(t); w.removeClass(p.selected), k.removeClass(p.selected).removeClass(p.active), e > 0 && (f.verbose("Setting current rating to", e), n.prevAll().addBack().addClass(p.active)), f.is.initialLoad() || m.onRate.call(x, e) }, initialLoad: function () { d = !0 } }, setting: function (t, n) { if (f.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, m, t); else { if (n === i) return m[t]; e.isPlainObject(m[t]) ? e.extend(!0, m[t], n) : m[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, f, t); else { if (n === i) return f[t]; f[t] = n } }, debug: function () { !m.silent && m.debug && (m.performance ? f.performance.log(arguments) : (f.debug = Function.prototype.bind.call(console.info, console, m.name + ":"), f.debug.apply(console, arguments))) }, verbose: function () { !m.silent && m.verbose && m.debug && (m.performance ? f.performance.log(arguments) : (f.verbose = Function.prototype.bind.call(console.info, console, m.name + ":"), f.verbose.apply(console, arguments))) }, error: function () { m.silent || (f.error = Function.prototype.bind.call(console.error, console, m.name + ":"), f.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; m.performance && (t = (new Date).getTime(), i = r || t, n = t - i, r = t, s.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: x, "Execution Time": n })), clearTimeout(f.performance.timer), f.performance.timer = setTimeout(f.performance.display, 500) }, display: function () { var t = m.name + ":", n = 0; r = !1, clearTimeout(f.performance.timer), e.each(s, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", a && (t += " '" + a + "'"), o.length > 1 && (t += " (" + o.length + ")"), (console.group !== i || console.table !== i) && s.length > 0 && (console.groupCollapsed(t), console.table ? console.table(s) : e.each(s, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), s = [] } }, invoke: function (t, o, a) { var r, s, l, c = C; return o = o || u, a = x || a, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i && (s = c[o], !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(a, o) : s !== i && (l = s), e.isArray(n) ? n.push(l) : n !== i ? n = [n, l] : l !== i && (n = l), s } }, c ? (C === i && f.initialize(), f.invoke(l)) : (C !== i && C.invoke("destroy"), f.initialize()) }), n !== i ? n : this }, e.fn.rating.settings = { name: "Rating", namespace: "rating", slent: !1, debug: !1, verbose: !1, performance: !0, initialRating: 0, interactive: !0, maxRating: 4, clearable: "auto", fireOnInit: !1, onRate: function (e) { }, error: { method: "The method you called is not defined", noMaximum: "No maximum rating specified. Cannot generate HTML automatically" }, metadata: { rating: "rating", maxRating: "maxRating" }, className: { active: "active", disabled: "disabled", selected: "selected", loading: "loading" }, selector: { icon: ".icon" }, templates: { icon: function (e) { for (var t = 1, n = ""; t <= e;)n += '<i class="icon"></i>', t++; return n } } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.search = function (o) { var a, r = e(this), s = r.selector || "", l = (new Date).getTime(), c = [], u = arguments[0], d = "string" == typeof u, f = [].slice.call(arguments, 1); return e(this).each(function () { var m, g = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.search.settings, o) : e.extend({}, e.fn.search.settings), p = g.className, h = g.metadata, v = g.regExp, b = g.fields, y = g.selector, x = g.error, C = g.namespace, w = "." + C, k = C + "-module", S = e(this), T = S.find(y.prompt), A = S.find(y.searchButton), R = S.find(y.results), P = S.find(y.result), E = S.find(y.category), F = this, O = S.data(k), D = !1, q = !1; m = { initialize: function () { m.verbose("Initializing module"), m.determine.searchFields(), m.bind.events(), m.set.type(), m.create.results(), m.instantiate() }, instantiate: function () { m.verbose("Storing instance of module", m), O = m, S.data(k, m) }, destroy: function () { m.verbose("Destroying instance"), S.off(w).removeData(k) }, refresh: function () { m.debug("Refreshing selector cache"), T = S.find(y.prompt), A = S.find(y.searchButton), E = S.find(y.category), R = S.find(y.results), P = S.find(y.result) }, refreshResults: function () { R = S.find(y.results), P = S.find(y.result) }, bind: { events: function () { m.verbose("Binding events to search"), g.automatic && (S.on(m.get.inputEvent() + w, y.prompt, m.event.input), T.attr("autocomplete", "off")), S.on("focus" + w, y.prompt, m.event.focus).on("blur" + w, y.prompt, m.event.blur).on("keydown" + w, y.prompt, m.handleKeyboard).on("click" + w, y.searchButton, m.query).on("mousedown" + w, y.results, m.event.result.mousedown).on("mouseup" + w, y.results, m.event.result.mouseup).on("click" + w, y.result, m.event.result.click) } }, determine: { searchFields: function () { o && o.searchFields !== i && (g.searchFields = o.searchFields) } }, event: { input: function () { clearTimeout(m.timer), m.timer = setTimeout(m.query, g.searchDelay) }, focus: function () { m.set.focus(), g.searchOnFocus && m.has.minimumCharacters() && m.query(function () { m.can.show() && m.showResults() }) }, blur: function (e) { var t = n.activeElement === this, i = function () { m.cancel.query(), m.remove.focus(), m.timer = setTimeout(m.hideResults, g.hideDelay) }; t || (q = !1, m.resultsClicked ? (m.debug("Determining if user action caused search to close"), S.one("click.close" + w, y.results, function (e) { return m.is.inMessage(e) || D ? void T.focus() : (D = !1, void (m.is.animating() || m.is.hidden() || i())) })) : (m.debug("Input blurred without user action, closing results"), i())) }, result: { mousedown: function () { m.resultsClicked = !0 }, mouseup: function () { m.resultsClicked = !1 }, click: function (n) { m.debug("Search result selected"); var i = e(this), o = i.find(y.title).eq(0), a = i.is("a[href]") ? i : i.find("a[href]").eq(0), r = a.attr("href") || !1, s = a.attr("target") || !1, l = (o.html(), o.length > 0 && o.text()), c = m.get.results(), u = i.data(h.result) || m.get.result(l, c); return e.isFunction(g.onSelect) && g.onSelect.call(F, u, c) === !1 ? (m.debug("Custom onSelect callback cancelled default select action"), void (D = !0)) : (m.hideResults(), l && m.set.value(l), void (r && (m.verbose("Opening search link found in result", a), "_blank" == s || n.ctrlKey ? t.open(r) : t.location.href = r))) } } }, handleKeyboard: function (e) { var t, n = S.find(y.result), i = S.find(y.category), o = n.filter("." + p.active), a = n.index(o), r = n.length, s = o.length > 0, l = e.which, c = { backspace: 8, enter: 13, escape: 27, upArrow: 38, downArrow: 40 }; if (l == c.escape && (m.verbose("Escape key pressed, blurring search field"), m.hideResults(), q = !0), m.is.visible()) if (l == c.enter) { if (m.verbose("Enter key pressed, selecting active result"), n.filter("." + p.active).length > 0) return m.event.result.click.call(n.filter("." + p.active), e), e.preventDefault(), !1 } else l == c.upArrow && s ? (m.verbose("Up key pressed, changing active result"), t = a - 1 < 0 ? a : a - 1, i.removeClass(p.active), n.removeClass(p.active).eq(t).addClass(p.active).closest(i).addClass(p.active), e.preventDefault()) : l == c.downArrow && (m.verbose("Down key pressed, changing active result"), t = a + 1 >= r ? a : a + 1, i.removeClass(p.active), n.removeClass(p.active).eq(t).addClass(p.active).closest(i).addClass(p.active), e.preventDefault()); else l == c.enter && (m.verbose("Enter key pressed, executing query"), m.query(), m.set.buttonPressed(), T.one("keyup", m.remove.buttonFocus)) }, setup: { api: function (t, n) { var i = { debug: g.debug, on: !1, cache: !0, action: "search", urlData: { query: t }, onSuccess: function (e) { m.parse.response.call(F, e, t), n() }, onFailure: function () { m.displayMessage(x.serverError), n() }, onAbort: function (e) { }, onError: m.error }; e.extend(!0, i, g.apiSettings), m.verbose("Setting up API request", i), S.api(i) } }, can: { useAPI: function () { return e.fn.api !== i }, show: function () { return m.is.focused() && !m.is.visible() && !m.is.empty() }, transition: function () { return g.transition && e.fn.transition !== i && S.transition("is supported") } }, is: { animating: function () { return R.hasClass(p.animating) }, hidden: function () { return R.hasClass(p.hidden) }, inMessage: function (t) { if (t.target) { var i = e(t.target), o = e.contains(n.documentElement, t.target); return o && i.closest(y.message).length > 0 } }, empty: function () { return "" === R.html() }, visible: function () { return R.filter(":visible").length > 0 }, focused: function () { return T.filter(":focus").length > 0 } }, get: { inputEvent: function () { var e = T[0], t = e !== i && e.oninput !== i ? "input" : e !== i && e.onpropertychange !== i ? "propertychange" : "keyup"; return t }, value: function () { return T.val() }, results: function () { var e = S.data(h.results); return e }, result: function (t, n) { var o = ["title", "id"], a = !1; return t = t !== i ? t : m.get.value(), n = n !== i ? n : m.get.results(), "category" === g.type ? (m.debug("Finding result that matches", t), e.each(n, function (n, i) { if (e.isArray(i.results) && (a = m.search.object(t, i.results, o)[0])) return !1 })) : (m.debug("Finding result in results object", t), a = m.search.object(t, n, o)[0]), a || !1 } }, select: { firstResult: function () { m.verbose("Selecting first result"), P.first().addClass(p.active) } }, set: { focus: function () { S.addClass(p.focus) }, loading: function () { S.addClass(p.loading) }, value: function (e) { m.verbose("Setting search input value", e), T.val(e) }, type: function (e) { e = e || g.type, "category" == g.type && S.addClass(g.type) }, buttonPressed: function () { A.addClass(p.pressed) } }, remove: { loading: function () { S.removeClass(p.loading) }, focus: function () { S.removeClass(p.focus) }, buttonPressed: function () { A.removeClass(p.pressed) } }, query: function (t) { t = e.isFunction(t) ? t : function () { }; var n = m.get.value(), i = m.read.cache(n); t = t || function () { }, m.has.minimumCharacters() ? (i ? (m.debug("Reading result from cache", n), m.save.results(i.results), m.addResults(i.html), m.inject.id(i.results), t()) : (m.debug("Querying for", n), e.isPlainObject(g.source) || e.isArray(g.source) ? (m.search.local(n), t()) : m.can.useAPI() ? m.search.remote(n, t) : (m.error(x.source), t())), g.onSearchQuery.call(F, n)) : m.hideResults() }, search: { local: function (e) { var t, n = m.search.object(e, g.content); m.set.loading(), m.save.results(n), m.debug("Returned local search results", n), t = m.generateResults({ results: n }), m.remove.loading(), m.addResults(t), m.inject.id(n), m.write.cache(e, { html: t, results: n }) }, remote: function (t, n) { n = e.isFunction(n) ? n : function () { }, S.api("is loading") && S.api("abort"), m.setup.api(t, n), S.api("query") }, object: function (t, n, o) { var a = [], r = [], s = t.toString().replace(v.escape, "\\$&"), l = new RegExp(v.beginsWith + s, "i"), c = function (t, n) { var i = e.inArray(n, a) == -1, o = e.inArray(n, r) == -1; i && o && t.push(n) }; return n = n || g.source, o = o !== i ? o : g.searchFields, e.isArray(o) || (o = [o]), n === i || n === !1 ? (m.error(x.source), []) : (e.each(o, function (i, o) { e.each(n, function (e, n) { var i = "string" == typeof n[o]; i && (n[o].search(l) !== -1 ? c(a, n) : g.searchFullText && m.fuzzySearch(t, n[o]) && c(r, n)) }) }), e.merge(a, r)) } }, fuzzySearch: function (e, t) { var n = t.length, i = e.length; if ("string" != typeof e) return !1; if (e = e.toLowerCase(), t = t.toLowerCase(), i > n) return !1; if (i === n) return e === t; e: for (var o = 0, a = 0; o < i; o++) { for (var r = e.charCodeAt(o); a < n;)if (t.charCodeAt(a++) === r) continue e; return !1 } return !0 }, parse: { response: function (e, t) { var n = m.generateResults(e); m.verbose("Parsing server response", e), e !== i && t !== i && e[b.results] !== i && (m.addResults(n), m.inject.id(e[b.results]), m.write.cache(t, { html: n, results: e[b.results] }), m.save.results(e[b.results])) } }, cancel: { query: function () { m.can.useAPI() && S.api("abort") } }, has: { minimumCharacters: function () { var e = m.get.value(), t = e.length; return t >= g.minCharacters }, results: function () { if (0 === R.length) return !1; var e = R.html(); return "" != e } }, clear: { cache: function (e) { var t = S.data(h.cache); e ? e && t && t[e] && (m.debug("Removing value from cache", e), delete t[e], S.data(h.cache, t)) : (m.debug("Clearing cache", e), S.removeData(h.cache)) } }, read: { cache: function (e) { var t = S.data(h.cache); return !!g.cache && (m.verbose("Checking cache for generated html for query", e), "object" == typeof t && t[e] !== i && t[e]) } }, create: { id: function (e, t) { var n, o, a = e + 1; return t !== i ? (n = String.fromCharCode(97 + t), o = n + a, m.verbose("Creating category result id", o)) : (o = a, m.verbose("Creating result id", o)), o }, results: function () { 0 === R.length && (R = e("<div />").addClass(p.results).appendTo(S)) } }, inject: { result: function (e, t, n) { m.verbose("Injecting result into results"); var o = n !== i ? R.children().eq(n).children(y.result).eq(t) : R.children(y.result).eq(t); m.verbose("Injecting results metadata", o), o.data(h.result, e) }, id: function (t) { m.debug("Injecting unique ids into results"); var n = 0, o = 0; return "category" === g.type ? e.each(t, function (t, a) { o = 0, e.each(a.results, function (e, t) { var r = a.results[e]; r.id === i && (r.id = m.create.id(o, n)), m.inject.result(r, o, n), o++ }), n++ }) : e.each(t, function (e, n) { var a = t[e]; a.id === i && (a.id = m.create.id(o)), m.inject.result(a, o), o++ }), t } }, save: { results: function (e) { m.verbose("Saving current search results to metadata", e), S.data(h.results, e) } }, write: { cache: function (e, t) { var n = S.data(h.cache) !== i ? S.data(h.cache) : {}; g.cache && (m.verbose("Writing generated html to cache", e, t), n[e] = t, S.data(h.cache, n)) } }, addResults: function (t) { return e.isFunction(g.onResultsAdd) && g.onResultsAdd.call(R, t) === !1 ? (m.debug("onResultsAdd callback cancelled default action"), !1) : void (t ? (R.html(t), m.refreshResults(), g.selectFirstResult && m.select.firstResult(), m.showResults()) : m.hideResults(function () { R.empty() })) }, showResults: function (t) { t = e.isFunction(t) ? t : function () { }, q || !m.is.visible() && m.has.results() && (m.can.transition() ? (m.debug("Showing results with css animations"), R.transition({ animation: g.transition + " in", debug: g.debug, verbose: g.verbose, duration: g.duration, onComplete: function () { t() }, queue: !0 })) : (m.debug("Showing results with javascript"), R.stop().fadeIn(g.duration, g.easing)), g.onResultsOpen.call(R)) }, hideResults: function (t) { t = e.isFunction(t) ? t : function () { }, m.is.visible() && (m.can.transition() ? (m.debug("Hiding results with css animations"), R.transition({ animation: g.transition + " out", debug: g.debug, verbose: g.verbose, duration: g.duration, onComplete: function () { t() }, queue: !0 })) : (m.debug("Hiding results with javascript"), R.stop().fadeOut(g.duration, g.easing)), g.onResultsClose.call(R)) }, generateResults: function (t) { m.debug("Generating html from response", t); var n = g.templates[g.type], i = e.isPlainObject(t[b.results]) && !e.isEmptyObject(t[b.results]), o = e.isArray(t[b.results]) && t[b.results].length > 0, a = ""; return i || o ? (g.maxResults > 0 && (i ? "standard" == g.type && m.error(x.maxResults) : t[b.results] = t[b.results].slice(0, g.maxResults)), e.isFunction(n) ? a = n(t, b) : m.error(x.noTemplate, !1)) : g.showNoResults && (a = m.displayMessage(x.noResults, "empty")), g.onResults.call(F, t), a }, displayMessage: function (e, t) { return t = t || "standard", m.debug("Displaying message", e, t), m.addResults(g.templates.message(e, t)), g.templates.message(e, t) }, setting: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, g, t); else { if (n === i) return g[t]; g[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, m, t); else { if (n === i) return m[t]; m[t] = n } }, debug: function () { !g.silent && g.debug && (g.performance ? m.performance.log(arguments) : (m.debug = Function.prototype.bind.call(console.info, console, g.name + ":"), m.debug.apply(console, arguments))) }, verbose: function () { !g.silent && g.verbose && g.debug && (g.performance ? m.performance.log(arguments) : (m.verbose = Function.prototype.bind.call(console.info, console, g.name + ":"), m.verbose.apply(console, arguments))) }, error: function () { g.silent || (m.error = Function.prototype.bind.call(console.error, console, g.name + ":"), m.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; g.performance && (t = (new Date).getTime(), i = l || t, n = t - i, l = t, c.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: F, "Execution Time": n })), clearTimeout(m.performance.timer), m.performance.timer = setTimeout(m.performance.display, 500) }, display: function () { var t = g.name + ":", n = 0; l = !1, clearTimeout(m.performance.timer), e.each(c, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", s && (t += " '" + s + "'"), r.length > 1 && (t += " (" + r.length + ")"), (console.group !== i || console.table !== i) && c.length > 0 && (console.groupCollapsed(t), console.table ? console.table(c) : e.each(c, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), c = [] } }, invoke: function (t, n, o) { var r, s, l, c = O; return n = n || f, o = F || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i && (s = c[o], !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, d ? (O === i && m.initialize(), m.invoke(u)) : (O !== i && O.invoke("destroy"), m.initialize()) }), a !== i ? a : this }, e.fn.search.settings = { name: "Search", namespace: "search", silent: !1, debug: !1, verbose: !1, performance: !0, type: "standard", minCharacters: 1, selectFirstResult: !1, apiSettings: !1, source: !1, searchOnFocus: !0, searchFields: ["title", "description"], displayField: "", searchFullText: !0, automatic: !0, hideDelay: 0, searchDelay: 200, maxResults: 7, cache: !0, showNoResults: !0, transition: "scale", duration: 200, easing: "easeOutExpo", onSelect: !1, onResultsAdd: !1, onSearchQuery: function (e) { }, onResults: function (e) { }, onResultsOpen: function () { }, onResultsClose: function () { }, className: { animating: "animating", active: "active", empty: "empty", focus: "focus", hidden: "hidden", loading: "loading", results: "results", pressed: "down" }, error: { source: "Cannot search. No source used, and Semantic API module was not included", noResults: "Your search returned no results", logging: "Error in debug logging, exiting.", noEndpoint: "No search endpoint was specified", noTemplate: "A valid template name was not specified.", serverError: "There was an issue querying the server.", maxResults: "Results must be an array to use maxResults setting", method: "The method you called is not defined." }, metadata: { cache: "cache", results: "results", result: "result" }, regExp: { escape: /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, beginsWith: "(?:s|^)" }, fields: { categories: "results", categoryName: "name", categoryResults: "results", description: "description", image: "image", price: "price", results: "results", title: "title", url: "url", action: "action", actionText: "text", actionURL: "url" }, selector: { prompt: ".prompt", searchButton: ".search.button", results: ".results", message: ".results > .message", category: ".category", result: ".result", title: ".title, .name" }, templates: { escape: function (e) { var t = /[&<>"'`]/g, n = /[&<>"'`]/, i = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;", "`": "&#x60;" }, o = function (e) { return i[e] }; return n.test(e) ? e.replace(t, o) : e }, message: function (e, t) { var n = ""; return e !== i && t !== i && (n += '<div class="message ' + t + '">', n += "empty" == t ? '<div class="header">No Results</div class="header"><div class="description">' + e + '</div class="description">' : ' <div class="description">' + e + "</div>", n += "</div>"), n }, category: function (t, n) { var o = ""; e.fn.search.settings.templates.escape; return t[n.categoryResults] !== i && (e.each(t[n.categoryResults], function (t, a) { a[n.results] !== i && a.results.length > 0 && (o += '<div class="category">', a[n.categoryName] !== i && (o += '<div class="name">' + a[n.categoryName] + "</div>"), e.each(a.results, function (e, t) { o += t[n.url] ? '<a class="result" href="' + t[n.url] + '">' : '<a class="result">', t[n.image] !== i && (o += '<div class="image"> <img src="' + t[n.image] + '"></div>'), o += '<div class="content">', t[n.price] !== i && (o += '<div class="price">' + t[n.price] + "</div>"), t[n.title] !== i && (o += '<div class="title">' + t[n.title] + "</div>"), t[n.description] !== i && (o += '<div class="description">' + t[n.description] + "</div>"), o += "</div>", o += "</a>" }), o += "</div>") }), t[n.action] && (o += '<a href="' + t[n.action][n.actionURL] + '" class="action">' + t[n.action][n.actionText] + "</a>"), o) }, standard: function (t, n) { var o = ""; return t[n.results] !== i && (e.each(t[n.results], function (e, t) { o += t[n.url] ? '<a class="result" href="' + t[n.url] + '">' : '<a class="result">', t[n.image] !== i && (o += '<div class="image"> <img src="' + t[n.image] + '"></div>'), o += '<div class="content">', t[n.price] !== i && (o += '<div class="price">' + t[n.price] + "</div>"), t[n.title] !== i && (o += '<div class="title">' + t[n.title] + "</div>"), t[n.description] !== i && (o += '<div class="description">' + t[n.description] + "</div>"), o += "</div>", o += "</a>" }), t[n.action] && (o += '<a href="' + t[n.action][n.actionURL] + '" class="action">' + t[n.action][n.actionText] + "</a>"), o) } } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.shape = function (o) { var a, r = e(this), s = (e("body"), (new Date).getTime()), l = [], c = arguments[0], u = "string" == typeof c, d = [].slice.call(arguments, 1), f = t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }; return r.each(function () { var t, m, g, p = r.selector || "", h = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.shape.settings, o) : e.extend({}, e.fn.shape.settings), v = h.namespace, b = h.selector, y = h.error, x = h.className, C = "." + v, w = "module-" + v, k = e(this), S = k.find(b.sides), T = k.find(b.side), A = !1, R = this, P = k.data(w); g = { initialize: function () { g.verbose("Initializing module for", R), g.set.defaultSide(), g.instantiate() }, instantiate: function () { g.verbose("Storing instance of module", g), P = g, k.data(w, P) }, destroy: function () { g.verbose("Destroying previous module for", R), k.removeData(w).off(C) }, refresh: function () { g.verbose("Refreshing selector cache for", R), k = e(R), S = e(this).find(b.shape), T = e(this).find(b.side) }, repaint: function () { g.verbose("Forcing repaint event"); var e = S[0] || n.createElement("div"); e.offsetWidth }, animate: function (e, n) { g.verbose("Animating box with properties", e), n = n || function (e) { g.verbose("Executing animation callback"), e !== i && e.stopPropagation(), g.reset(), g.set.active() }, h.beforeChange.call(m[0]), g.get.transitionEvent() ? (g.verbose("Starting CSS animation"), k.addClass(x.animating), S.css(e).one(g.get.transitionEvent(), n), g.set.duration(h.duration), f(function () { k.addClass(x.animating), t.addClass(x.hidden) })) : n() }, queue: function (e) { g.debug("Queueing animation of", e), S.one(g.get.transitionEvent(), function () { g.debug("Executing queued animation"), setTimeout(function () { k.shape(e) }, 0) }) }, reset: function () { g.verbose("Animating states reset"), k.removeClass(x.animating).attr("style", "").removeAttr("style"), S.attr("style", "").removeAttr("style"), T.attr("style", "").removeAttr("style").removeClass(x.hidden), m.removeClass(x.animating).attr("style", "").removeAttr("style") }, is: { complete: function () { return T.filter("." + x.active)[0] == m[0] }, animating: function () { return k.hasClass(x.animating) } }, set: { defaultSide: function () { t = k.find("." + h.className.active), m = t.next(b.side).length > 0 ? t.next(b.side) : k.find(b.side).first(), A = !1, g.verbose("Active side set to", t), g.verbose("Next side set to", m) }, duration: function (e) { e = e || h.duration, e = "number" == typeof e ? e + "ms" : e, g.verbose("Setting animation duration", e), (h.duration || 0 === h.duration) && S.add(T).css({ "-webkit-transition-duration": e, "-moz-transition-duration": e, "-ms-transition-duration": e, "-o-transition-duration": e, "transition-duration": e }) }, currentStageSize: function () { var e = k.find("." + h.className.active), t = e.outerWidth(!0), n = e.outerHeight(!0); k.css({ width: t, height: n }) }, stageSize: function () { var e = k.clone().addClass(x.loading), t = e.find("." + h.className.active), n = A ? e.find(b.side).eq(A) : t.next(b.side).length > 0 ? t.next(b.side) : e.find(b.side).first(), i = "next" == h.width ? n.outerWidth(!0) : "initial" == h.width ? k.width() : h.width, o = "next" == h.height ? n.outerHeight(!0) : "initial" == h.height ? k.height() : h.height; t.removeClass(x.active), n.addClass(x.active), e.insertAfter(k), e.remove(), "auto" != h.width && (k.css("width", i + h.jitter), g.verbose("Specifying width during animation", i)), "auto" != h.height && (k.css("height", o + h.jitter), g.verbose("Specifying height during animation", o)) }, nextSide: function (e) { A = e, m = T.filter(e), A = T.index(m), 0 === m.length && (g.set.defaultSide(), g.error(y.side)), g.verbose("Next side manually set to", m) }, active: function () { g.verbose("Setting new side to active", m), T.removeClass(x.active), m.addClass(x.active), h.onChange.call(m[0]), g.set.defaultSide() } }, flip: { up: function () { if (g.is.complete() && !g.is.animating() && !h.allowRepeats) return void g.debug("Side already visible", m); if (g.is.animating()) g.queue("flip up"); else { g.debug("Flipping up", m); var e = g.get.transform.up(); g.set.stageSize(), g.stage.above(), g.animate(e) } }, down: function () { if (g.is.complete() && !g.is.animating() && !h.allowRepeats) return void g.debug("Side already visible", m); if (g.is.animating()) g.queue("flip down"); else { g.debug("Flipping down", m); var e = g.get.transform.down(); g.set.stageSize(), g.stage.below(), g.animate(e) } }, left: function () { if (g.is.complete() && !g.is.animating() && !h.allowRepeats) return void g.debug("Side already visible", m); if (g.is.animating()) g.queue("flip left"); else { g.debug("Flipping left", m); var e = g.get.transform.left(); g.set.stageSize(), g.stage.left(), g.animate(e) } }, right: function () { if (g.is.complete() && !g.is.animating() && !h.allowRepeats) return void g.debug("Side already visible", m); if (g.is.animating()) g.queue("flip right"); else { g.debug("Flipping right", m); var e = g.get.transform.right(); g.set.stageSize(), g.stage.right(), g.animate(e) } }, over: function () { return !g.is.complete() || g.is.animating() || h.allowRepeats ? void (g.is.animating() ? g.queue("flip over") : (g.debug("Flipping over", m), g.set.stageSize(), g.stage.behind(), g.animate(g.get.transform.over()))) : void g.debug("Side already visible", m) }, back: function () { return !g.is.complete() || g.is.animating() || h.allowRepeats ? void (g.is.animating() ? g.queue("flip back") : (g.debug("Flipping back", m), g.set.stageSize(), g.stage.behind(), g.animate(g.get.transform.back()))) : void g.debug("Side already visible", m) } }, get: { transform: { up: function () { var e = { y: -((t.outerHeight(!0) - m.outerHeight(!0)) / 2), z: -(t.outerHeight(!0) / 2) }; return { transform: "translateY(" + e.y + "px) translateZ(" + e.z + "px) rotateX(-90deg)" } }, down: function () { var e = { y: -((t.outerHeight(!0) - m.outerHeight(!0)) / 2), z: -(t.outerHeight(!0) / 2) }; return { transform: "translateY(" + e.y + "px) translateZ(" + e.z + "px) rotateX(90deg)" } }, left: function () { var e = { x: -((t.outerWidth(!0) - m.outerWidth(!0)) / 2), z: -(t.outerWidth(!0) / 2) }; return { transform: "translateX(" + e.x + "px) translateZ(" + e.z + "px) rotateY(90deg)" } }, right: function () { var e = { x: -((t.outerWidth(!0) - m.outerWidth(!0)) / 2), z: -(t.outerWidth(!0) / 2) }; return { transform: "translateX(" + e.x + "px) translateZ(" + e.z + "px) rotateY(-90deg)" } }, over: function () { var e = { x: -((t.outerWidth(!0) - m.outerWidth(!0)) / 2) }; return { transform: "translateX(" + e.x + "px) rotateY(180deg)" } }, back: function () { var e = { x: -((t.outerWidth(!0) - m.outerWidth(!0)) / 2) }; return { transform: "translateX(" + e.x + "px) rotateY(-180deg)" } } }, transitionEvent: function () { var e, t = n.createElement("element"), o = { transition: "transitionend", OTransition: "oTransitionEnd", MozTransition: "transitionend", WebkitTransition: "webkitTransitionEnd" }; for (e in o) if (t.style[e] !== i) return o[e] }, nextSide: function () { return t.next(b.side).length > 0 ? t.next(b.side) : k.find(b.side).first() } }, stage: { above: function () { var e = { origin: (t.outerHeight(!0) - m.outerHeight(!0)) / 2, depth: { active: m.outerHeight(!0) / 2, next: t.outerHeight(!0) / 2 } }; g.verbose("Setting the initial animation position as above", m, e), S.css({ transform: "translateZ(-" + e.depth.active + "px)" }), t.css({ transform: "rotateY(0deg) translateZ(" + e.depth.active + "px)" }), m.addClass(x.animating).css({ top: e.origin + "px", transform: "rotateX(90deg) translateZ(" + e.depth.next + "px)" }) }, below: function () { var e = { origin: (t.outerHeight(!0) - m.outerHeight(!0)) / 2, depth: { active: m.outerHeight(!0) / 2, next: t.outerHeight(!0) / 2 } }; g.verbose("Setting the initial animation position as below", m, e), S.css({ transform: "translateZ(-" + e.depth.active + "px)" }), t.css({ transform: "rotateY(0deg) translateZ(" + e.depth.active + "px)" }), m.addClass(x.animating).css({ top: e.origin + "px", transform: "rotateX(-90deg) translateZ(" + e.depth.next + "px)" }) }, left: function () { var e = { active: t.outerWidth(!0), next: m.outerWidth(!0) }, n = { origin: (e.active - e.next) / 2, depth: { active: e.next / 2, next: e.active / 2 } }; g.verbose("Setting the initial animation position as left", m, n), S.css({ transform: "translateZ(-" + n.depth.active + "px)" }), t.css({ transform: "rotateY(0deg) translateZ(" + n.depth.active + "px)" }), m.addClass(x.animating).css({ left: n.origin + "px", transform: "rotateY(-90deg) translateZ(" + n.depth.next + "px)" }) }, right: function () { var e = { active: t.outerWidth(!0), next: m.outerWidth(!0) }, n = { origin: (e.active - e.next) / 2, depth: { active: e.next / 2, next: e.active / 2 } }; g.verbose("Setting the initial animation position as left", m, n), S.css({ transform: "translateZ(-" + n.depth.active + "px)" }), t.css({ transform: "rotateY(0deg) translateZ(" + n.depth.active + "px)" }), m.addClass(x.animating).css({ left: n.origin + "px", transform: "rotateY(90deg) translateZ(" + n.depth.next + "px)" }) }, behind: function () { var e = { active: t.outerWidth(!0), next: m.outerWidth(!0) }, n = { origin: (e.active - e.next) / 2, depth: { active: e.next / 2, next: e.active / 2 } }; g.verbose("Setting the initial animation position as behind", m, n), t.css({ transform: "rotateY(0deg)" }), m.addClass(x.animating).css({ left: n.origin + "px", transform: "rotateY(-180deg)" }) } }, setting: function (t, n) { if (g.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, h, t); else { if (n === i) return h[t]; e.isPlainObject(h[t]) ? e.extend(!0, h[t], n) : h[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, g, t); else { if (n === i) return g[t]; g[t] = n } }, debug: function () { !h.silent && h.debug && (h.performance ? g.performance.log(arguments) : (g.debug = Function.prototype.bind.call(console.info, console, h.name + ":"), g.debug.apply(console, arguments))) }, verbose: function () { !h.silent && h.verbose && h.debug && (h.performance ? g.performance.log(arguments) : (g.verbose = Function.prototype.bind.call(console.info, console, h.name + ":"), g.verbose.apply(console, arguments))) }, error: function () { h.silent || (g.error = Function.prototype.bind.call(console.error, console, h.name + ":"), g.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; h.performance && (t = (new Date).getTime(), i = s || t, n = t - i, s = t, l.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: R, "Execution Time": n })), clearTimeout(g.performance.timer), g.performance.timer = setTimeout(g.performance.display, 500) }, display: function () { var t = h.name + ":", n = 0; s = !1, clearTimeout(g.performance.timer), e.each(l, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", p && (t += " '" + p + "'"), r.length > 1 && (t += " (" + r.length + ")"), (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, n, o) { var r, s, l, c = P; return n = n || d, o = R || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i && (s = c[o], !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, u ? (P === i && g.initialize(), g.invoke(c)) : (P !== i && P.invoke("destroy"), g.initialize()) }), a !== i ? a : this }, e.fn.shape.settings = { name: "Shape", silent: !1, debug: !1, verbose: !1, jitter: 0, performance: !0, namespace: "shape", width: "initial", height: "initial", beforeChange: function () { }, onChange: function () { }, allowRepeats: !1, duration: !1, error: { side: "You tried to switch to a side that does not exist.", method: "The method you called is not defined" }, className: { animating: "animating", hidden: "hidden", loading: "loading", active: "active" }, selector: { sides: ".sides", side: ".side" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.sidebar = function (o) { var a, r = e(this), s = e(t), l = e(n), c = e("html"), u = e("head"), d = r.selector || "", f = (new Date).getTime(), m = [], g = arguments[0], p = "string" == typeof g, h = [].slice.call(arguments, 1), v = t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }; return r.each(function () { var r, b, y, x, C, w, k = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.sidebar.settings, o) : e.extend({}, e.fn.sidebar.settings), S = k.selector, T = k.className, A = k.namespace, R = k.regExp, P = k.error, E = "." + A, F = "module-" + A, O = e(this), D = e(k.context), q = O.children(S.sidebar), j = D.children(S.fixed), z = D.children(S.pusher), I = this, M = O.data(F); w = { initialize: function () { w.debug("Initializing sidebar", o), w.create.id(), C = w.get.transitionEvent(), w.is.ios() && w.set.ios(), k.delaySetup ? v(w.setup.layout) : w.setup.layout(), v(function () { w.setup.cache() }), w.instantiate() }, instantiate: function () { w.verbose("Storing instance of module", w), M = w, O.data(F, w) }, create: { id: function () { y = (Math.random().toString(16) + "000000000").substr(2, 8), b = "." + y, w.verbose("Creating unique id for element", y) } }, destroy: function () { w.verbose("Destroying previous module for", O), O.off(E).removeData(F), w.is.ios() && w.remove.ios(), D.off(b), s.off(b), l.off(b) }, event: { clickaway: function (e) { var t = z.find(e.target).length > 0 || z.is(e.target), n = D.is(e.target); t && (w.verbose("User clicked on dimmed page"), w.hide()), n && (w.verbose("User clicked on dimmable context (scaled out page)"), w.hide()) }, touch: function (e) { }, containScroll: function (e) { I.scrollTop <= 0 && (I.scrollTop = 1), I.scrollTop + I.offsetHeight >= I.scrollHeight && (I.scrollTop = I.scrollHeight - I.offsetHeight - 1) }, scroll: function (t) { 0 === e(t.target).closest(S.sidebar).length && t.preventDefault() } }, bind: { clickaway: function () { w.verbose("Adding clickaway events to context", D), k.closable && D.on("click" + b, w.event.clickaway).on("touchend" + b, w.event.clickaway) }, scrollLock: function () { k.scrollLock && (w.debug("Disabling page scroll"), s.on("DOMMouseScroll" + b, w.event.scroll)), w.verbose("Adding events to contain sidebar scroll"), l.on("touchmove" + b, w.event.touch), O.on("scroll" + E, w.event.containScroll) } }, unbind: { clickaway: function () { w.verbose("Removing clickaway events from context", D), D.off(b) }, scrollLock: function () { w.verbose("Removing scroll lock from page"), l.off(b), s.off(b), O.off("scroll" + E) } }, add: { inlineCSS: function () { var t, n = w.cache.width || O.outerWidth(), i = w.cache.height || O.outerHeight(), o = w.is.rtl(), a = w.get.direction(), s = { left: n, right: -n, top: i, bottom: -i }; o && (w.verbose("RTL detected, flipping widths"), s.left = -n, s.right = n), t = "<style>", "left" === a || "right" === a ? (w.debug("Adding CSS rules for animation distance", n), t += " .ui.visible." + a + ".sidebar ~ .fixed, .ui.visible." + a + ".sidebar ~ .pusher {   -webkit-transform: translate3d(" + s[a] + "px, 0, 0);           transform: translate3d(" + s[a] + "px, 0, 0); }") : "top" !== a && "bottom" != a || (t += " .ui.visible." + a + ".sidebar ~ .fixed, .ui.visible." + a + ".sidebar ~ .pusher {   -webkit-transform: translate3d(0, " + s[a] + "px, 0);           transform: translate3d(0, " + s[a] + "px, 0); }"), w.is.ie() && ("left" === a || "right" === a ? (w.debug("Adding CSS rules for animation distance", n), t += " body.pushable > .ui.visible." + a + ".sidebar ~ .pusher:after {   -webkit-transform: translate3d(" + s[a] + "px, 0, 0);           transform: translate3d(" + s[a] + "px, 0, 0); }") : "top" !== a && "bottom" != a || (t += " body.pushable > .ui.visible." + a + ".sidebar ~ .pusher:after {   -webkit-transform: translate3d(0, " + s[a] + "px, 0);           transform: translate3d(0, " + s[a] + "px, 0); }"), t += " body.pushable > .ui.visible.left.sidebar ~ .ui.visible.right.sidebar ~ .pusher:after, body.pushable > .ui.visible.right.sidebar ~ .ui.visible.left.sidebar ~ .pusher:after {   -webkit-transform: translate3d(0px, 0, 0);           transform: translate3d(0px, 0, 0); }"), t += "</style>", r = e(t).appendTo(u), w.debug("Adding sizing css to head", r) } }, refresh: function () { w.verbose("Refreshing selector cache"), D = e(k.context), q = D.children(S.sidebar), z = D.children(S.pusher), j = D.children(S.fixed), w.clear.cache() }, refreshSidebars: function () { w.verbose("Refreshing other sidebars"), q = D.children(S.sidebar) }, repaint: function () { w.verbose("Forcing repaint event"), I.style.display = "none"; I.offsetHeight; I.scrollTop = I.scrollTop, I.style.display = "" }, setup: { cache: function () { w.cache = { width: O.outerWidth(), height: O.outerHeight(), rtl: "rtl" == O.css("direction") } }, layout: function () { 0 === D.children(S.pusher).length && (w.debug("Adding wrapper element for sidebar"), w.error(P.pusher), z = e('<div class="pusher" />'), D.children().not(S.omitted).not(q).wrapAll(z), w.refresh()), 0 !== O.nextAll(S.pusher).length && O.nextAll(S.pusher)[0] === z[0] || (w.debug("Moved sidebar to correct parent element"), w.error(P.movedSidebar, I), O.detach().prependTo(D), w.refresh()), w.clear.cache(), w.set.pushable(), w.set.direction() } }, attachEvents: function (t, n) { var i = e(t); n = e.isFunction(w[n]) ? w[n] : w.toggle, i.length > 0 ? (w.debug("Attaching sidebar events to element", t, n), i.on("click" + E, n)) : w.error(P.notFound, t) }, show: function (t) { if (t = e.isFunction(t) ? t : function () { }, w.is.hidden()) { if (w.refreshSidebars(), k.overlay && (w.error(P.overlay), k.transition = "overlay"), w.refresh(), w.othersActive()) if (w.debug("Other sidebars currently visible"), k.exclusive) { if ("overlay" != k.transition) return void w.hideOthers(w.show); w.hideOthers() } else k.transition = "overlay"; w.pushPage(function () { t.call(I), k.onShow.call(I) }), k.onChange.call(I), k.onVisible.call(I) } else w.debug("Sidebar is already visible") }, hide: function (t) { t = e.isFunction(t) ? t : function () { }, (w.is.visible() || w.is.animating()) && (w.debug("Hiding sidebar", t), w.refreshSidebars(), w.pullPage(function () { t.call(I), k.onHidden.call(I) }), k.onChange.call(I), k.onHide.call(I)) }, othersAnimating: function () { return q.not(O).filter("." + T.animating).length > 0 }, othersVisible: function () { return q.not(O).filter("." + T.visible).length > 0 }, othersActive: function () { return w.othersVisible() || w.othersAnimating() }, hideOthers: function (e) { var t = q.not(O).filter("." + T.visible), n = t.length, i = 0; e = e || function () { }, t.sidebar("hide", function () { i++, i == n && e() }) }, toggle: function () { w.verbose("Determining toggled direction"), w.is.hidden() ? w.show() : w.hide() }, pushPage: function (t) { var n, i, o, a = w.get.transition(), r = "overlay" === a || w.othersActive() ? O : z; t = e.isFunction(t) ? t : function () { }, "scale down" == k.transition && w.scrollToTop(), w.set.transition(a), w.repaint(), n = function () { w.bind.clickaway(), w.add.inlineCSS(), w.set.animating(), w.set.visible() }, i = function () { w.set.dimmed() }, o = function (e) { e.target == r[0] && (r.off(C + b, o), w.remove.animating(), w.bind.scrollLock(), t.call(I)) }, r.off(C + b), r.on(C + b, o), v(n), k.dimPage && !w.othersVisible() && v(i) }, pullPage: function (t) { var n, i, o = w.get.transition(), a = "overlay" == o || w.othersActive() ? O : z; t = e.isFunction(t) ? t : function () { }, w.verbose("Removing context push state", w.get.direction()), w.unbind.clickaway(), w.unbind.scrollLock(), n = function () { w.set.transition(o), w.set.animating(), w.remove.visible(), k.dimPage && !w.othersVisible() && z.removeClass(T.dimmed) }, i = function (e) { e.target == a[0] && (a.off(C + b, i), w.remove.animating(), w.remove.transition(), w.remove.inlineCSS(), ("scale down" == o || k.returnScroll && w.is.mobile()) && w.scrollBack(), t.call(I)) }, a.off(C + b), a.on(C + b, i), v(n) }, scrollToTop: function () { w.verbose("Scrolling to top of page to avoid animation issues"), x = e(t).scrollTop(), O.scrollTop(0), t.scrollTo(0, 0) }, scrollBack: function () { w.verbose("Scrolling back to original page position"), t.scrollTo(0, x) }, clear: { cache: function () { w.verbose("Clearing cached dimensions"), w.cache = {} } }, set: { ios: function () { c.addClass(T.ios) }, pushed: function () { D.addClass(T.pushed) }, pushable: function () { D.addClass(T.pushable) }, dimmed: function () { z.addClass(T.dimmed) }, active: function () { O.addClass(T.active) }, animating: function () { O.addClass(T.animating) }, transition: function (e) { e = e || w.get.transition(), O.addClass(e) }, direction: function (e) { e = e || w.get.direction(), O.addClass(T[e]) }, visible: function () { O.addClass(T.visible) }, overlay: function () { O.addClass(T.overlay) } }, remove: { inlineCSS: function () { w.debug("Removing inline css styles", r), r && r.length > 0 && r.remove() }, ios: function () { c.removeClass(T.ios) }, pushed: function () { D.removeClass(T.pushed) }, pushable: function () { D.removeClass(T.pushable) }, active: function () { O.removeClass(T.active) }, animating: function () { O.removeClass(T.animating) }, transition: function (e) { e = e || w.get.transition(), O.removeClass(e) }, direction: function (e) { e = e || w.get.direction(), O.removeClass(T[e]) }, visible: function () { O.removeClass(T.visible) }, overlay: function () { O.removeClass(T.overlay) } }, get: { direction: function () { return O.hasClass(T.top) ? T.top : O.hasClass(T.right) ? T.right : O.hasClass(T.bottom) ? T.bottom : T.left }, transition: function () { var e, t = w.get.direction(); return e = w.is.mobile() ? "auto" == k.mobileTransition ? k.defaultTransition.mobile[t] : k.mobileTransition : "auto" == k.transition ? k.defaultTransition.computer[t] : k.transition, w.verbose("Determined transition", e), e }, transitionEvent: function () { var e, t = n.createElement("element"), o = { transition: "transitionend", OTransition: "oTransitionEnd", MozTransition: "transitionend", WebkitTransition: "webkitTransitionEnd" }; for (e in o) if (t.style[e] !== i) return o[e] } }, is: { ie: function () { var e = !t.ActiveXObject && "ActiveXObject" in t, n = "ActiveXObject" in t; return e || n }, ios: function () { var e = navigator.userAgent, t = e.match(R.ios), n = e.match(R.mobileChrome); return !(!t || n) && (w.verbose("Browser was found to be iOS", e), !0) }, mobile: function () { var e = navigator.userAgent, t = e.match(R.mobile); return t ? (w.verbose("Browser was found to be mobile", e), !0) : (w.verbose("Browser is not mobile, using regular transition", e), !1) }, hidden: function () { return !w.is.visible() }, visible: function () { return O.hasClass(T.visible) }, open: function () { return w.is.visible() }, closed: function () { return w.is.hidden() }, vertical: function () { return O.hasClass(T.top) }, animating: function () { return D.hasClass(T.animating) }, rtl: function () { return w.cache.rtl === i && (w.cache.rtl = "rtl" == O.css("direction")), w.cache.rtl } }, setting: function (t, n) { if (w.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, k, t); else { if (n === i) return k[t]; e.isPlainObject(k[t]) ? e.extend(!0, k[t], n) : k[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, w, t); else { if (n === i) return w[t]; w[t] = n } }, debug: function () { !k.silent && k.debug && (k.performance ? w.performance.log(arguments) : (w.debug = Function.prototype.bind.call(console.info, console, k.name + ":"), w.debug.apply(console, arguments))) }, verbose: function () { !k.silent && k.verbose && k.debug && (k.performance ? w.performance.log(arguments) : (w.verbose = Function.prototype.bind.call(console.info, console, k.name + ":"), w.verbose.apply(console, arguments))) }, error: function () { k.silent || (w.error = Function.prototype.bind.call(console.error, console, k.name + ":"), w.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; k.performance && (t = (new Date).getTime(), i = f || t, n = t - i, f = t, m.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: I, "Execution Time": n })), clearTimeout(w.performance.timer), w.performance.timer = setTimeout(w.performance.display, 500) }, display: function () { var t = k.name + ":", n = 0; f = !1, clearTimeout(w.performance.timer), e.each(m, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", d && (t += " '" + d + "'"), (console.group !== i || console.table !== i) && m.length > 0 && (console.groupCollapsed(t), console.table ? console.table(m) : e.each(m, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), m = [] } }, invoke: function (t, n, o) { var r, s, l, c = M; return n = n || h, o = I || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (w.error(P.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, p ? (M === i && w.initialize(), w.invoke(g)) : (M !== i && w.invoke("destroy"), w.initialize()) }), a !== i ? a : this }, e.fn.sidebar.settings = { name: "Sidebar", namespace: "sidebar", silent: !1, debug: !1, verbose: !1, performance: !0, transition: "auto", mobileTransition: "auto", defaultTransition: { computer: { left: "uncover", right: "uncover", top: "overlay", bottom: "overlay" }, mobile: { left: "uncover", right: "uncover", top: "overlay", bottom: "overlay" } }, context: "body", exclusive: !1, closable: !0, dimPage: !0, scrollLock: !1, returnScroll: !1, delaySetup: !1, duration: 500, onChange: function () { }, onShow: function () { }, onHide: function () { }, onHidden: function () { }, onVisible: function () { }, className: { active: "active", animating: "animating", dimmed: "dimmed", ios: "ios", pushable: "pushable", pushed: "pushed", right: "right", top: "top", left: "left", bottom: "bottom", visible: "visible" }, selector: { fixed: ".fixed", omitted: "script, link, style, .ui.modal, .ui.dimmer, .ui.nag, .ui.fixed", pusher: ".pusher", sidebar: ".ui.sidebar" }, regExp: { ios: /(iPad|iPhone|iPod)/g, mobileChrome: /(CriOS)/g, mobile: /Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/g }, error: { method: "The method you called is not defined.", pusher: "Had to add pusher element. For optimal performance make sure body content is inside a pusher element", movedSidebar: "Had to move sidebar. For optimal performance make sure sidebar and pusher are direct children of your body tag", overlay: "The overlay setting is no longer supported, use animation: overlay", notFound: "There were no elements that matched the specified selector" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.sticky = function (o) { var a, r = e(this), s = r.selector || "", l = (new Date).getTime(), c = [], u = arguments[0], d = "string" == typeof u, f = [].slice.call(arguments, 1); return r.each(function () { var r, m, g, p, h, v = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.sticky.settings, o) : e.extend({}, e.fn.sticky.settings), b = v.className, y = v.namespace, x = v.error, C = "." + y, w = "module-" + y, k = e(this), S = e(t), T = e(v.scrollContext), A = (k.selector || "", k.data(w)), R = t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }, P = this; h = { initialize: function () { h.determineContainer(), h.determineContext(), h.verbose("Initializing sticky", v, r), h.save.positions(), h.checkErrors(), h.bind.events(), v.observeChanges && h.observeChanges(), h.instantiate() }, instantiate: function () { h.verbose("Storing instance of module", h), A = h, k.data(w, h) }, destroy: function () { h.verbose("Destroying previous instance"), h.reset(), g && g.disconnect(), p && p.disconnect(), S.off("load" + C, h.event.load).off("resize" + C, h.event.resize), T.off("scrollchange" + C, h.event.scrollchange), k.removeData(w) }, observeChanges: function () { "MutationObserver" in t && (g = new MutationObserver(h.event.documentChanged), p = new MutationObserver(h.event.changed), g.observe(n, { childList: !0, subtree: !0 }), p.observe(P, { childList: !0, subtree: !0 }), p.observe(m[0], { childList: !0, subtree: !0 }), h.debug("Setting up mutation observer", p)) }, determineContainer: function () { r = v.container ? e(v.container) : k.offsetParent() }, determineContext: function () { if (m = v.context ? e(v.context) : r, 0 === m.length) return void h.error(x.invalidContext, v.context, k) }, checkErrors: function () { if (h.is.hidden() && h.error(x.visible, k), h.cache.element.height > h.cache.context.height) return h.reset(), void h.error(x.elementSize, k) }, bind: { events: function () { S.on("load" + C, h.event.load).on("resize" + C, h.event.resize), T.off("scroll" + C).on("scroll" + C, h.event.scroll).on("scrollchange" + C, h.event.scrollchange) } }, event: { changed: function (e) { clearTimeout(h.timer), h.timer = setTimeout(function () { h.verbose("DOM tree modified, updating sticky menu", e), h.refresh() }, 100) }, documentChanged: function (t) { [].forEach.call(t, function (t) { t.removedNodes && [].forEach.call(t.removedNodes, function (t) { (t == P || e(t).find(P).length > 0) && (h.debug("Element removed from DOM, tearing down events"), h.destroy()) }) }) }, load: function () { h.verbose("Page contents finished loading"), R(h.refresh) }, resize: function () { h.verbose("Window resized"), R(h.refresh) }, scroll: function () { R(function () { T.triggerHandler("scrollchange" + C, T.scrollTop()) }) }, scrollchange: function (e, t) { h.stick(t), v.onScroll.call(P) } }, refresh: function (e) { h.reset(), v.context || h.determineContext(), e && h.determineContainer(), h.save.positions(), h.stick(), v.onReposition.call(P) }, supports: { sticky: function () { var t = e("<div/>"); t[0]; return t.addClass(b.supported), t.css("position").match("sticky") } }, save: { lastScroll: function (e) { h.lastScroll = e }, elementScroll: function (e) { h.elementScroll = e }, positions: function () { var e = { height: T.height() }, t = { margin: { top: parseInt(k.css("margin-top"), 10), bottom: parseInt(k.css("margin-bottom"), 10) }, offset: k.offset(), width: k.outerWidth(), height: k.outerHeight() }, n = { offset: m.offset(), height: m.outerHeight() }; ({ height: r.outerHeight() }); h.is.standardScroll() || (h.debug("Non-standard scroll. Removing scroll offset from element offset"), e.top = T.scrollTop(), e.left = T.scrollLeft(), t.offset.top += e.top, n.offset.top += e.top, t.offset.left += e.left, n.offset.left += e.left), h.cache = { fits: t.height < e.height, scrollContext: { height: e.height }, element: { margin: t.margin, top: t.offset.top - t.margin.top, left: t.offset.left, width: t.width, height: t.height, bottom: t.offset.top + t.height }, context: { top: n.offset.top, height: n.height, bottom: n.offset.top + n.height } }, h.set.containerSize(), h.set.size(), h.stick(), h.debug("Caching element positions", h.cache) } }, get: { direction: function (e) { var t = "down"; return e = e || T.scrollTop(), h.lastScroll !== i && (h.lastScroll < e ? t = "down" : h.lastScroll > e && (t = "up")), t }, scrollChange: function (e) { return e = e || T.scrollTop(), h.lastScroll ? e - h.lastScroll : 0 }, currentElementScroll: function () { return h.elementScroll ? h.elementScroll : h.is.top() ? Math.abs(parseInt(k.css("top"), 10)) || 0 : Math.abs(parseInt(k.css("bottom"), 10)) || 0 }, elementScroll: function (e) { e = e || T.scrollTop(); var t = h.cache.element, n = h.cache.scrollContext, i = h.get.scrollChange(e), o = t.height - n.height + v.offset, a = h.get.currentElementScroll(), r = a + i; return a = h.cache.fits || r < 0 ? 0 : r > o ? o : r } }, remove: { lastScroll: function () { delete h.lastScroll }, elementScroll: function (e) { delete h.elementScroll }, offset: function () { k.css("margin-top", "") } }, set: { offset: function () { h.verbose("Setting offset on element", v.offset), k.css("margin-top", v.offset) }, containerSize: function () { var e = r.get(0).tagName; "HTML" === e || "body" == e ? h.determineContainer() : Math.abs(r.outerHeight() - h.cache.context.height) > v.jitter && (h.debug("Context has padding, specifying exact height for container", h.cache.context.height), r.css({ height: h.cache.context.height })) }, minimumSize: function () { var e = h.cache.element; r.css("min-height", e.height) }, scroll: function (e) { h.debug("Setting scroll on element", e), h.elementScroll != e && (h.is.top() && k.css("bottom", "").css("top", -e), h.is.bottom() && k.css("top", "").css("bottom", e)) }, size: function () { 0 !== h.cache.element.height && 0 !== h.cache.element.width && (P.style.setProperty("width", h.cache.element.width + "px", "important"), P.style.setProperty("height", h.cache.element.height + "px", "important")) } }, is: { standardScroll: function () { return T[0] == t }, top: function () { return k.hasClass(b.top) }, bottom: function () { return k.hasClass(b.bottom) }, initialPosition: function () { return !h.is.fixed() && !h.is.bound() }, hidden: function () { return !k.is(":visible") }, bound: function () { return k.hasClass(b.bound) }, fixed: function () { return k.hasClass(b.fixed) } }, stick: function (e) { var t = e || T.scrollTop(), n = h.cache, i = n.fits, o = n.element, a = n.scrollContext, r = n.context, s = h.is.bottom() && v.pushing ? v.bottomOffset : v.offset, e = { top: t + s, bottom: t + s + a.height }, l = (h.get.direction(e.top), i ? 0 : h.get.elementScroll(e.top)), c = !i, u = 0 !== o.height; u && (h.is.initialPosition() ? e.top >= r.bottom ? (h.debug("Initial element position is bottom of container"), h.bindBottom()) : e.top > o.top && (o.height + e.top - l >= r.bottom ? (h.debug("Initial element position is bottom of container"), h.bindBottom()) : (h.debug("Initial element position is fixed"), h.fixTop())) : h.is.fixed() ? h.is.top() ? e.top <= o.top ? (h.debug("Fixed element reached top of container"), h.setInitialPosition()) : o.height + e.top - l >= r.bottom ? (h.debug("Fixed element reached bottom of container"), h.bindBottom()) : c && (h.set.scroll(l), h.save.lastScroll(e.top), h.save.elementScroll(l)) : h.is.bottom() && (e.bottom - o.height <= o.top ? (h.debug("Bottom fixed rail has reached top of container"), h.setInitialPosition()) : e.bottom >= r.bottom ? (h.debug("Bottom fixed rail has reached bottom of container"), h.bindBottom()) : c && (h.set.scroll(l), h.save.lastScroll(e.top), h.save.elementScroll(l))) : h.is.bottom() && (e.top <= o.top ? (h.debug("Jumped from bottom fixed to top fixed, most likely used home/end button"), h.setInitialPosition()) : v.pushing ? h.is.bound() && e.bottom <= r.bottom && (h.debug("Fixing bottom attached element to bottom of browser."), h.fixBottom()) : h.is.bound() && e.top <= r.bottom - o.height && (h.debug("Fixing bottom attached element to top of browser."), h.fixTop()))) }, bindTop: function () { h.debug("Binding element to top of parent container"), h.remove.offset(), k.css({ left: "", top: "", marginBottom: "" }).removeClass(b.fixed).removeClass(b.bottom).addClass(b.bound).addClass(b.top), v.onTop.call(P), v.onUnstick.call(P) }, bindBottom: function () { h.debug("Binding element to bottom of parent container"), h.remove.offset(), k.css({ left: "", top: "" }).removeClass(b.fixed).removeClass(b.top).addClass(b.bound).addClass(b.bottom), v.onBottom.call(P), v.onUnstick.call(P) }, setInitialPosition: function () { h.debug("Returning to initial position"), h.unfix(), h.unbind() }, fixTop: function () { h.debug("Fixing element to top of page"), h.set.minimumSize(), h.set.offset(), k.css({ left: h.cache.element.left, bottom: "", marginBottom: "" }).removeClass(b.bound).removeClass(b.bottom).addClass(b.fixed).addClass(b.top), v.onStick.call(P) }, fixBottom: function () { h.debug("Sticking element to bottom of page"), h.set.minimumSize(), h.set.offset(), k.css({ left: h.cache.element.left, bottom: "", marginBottom: "" }).removeClass(b.bound).removeClass(b.top).addClass(b.fixed).addClass(b.bottom), v.onStick.call(P) }, unbind: function () { h.is.bound() && (h.debug("Removing container bound position on element"), h.remove.offset(), k.removeClass(b.bound).removeClass(b.top).removeClass(b.bottom)) }, unfix: function () { h.is.fixed() && (h.debug("Removing fixed position on element"), h.remove.offset(), k.removeClass(b.fixed).removeClass(b.top).removeClass(b.bottom), v.onUnstick.call(P)) }, reset: function () { h.debug("Resetting elements position"), h.unbind(), h.unfix(), h.resetCSS(), h.remove.offset(), h.remove.lastScroll() }, resetCSS: function () { k.css({ width: "", height: "" }), r.css({ height: "" }) }, setting: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, v, t); else { if (n === i) return v[t]; v[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, h, t); else { if (n === i) return h[t]; h[t] = n } }, debug: function () { !v.silent && v.debug && (v.performance ? h.performance.log(arguments) : (h.debug = Function.prototype.bind.call(console.info, console, v.name + ":"), h.debug.apply(console, arguments))) }, verbose: function () { !v.silent && v.verbose && v.debug && (v.performance ? h.performance.log(arguments) : (h.verbose = Function.prototype.bind.call(console.info, console, v.name + ":"), h.verbose.apply(console, arguments))) }, error: function () { v.silent || (h.error = Function.prototype.bind.call(console.error, console, v.name + ":"), h.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; v.performance && (t = (new Date).getTime(), i = l || t, n = t - i, l = t, c.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: P, "Execution Time": n })), clearTimeout(h.performance.timer), h.performance.timer = setTimeout(h.performance.display, 0) }, display: function () { var t = v.name + ":", n = 0; l = !1, clearTimeout(h.performance.timer), e.each(c, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", s && (t += " '" + s + "'"), (console.group !== i || console.table !== i) && c.length > 0 && (console.groupCollapsed(t), console.table ? console.table(c) : e.each(c, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), c = [] } }, invoke: function (t, n, o) { var r, s, l, c = A; return n = n || f, o = P || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i && (s = c[o], !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, d ? (A === i && h.initialize(), h.invoke(u)) : (A !== i && A.invoke("destroy"), h.initialize()) }), a !== i ? a : this }, e.fn.sticky.settings = { name: "Sticky", namespace: "sticky", silent: !1, debug: !1, verbose: !0, performance: !0, pushing: !1, context: !1, container: !1, scrollContext: t, offset: 0, bottomOffset: 0, jitter: 5, observeChanges: !1, onReposition: function () { }, onScroll: function () { }, onStick: function () { }, onUnstick: function () { }, onTop: function () { }, onBottom: function () { }, error: { container: "Sticky element must be inside a relative container", visible: "Element is hidden, you must call refresh after element becomes visible. Use silent setting to surpress this warning in production.", method: "The method you called is not defined.", invalidContext: "Context specified does not exist", elementSize: "Sticky element is larger than its container, cannot create sticky." }, className: { bound: "bound", fixed: "fixed", supported: "native", top: "top", bottom: "bottom" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.tab = function (o) { var a, r = e(e.isFunction(this) ? t : this), s = r.selector || "", l = (new Date).getTime(), c = [], u = arguments[0], d = "string" == typeof u, f = [].slice.call(arguments, 1), m = !1; return r.each(function () { var g, p, h, v, b, y, x = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.tab.settings, o) : e.extend({}, e.fn.tab.settings), C = x.className, w = x.metadata, k = x.selector, S = x.error, T = "." + x.namespace, A = "module-" + x.namespace, R = e(this), P = {}, E = !0, F = 0, O = this, D = R.data(A); b = { initialize: function () { b.debug("Initializing tab menu item", R), b.fix.callbacks(), b.determineTabs(), b.debug("Determining tabs", x.context, p), x.auto && b.set.auto(), b.bind.events(), x.history && !m && (b.initializeHistory(), m = !0), b.instantiate() }, instantiate: function () { b.verbose("Storing instance of module", b), D = b, R.data(A, b) }, destroy: function () { b.debug("Destroying tabs", R), R.removeData(A).off(T) }, bind: { events: function () { e.isWindow(O) || (b.debug("Attaching tab activation events to element", R), R.on("click" + T, b.event.click)) } }, determineTabs: function () { var t; "parent" === x.context ? (R.closest(k.ui).length > 0 ? (t = R.closest(k.ui), b.verbose("Using closest UI element as parent", t)) : t = R, g = t.parent(), b.verbose("Determined parent element for creating context", g)) : x.context ? (g = e(x.context), b.verbose("Using selector for tab context", x.context, g)) : g = e("body"), x.childrenOnly ? (p = g.children(k.tabs), b.debug("Searching tab context children for tabs", g, p)) : (p = g.find(k.tabs), b.debug("Searching tab context for tabs", g, p)) }, fix: { callbacks: function () { e.isPlainObject(o) && (o.onTabLoad || o.onTabInit) && (o.onTabLoad && (o.onLoad = o.onTabLoad, delete o.onTabLoad, b.error(S.legacyLoad, o.onLoad)), o.onTabInit && (o.onFirstLoad = o.onTabInit, delete o.onTabInit, b.error(S.legacyInit, o.onFirstLoad)), x = e.extend(!0, {}, e.fn.tab.settings, o)) } }, initializeHistory: function () { if (b.debug("Initializing page state"), e.address === i) return b.error(S.state), !1; if ("state" == x.historyType) { if (b.debug("Using HTML5 to manage state"), x.path === !1) return b.error(S.path), !1; e.address.history(!0).state(x.path) } e.address.bind("change", b.event.history.change) }, event: { click: function (t) { var n = e(this).data(w.tab); n !== i ? (x.history ? (b.verbose("Updating page state", t), e.address.value(n)) : (b.verbose("Changing tab", t), b.changeTab(n)), t.preventDefault()) : b.debug("No tab specified") }, history: { change: function (t) { var n = t.pathNames.join("/") || b.get.initialPath(), o = x.templates.determineTitle(n) || !1; b.performance.display(), b.debug("History change event", n, t), y = t, n !== i && b.changeTab(n), o && e.address.title(o) } } }, refresh: function () { h && (b.debug("Refreshing tab", h), b.changeTab(h)) }, cache: { read: function (e) { return e !== i && P[e] }, add: function (e, t) { e = e || h, b.debug("Adding cached content for", e), P[e] = t }, remove: function (e) { e = e || h, b.debug("Removing cached content for", e), delete P[e] } }, set: { auto: function () { var t = "string" == typeof x.path ? x.path.replace(/\/$/, "") + "/{$tab}" : "/{$tab}"; b.verbose("Setting up automatic tab retrieval from server", t), e.isPlainObject(x.apiSettings) ? x.apiSettings.url = t : x.apiSettings = { url: t } }, loading: function (e) { var t = b.get.tabElement(e), n = t.hasClass(C.loading); n || (b.verbose("Setting loading state for", t), t.addClass(C.loading).siblings(p).removeClass(C.active + " " + C.loading), t.length > 0 && x.onRequest.call(t[0], e)) }, state: function (t) { e.address.value(t) } }, changeTab: function (n) { var i = t.history && t.history.pushState, o = i && x.ignoreFirstLoad && E, a = x.auto || e.isPlainObject(x.apiSettings), r = a && !o ? b.utilities.pathToArray(n) : b.get.defaultPathArray(n); n = b.utilities.arrayToPath(r), e.each(r, function (t, i) { var s, l, c, u, d = r.slice(0, t + 1), f = b.utilities.arrayToPath(d), m = b.is.tab(f), p = t + 1 == r.length, k = b.get.tabElement(f); if (b.verbose("Looking for tab", i), m) { if (b.verbose("Tab was found", i), h = f, v = b.utilities.filterArray(r, d), p ? u = !0 : (l = r.slice(0, t + 2), c = b.utilities.arrayToPath(l), u = !b.is.tab(c), u && b.verbose("Tab parameters found", l)), u && a) return o ? (b.debug("Ignoring remote content on first tab load", f), E = !1, b.cache.add(n, k.html()), b.activate.all(f), x.onFirstLoad.call(k[0], f, v, y), x.onLoad.call(k[0], f, v, y)) : (b.activate.navigation(f), b.fetch.content(f, n)), !1; b.debug("Opened local tab", f), b.activate.all(f), b.cache.read(f) || (b.cache.add(f, !0), b.debug("First time tab loaded calling tab init"), x.onFirstLoad.call(k[0], f, v, y)), x.onLoad.call(k[0], f, v, y) } else { if (n.search("/") != -1 || "" === n) return b.error(S.missingTab, R, g, f), !1; if (s = e("#" + n + ', a[name="' + n + '"]'), f = s.closest("[data-tab]").data(w.tab), k = b.get.tabElement(f), s && s.length > 0 && f) return b.debug("Anchor link used, opening parent tab", k, s), k.hasClass(C.active) || setTimeout(function () { b.scrollTo(s) }, 0), b.activate.all(f), b.cache.read(f) || (b.cache.add(f, !0), b.debug("First time tab loaded calling tab init"), x.onFirstLoad.call(k[0], f, v, y)), x.onLoad.call(k[0], f, v, y), !1 } }) }, scrollTo: function (t) { var i = !!(t && t.length > 0) && t.offset().top; i !== !1 && (b.debug("Forcing scroll to an in-page link in a hidden tab", i, t), e(n).scrollTop(i)) }, update: { content: function (t, n, o) { var a = b.get.tabElement(t), r = a[0]; o = o !== i ? o : x.evaluateScripts, "string" == typeof x.cacheType && "dom" == x.cacheType.toLowerCase() && "string" != typeof n ? a.empty().append(e(n).clone(!0)) : o ? (b.debug("Updating HTML and evaluating inline scripts", t, n), a.html(n)) : (b.debug("Updating HTML", t, n), r.innerHTML = n) } }, fetch: { content: function (t, n) { var o, a, r = b.get.tabElement(t), s = { dataType: "html", encodeParameters: !1, on: "now", cache: x.alwaysRefresh, headers: { "X-Remote": !0 }, onSuccess: function (e) { "response" == x.cacheType && b.cache.add(n, e), b.update.content(t, e), t == h ? (b.debug("Content loaded", t), b.activate.tab(t)) : b.debug("Content loaded in background", t), x.onFirstLoad.call(r[0], t, v, y), x.onLoad.call(r[0], t, v, y), x.loadOnce ? b.cache.add(n, !0) : "string" == typeof x.cacheType && "dom" == x.cacheType.toLowerCase() && r.children().length > 0 ? setTimeout(function () { var e = r.children().clone(!0); e = e.not("script"), b.cache.add(n, e) }, 0) : b.cache.add(n, r.html()) }, urlData: { tab: n } }, l = r.api("get request") || !1, c = l && "pending" === l.state(); n = n || t, a = b.cache.read(n), x.cache && a ? (b.activate.tab(t), b.debug("Adding cached content", n), x.loadOnce || ("once" == x.evaluateScripts ? b.update.content(t, a, !1) : b.update.content(t, a)), x.onLoad.call(r[0], t, v, y)) : c ? (b.set.loading(t), b.debug("Content is already loading", n)) : e.api !== i ? (o = e.extend(!0, {}, x.apiSettings, s), b.debug("Retrieving remote content", n, o), b.set.loading(t), r.api(o)) : b.error(S.api) } }, activate: { all: function (e) { b.activate.tab(e), b.activate.navigation(e) }, tab: function (e) { var t = b.get.tabElement(e), n = "siblings" == x.deactivate ? t.siblings(p) : p.not(t), i = t.hasClass(C.active); b.verbose("Showing tab content for", t), i || (t.addClass(C.active), n.removeClass(C.active + " " + C.loading), t.length > 0 && x.onVisible.call(t[0], e)) }, navigation: function (e) { var t = b.get.navElement(e), n = "siblings" == x.deactivate ? t.siblings(r) : r.not(t), i = t.hasClass(C.active); b.verbose("Activating tab navigation for", t, e), i || (t.addClass(C.active), n.removeClass(C.active + " " + C.loading)) } }, deactivate: { all: function () { b.deactivate.navigation(), b.deactivate.tabs() }, navigation: function () { r.removeClass(C.active) }, tabs: function () { p.removeClass(C.active + " " + C.loading) } }, is: { tab: function (e) { return e !== i && b.get.tabElement(e).length > 0 } }, get: { initialPath: function () { return r.eq(0).data(w.tab) || p.eq(0).data(w.tab) }, path: function () { return e.address.value() }, defaultPathArray: function (e) { return b.utilities.pathToArray(b.get.defaultPath(e)) }, defaultPath: function (e) { var t = r.filter("[data-" + w.tab + '^="' + e + '/"]').eq(0), n = t.data(w.tab) || !1; if (n) { if (b.debug("Found default tab", n), F < x.maxDepth) return F++, b.get.defaultPath(n); b.error(S.recursion) } else b.debug("No default tabs found for", e, p); return F = 0, e }, navElement: function (e) { return e = e || h, r.filter("[data-" + w.tab + '="' + e + '"]') }, tabElement: function (e) { var t, n, i, o; return e = e || h, i = b.utilities.pathToArray(e), o = b.utilities.last(i), t = p.filter("[data-" + w.tab + '="' + e + '"]'), n = p.filter("[data-" + w.tab + '="' + o + '"]'), t.length > 0 ? t : n }, tab: function () { return h } }, utilities: { filterArray: function (t, n) { return e.grep(t, function (t) { return e.inArray(t, n) == -1 }) }, last: function (t) { return !!e.isArray(t) && t[t.length - 1] }, pathToArray: function (e) { return e === i && (e = h), "string" == typeof e ? e.split("/") : [e] }, arrayToPath: function (t) { return !!e.isArray(t) && t.join("/") } }, setting: function (t, n) { if (b.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, x, t); else { if (n === i) return x[t]; e.isPlainObject(x[t]) ? e.extend(!0, x[t], n) : x[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, b, t); else { if (n === i) return b[t]; b[t] = n } }, debug: function () { !x.silent && x.debug && (x.performance ? b.performance.log(arguments) : (b.debug = Function.prototype.bind.call(console.info, console, x.name + ":"), b.debug.apply(console, arguments))) }, verbose: function () { !x.silent && x.verbose && x.debug && (x.performance ? b.performance.log(arguments) : (b.verbose = Function.prototype.bind.call(console.info, console, x.name + ":"), b.verbose.apply(console, arguments))) }, error: function () { x.silent || (b.error = Function.prototype.bind.call(console.error, console, x.name + ":"), b.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; x.performance && (t = (new Date).getTime(), i = l || t, n = t - i, l = t, c.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: O, "Execution Time": n })), clearTimeout(b.performance.timer), b.performance.timer = setTimeout(b.performance.display, 500) }, display: function () { var t = x.name + ":", n = 0; l = !1, clearTimeout(b.performance.timer), e.each(c, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", s && (t += " '" + s + "'"), (console.group !== i || console.table !== i) && c.length > 0 && (console.groupCollapsed(t), console.table ? console.table(c) : e.each(c, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), c = [] } }, invoke: function (t, n, o) { var r, s, l, c = D; return n = n || f, o = O || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (b.error(S.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, d ? (D === i && b.initialize(), b.invoke(u)) : (D !== i && D.invoke("destroy"), b.initialize()) }), a !== i ? a : this }, e.tab = function () { e(t).tab.apply(this, arguments) }, e.fn.tab.settings = { name: "Tab", namespace: "tab", silent: !1, debug: !1, verbose: !1, performance: !0, auto: !1, history: !1, historyType: "hash", path: !1, context: !1, childrenOnly: !1, maxDepth: 25, deactivate: "siblings", alwaysRefresh: !1, cache: !0, loadOnce: !1, cacheType: "response", ignoreFirstLoad: !1, apiSettings: !1, evaluateScripts: "once", onFirstLoad: function (e, t, n) { }, onLoad: function (e, t, n) { }, onVisible: function (e, t, n) { }, onRequest: function (e, t, n) { }, templates: { determineTitle: function (e) { } }, error: { api: "You attempted to load content without API module", method: "The method you called is not defined", missingTab: "Activated tab cannot be found. Tabs are case-sensitive.", noContent: "The tab you specified is missing a content url.", path: "History enabled, but no path was specified", recursion: "Max recursive depth reached", legacyInit: "onTabInit has been renamed to onFirstLoad in 2.0, please adjust your code.", legacyLoad: "onTabLoad has been renamed to onLoad in 2.0. Please adjust your code", state: "History requires Asual's Address library <https://github.com/asual/jquery-address>" }, metadata: { tab: "tab", loaded: "loaded", promise: "promise" }, className: { loading: "loading", active: "active" }, selector: { tabs: ".ui.tab", ui: ".ui" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.transition = function () { var o, a = e(this), r = a.selector || "", s = (new Date).getTime(), l = [], c = arguments, u = c[0], d = [].slice.call(arguments, 1), f = "string" == typeof u; t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }; return a.each(function (t) { var m, g, p, h, v, b, y, x, C, w = e(this), k = this; C = { initialize: function () { m = C.get.settings.apply(k, c), h = m.className, p = m.error, v = m.metadata, x = "." + m.namespace, y = "module-" + m.namespace, g = w.data(y) || C, b = C.get.animationEndEvent(), f && (f = C.invoke(u)), f === !1 && (C.verbose("Converted arguments into settings object", m), m.interval ? C.delay(m.animate) : C.animate(), C.instantiate()) }, instantiate: function () { C.verbose("Storing instance of module", C), g = C, w.data(y, g) }, destroy: function () { C.verbose("Destroying previous module for", k), w.removeData(y) }, refresh: function () { C.verbose("Refreshing display type on next animation"), delete C.displayType }, forceRepaint: function () { C.verbose("Forcing element repaint"); var e = w.parent(), t = w.next(); 0 === t.length ? w.detach().appendTo(e) : w.detach().insertBefore(t) }, repaint: function () { C.verbose("Repainting element"); k.offsetWidth }, delay: function (e) { var n, o, r = C.get.animationDirection(); r || (r = C.can.transition() ? C.get.direction() : "static"), e = e !== i ? e : m.interval, n = "auto" == m.reverse && r == h.outward, o = n || 1 == m.reverse ? (a.length - t) * m.interval : t * m.interval, C.debug("Delaying animation by", o), setTimeout(C.animate, o) }, animate: function (e) { if (m = e || m, !C.is.supported()) return C.error(p.support), !1; if (C.debug("Preparing animation", m.animation), C.is.animating()) { if (m.queue) return !m.allowRepeats && C.has.direction() && C.is.occurring() && C.queuing !== !0 ? C.debug("Animation is currently occurring, preventing queueing same animation", m.animation) : C.queue(m.animation), !1; if (!m.allowRepeats && C.is.occurring()) return C.debug("Animation is already occurring, will not execute repeated animation", m.animation), !1; C.debug("New animation started, completing previous early", m.animation), g.complete() } C.can.animate() ? C.set.animating(m.animation) : C.error(p.noAnimation, m.animation, k) }, reset: function () { C.debug("Resetting animation to beginning conditions"), C.remove.animationCallbacks(), C.restore.conditions(), C.remove.animating() }, queue: function (e) { C.debug("Queueing animation of", e), C.queuing = !0, w.one(b + ".queue" + x, function () { C.queuing = !1, C.repaint(), C.animate.apply(this, m) }) }, complete: function (e) { C.debug("Animation complete", m.animation), C.remove.completeCallback(), C.remove.failSafe(), C.is.looping() || (C.is.outward() ? (C.verbose("Animation is outward, hiding element"), C.restore.conditions(), C.hide()) : C.is.inward() ? (C.verbose("Animation is outward, showing element"), C.restore.conditions(), C.show()) : (C.verbose("Static animation completed"), C.restore.conditions(), m.onComplete.call(k))) }, force: { visible: function () { var e = w.attr("style"), t = C.get.userStyle(), n = C.get.displayType(), o = t + "display: " + n + " !important;", a = w.css("display"), r = e === i || "" === e; a !== n ? (C.verbose("Overriding default display to show element", n), w.attr("style", o)) : r && w.removeAttr("style") }, hidden: function () { var e = w.attr("style"), t = w.css("display"), n = e === i || "" === e; "none" === t || C.is.hidden() ? n && w.removeAttr("style") : (C.verbose("Overriding default display to hide element"), w.css("display", "none")) } }, has: { direction: function (t) { var n = !1; return t = t || m.animation, "string" == typeof t && (t = t.split(" "), e.each(t, function (e, t) { t !== h.inward && t !== h.outward || (n = !0) })), n }, inlineDisplay: function () { var t = w.attr("style") || ""; return e.isArray(t.match(/display.*?;/, "")) } }, set: { animating: function (e) { var t; C.remove.completeCallback(), e = e || m.animation, t = C.get.animationClass(e), C.save.animation(t), C.force.visible(), C.remove.hidden(), C.remove.direction(), C.start.animation(t) }, duration: function (e, t) { t = t || m.duration, t = "number" == typeof t ? t + "ms" : t, (t || 0 === t) && (C.verbose("Setting animation duration", t), w.css({ "animation-duration": t })) }, direction: function (e) { e = e || C.get.direction(), e == h.inward ? C.set.inward() : C.set.outward() }, looping: function () { C.debug("Transition set to loop"), w.addClass(h.looping) }, hidden: function () { w.addClass(h.transition).addClass(h.hidden) }, inward: function () { C.debug("Setting direction to inward"), w.removeClass(h.outward).addClass(h.inward) }, outward: function () { C.debug("Setting direction to outward"), w.removeClass(h.inward).addClass(h.outward) }, visible: function () { w.addClass(h.transition).addClass(h.visible) } }, start: { animation: function (e) { e = e || C.get.animationClass(), C.debug("Starting tween", e), w.addClass(e).one(b + ".complete" + x, C.complete), m.useFailSafe && C.add.failSafe(), C.set.duration(m.duration), m.onStart.call(k) } }, save: { animation: function (e) { C.cache || (C.cache = {}), C.cache.animation = e }, displayType: function (e) { "none" !== e && w.data(v.displayType, e) }, transitionExists: function (t, n) { e.fn.transition.exists[t] = n, C.verbose("Saving existence of transition", t, n) } }, restore: { conditions: function () { var e = C.get.currentAnimation(); e && (w.removeClass(e), C.verbose("Removing animation class", C.cache)), C.remove.duration() } }, add: { failSafe: function () { var e = C.get.duration(); C.timer = setTimeout(function () { w.triggerHandler(b) }, e + m.failSafeDelay), C.verbose("Adding fail safe timer", C.timer) } }, remove: { animating: function () { w.removeClass(h.animating) }, animationCallbacks: function () { C.remove.queueCallback(), C.remove.completeCallback() }, queueCallback: function () { w.off(".queue" + x) }, completeCallback: function () { w.off(".complete" + x) }, display: function () { w.css("display", "") }, direction: function () { w.removeClass(h.inward).removeClass(h.outward) }, duration: function () { w.css("animation-duration", "") }, failSafe: function () { C.verbose("Removing fail safe timer", C.timer), C.timer && clearTimeout(C.timer) }, hidden: function () { w.removeClass(h.hidden) }, visible: function () { w.removeClass(h.visible) }, looping: function () { C.debug("Transitions are no longer looping"), C.is.looping() && (C.reset(), w.removeClass(h.looping)) }, transition: function () { w.removeClass(h.visible).removeClass(h.hidden) } }, get: { settings: function (t, n, i) { return "object" == typeof t ? e.extend(!0, {}, e.fn.transition.settings, t) : "function" == typeof i ? e.extend({}, e.fn.transition.settings, { animation: t, onComplete: i, duration: n }) : "string" == typeof n || "number" == typeof n ? e.extend({}, e.fn.transition.settings, { animation: t, duration: n }) : "object" == typeof n ? e.extend({}, e.fn.transition.settings, n, { animation: t }) : "function" == typeof n ? e.extend({}, e.fn.transition.settings, { animation: t, onComplete: n }) : e.extend({}, e.fn.transition.settings, { animation: t }) }, animationClass: function (e) { var t = e || m.animation, n = C.can.transition() && !C.has.direction() ? C.get.direction() + " " : ""; return h.animating + " " + h.transition + " " + n + t }, currentAnimation: function () { return !(!C.cache || C.cache.animation === i) && C.cache.animation }, currentDirection: function () { return C.is.inward() ? h.inward : h.outward }, direction: function () { return C.is.hidden() || !C.is.visible() ? h.inward : h.outward }, animationDirection: function (t) { var n; return t = t || m.animation, "string" == typeof t && (t = t.split(" "), e.each(t, function (e, t) { t === h.inward ? n = h.inward : t === h.outward && (n = h.outward) })), !!n && n }, duration: function (e) { return e = e || m.duration, e === !1 && (e = w.css("animation-duration") || 0), "string" == typeof e ? e.indexOf("ms") > -1 ? parseFloat(e) : 1e3 * parseFloat(e) : e }, displayType: function (e) { return e = e === i || e, m.displayType ? m.displayType : (e && w.data(v.displayType) === i && C.can.transition(!0), w.data(v.displayType)) }, userStyle: function (e) { return e = e || w.attr("style") || "", e.replace(/display.*?;/, "") }, transitionExists: function (t) { return e.fn.transition.exists[t] }, animationStartEvent: function () { var e, t = n.createElement("div"), o = { animation: "animationstart", OAnimation: "oAnimationStart", MozAnimation: "mozAnimationStart", WebkitAnimation: "webkitAnimationStart" }; for (e in o) if (t.style[e] !== i) return o[e]; return !1 }, animationEndEvent: function () { var e, t = n.createElement("div"), o = { animation: "animationend", OAnimation: "oAnimationEnd", MozAnimation: "mozAnimationEnd", WebkitAnimation: "webkitAnimationEnd" }; for (e in o) if (t.style[e] !== i) return o[e]; return !1 } }, can: { transition: function (t) { var n, o, a, r, s, l, c = m.animation, u = C.get.transitionExists(c), d = C.get.displayType(!1); if (u === i || t) { if (C.verbose("Determining whether animation exists"), n = w.attr("class"), o = w.prop("tagName"), a = e("<" + o + " />").addClass(n).insertAfter(w), r = a.addClass(c).removeClass(h.inward).removeClass(h.outward).addClass(h.animating).addClass(h.transition).css("animationName"), s = a.addClass(h.inward).css("animationName"), d || (d = a.attr("class", n).removeAttr("style").removeClass(h.hidden).removeClass(h.visible).show().css("display"), C.verbose("Determining final display state", d), C.save.displayType(d)), a.remove(), r != s) C.debug("Direction exists for animation", c), l = !0; else { if ("none" == r || !r) return void C.debug("No animation defined in css", c); C.debug("Static animation found", c, d), l = !1 } C.save.transitionExists(c, l) } return u !== i ? u : l }, animate: function () { return C.can.transition() !== i } }, is: { animating: function () { return w.hasClass(h.animating) }, inward: function () { return w.hasClass(h.inward) }, outward: function () { return w.hasClass(h.outward) }, looping: function () { return w.hasClass(h.looping) }, occurring: function (e) { return e = e || m.animation, e = "." + e.replace(" ", "."), w.filter(e).length > 0 }, visible: function () { return w.is(":visible") }, hidden: function () { return "hidden" === w.css("visibility") }, supported: function () { return b !== !1 } }, hide: function () { C.verbose("Hiding element"), C.is.animating() && C.reset(), k.blur(), C.remove.display(), C.remove.visible(), C.set.hidden(), C.force.hidden(), m.onHide.call(k), m.onComplete.call(k) }, show: function (e) { C.verbose("Showing element", e), C.remove.hidden(), C.set.visible(), C.force.visible(), m.onShow.call(k), m.onComplete.call(k) }, toggle: function () { C.is.visible() ? C.hide() : C.show() }, stop: function () { C.debug("Stopping current animation"), w.triggerHandler(b) }, stopAll: function () { C.debug("Stopping all animation"), C.remove.queueCallback(), w.triggerHandler(b) }, clear: { queue: function () { C.debug("Clearing animation queue"), C.remove.queueCallback() } }, enable: function () { C.verbose("Starting animation"), w.removeClass(h.disabled) }, disable: function () { C.debug("Stopping animation"), w.addClass(h.disabled) }, setting: function (t, n) { if (C.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, m, t); else { if (n === i) return m[t]; e.isPlainObject(m[t]) ? e.extend(!0, m[t], n) : m[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, C, t); else { if (n === i) return C[t]; C[t] = n } }, debug: function () { !m.silent && m.debug && (m.performance ? C.performance.log(arguments) : (C.debug = Function.prototype.bind.call(console.info, console, m.name + ":"), C.debug.apply(console, arguments))) }, verbose: function () { !m.silent && m.verbose && m.debug && (m.performance ? C.performance.log(arguments) : (C.verbose = Function.prototype.bind.call(console.info, console, m.name + ":"), C.verbose.apply(console, arguments))) }, error: function () { m.silent || (C.error = Function.prototype.bind.call(console.error, console, m.name + ":"), C.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; m.performance && (t = (new Date).getTime(), i = s || t, n = t - i, s = t, l.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: k, "Execution Time": n })), clearTimeout(C.performance.timer), C.performance.timer = setTimeout(C.performance.display, 500) }, display: function () { var t = m.name + ":", n = 0; s = !1, clearTimeout(C.performance.timer), e.each(l, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", r && (t += " '" + r + "'"), a.length > 1 && (t += " (" + a.length + ")"), (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, n, a) { var r, s, l, c = g; return n = n || d, a = k || a, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i && (s = c[o], !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(a, n) : s !== i && (l = s), e.isArray(o) ? o.push(l) : o !== i ? o = [o, l] : l !== i && (o = l), s !== i && s } }, C.initialize() }), o !== i ? o : this }, e.fn.transition.exists = {}, e.fn.transition.settings = { name: "Transition", silent: !1, debug: !1, verbose: !1, performance: !0, namespace: "transition", interval: 0, reverse: "auto", onStart: function () { }, onComplete: function () { }, onShow: function () { }, onHide: function () { }, useFailSafe: !0, failSafeDelay: 100, allowRepeats: !1, displayType: !1, animation: "fade", duration: !1, queue: !0, metadata: { displayType: "display" }, className: { animating: "animating", disabled: "disabled", hidden: "hidden", inward: "in", loading: "loading", looping: "looping", outward: "out", transition: "transition", visible: "visible" }, error: { noAnimation: "Element is no longer attached to DOM. Unable to animate.  Use silent setting to surpress this warning in production.", repeated: "That animation is already occurring, cancelling repeated animation", method: "The method you called is not defined", support: "This browser does not support CSS animations" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; var t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); e.api = e.fn.api = function (n) { var o, a = e(e.isFunction(this) ? t : this), r = a.selector || "", s = (new Date).getTime(), l = [], c = arguments[0], u = "string" == typeof c, d = [].slice.call(arguments, 1); return a.each(function () { var a, f, m, g, p, h, v = e.isPlainObject(n) ? e.extend(!0, {}, e.fn.api.settings, n) : e.extend({}, e.fn.api.settings), b = v.namespace, y = v.metadata, x = v.selector, C = v.error, w = v.className, k = "." + b, S = "module-" + b, T = e(this), A = T.closest(x.form), R = v.stateContext ? e(v.stateContext) : T, P = this, E = R[0], F = T.data(S); h = { initialize: function () { u || h.bind.events(), h.instantiate() }, instantiate: function () { h.verbose("Storing instance of module", h), F = h, T.data(S, F) }, destroy: function () { h.verbose("Destroying previous module for", P), T.removeData(S).off(k) }, bind: { events: function () { var e = h.get.event(); e ? (h.verbose("Attaching API events to element", e), T.on(e + k, h.event.trigger)) : "now" == v.on && (h.debug("Querying API endpoint immediately"), h.query()) } }, decode: { json: function (e) { if (e !== i && "string" == typeof e) try { e = JSON.parse(e) } catch (e) { } return e } }, read: { cachedResponse: function (e) { var n; return t.Storage === i ? void h.error(C.noStorage) : (n = sessionStorage.getItem(e), h.debug("Using cached response", e, n), n = h.decode.json(n)) } }, write: { cachedResponse: function (n, o) { return o && "" === o ? void h.debug("Response empty, not caching", o) : t.Storage === i ? void h.error(C.noStorage) : (e.isPlainObject(o) && (o = JSON.stringify(o)), sessionStorage.setItem(n, o), void h.verbose("Storing cached response for url", n, o)) } }, query: function () { if (h.is.disabled()) return void h.debug("Element is disabled API request aborted"); if (h.is.loading()) { if (!v.interruptRequests) return void h.debug("Cancelling request, previous request is still pending"); h.debug("Interrupting previous request"), h.abort() } return v.defaultData && e.extend(!0, v.urlData, h.get.defaultData()), v.serializeForm && (v.data = h.add.formData(v.data)), f = h.get.settings(), f === !1 ? (h.cancelled = !0, void h.error(C.beforeSend)) : (h.cancelled = !1, m = h.get.templatedURL(), m || h.is.mocked() ? (m = h.add.urlData(m), m || h.is.mocked() ? (f.url = v.base + m, a = e.extend(!0, {}, v, { type: v.method || v.type, data: g, url: v.base + m, beforeSend: v.beforeXHR, success: function () { }, failure: function () { }, complete: function () { } }), h.debug("Querying URL", a.url), h.verbose("Using AJAX settings", a), "local" === v.cache && h.read.cachedResponse(m) ? (h.debug("Response returned from local cache"), h.request = h.create.request(), void h.request.resolveWith(E, [h.read.cachedResponse(m)])) : void (v.throttle ? v.throttleFirstRequest || h.timer ? (h.debug("Throttling request", v.throttle), clearTimeout(h.timer), h.timer = setTimeout(function () { h.timer && delete h.timer, h.debug("Sending throttled request", g, a.method), h.send.request() }, v.throttle)) : (h.debug("Sending request", g, a.method), h.send.request(), h.timer = setTimeout(function () { }, v.throttle)) : (h.debug("Sending request", g, a.method), h.send.request()))) : void 0) : void h.error(C.missingURL)) }, should: { removeError: function () { return v.hideError === !0 || "auto" === v.hideError && !h.is.form() } }, is: { disabled: function () { return T.filter(x.disabled).length > 0 }, expectingJSON: function () { return "json" === v.dataType || "jsonp" === v.dataType }, form: function () { return T.is("form") || R.is("form") }, mocked: function () { return v.mockResponse || v.mockResponseAsync || v.response || v.responseAsync }, input: function () { return T.is("input") }, loading: function () { return !!h.request && "pending" == h.request.state() }, abortedRequest: function (e) { return e && e.readyState !== i && 0 === e.readyState ? (h.verbose("XHR request determined to be aborted"), !0) : (h.verbose("XHR request was not aborted"), !1) }, validResponse: function (t) { return h.is.expectingJSON() && e.isFunction(v.successTest) ? (h.debug("Checking JSON returned success", v.successTest, t), v.successTest(t) ? (h.debug("Response passed success test", t), !0) : (h.debug("Response failed success test", t), !1)) : (h.verbose("Response is not JSON, skipping validation", v.successTest, t), !0) } }, was: { cancelled: function () { return h.cancelled || !1 }, succesful: function () { return h.request && "resolved" == h.request.state() }, failure: function () { return h.request && "rejected" == h.request.state() }, complete: function () { return h.request && ("resolved" == h.request.state() || "rejected" == h.request.state()) } }, add: { urlData: function (t, n) { var o, a; return t && (o = t.match(v.regExp.required), a = t.match(v.regExp.optional), n = n || v.urlData, o && (h.debug("Looking for required URL variables", o), e.each(o, function (o, a) { var r = a.indexOf("$") !== -1 ? a.substr(2, a.length - 3) : a.substr(1, a.length - 2), s = e.isPlainObject(n) && n[r] !== i ? n[r] : T.data(r) !== i ? T.data(r) : R.data(r) !== i ? R.data(r) : n[r]; return s === i ? (h.error(C.requiredParameter, r, t), t = !1, !1) : (h.verbose("Found required variable", r, s), s = v.encodeParameters ? h.get.urlEncodedValue(s) : s, t = t.replace(a, s), void 0) })), a && (h.debug("Looking for optional URL variables", o), e.each(a, function (o, a) { var r = a.indexOf("$") !== -1 ? a.substr(3, a.length - 4) : a.substr(2, a.length - 3), s = e.isPlainObject(n) && n[r] !== i ? n[r] : T.data(r) !== i ? T.data(r) : R.data(r) !== i ? R.data(r) : n[r]; s !== i ? (h.verbose("Optional variable Found", r, s), t = t.replace(a, s)) : (h.verbose("Optional variable not found", r), t = t.indexOf("/" + a) !== -1 ? t.replace("/" + a, "") : t.replace(a, "")) }))), t }, formData: function (t) { var n, o = e.fn.serializeObject !== i, a = o ? A.serializeObject() : A.serialize(); return t = t || v.data, n = e.isPlainObject(t), n ? o ? (h.debug("Extending existing data with form data", t, a), t = e.extend(!0, {}, t, a)) : (h.error(C.missingSerialize), h.debug("Cant extend data. Replacing data with form data", t, a), t = a) : (h.debug("Adding form data", a), t = a), t } }, send: { request: function () { h.set.loading(), h.request = h.create.request(), h.is.mocked() ? h.mockedXHR = h.create.mockedXHR() : h.xhr = h.create.xhr(), v.onRequest.call(E, h.request, h.xhr) } }, event: { trigger: function (e) { h.query(), "submit" != e.type && "click" != e.type || e.preventDefault() }, xhr: { always: function () { }, done: function (t, n, i) { var o = this, a = (new Date).getTime() - p, r = v.loadingDuration - a, s = !!e.isFunction(v.onResponse) && (h.is.expectingJSON() ? v.onResponse.call(o, e.extend(!0, {}, t)) : v.onResponse.call(o, t)); r = r > 0 ? r : 0, s && (h.debug("Modified API response in onResponse callback", v.onResponse, s, t), t = s), r > 0 && h.debug("Response completed early delaying state change by", r), setTimeout(function () { h.is.validResponse(t) ? h.request.resolveWith(o, [t, i]) : h.request.rejectWith(o, [i, "invalid"]) }, r) }, fail: function (e, t, n) { var i = this, o = (new Date).getTime() - p, a = v.loadingDuration - o; a = a > 0 ? a : 0, a > 0 && h.debug("Response completed early delaying state change by", a), setTimeout(function () { h.is.abortedRequest(e) ? h.request.rejectWith(i, [e, "aborted", n]) : h.request.rejectWith(i, [e, "error", t, n]) }, a) } }, request: { done: function (e, t) { h.debug("Successful API Response", e), "local" === v.cache && m && (h.write.cachedResponse(m, e), h.debug("Saving server response locally", h.cache)), v.onSuccess.call(E, e, T, t) }, complete: function (e, t) { var n, i; h.was.succesful() ? (i = e, n = t) : (n = e, i = h.get.responseFromXHR(n)), h.remove.loading(), v.onComplete.call(E, i, T, n) }, fail: function (e, t, n) { var o = h.get.responseFromXHR(e), r = h.get.errorFromRequest(o, t, n); return "aborted" == t ? (h.debug("XHR Aborted (Most likely caused by page navigation or CORS Policy)", t, n), v.onAbort.call(E, t, T, e), !0) : ("invalid" == t ? h.debug("JSON did not pass success test. A server-side error has most likely occurred", o) : "error" == t && e !== i && (h.debug("XHR produced a server error", t, n), 200 != e.status && n !== i && "" !== n && h.error(C.statusMessage + n, a.url), v.onError.call(E, r, T, e)), v.errorDuration && "aborted" !== t && (h.debug("Adding error state"), h.set.error(), h.should.removeError() && setTimeout(h.remove.error, v.errorDuration)), h.debug("API Request failed", r, e), void v.onFailure.call(E, o, T, e)) } } }, create: { request: function () { return e.Deferred().always(h.event.request.complete).done(h.event.request.done).fail(h.event.request.fail) }, mockedXHR: function () { var t, n, i, o = !1, a = !1, r = !1, s = v.mockResponse || v.response, l = v.mockResponseAsync || v.responseAsync; return i = e.Deferred().always(h.event.xhr.complete).done(h.event.xhr.done).fail(h.event.xhr.fail), s ? (e.isFunction(s) ? (h.debug("Using specified synchronous callback", s), n = s.call(E, f)) : (h.debug("Using settings specified response", s), n = s), i.resolveWith(E, [n, o, { responseText: n }])) : e.isFunction(l) && (t = function (e) { h.debug("Async callback returned response", e), e ? i.resolveWith(E, [e, o, { responseText: e }]) : i.rejectWith(E, [{ responseText: e }, a, r]) }, h.debug("Using specified async response callback", l), l.call(E, f, t)), i }, xhr: function () { var t; return t = e.ajax(a).always(h.event.xhr.always).done(h.event.xhr.done).fail(h.event.xhr.fail), h.verbose("Created server request", t, a), t } }, set: { error: function () { h.verbose("Adding error state to element", R), R.addClass(w.error) }, loading: function () { h.verbose("Adding loading state to element", R), R.addClass(w.loading), p = (new Date).getTime() } }, remove: { error: function () { h.verbose("Removing error state from element", R), R.removeClass(w.error) }, loading: function () { h.verbose("Removing loading state from element", R), R.removeClass(w.loading) } }, get: { responseFromXHR: function (t) { return !!e.isPlainObject(t) && (h.is.expectingJSON() ? h.decode.json(t.responseText) : t.responseText) }, errorFromRequest: function (t, n, o) { return e.isPlainObject(t) && t.error !== i ? t.error : v.error[n] !== i ? v.error[n] : o }, request: function () { return h.request || !1 }, xhr: function () { return h.xhr || !1 }, settings: function () { var t; return t = v.beforeSend.call(E, v), t && (t.success !== i && (h.debug("Legacy success callback detected", t), h.error(C.legacyParameters, t.success), t.onSuccess = t.success), t.failure !== i && (h.debug("Legacy failure callback detected", t), h.error(C.legacyParameters, t.failure), t.onFailure = t.failure), t.complete !== i && (h.debug("Legacy complete callback detected", t), h.error(C.legacyParameters, t.complete), t.onComplete = t.complete)), t === i && h.error(C.noReturnedValue), t === !1 ? t : t !== i ? e.extend(!0, {}, t) : e.extend(!0, {}, v) }, urlEncodedValue: function (e) { var n = t.decodeURIComponent(e), i = t.encodeURIComponent(e), o = n !== e; return o ? (h.debug("URL value is already encoded, avoiding double encoding", e), e) : (h.verbose("Encoding value using encodeURIComponent", e, i), i) }, defaultData: function () { var t = {}; return e.isWindow(P) || (h.is.input() ? t.value = T.val() : h.is.form() || (t.text = T.text())), t }, event: function () { return e.isWindow(P) || "now" == v.on ? (h.debug("API called without element, no events attached"), !1) : "auto" == v.on ? T.is("input") ? P.oninput !== i ? "input" : P.onpropertychange !== i ? "propertychange" : "keyup" : T.is("form") ? "submit" : "click" : v.on }, templatedURL: function (e) { if (e = e || T.data(y.action) || v.action || !1, m = T.data(y.url) || v.url || !1) return h.debug("Using specified url", m), m; if (e) { if (h.debug("Looking up url for action", e, v.api), v.api[e] === i && !h.is.mocked()) return void h.error(C.missingAction, v.action, v.api); m = v.api[e] } else h.is.form() && (m = T.attr("action") || R.attr("action") || !1, h.debug("No url or action specified, defaulting to form action", m)); return m } }, abort: function () { var e = h.get.xhr(); e && "resolved" !== e.state() && (h.debug("Cancelling API request"), e.abort()) }, reset: function () { h.remove.error(), h.remove.loading() }, setting: function (t, n) { if (h.debug("Changing setting", t, n), e.isPlainObject(t)) e.extend(!0, v, t); else { if (n === i) return v[t]; e.isPlainObject(v[t]) ? e.extend(!0, v[t], n) : v[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, h, t); else { if (n === i) return h[t]; h[t] = n } }, debug: function () { !v.silent && v.debug && (v.performance ? h.performance.log(arguments) : (h.debug = Function.prototype.bind.call(console.info, console, v.name + ":"), h.debug.apply(console, arguments))) }, verbose: function () { !v.silent && v.verbose && v.debug && (v.performance ? h.performance.log(arguments) : (h.verbose = Function.prototype.bind.call(console.info, console, v.name + ":"), h.verbose.apply(console, arguments))) }, error: function () { v.silent || (h.error = Function.prototype.bind.call(console.error, console, v.name + ":"), h.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; v.performance && (t = (new Date).getTime(), i = s || t, n = t - i, s = t, l.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", "Execution Time": n })), clearTimeout(h.performance.timer), h.performance.timer = setTimeout(h.performance.display, 500) }, display: function () { var t = v.name + ":", n = 0; s = !1, clearTimeout(h.performance.timer), e.each(l, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", r && (t += " '" + r + "'"), (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, n, a) { var r, s, l, c = F; return n = n || d, a = P || a, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (h.error(C.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(a, n) : s !== i && (l = s), e.isArray(o) ? o.push(l) : o !== i ? o = [o, l] : l !== i && (o = l), s } }, u ? (F === i && h.initialize(), h.invoke(c)) : (F !== i && F.invoke("destroy"), h.initialize()) }), o !== i ? o : this }, e.api.settings = { name: "API", namespace: "api", debug: !1, verbose: !1, performance: !0, api: {}, cache: !0, interruptRequests: !0, on: "auto", stateContext: !1, loadingDuration: 0, hideError: "auto", errorDuration: 2e3, encodeParameters: !0, action: !1, url: !1, base: "", urlData: {}, defaultData: !0, serializeForm: !1, throttle: 0, throttleFirstRequest: !0, method: "get", data: {}, dataType: "json", mockResponse: !1, mockResponseAsync: !1, response: !1, responseAsync: !1, beforeSend: function (e) { return e }, beforeXHR: function (e) { }, onRequest: function (e, t) { }, onResponse: !1, onSuccess: function (e, t) { }, onComplete: function (e, t) { }, onFailure: function (e, t) { }, onError: function (e, t) { }, onAbort: function (e, t) { }, successTest: !1, error: { beforeSend: "The before send function has aborted the request", error: "There was an error with your request", exitConditions: "API Request Aborted. Exit conditions met", JSONParse: "JSON could not be parsed during error handling", legacyParameters: "You are using legacy API success callback names", method: "The method you called is not defined", missingAction: "API action used but no url was defined", missingSerialize: "jquery-serialize-object is required to add form data to an existing data object", missingURL: "No URL specified for api event", noReturnedValue: "The beforeSend callback must return a settings object, beforeSend ignored.", noStorage: "Caching responses locally requires session storage", parseError: "There was an error parsing your request", requiredParameter: "Missing a required URL parameter: ", statusMessage: "Server gave an error: ", timeout: "Your request timed out" }, regExp: { required: /\{\$*[A-z0-9]+\}/g, optional: /\{\/\$*[A-z0-9]+\}/g }, className: { loading: "loading", error: "error" }, selector: { disabled: ".disabled", form: "form" }, metadata: { action: "action", url: "url" } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.state = function (t) { var o, a = e(this), r = a.selector || "", s = ("ontouchstart" in n.documentElement, (new Date).getTime()), l = [], c = arguments[0], u = "string" == typeof c, d = [].slice.call(arguments, 1); return a.each(function () { var n, f = e.isPlainObject(t) ? e.extend(!0, {}, e.fn.state.settings, t) : e.extend({}, e.fn.state.settings), m = f.error, g = f.metadata, p = f.className, h = f.namespace, v = f.states, b = f.text, y = "." + h, x = h + "-module", C = e(this), w = this, k = C.data(x); n = { initialize: function () { n.verbose("Initializing module"), f.automatic && n.add.defaults(), f.context && "" !== r ? e(f.context).on(r, "mouseenter" + y, n.change.text).on(r, "mouseleave" + y, n.reset.text).on(r, "click" + y, n.toggle.state) : C.on("mouseenter" + y, n.change.text).on("mouseleave" + y, n.reset.text).on("click" + y, n.toggle.state), n.instantiate() }, instantiate: function () { n.verbose("Storing instance of module", n), k = n, C.data(x, n) }, destroy: function () { n.verbose("Destroying previous module", k), C.off(y).removeData(x) }, refresh: function () { n.verbose("Refreshing selector cache"), C = e(w) }, add: { defaults: function () { var o = t && e.isPlainObject(t.states) ? t.states : {}; e.each(f.defaults, function (t, a) { n.is[t] !== i && n.is[t]() && (n.verbose("Adding default states", t, w), e.extend(f.states, a, o)) }) } }, is: { active: function () { return C.hasClass(p.active) }, loading: function () { return C.hasClass(p.loading) }, inactive: function () { return !C.hasClass(p.active) }, state: function (e) { return p[e] !== i && C.hasClass(p[e]) }, enabled: function () { return !C.is(f.filter.active) }, disabled: function () { return C.is(f.filter.active) }, textEnabled: function () { return !C.is(f.filter.text) }, button: function () { return C.is(".button:not(a, .submit)") }, input: function () { return C.is("input") }, progress: function () { return C.is(".ui.progress") } }, allow: function (e) { n.debug("Now allowing state", e), v[e] = !0 }, disallow: function (e) { n.debug("No longer allowing", e), v[e] = !1 }, allows: function (e) { return v[e] || !1 }, enable: function () { C.removeClass(p.disabled) }, disable: function () { C.addClass(p.disabled) }, setState: function (e) { n.allows(e) && C.addClass(p[e]) }, removeState: function (e) { n.allows(e) && C.removeClass(p[e]) }, toggle: { state: function () { var t, o; if (n.allows("active") && n.is.enabled()) { if (n.refresh(), e.fn.api !== i) if (t = C.api("get request"), o = C.api("was cancelled")) n.debug("API Request cancelled by beforesend"), f.activateTest = function () { return !1 }, f.deactivateTest = function () { return !1 }; else if (t) return void n.listenTo(t); n.change.state() } } }, listenTo: function (t) { n.debug("API request detected, waiting for state signal", t), t && (b.loading && n.update.text(b.loading), e.when(t).then(function () { "resolved" == t.state() ? (n.debug("API request succeeded"), f.activateTest = function () { return !0 }, f.deactivateTest = function () { return !0 }) : (n.debug("API request failed"), f.activateTest = function () { return !1 }, f.deactivateTest = function () { return !1 }), n.change.state() })) }, change: { state: function () { n.debug("Determining state change direction"), n.is.inactive() ? n.activate() : n.deactivate(), f.sync && n.sync(), f.onChange.call(w) }, text: function () { n.is.textEnabled() && (n.is.disabled() ? (n.verbose("Changing text to disabled text", b.hover), n.update.text(b.disabled)) : n.is.active() ? b.hover ? (n.verbose("Changing text to hover text", b.hover), n.update.text(b.hover)) : b.deactivate && (n.verbose("Changing text to deactivating text", b.deactivate), n.update.text(b.deactivate)) : b.hover ? (n.verbose("Changing text to hover text", b.hover), n.update.text(b.hover)) : b.activate && (n.verbose("Changing text to activating text", b.activate), n.update.text(b.activate))) } }, activate: function () { f.activateTest.call(w) && (n.debug("Setting state to active"), C.addClass(p.active), n.update.text(b.active), f.onActivate.call(w)) }, deactivate: function () { f.deactivateTest.call(w) && (n.debug("Setting state to inactive"), C.removeClass(p.active), n.update.text(b.inactive), f.onDeactivate.call(w)) }, sync: function () { n.verbose("Syncing other buttons to current state"), n.is.active() ? a.not(C).state("activate") : a.not(C).state("deactivate") }, get: { text: function () { return f.selector.text ? C.find(f.selector.text).text() : C.html() }, textFor: function (e) { return b[e] || !1 } }, flash: { text: function (e, t, i) { var o = n.get.text(); n.debug("Flashing text message", e, t), e = e || f.text.flash, t = t || f.flashDuration, i = i || function () { }, n.update.text(e), setTimeout(function () { n.update.text(o), i.call(w) }, t) } }, reset: { text: function () { var e = b.active || C.data(g.storedText), t = b.inactive || C.data(g.storedText); n.is.textEnabled() && (n.is.active() && e ? (n.verbose("Resetting active text", e), n.update.text(e)) : t && (n.verbose("Resetting inactive text", e), n.update.text(t))) } }, update: { text: function (e) { var t = n.get.text(); e && e !== t ? (n.debug("Updating text", e), f.selector.text ? C.data(g.storedText, e).find(f.selector.text).text(e) : C.data(g.storedText, e).html(e)) : n.debug("Text is already set, ignoring update", e) } }, setting: function (t, o) { if (n.debug("Changing setting", t, o), e.isPlainObject(t)) e.extend(!0, f, t); else { if (o === i) return f[t]; e.isPlainObject(f[t]) ? e.extend(!0, f[t], o) : f[t] = o } }, internal: function (t, o) { if (e.isPlainObject(t)) e.extend(!0, n, t); else { if (o === i) return n[t]; n[t] = o } }, debug: function () { !f.silent && f.debug && (f.performance ? n.performance.log(arguments) : (n.debug = Function.prototype.bind.call(console.info, console, f.name + ":"), n.debug.apply(console, arguments))) }, verbose: function () { !f.silent && f.verbose && f.debug && (f.performance ? n.performance.log(arguments) : (n.verbose = Function.prototype.bind.call(console.info, console, f.name + ":"), n.verbose.apply(console, arguments))) }, error: function () { f.silent || (n.error = Function.prototype.bind.call(console.error, console, f.name + ":"), n.error.apply(console, arguments)) }, performance: { log: function (e) { var t, i, o; f.performance && (t = (new Date).getTime(), o = s || t, i = t - o, s = t, l.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: w, "Execution Time": i })), clearTimeout(n.performance.timer), n.performance.timer = setTimeout(n.performance.display, 500) }, display: function () { var t = f.name + ":", o = 0; s = !1, clearTimeout(n.performance.timer), e.each(l, function (e, t) { o += t["Execution Time"] }), t += " " + o + "ms", r && (t += " '" + r + "'"), (console.group !== i || console.table !== i) && l.length > 0 && (console.groupCollapsed(t), console.table ? console.table(l) : e.each(l, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), l = [] } }, invoke: function (t, a, r) { var s, l, c, u = k; return a = a || d, r = w || r, "string" == typeof t && u !== i && (t = t.split(/[\. ]/), s = t.length - 1, e.each(t, function (o, a) { var r = o != s ? a + t[o + 1].charAt(0).toUpperCase() + t[o + 1].slice(1) : t; if (e.isPlainObject(u[r]) && o != s) u = u[r]; else { if (u[r] !== i) return l = u[r], !1; if (!e.isPlainObject(u[a]) || o == s) return u[a] !== i ? (l = u[a], !1) : (n.error(m.method, t), !1); u = u[a] } })), e.isFunction(l) ? c = l.apply(r, a) : l !== i && (c = l), e.isArray(o) ? o.push(c) : o !== i ? o = [o, c] : c !== i && (o = c), l } }, u ? (k === i && n.initialize(), n.invoke(c)) : (k !== i && k.invoke("destroy"), n.initialize()) }), o !== i ? o : this }, e.fn.state.settings = { name: "State", debug: !1, verbose: !1, namespace: "state", performance: !0, onActivate: function () { }, onDeactivate: function () { }, onChange: function () { }, activateTest: function () { return !0 }, deactivateTest: function () { return !0 }, automatic: !0, sync: !1, flashDuration: 1e3, filter: { text: ".loading, .disabled", active: ".disabled" }, context: !1, error: { beforeSend: "The before send function has cancelled state change", method: "The method you called is not defined." }, metadata: { promise: "promise", storedText: "stored-text" }, className: { active: "active", disabled: "disabled", error: "error", loading: "loading", success: "success", warning: "warning" }, selector: { text: !1 }, defaults: { input: { disabled: !0, loading: !0, active: !0 }, button: { disabled: !0, loading: !0, active: !0 }, progress: { active: !0, success: !0, warning: !0, error: !0 } }, states: { active: !0, disabled: !0, error: !0, loading: !0, success: !0, warning: !0 }, text: { disabled: !1, flash: !1, hover: !1, active: !1, inactive: !1, activate: !1, deactivate: !1 } } }(jQuery, window, document), function (e, t, n, i) { "use strict"; t = "undefined" != typeof t && t.Math == Math ? t : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(), e.fn.visibility = function (o) { var a, r = e(this), s = r.selector || "", l = (new Date).getTime(), c = [], u = arguments[0], d = "string" == typeof u, f = [].slice.call(arguments, 1), m = r.length, g = 0; return r.each(function () { var r, p, h, v, b = e.isPlainObject(o) ? e.extend(!0, {}, e.fn.visibility.settings, o) : e.extend({}, e.fn.visibility.settings), y = b.className, x = b.namespace, C = b.error, w = b.metadata, k = "." + x, S = "module-" + x, T = e(t), A = e(this), R = e(b.context), P = (A.selector || "", A.data(S)), E = t.requestAnimationFrame || t.mozRequestAnimationFrame || t.webkitRequestAnimationFrame || t.msRequestAnimationFrame || function (e) { setTimeout(e, 0) }, F = this, O = !1; v = { initialize: function () { v.debug("Initializing", b), v.setup.cache(), v.should.trackChanges() && ("image" == b.type && v.setup.image(), "fixed" == b.type && v.setup.fixed(), b.observeChanges && v.observeChanges(), v.bind.events()), v.save.position(), v.is.visible() || v.error(C.visible, A), b.initialCheck && v.checkVisibility(), v.instantiate() }, instantiate: function () { v.debug("Storing instance", v), A.data(S, v), P = v }, destroy: function () { v.verbose("Destroying previous module"), h && h.disconnect(), p && p.disconnect(), T.off("load" + k, v.event.load).off("resize" + k, v.event.resize), R.off("scroll" + k, v.event.scroll).off("scrollchange" + k, v.event.scrollchange), "fixed" == b.type && (v.resetFixed(), v.remove.placeholder()), A.off(k).removeData(S) }, observeChanges: function () { "MutationObserver" in t && (p = new MutationObserver(v.event.contextChanged), h = new MutationObserver(v.event.changed), p.observe(n, { childList: !0, subtree: !0 }), h.observe(F, { childList: !0, subtree: !0 }), v.debug("Setting up mutation observer", h)) }, bind: { events: function () { v.verbose("Binding visibility events to scroll and resize"), b.refreshOnLoad && T.on("load" + k, v.event.load), T.on("resize" + k, v.event.resize), R.off("scroll" + k).on("scroll" + k, v.event.scroll).on("scrollchange" + k, v.event.scrollchange) } }, event: { changed: function (e) { v.verbose("DOM tree modified, updating visibility calculations"), v.timer = setTimeout(function () { v.verbose("DOM tree modified, updating sticky menu"), v.refresh() }, 100) }, contextChanged: function (t) { [].forEach.call(t, function (t) { t.removedNodes && [].forEach.call(t.removedNodes, function (t) { (t == F || e(t).find(F).length > 0) && (v.debug("Element removed from DOM, tearing down events"), v.destroy()) }) }) }, resize: function () { v.debug("Window resized"), b.refreshOnResize && E(v.refresh) }, load: function () { v.debug("Page finished loading"), E(v.refresh) }, scroll: function () { b.throttle ? (clearTimeout(v.timer), v.timer = setTimeout(function () { R.triggerHandler("scrollchange" + k, [R.scrollTop()]) }, b.throttle)) : E(function () { R.triggerHandler("scrollchange" + k, [R.scrollTop()]) }) }, scrollchange: function (e, t) { v.checkVisibility(t) } }, precache: function (t, i) { t instanceof Array || (t = [t]); for (var o = t.length, a = 0, r = [], s = n.createElement("img"), l = function () { a++, a >= t.length && e.isFunction(i) && i() }; o--;)s = n.createElement("img"), s.onload = l, s.onerror = l, s.src = t[o], r.push(s) }, enableCallbacks: function () { v.debug("Allowing callbacks to occur"), O = !1 }, disableCallbacks: function () { v.debug("Disabling all callbacks temporarily"), O = !0 }, should: { trackChanges: function () { return d ? (v.debug("One time query, no need to bind events"), !1) : (v.debug("Callbacks being attached"), !0) } }, setup: { cache: function () { v.cache = { occurred: {}, screen: {}, element: {} } }, image: function () { var e = A.data(w.src); e && (v.verbose("Lazy loading image", e), b.once = !0, b.observeChanges = !1, b.onOnScreen = function () { v.debug("Image on screen", F), v.precache(e, function () { v.set.image(e, function () { g++, g == m && b.onAllLoaded.call(this), b.onLoad.call(this) }) }) }) }, fixed: function () { v.debug("Setting up fixed"), b.once = !1, b.observeChanges = !1, b.initialCheck = !0, b.refreshOnLoad = !0, o.transition || (b.transition = !1), v.create.placeholder(), v.debug("Added placeholder", r), b.onTopPassed = function () { v.debug("Element passed, adding fixed position", A), v.show.placeholder(), v.set.fixed(), b.transition && e.fn.transition !== i && A.transition(b.transition, b.duration) }, b.onTopPassedReverse = function () { v.debug("Element returned to position, removing fixed", A), v.hide.placeholder(), v.remove.fixed() } } }, create: { placeholder: function () { v.verbose("Creating fixed position placeholder"), r = A.clone(!1).css("display", "none").addClass(y.placeholder).insertAfter(A) } }, show: { placeholder: function () { v.verbose("Showing placeholder"), r.css("display", "block").css("visibility", "hidden") } }, hide: { placeholder: function () { v.verbose("Hiding placeholder"), r.css("display", "none").css("visibility", "") } }, set: { fixed: function () { v.verbose("Setting element to fixed position"), A.addClass(y.fixed).css({ position: "fixed", top: b.offset + "px", left: "auto", zIndex: b.zIndex }), b.onFixed.call(F) }, image: function (t, n) { if (A.attr("src", t), b.transition) if (e.fn.transition !== i) { if (A.hasClass(y.visible)) return void v.debug("Transition already occurred on this image, skipping animation"); A.transition(b.transition, b.duration, n) } else A.fadeIn(b.duration, n); else A.show() } }, is: { onScreen: function () { var e = v.get.elementCalculations(); return e.onScreen }, offScreen: function () { var e = v.get.elementCalculations(); return e.offScreen }, visible: function () { return !(!v.cache || !v.cache.element) && !(0 === v.cache.element.width && 0 === v.cache.element.offset.top) } }, refresh: function () { v.debug("Refreshing constants (width/height)"), "fixed" == b.type && v.resetFixed(), v.reset(), v.save.position(), b.checkOnRefresh && v.checkVisibility(), b.onRefresh.call(F) }, resetFixed: function () { v.remove.fixed(), v.remove.occurred() }, reset: function () { v.verbose("Resetting all cached values"), e.isPlainObject(v.cache) && (v.cache.screen = {}, v.cache.element = {}) }, checkVisibility: function (e) { v.verbose("Checking visibility of element", v.cache.element), !O && v.is.visible() && (v.save.scroll(e), v.save.calculations(), v.passed(), v.passingReverse(), v.topVisibleReverse(), v.bottomVisibleReverse(), v.topPassedReverse(), v.bottomPassedReverse(), v.onScreen(), v.offScreen(), v.passing(), v.topVisible(), v.bottomVisible(), v.topPassed(), v.bottomPassed(), b.onUpdate && b.onUpdate.call(F, v.get.elementCalculations())) }, passed: function (t, n) { var o = v.get.elementCalculations(); if (t && n) b.onPassed[t] = n; else { if (t !== i) return v.get.pixelsPassed(t) > o.pixelsPassed; o.passing && e.each(b.onPassed, function (e, t) { o.bottomVisible || o.pixelsPassed > v.get.pixelsPassed(e) ? v.execute(t, e) : b.once || v.remove.occurred(t) }) } }, onScreen: function (e) { var t = v.get.elementCalculations(), n = e || b.onOnScreen, o = "onScreen"; if (e && (v.debug("Adding callback for onScreen", e), b.onOnScreen = e), t.onScreen ? v.execute(n, o) : b.once || v.remove.occurred(o), e !== i) return t.onOnScreen }, offScreen: function (e) { var t = v.get.elementCalculations(), n = e || b.onOffScreen, o = "offScreen"; if (e && (v.debug("Adding callback for offScreen", e), b.onOffScreen = e), t.offScreen ? v.execute(n, o) : b.once || v.remove.occurred(o), e !== i) return t.onOffScreen }, passing: function (e) { var t = v.get.elementCalculations(), n = e || b.onPassing, o = "passing"; if (e && (v.debug("Adding callback for passing", e), b.onPassing = e), t.passing ? v.execute(n, o) : b.once || v.remove.occurred(o), e !== i) return t.passing }, topVisible: function (e) { var t = v.get.elementCalculations(), n = e || b.onTopVisible, o = "topVisible"; if (e && (v.debug("Adding callback for top visible", e), b.onTopVisible = e), t.topVisible ? v.execute(n, o) : b.once || v.remove.occurred(o), e === i) return t.topVisible }, bottomVisible: function (e) { var t = v.get.elementCalculations(), n = e || b.onBottomVisible, o = "bottomVisible"; if (e && (v.debug("Adding callback for bottom visible", e), b.onBottomVisible = e), t.bottomVisible ? v.execute(n, o) : b.once || v.remove.occurred(o), e === i) return t.bottomVisible }, topPassed: function (e) { var t = v.get.elementCalculations(), n = e || b.onTopPassed, o = "topPassed"; if (e && (v.debug("Adding callback for top passed", e), b.onTopPassed = e), t.topPassed ? v.execute(n, o) : b.once || v.remove.occurred(o), e === i) return t.topPassed }, bottomPassed: function (e) { var t = v.get.elementCalculations(), n = e || b.onBottomPassed, o = "bottomPassed"; if (e && (v.debug("Adding callback for bottom passed", e), b.onBottomPassed = e), t.bottomPassed ? v.execute(n, o) : b.once || v.remove.occurred(o), e === i) return t.bottomPassed }, passingReverse: function (e) { var t = v.get.elementCalculations(), n = e || b.onPassingReverse, o = "passingReverse"; if (e && (v.debug("Adding callback for passing reverse", e), b.onPassingReverse = e), t.passing ? b.once || v.remove.occurred(o) : v.get.occurred("passing") && v.execute(n, o), e !== i) return !t.passing }, topVisibleReverse: function (e) { var t = v.get.elementCalculations(), n = e || b.onTopVisibleReverse, o = "topVisibleReverse"; if (e && (v.debug("Adding callback for top visible reverse", e), b.onTopVisibleReverse = e), t.topVisible ? b.once || v.remove.occurred(o) : v.get.occurred("topVisible") && v.execute(n, o), e === i) return !t.topVisible }, bottomVisibleReverse: function (e) { var t = v.get.elementCalculations(), n = e || b.onBottomVisibleReverse, o = "bottomVisibleReverse"; if (e && (v.debug("Adding callback for bottom visible reverse", e), b.onBottomVisibleReverse = e), t.bottomVisible ? b.once || v.remove.occurred(o) : v.get.occurred("bottomVisible") && v.execute(n, o), e === i) return !t.bottomVisible }, topPassedReverse: function (e) { var t = v.get.elementCalculations(), n = e || b.onTopPassedReverse, o = "topPassedReverse"; if (e && (v.debug("Adding callback for top passed reverse", e), b.onTopPassedReverse = e), t.topPassed ? b.once || v.remove.occurred(o) : v.get.occurred("topPassed") && v.execute(n, o), e === i) return !t.onTopPassed }, bottomPassedReverse: function (e) { var t = v.get.elementCalculations(), n = e || b.onBottomPassedReverse, o = "bottomPassedReverse"; if (e && (v.debug("Adding callback for bottom passed reverse", e), b.onBottomPassedReverse = e), t.bottomPassed ? b.once || v.remove.occurred(o) : v.get.occurred("bottomPassed") && v.execute(n, o), e === i) return !t.bottomPassed }, execute: function (e, t) { var n = v.get.elementCalculations(), i = v.get.screenCalculations(); e = e || !1, e && (b.continuous ? (v.debug("Callback being called continuously", t, n), e.call(F, n, i)) : v.get.occurred(t) || (v.debug("Conditions met", t, n), e.call(F, n, i))), v.save.occurred(t) }, remove: { fixed: function () { v.debug("Removing fixed position"), A.removeClass(y.fixed).css({ position: "", top: "", left: "", zIndex: "" }), b.onUnfixed.call(F) }, placeholder: function () { v.debug("Removing placeholder content"), r && r.remove() }, occurred: function (e) { if (e) { var t = v.cache.occurred; t[e] !== i && t[e] === !0 && (v.debug("Callback can now be called again", e), v.cache.occurred[e] = !1) } else v.cache.occurred = {} } }, save: { calculations: function () { v.verbose("Saving all calculations necessary to determine positioning"), v.save.direction(), v.save.screenCalculations(), v.save.elementCalculations() }, occurred: function (e) { e && (v.cache.occurred[e] !== i && v.cache.occurred[e] === !0 || (v.verbose("Saving callback occurred", e), v.cache.occurred[e] = !0)) }, scroll: function (e) { e = e + b.offset || R.scrollTop() + b.offset, v.cache.scroll = e }, direction: function () { var e, t = v.get.scroll(), n = v.get.lastScroll(); return e = t > n && n ? "down" : t < n && n ? "up" : "static", v.cache.direction = e, v.cache.direction }, elementPosition: function () { var e = v.cache.element, t = v.get.screenSize(); return v.verbose("Saving element position"), e.fits = e.height < t.height, e.offset = A.offset(), e.width = A.outerWidth(), e.height = A.outerHeight(), v.cache.element = e, e }, elementCalculations: function () { var e = v.get.screenCalculations(), t = v.get.elementPosition(); return b.includeMargin ? (t.margin = {}, t.margin.top = parseInt(A.css("margin-top"), 10), t.margin.bottom = parseInt(A.css("margin-bottom"), 10), t.top = t.offset.top - t.margin.top, t.bottom = t.offset.top + t.height + t.margin.bottom) : (t.top = t.offset.top, t.bottom = t.offset.top + t.height), t.topVisible = e.bottom >= t.top, t.topPassed = e.top >= t.top, t.bottomVisible = e.bottom >= t.bottom, t.bottomPassed = e.top >= t.bottom, t.pixelsPassed = 0, t.percentagePassed = 0, t.onScreen = t.topVisible && !t.bottomPassed, t.passing = t.topPassed && !t.bottomPassed, t.offScreen = !t.onScreen, t.passing && (t.pixelsPassed = e.top - t.top, t.percentagePassed = (e.top - t.top) / t.height), v.cache.element = t, v.verbose("Updated element calculations", t), t }, screenCalculations: function () { var e = v.get.scroll(); return v.save.direction(), v.cache.screen.top = e, v.cache.screen.bottom = e + v.cache.screen.height, v.cache.screen }, screenSize: function () { v.verbose("Saving window position"), v.cache.screen = { height: R.height() } }, position: function () { v.save.screenSize(), v.save.elementPosition() } }, get: { pixelsPassed: function (e) { var t = v.get.elementCalculations(); return e.search("%") > -1 ? t.height * (parseInt(e, 10) / 100) : parseInt(e, 10) }, occurred: function (e) { return v.cache.occurred !== i && (v.cache.occurred[e] || !1) }, direction: function () { return v.cache.direction === i && v.save.direction(), v.cache.direction }, elementPosition: function () { return v.cache.element === i && v.save.elementPosition(), v.cache.element }, elementCalculations: function () { return v.cache.element === i && v.save.elementCalculations(), v.cache.element }, screenCalculations: function () { return v.cache.screen === i && v.save.screenCalculations(), v.cache.screen }, screenSize: function () { return v.cache.screen === i && v.save.screenSize(), v.cache.screen }, scroll: function () { return v.cache.scroll === i && v.save.scroll(), v.cache.scroll }, lastScroll: function () { return v.cache.screen === i ? (v.debug("First scroll event, no last scroll could be found"), !1) : v.cache.screen.top } }, setting: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, b, t); else { if (n === i) return b[t]; b[t] = n } }, internal: function (t, n) { if (e.isPlainObject(t)) e.extend(!0, v, t); else { if (n === i) return v[t]; v[t] = n } }, debug: function () { !b.silent && b.debug && (b.performance ? v.performance.log(arguments) : (v.debug = Function.prototype.bind.call(console.info, console, b.name + ":"), v.debug.apply(console, arguments))) }, verbose: function () { !b.silent && b.verbose && b.debug && (b.performance ? v.performance.log(arguments) : (v.verbose = Function.prototype.bind.call(console.info, console, b.name + ":"), v.verbose.apply(console, arguments))) }, error: function () { b.silent || (v.error = Function.prototype.bind.call(console.error, console, b.name + ":"), v.error.apply(console, arguments)) }, performance: { log: function (e) { var t, n, i; b.performance && (t = (new Date).getTime(), i = l || t, n = t - i, l = t, c.push({ Name: e[0], Arguments: [].slice.call(e, 1) || "", Element: F, "Execution Time": n })), clearTimeout(v.performance.timer), v.performance.timer = setTimeout(v.performance.display, 500) }, display: function () { var t = b.name + ":", n = 0; l = !1, clearTimeout(v.performance.timer), e.each(c, function (e, t) { n += t["Execution Time"] }), t += " " + n + "ms", s && (t += " '" + s + "'"), (console.group !== i || console.table !== i) && c.length > 0 && (console.groupCollapsed(t), console.table ? console.table(c) : e.each(c, function (e, t) { console.log(t.Name + ": " + t["Execution Time"] + "ms") }), console.groupEnd()), c = [] } }, invoke: function (t, n, o) { var r, s, l, c = P; return n = n || f, o = F || o, "string" == typeof t && c !== i && (t = t.split(/[\. ]/), r = t.length - 1, e.each(t, function (n, o) { var a = n != r ? o + t[n + 1].charAt(0).toUpperCase() + t[n + 1].slice(1) : t; if (e.isPlainObject(c[a]) && n != r) c = c[a]; else { if (c[a] !== i) return s = c[a], !1; if (!e.isPlainObject(c[o]) || n == r) return c[o] !== i ? (s = c[o], !1) : (v.error(C.method, t), !1); c = c[o] } })), e.isFunction(s) ? l = s.apply(o, n) : s !== i && (l = s), e.isArray(a) ? a.push(l) : a !== i ? a = [a, l] : l !== i && (a = l), s } }, d ? (P === i && v.initialize(), P.save.scroll(), P.save.calculations(), v.invoke(u)) : (P !== i && P.invoke("destroy"), v.initialize()) }), a !== i ? a : this }, e.fn.visibility.settings = { name: "Visibility", namespace: "visibility", debug: !1, verbose: !1, performance: !0, observeChanges: !0, initialCheck: !0, refreshOnLoad: !0, refreshOnResize: !0, checkOnRefresh: !0, once: !0, continuous: !1, offset: 0, includeMargin: !1, context: t, throttle: !1, type: !1, zIndex: "10", transition: "fade in", duration: 1e3, onPassed: {}, onOnScreen: !1, onOffScreen: !1, onPassing: !1, onTopVisible: !1, onBottomVisible: !1, onTopPassed: !1, onBottomPassed: !1, onPassingReverse: !1, onTopVisibleReverse: !1, onBottomVisibleReverse: !1, onTopPassedReverse: !1, onBottomPassedReverse: !1, onLoad: function () { }, onAllLoaded: function () { }, onFixed: function () { }, onUnfixed: function () { }, onUpdate: !1, onRefresh: function () { }, metadata: { src: "src" }, className: { fixed: "fixed", placeholder: "placeholder", visible: "visible" }, error: { method: "The method you called is not defined.", visible: "Element is hidden, you must call refresh after element becomes visible" } } }(jQuery, window, document); var haveEvents = "GamepadEvent" in window; var haveWebkitEvents = "WebKitGamepadEvent" in window; var controllers = {}; var updateAF; var rAF = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame; function connecthandler(e, flag) { if (flag) { addgamepad(e.gamepad); var openLayer = layer.msg("åç°ææ,ç®ååªæ¯æXboxå¼å®¹ææ", { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }) } } function addgamepad(gamepad) { controllers[gamepad.index] = gamepad; rAF(updateStatus) } function disconnecthandler(e, flag) { if (flag) { removegamepad(e.gamepad); layer.msg("ææå·²ç§»é¤", { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }) } } function removegamepad(gamepad) { delete controllers[gamepad.index]; var count = 0; for (var i in controllers) { count++ } if (!count && updateAF) { window.cancelAnimationFrame(updateAF); updateAF = undefined } } function updateStatus() { scangamepads(); if (typeof xc != "undefined" && xc != null) { for (var j in controllers) { var controller = controllers[j]; if (controller == null || typeof controller == "undefined" || typeof controller.id == "undefined") { continue } var buttonX, buttonY, buttonA, buttonB, buttonLT, buttonLB, buttonRT, buttonRB, buttonBack, buttonStart, buttonAxisL, buttonAxisR, buttonUp, buttonDown, buttonLeft, buttonRight; var buttonState, hat, hat_tmp; for (var buttonIndex in controller.buttons) { var button = controller.buttons[buttonIndex]; if (button.pressed) { } } var buttonsSize = controller.buttons.length; if (buttonsSize >= 10) { buttonA = controller.buttons[0].pressed; buttonB = controller.buttons[1].pressed; buttonX = controller.buttons[2].pressed; buttonY = controller.buttons[3].pressed; buttonLT = controller.buttons[6].pressed; buttonLB = controller.buttons[4].pressed; buttonRT = controller.buttons[7].pressed; buttonRB = controller.buttons[5].pressed; buttonBack = controller.buttons[8].pressed; buttonStart = controller.buttons[9].pressed } if (buttonsSize >= 16) { buttonAxisL = controller.buttons[10].pressed; buttonAxisR = controller.buttons[11].pressed; buttonUp = controller.buttons[12].pressed; buttonRight = controller.buttons[15].pressed; buttonDown = controller.buttons[13].pressed; buttonLeft = controller.buttons[14].pressed } buttonState = (buttonX ? 16384 : 0) | (buttonA ? 4096 : 0) | (buttonB ? 8192 : 0) | (buttonY ? 32768 : 0) | (buttonAxisL ? 64 : 0) | (buttonAxisR ? 128 : 0) | (buttonLB ? 256 : 0) | (buttonRB ? 512 : 0) | (buttonBack ? 32 : 0) | (buttonStart ? 16 : 0) | (buttonUp ? 1 : 0) | (buttonRight ? 8 : 0) | (buttonDown ? 2 : 0) | (buttonLeft ? 4 : 0); hat_tmp = +buttonUp + +buttonRight * 2 + +buttonDown * 4 + +buttonLeft * 8; var map = { 0: 0, 1: 1, 3: 32, 2: 64, 6: 96, 4: 128, 12: 160, 8: 192, 9: 224 }; hat = map[hat_tmp]; var LAxisX, LAxisY, RAxisX, RAxisY; for (var i = 0; i < controller.axes.length; i++) { var axis = controller.axes[i]; if (axis > -.15 && axis < .15) { axis = 0 } axis *= 32767; switch (i) { case 0: LAxisX = axis; break; case 1: LAxisY = -axis; break; case 2: RAxisX = axis; break; case 3: RAxisY = -axis } } if (xc.gamepadButton != buttonState || xc.LAxisX != LAxisX || xc.LAxisY != LAxisY || xc.RAxisX != RAxisX || xc.RAxisY != RAxisY || xc.hat != hat || xc.LTrigger != controller.buttons[6].value || xc.RTrigger != controller.buttons[7].value) { xc.gamepadButton = buttonState; xc.LAxisX = LAxisX; xc.LAxisY = LAxisY; xc.RAxisX = RAxisX; xc.RAxisY = RAxisY; xc.LTrigger = controller.buttons[6].value * 255; xc.RTrigger = controller.buttons[7].value * 255; var msg = new DataChannelMsg; var gamepad = new DataChannelMsgGamePad(buttonState, xc.LTrigger, xc.RTrigger, LAxisX, LAxisY, RAxisX, RAxisY); sendMsg(msg.build_msg(INPUT_TYPE_GAMEPAD, gamepad)) } } } updateAF = rAF(updateStatus) } function scangamepads() { var gamepads = navigator.getGamepads ? navigator.getGamepads() : navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : []; for (var i = 0; i < gamepads.length; i++) { if (gamepads[i]) { if (!(gamepads[i].index in controllers)) { addgamepad(gamepads[i]) } else { controllers[gamepads[i].index] = gamepads[i] } } } } function handleGamePadEffect(strongMagnitudeValue, weakMagnitudeValue) { for (var j in controllers) { var controller = controllers[j]; if (controller == null || typeof controller == "undefined" || controller.vibrationActuator == null || typeof controller.vibrationActuator == "undefined") { return } if (strongMagnitudeValue == null || typeof strongMagnitudeValue == "undefined") { strongMagnitudeValue = 0 } if (weakMagnitudeValue == null || typeof weakMagnitudeValue == "undefined") { weakMagnitudeValue = 0 } if (strongMagnitudeValue == 0 && weakMagnitudeValue == 0) { controller.vibrationActuator.reset() } else { controller.vibrationActuator.playEffect("dual-rumble", { duration: 5e3, strongMagnitude: strongMagnitudeValue * 1 / 255, weakMagnitude: weakMagnitudeValue * 1 / 255 }) } } } var showed = false; var showed_15 = false; var showed_3 = false; var showed_card_3 = false; var showed_card_15 = false; var showed_free_3 = false; var showed_free_15 = false; var showed_change_18 = false; var showed_change_16 = false; var hintTimer; var timer; var hintFlag = true; function handlePCStats(pc, pc_constraints) { if (!navigator.mozGetUserMedia && window.useREST) { getStats(pc, function (result) { var video = {}; var audio = {}; var bandWidth = {}; var rtt = -1; result.results.forEach(function (r) { if (r.mediaType == "video") { video = r } if (r.mediaType == "audio") { audio = r } if (r.type == "VideoBwe") { bandWidth = r } if (r.googActiveConnection == "true" && r.type == "googCandidatePair") { rtt = parseInt(r.googRtt) } }); var jsonResult = {}; video.rtt = rtt; jsonResult.instanceKey = getUrlParam("key"); jsonResult.user = "web"; post("/api/v1/web/running/heartbeat3", { content: JSON.stringify(jsonResult) }, function (req) { req.setRequestHeader("token", localStorage.getItem("token")) }, function (data) { var code = data.code; gameTime(data); if (code == 0) { showed_15 = false; showed_3 = false; showed_card_3 = false; showed_card_15 = false; showed_free_3 = false; showed_free_15 = false; showed_change_18 = false; showed_change_16 = false } else if (code == 4) { if (showed_15 == false) { layer.msg('éå¸ä½é¢å·²ä¸è¶³15åéï¼å»ºè®®æ¨<span class="clientPay">ç«å³ç»­è´¹</span> <img src="https://image.anygame.info/source/front/images/client/clientMsgClose.png" />', { time: -1, skin: "clientPayGold", offset: ["65px", "auto"], anim: 5 }); showed_15 = true; var gameStartList = JSON.parse(localStorage.getItem("gameStartList")); localStorage.setItem("guide_time", "15åé"); var anGuide_pay_num = { game_name: `${gameStartList.game_name}`, game_area: `${gameStartList.game_area}`, guide_time: "15åé", guide_area: true, guide_place: true }; sendAnalysysAgent("track", anGuide_pay_num, "guide_pay_num") } } else if (code == 5) { if (showed_3 == false) { layer.msg('éå¸ä½é¢å·²ä¸è¶³3åéï¼å»ºè®®æ¨<span class="clientPay">ç«å³ç»­è´¹</span> <img src="https://image.anygame.info/source/front/images/client/clientMsgClose.png" />', { time: -1, skin: "clientPayGold", offset: ["65px", "auto"], anim: 5 }); showed_3 = true; var gameStartList = JSON.parse(localStorage.getItem("gameStartList")); localStorage.setItem("guide_time", "3åé"); var anGuide_pay_num = { game_name: `${gameStartList.game_name}`, game_area: `${gameStartList.game_area}`, guide_time: "3åé", guide_area: true, guide_place: true }; sendAnalysysAgent("track", anGuide_pay_num, "guide_pay_num") } } else if (code == 14) { if (showed_card_15 == false) { layer.msg('å¡åå·²ä¸è¶³15åéï¼å°è½¬æ¢éå¸æ£è´¹ï¼å»ºè®®æ¨<span class="clientPay">ç«å³è´­å¡</span> <img src="https://image.anygame.info/source/front/images/client/clientMsgClose.png" />', { time: -1, skin: "clientPayCard", offset: ["65px", "auto"], anim: 5 }); showed_card_15 = true; var gameStartList = JSON.parse(localStorage.getItem("gameStartList")); localStorage.setItem("guide_time", "15åé"); var anGuide_pay_num = { game_name: `${gameStartList.game_name}`, game_area: `${gameStartList.game_area}`, guide_time: "15åé", guide_area: true, guide_place: true }; sendAnalysysAgent("track", anGuide_pay_num, "guide_pay_num") } } else if (code == 15) { if (showed_card_3 == false) { layer.msg('å¡åå·²ä¸è¶³3åéï¼å°è½¬æ¢éå¸æ£è´¹ï¼å»ºè®®æ¨<span class="clientPay">ç«å³è´­å¡</span> <img src="https://image.anygame.info/source/front/images/client/clientMsgClose.png" />', { time: -1, skin: "clientPayCard", offset: ["65px", "auto"], anim: 5 }); showed_card_3 = true; var gameStartList = JSON.parse(localStorage.getItem("gameStartList")); localStorage.setItem("guide_time", "3åé"); var anGuide_pay_num = { game_name: `${gameStartList.game_name}`, game_area: `${gameStartList.game_area}`, guide_time: "3åé", guide_area: true, guide_place: true }; sendAnalysysAgent("track", anGuide_pay_num, "guide_pay_num") } } else if (code == 16) { if (showed_change_16 == false) { layer.msg("è´­å¡æåï¼å·²è½¬ä¸ºçç©å¡è®¡è´¹", { time: 3e3, skin: "clientPayCard", offset: ["65px", "auto"], anim: 5 }); showed_change_16 = true; showed_15 = false; showed_3 = false; showed_card_3 = false; showed_card_15 = false; showed_free_3 = false; showed_free_15 = false; showed_change_18 = false } } else if (code == 18) { if (showed_change_18 == false) { layer.msg('å¡åå·²å°æï¼è½¬ä¸ºéå¸æ£è´¹ï¼å»ºè®®æ¨<span class="clientPay">ç«å³è´­å¡</span> <img src="https://image.anygame.info/source/front/images/client/clientMsgClose.png" />', { time: -1, skin: "clientPayCard", offset: ["65px", "auto"], anim: 5 }); showed_change_18 = true; showed_15 = false; showed_3 = false; showed_card_3 = false; showed_card_15 = false; showed_free_3 = false; showed_free_15 = false; showed_change_16 = false; var gameStartList = JSON.parse(localStorage.getItem("gameStartList")); localStorage.setItem("guide_time", "0åé"); var anGuide_pay_num = { game_name: `${gameStartList.game_name}`, game_area: `${gameStartList.game_area}`, guide_time: "0åé", guide_area: true, guide_place: true }; sendAnalysysAgent("track", anGuide_pay_num, "guide_pay_num") } } else if (code == 24) { if (showed_free_15 == false) { layer.msg('æ¨çåè´¹æ¶é¿è¿å©ä¸å°15åéï¼å»ºè®®æ¨åå¾ä»è´¹åº<img src="https://image.anygame.info/source/front/images/client/clientMsgClose.png" />', { time: -1, skin: "clientFree", offset: ["65px", "auto"], anim: 5 }); showed_free_15 = true; var gameStartList = JSON.parse(localStorage.getItem("gameStartList")); var anGuide_pay_num = { game_name: `${gameStartList.game_name}`, game_area: `${gameStartList.game_area}`, guide_time: "15åé", guide_area: false, guide_place: true }; sendAnalysysAgent("track", anGuide_pay_num, "guide_pay_num") } } else if (code == 25) { if (showed_free_3 == false) { layer.msg('æ¨çåè´¹æ¶é¿è¿å©ä¸å°3åéï¼å»ºè®®æ¨åå¾ä»è´¹åº<img src="https://image.anygame.info/source/front/images/client/clientMsgClose.png" />', { time: 5e3, skin: "clientFree", offset: ["65px", "auto"], anim: 5 }); showed_free_3 = true; var gameStartList = JSON.parse(localStorage.getItem("gameStartList")); var anGuide_pay_num = { game_name: `${gameStartList.game_name}`, game_area: `${gameStartList.game_area}`, guide_time: "3åé", guide_area: false, guide_place: true }; sendAnalysysAgent("track", anGuide_pay_num, "guide_pay_num") } } else if (code == 6 || code == 7) { layer.msg(data.message, { time: 1e4, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }, function () { window.opener = null; window.open("", "_self"); window.close() }) } else if (code == 63 || code == 66) { layer.msg(`${data.message}<img src="https://image.anygame.info/source/front/images/client/clientMsgClose.png" />`, { time: 5e3, skin: "clientFree", offset: ["65px", "auto"], anim: 5 }) } else if (code == 9999) { layer.msg(data.message, { time: 5e3, skin: "clientMsg", offset: ["80%", "40px"], anim: 3 }, function () { window.opener = null; window.open("", "_self"); window.close() }) } }, true) }, 15 * 1e3) } window.count = 0; window.bitrate = ""; window.lastPacketsReceived = 0; window.lastBytesReceived = 0; var lastPacktetsLost = 0; var lastPacktetsReceived = 0; if (!navigator.mozGetUserMedia) { getStats(pc, function (result) { window.count++; var rtt, info; result.results.forEach(function (r) { if (r.googActiveConnection == "true" && r.type == "googCandidatePair") { rtt = parseInt(r.googRtt); $("#hintDelay").html(`å»¶è¿ï¼<i>${r.googRtt}ms</i>`) } if (r.mediaType == "video") { $("#packet_loss").text(r.packetsLost); $("#nack").text(r.googNacksSent); $("#hintFps").html(`FPSï¼<i>${r.googFrameRateOutput}</i>`); var bps = r.bytesReceived - window.lastBytesReceived; var bitrate = bps / 1024 / 128; window.bitrate = window.bitrate + window.count + " " + bitrate.toFixed(2) + "\n"; window.lastBytesReceived = r.bytesReceived; $("#packet_received").text(r.packetsReceived); var totalPackets = parseInt(r.packetsReceived - lastPacktetsReceived) + parseInt(r.packetsLost - lastPacktetsLost); var packetsLost = r.packetsLost - lastPacktetsLost; var packetsLostPerc = packetsLost / totalPackets * 100; lastPacktetsLost = r.packetsLost; lastPacktetsReceived = r.packetsReceived; $("#packet_lost_rate").text(packetsLostPerc.toFixed(2)); $("#packetlostrate").text(packetsLostPerc.toFixed(1) + "%"); info = new DataChannelMsgPCInfo(r.googFrameRateReceived, bps, r.googCurrentDelayMs, r.packetsLost, r.packetsReceived - window.lastPacketsReceived, r.googNacksSent, r.googFrameRateOutput); window.lastPacketsReceived = r.packetsReceived; var bitsReceivedPerSecond = bitrate; $("#currentRate").text(bitsReceivedPerSecond.toFixed(2) + "Mbps") } if (r.type == "VideoBwe") { } }); if (info) { var msg = new DataChannelMsg; info.rtt = rtt; sendMsg(msg.build_msg(DATA_CHANNEL_MSG_PC_INFO, info)) } }, 1e3) } } var Deviation = function (numbers) { var mean = 0; var sum = 0; for (var i = 0; i < numbers.length; i++) { sum += numbers[i] } mean = sum / numbers.length; sum = 0; for (var i = 0; i < numbers.length; i++) { sum += Math.pow(numbers[i] - mean, 2) } return Math.sqrt(sum / numbers.length) }; function formatSeconds(value) { var theTime = parseInt(value); var theTime1 = 0; var theTime2 = 0; if (theTime > 60) { theTime1 = parseInt(theTime / 60); theTime = parseInt(theTime % 60); if (theTime1 > 60) { theTime2 = parseInt(theTime1 / 60); theTime1 = parseInt(theTime1 % 60) } } var result = "" + parseInt(theTime); if (10 > theTime > 0) { result = "0" + parseInt(theTime) } else { result = "" + parseInt(theTime) } if (10 > theTime1 > 0) { result = "0" + parseInt(theTime1) + ":" + result } else { result = "" + parseInt(theTime1) + ":" + result } if (theTime2 > 0) { result = "" + parseInt(theTime2) + ":" + result } return result } function gameTime(data) { if (hintFlag) { $("#hintTime").html(`å¨çº¿æ¶é´ï¼<i>${formatSeconds(data.data)}</i>`); hintFlag = false } timer = data.data; if (!hintTimer) { localStorage.removeItem("clientClose"); hintTimer = setInterval(() => { $("#hintTime").html(`å¨çº¿æ¶é´ï¼<i>${formatSeconds(timer++)}</i>`); if (localStorage.getItem("clientClose")) { localStorage.removeItem("clientClose"); window.close() } }, 1e3) } }