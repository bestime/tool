<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="../js/bestime.min.js"></script>
    <script src="../js/test.js"></script>

    <script>
      ns.write('style', '../css/bestime.css', true)
      ns.write('script', '../js/update-version.js', true)
    </script>
    <!-- <script src="https://apps.bdimg.com/libs/jquery/1.9.1/jquery.min.js"></script> -->
    <title>测试页面</title>
  </head>

  <body>
    <button onclick="debounceDemo()">防抖升级版</button>
    <button onclick="throttleDemo()">节流升级版</button>
    <button onclick="confirmDemo()">确认函数</button>
    <button onclick="loopDemo()">轮询升级</button>
    <div style="margin:20px;">
      <div>可输入小数，正负数</div>
      <input style="border:red solid 1px;line-height:24px;width:100%;" placeholder="只能输入数字" id="axmk165a" />
    </div>
    <script>
      document.getElementById('axmk165a').oninput = function () {
        this.value = ns.symbolNumber(this.value)
      }
    </script>



    <style>
      * {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      #test {
        height: 300px;
        background: #fff;
        overflow: auto;
        position: relative;
        width: 600px;
        border: #ddd solid 1px;
        margin: 20px;
      }

      #test li {
        line-height: 40px;
        background: #f9f9f9;
        color: #444;
        margin: 10px;
        border: #ddd solid 1px;
        text-align: center;
      }

      #test li:after {
        content: '';
      }

      #sbgs12 {
        width: 100rem;
        line-height: 2;
        text-align: center;
        background: #f9f9f9;
        color: #999;
        margin: 20px;
        cursor: pointer;
      }

      #sbgs12.active {
        background: red;
        color: #fff;
      }
    </style>



    <a href="http://www.baidu.com" onClick="test02()">点击弹框，右键跳转</a>
    <div id="sbgs12" class="active map array some">鼠标移入<br>切换跟随</div>
    <div id="mouse-01"
      style="transition:0.2s ease-out;width:100px;height:100px;background:rgba(255, 255, 0, 0.7);position:fixed;z-index:100;display:none;">
    </div>
    <div id="mouse-02"
      style="transition:0.3s ease-out;width:130px;height:50px;background:rgba(255, 0, 255, 0.7);position:fixed;z-index:100;display:none;">
    </div>
    <div id="mouse-03"
      style="transition:0.15s ease-out;width:50px;height:130px;background:rgba(0, 255, 255, 0.7);position:fixed;z-index:100;display:none;">
    </div>
    <script>
      function test02(ev) {
        ev = ev || window.event;
        window.event ? window.event.returnValue = false : ev.preventDefault();
        ns.dialog({ msg: '被点击了, 不会跳转' })
      }
    </script>

    <div>
      <button onclick="scrollToBottom01()">滚动到底部</button>
    </div>
    <div id="test">
      <ul>
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
        <li id="tartet">6</li>
        <li>7</li>
        <li>8</li>
        <li>9</li>
        <li>10</li>
        <li>11</li>
        <li>12</li>
      </ul>
    </div>

    <style>
      #test15645 {
        display: inline-block;
        padding: 5px 10px;
        background: red;
        color: #fff;
      }
    </style>
    <div id="test15645"></div>
    <script>
      function wetw(el, msg) {
        el.innerHTML = msg
        var timer = setInterval(function () {
          msg = msg.substring(1) + msg.substr(0, 1)
          el.innerHTML = msg
        }, 150)
      }

      wetw(document.getElementById('test15645'), '欢迎使用XXX示例，这只是测试数据！')
    </script>




    <div class="demo">
      <h1>啊手动阀</h1>
    </div>
    <style>
      .demo {
        text-align: center;
      }

      .demo img {
        display: inline-block;
        vertical-align: middle;
        max-width: 100%;
        margin: 0;
        padding: 0;
      }
    </style>


  </body>


  <script>
    ns.scrollToElement(document.getElementById('tartet'), document.getElementById('test'), function () {
      console.log('完了')
    })

    var mus01, mus02, mus03;
    ns.DomMouse({
      el: document.getElementById('sbgs12'),
      onMouseEnter: function () {
        if (mus01 && mus01.isActive()) {
          mus01.remove()
          mus02.remove()
          mus03.remove()
          ns.removeClass(document.getElementById('sbgs12'), 'active')
        } else {
          ns.addClass(document.getElementById('sbgs12'), 'active')
          openGenSui()
        }
      },
      onMouseLeave: function () {
        console.log('leave')
      }
    })

    function openGenSui() {
      var options = {
        offsetHorizontal: 5,
        offsetVertical: 5
      }
      mus01 = ns.ContainerFollowMouse(document.getElementById('mouse-01'), options)
      mus02 = ns.ContainerFollowMouse(document.getElementById('mouse-02'), options)
      mus03 = ns.ContainerFollowMouse(document.getElementById('mouse-03'), options)
    }

    ns.removeClass(document.getElementById('sbgs12'), 'some')
  
    function scrollToBottom01() {
      ns.scrollToBottom(document.getElementById('test'))
    }

    ns.ready(function () {
      ns.onDomRoll(document.getElementById('test'), {
        onBottom: function (next) {
          console.log('到底了')
          next()
        }
      })
    })
    // 上十字 => 右下，上左，面逆，上右，面顺，右上
    // 鱼头 => 右下，上右，右上，右下，上右右，右上
  </script>












<script>











ns.formatTime('YY-M-D h:m:s:SSS')



/**
 * 组合区间
 * @param {Array:[]} list 区间片段列表
 */
function section(list) {
  var res = [], find, item;
  ;(function once () {
    if(list.length) {
      find = false
      item = list.splice(0, 1)[0]
      // console.log(item, list)
      list.forEach(function (current) {
        // console.log(item[0], current[1])
        var gp = toGroup(item, current)
        if(gp) {
          find = true
          current[0] = gp[0]
          current[1] = gp[1]
        }
      })
      if(!find) {
        res.push(item)
      }
      once()
    }
  })();
  return res;
}


/**
 *  两个区间是否重复
 */
function toGroup (a, b) {
  a.sort(_sort)
  b.sort(_sort)
  var x1 = a[0]
  var y1 = a[1]
  var x2 = b[0]
  var y2 = b[1] 
  var diff1 = y1 - x1
  var diff2 = y2 - x2
  var min = Math.min(x1, x2)
  var max = Math.max(y1, y2)
  if(Math.abs(max-min) <= Math.abs(diff1+diff2+1)) {
    return [min, max]
  } else {
    return false
  }
}


// 排序
function _sort (a, b) {
  return a > b ? 1 : -1
}





function demo (list) {
  list.sort(function (a, b) {
    return a[0] > b[0] ? 1 : -1
  })  
  for(var a1, a2, index=0; index < list.length; index++) {
    a1 = list[index]
    a2 = list[index+1]
    if(!a2) break; 
    if(a1[1] >= a2[0] - 1) {
      a2[0] = Math.min(a2[0], a1[0])
      a2[1] = Math.max(a2[1], a1[1])
      if(list.length>1) {
        list.splice(index, 1)
        index--
      }
    }  
  }
  return list
}







var testDC = ns.FN_debounce(1000, true)
var testThis = {
  time: 0
}
function debounceDemo () {  
  testDC.call(testThis, function () {
    console.log('防抖升级版', this.time++)
  })
}



var testTH = ns.FN_throttle(1000, true, false)
var jkdw = {
  time: 0
}
function throttleDemo () {
  testTH.call(jkdw, function () {
    console.log('节流升级版', this.time++)
  })
}





const confirmFN = ns.FN_confirm()

function confirmDemo () {
  confirmFN(function (next) {
    next()
    console.log(11111)
  })
}








ns.urlToGet('1111111111', {})
ns.urlToGet('2222222222?&', 'a=0&b=2')
ns.urlToGet('333333333?c=5&', 'a=0&b=2')
ns.urlToGet('333333333?c=5&', {
  name: '张三',
  age: [1, 2, 3]
})


function _downLoad (src, filename) {
  filename = filename || '图片01';
  var link = document.createElement('a');
  link.download = filename;
  link.style.display = 'none';
  link.href = src;
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
</script>





</html>